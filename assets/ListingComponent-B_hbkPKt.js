import{k as ne,l as oe,P as z,u as M,t as $,b as D,a as d,m as F,n as B,o as H,p as ie,d as le,s as Y,A as E,j as e,D as re,f as _,T as L,F as ce,B as x,q as de,v as ue,I as pe,S as me,M as he,w as ge,h as S,x as xe,y as fe,U as J,G as q}from"./index-dsWAcX1f.js";import{d as be,l as G,S as je,a as ye,b as Ce}from"./listBG-dw88K66u.js";import{c as Q}from"./index-mbUFVO5S.js";import{u as Se}from"./index-uKa1WJb8.js";import"./FormControlLabel-GbaKk4ky.js";import"./toPropertyKey-Z1a84DJL.js";import"./typeof-LnL08gqA.js";import"./CircularProgress-4dZqOr9B.js";const ve=ne().shape({name:oe().min(1,"Name is Too Short!").max(40,"Name is Too Long!").required("This Field is Required")}),V={name:"",status:"inactive",subjects:[]},K=({openDialog:v,setOpenDialog:f})=>{const h=M(),u=$(h.palette.mode),b=D(h.breakpoints.down("md")),A=D("(max-width:480px)"),s=D("(max-width:920px)"),T=()=>{f(!1)},[g,k]=d.useState("Create"),[R,n]=d.useState(!1),[w,p]=d.useState(V),j=F(t=>t.menuItems.selected),y=F(t=>t.toastInfo),m=B(),r=H(),{state:I}=ie(),{typography:P}=le(h.palette.mode),{toastAndNavigate:l,getLocalStorage:X,getIdsFromObject:W}=J();let O=I==null?void 0:I.id;d.useEffect(()=>{const t=X("menu");r(Y(t.selected)),O?(k("Update"),ee(O)):(k("Create"),p(V))},[O]);const Z=d.useCallback(t=>{const o=[{...t,subjects:W(t.subjects)}],a=["/update-class"];n(!0),E.CommonAPI.multipleAPICall("PATCH",a,o).then(i=>{let c=!0;i.forEach(C=>{C.data.status!=="Success"&&(c=!1)}),c?(n(!1),l(r,!0,"info","Successfully Updated",m,"/class/listing",location.reload())):(n(!1),l(r,!0,"error","An Error Occurred. Please Try Again",m,location.reload()))}).catch(i=>{var c,C;throw n(!1),l(r,!0,"error",(C=(c=i==null?void 0:i.response)==null?void 0:c.data)==null?void 0:C.msg),i})},[]),ee=d.useCallback(t=>{n(!0);const o=[`/get-by-pk/class/${t}`];E.CommonAPI.multipleAPICall("GET",o).then(a=>{a[0].data.status==="Success"?(p(a[0].data.data),n(!1)):(n(!1),l(r,!0,"error","An Error Occurred, Please Try Again",m,0))}).catch(a=>{var i,c;throw n(!1),l(r,!0,"error",a?(c=(i=a==null?void 0:a.response)==null?void 0:i.data)==null?void 0:c.msg:"An Error Occurred",m,0),a})},[]),te=d.useCallback(t=>{n(!0),t={...t,subjects:W(t==null?void 0:t.subjects)},E.ClassAPI.createClass(t).then(({data:o})=>{(o==null?void 0:o.status)==="Success"?(n(!1),l(r,!0,"success","Successfully Created"),setTimeout(()=>{T(),m(0)},2e3)):(n(!1),l(r,!0,"error","An Error Occurred, Please Try Again",m,0))}).catch(o=>{var a,i;throw n(!1),l(r,!0,o?(i=(a=o.response)==null?void 0:a.data)==null?void 0:i.msg:"An Error Occurred",m,0),o})},[]);return e.jsx("div",{children:e.jsxs(re,{fullScreen:b,open:v,onClose:T,"aria-labelledby":"responsive-dialog-title",sx:{top:A?"33%":s?"25%":"20%",height:A?"49%":s?"39%":"60%","& .MuiPaper-root":{width:"100%",backgroundImage:h.palette.mode=="light"?`linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url(${_})`:`linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), url(${_})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}},children:[e.jsx(L,{fontFamily:P.fontFamily,fontSize:P.h2.fontSize,color:u.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${g} ${j}`}),e.jsx(ce,{initialValues:w,enableReinitialize:!0,validationSchema:ve,onSubmit:t=>{t.id?Z(t):te(t)},children:({values:t,errors:o,touched:a,dirty:i,isSubmitting:c,handleBlur:C,handleChange:U,handleSubmit:ae,resetForm:se})=>e.jsxs("form",{onSubmit:ae,children:[e.jsxs(x,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(de,{variant:"filled",type:"text",name:"name",label:"Name*",autoComplete:"new-name",onBlur:C,onChange:U,value:t.name,error:!!a.name&&!!o.name,helperText:a.name&&o.name}),e.jsxs(ue,{variant:"filled",sx:{minWidth:120},error:!!a.status&&!!o.status,children:[e.jsx(pe,{id:"statusField",children:"Status"}),e.jsx(me,{variant:"filled",labelId:"statusField",label:"Status",name:"status",autoComplete:"new-status",value:t.status,onChange:U,children:Object.keys(Q.status).map(N=>e.jsx(he,{value:N,children:Q.status[N]},N))})]})]}),e.jsx(ge,{}),e.jsxs(x,{display:"flex",justifyContent:"end",p:"20px",children:[g==="Update"?null:e.jsx(S,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!i||c,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&se()},children:"Reset"}),e.jsx(S,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>T(),children:"Cancel"}),e.jsx(S,{type:"submit",disabled:!i||c,color:g==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(xe,{alerting:y.toastAlert,severity:y.toastSeverity,message:y.toastMessage})]})]})}),R===!0?e.jsx(fe,{}):null]})})};K.propTypes={openDialog:z.bool,setOpenDialog:z.func};const Ae=v=>{const f=B(),h=M(),u=$(h.palette.mode),b=s=>{v(),f("#",{state:{id:s}})};return[{field:"class_name",headerName:"NAME",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"status",headerName:"STATUS",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:s}})=>e.jsx(x,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:s==="active"?u.greenAccent[600]:u.redAccent[700],borderRadius:"4px",children:e.jsx(L,{color:u.grey[100],sx:{ml:"5px"},children:s})})},{field:"updated_at",headerName:"UPDATED AT",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:s=>s==null?void 0:s.value.substring(0,10)},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{class_id:s}})=>e.jsx(x,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(S,{color:"info",variant:"contained",onClick:()=>b(s),sx:{minWidth:"50px"},children:e.jsx(be,{})})})}]},Te=[5,10,20],Oe=()=>{const[v,f]=d.useState(!1),[h,u]=d.useState({search:!1,searching:!1}),[b,A]=d.useState(),s=B(),T=H(),g=F(l=>l.menuItems.selected),{listData:k,loading:R}=F(l=>l.listingClasses),n=M(),w=$(n.palette.mode),p=D("(max-width:480px)"),j=D("(max-width:920px)"),y=document.getElementById("reload-btn"),{getPaginatedData:m}=Se(),{getLocalStorage:r}=J();d.useEffect(()=>{const l=r("menu");T(Y(l.selected))},[]);const I=()=>{y.style.display="none",u({search:!1,searching:!1,oldPagination:b})},P=()=>{f(!0)};return e.jsxs(x,{m:"10px",position:"relative",sx:{borderRadius:"20px",border:"0.5px solid black",overflow:"hidden",boxShadow:"1px 1px 10px black",backgroundImage:n.palette.mode==="light"?`linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url(${G})`:`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${G})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:[e.jsx(x,{height:p?"19vh":j?"8vh":"11vh",borderRadius:"4px",padding:p?"1vh":"2vh",backgroundColor:w.blueAccent[700],children:e.jsxs(x,{display:"flex",height:p?"16vh":"7vh",flexDirection:p?"column":"row",justifyContent:"space-between",alignItems:p?"center":"normal",children:[e.jsx(L,{component:"h2",variant:"h2",color:w.grey[100],fontWeight:"bold",children:g}),e.jsx(je,{action:q,api:E.ClassAPI,getSearchData:m,oldPagination:b,reloadBtn:y,setSearchFlag:u}),e.jsxs(S,{type:"submit",color:"success",variant:"contained",onClick:()=>{s("#",{state:{id:void 0}}),P()},sx:{height:j?"4vh":"auto"},children:["Create New ",g]})]})}),e.jsxs(S,{sx:{display:"none",position:"absolute",top:p?"23vh":j?"10.5vh":"16.5vh",left:p?"80vw":j?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:w.grey[100]},id:"reload-btn",type:"button",onClick:I,children:[e.jsx("span",{style:{display:"inherit",marginRight:"5px"},children:e.jsx(ye,{})}),"Back"]}),e.jsx(Ce,{action:q,api:E.ClassAPI,getQuery:m,columns:Ae(P),rows:k.rows,count:k.count,loading:R,selected:g,pageSizeOptions:Te,setOldPagination:A,searchFlag:h,setSearchFlag:u}),e.jsx(K,{openDialog:v,setOpenDialog:f})]})};export{Oe as default};
