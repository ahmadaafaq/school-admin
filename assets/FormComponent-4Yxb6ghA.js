import{k as Ne,l as se,P as B,a as n,m as K,o as Re,b as we,z as Ue,R as Ce,K as ze,j as a,B as me,q as O,v as W,I as q,S as M,M as V,C as N,O as Ae,w as Ye,U as $e,n as He,E as Ge,u as Qe,t as Ke,d as Je,p as Xe,s as Ze,A as j,f as Ee,T as ea,h as De,x as aa,y as sa}from"./index-dsWAcX1f.js";import{d as ta}from"./dayjs.min-2OarEC18.js";import{A as la}from"./AddressFormComponent-EqXGwUPp.js";import{I as na}from"./ImagePicker-Z9q8O9TX.js";import{a as Pe,s as ra}from"./SectionAction-OMdiSl6G.js";import{a as ia,s as oa}from"./SubjectAction-p-rplfCF.js";import{c as L}from"./index-mbUFVO5S.js";import{a as ca,A as da}from"./useMobilePicker-KFlc6nLK.js";import{F as Be,C as Oe}from"./FormControlLabel-GbaKk4ky.js";import{D as ua}from"./DatePicker-V9wsptq6.js";const ha=/^((\+[1-9]{1,4}[ -]?)|(\([0-9]{2,3}\)[ -]?)|([0-9]{2,4})[ -]?)*?[0-9]{3,4}[ -]?[0-9]{3,4}$/,ma=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/,ga=Ne().shape({firstname:se().min(2,"Firstname is Too Short!").max(20,"Firstname is Too Long!").required("This Field is Required"),lastname:se().min(2,"Lastname is Too Short!").max(20,"Lastname is Too Long!").required("This Field is Required"),email:se().matches(ma,"Email Address is Not Valid").required("This Field is Required"),contact_no:se().matches(ha,"Phone Number Is Not Valid").required("This Field is Required"),gender:se(),status:se()}),pa={firstname:"",lastname:"",email:"",contact_no:"",dob:null,age:"",nationality:"indian",religion:"",blood_group:"",qualification:"",achievements:"",experience:"",classes:[],sections:[],subjects:[[]],grade:"",is_specially_abled:!1,is_class_teacher:!1,class:"",section:"",caste_group:"",gender:"",status:"inactive"},Le=({onChange:J,refId:ge,setDirty:be,reset:_,setReset:w,classData:A,setClassData:U,allSubjects:pe,allSections:X,updatedValues:H=null})=>{var oe,ce,de,P,D,ee,ae;const[F,je]=n.useState(pa),m=K(s=>s.schoolClasses),p=K(s=>s.schoolSections),E=K(s=>s.schoolSubjects),te=Re(),le={inputProps:{"aria-label":"Checkboxes"}},ne=we("(min-width:600px)"),Z=we("(max-width:480px)"),{fetchAndSetSchoolData:ve,getLocalStorage:re,findMultipleById:G}=$e(),e=Ue({initialValues:F,validationSchema:ga,enableReinitialize:!0,onSubmit:()=>i()});Ce.useImperativeHandle(ge,()=>({Submit:async()=>{await e.submitForm()}}));const i=()=>{J&&J({values:e.values,validated:e.isSubmitting?Object.keys(e.errors).length===0:!1})},fe=()=>{console.log(e.values.sections," innnnformik.values.sections",e.values.classes,A);const s={};A.forEach(l=>{var r;if(e.values.classes.includes((r=F==null?void 0:F.sections)!=null&&r.length?`${l.class_id}`:l.class_id)&&e.values.sections.some(I=>I.some(o=>o.section_id===l.section_id))){s[l.class_id]||(s[l.class_id]={});const I=G(l.subject_ids,pe);s[l.class_id][l.section_id]=I}}),te(ia(s))};console.log(p==null?void 0:p.listData,"innnschool sections"),console.log(E==null?void 0:E.listData,"innnschool subjects");const ie=()=>{var I;const s=new Set;for(const o of A)(e.values.classes.length&&e.values.classes.includes((I=F==null?void 0:F.sections)!=null&&I.length?`${o.class_id}`:o.class_id)||!e.values.classes.length&&o.class_id===e.values.class)&&(console.log("innnside section set of classdata",A),s.add({section_id:o.section_id,section_name:o.section_name}));const l=Array.from(s),r=X.filter(o=>l.some(f=>f.section_id===o.section_id));console.log(r,"innnfilteredsections",l),te(Pe(r))};return n.useEffect(()=>{e.values.sections.some(s=>s.length>0)&&A.length&&(console.log("innnnside get subjects"),fe())},[(oe=e.values)==null?void 0:oe.sections,A.length]),n.useEffect(()=>{var s,l;((s=e.values)!=null&&s.classes||(l=e.values)!=null&&l.class)&&A.length&&(console.log("innnnside get sections"),ie())},[(ce=e.values)==null?void 0:ce.classes,(de=e.values)==null?void 0:de.class,A.length]),n.useEffect(()=>{var s,l,r;re("schoolInfo")&&(!((s=E==null?void 0:E.listData)!=null&&s.length)||!((l=m==null?void 0:m.listData)!=null&&l.length)||!((r=p==null?void 0:p.listData)!=null&&r.length))&&ve(te,ze,Pe,U)},[A.length]),n.useEffect(()=>{_&&(e.resetForm(),w(!1))},[_]),n.useEffect(()=>{e.dirty&&be(!0)},[e.dirty]),n.useEffect(()=>{if(H){const s=H.selectedClass.reduce((o,f)=>{const c=f.class_id;return o[c]||(o[c]=[]),o[c].push(f),o},{}),l=s&&Object.keys(s).length>0;console.log(s,"splittedarray");const r=o=>{let f=[];return o.map(c=>{console.log(c,"section");let g=X==null?void 0:X.filter(y=>c.some(x=>x.section_id===y.section_id));console.log(g,"filteredSection"),f.push(g)}),console.log(f,"filteredSectioArrayn"),f},I=o=>{const f=[[]];return Object.keys(o).map((c,g)=>{Object.values(o)[g].map((y,x)=>{const T=G(y.subject_ids,pe);g>0&&x===0&&(f[g]=[]),f[g][x]=T})}),f};je({...F,...H.teacherData,classes:l?Object.keys(s):[],sections:l?r(Object.values(s)):[],subjects:l?I(s):[[]]})}},[H]),console.log("innn formik sections=>",e.values.sections),console.log((P=F==null?void 0:F.sections)==null?void 0:P.length,"innn updarws values"),console.log("innn formik subjects=>",e.values.subjects),console.log("innn classdata=>",A),a.jsx(me,{m:"20px",children:a.jsxs("form",{ref:ge,children:[a.jsxs(me,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",gridColumn:"span 4",position:"relative",className:"box-shadow",sx:{"& > div":{gridColumn:ne?void 0:"span 4"},marginBottom:"40px"},children:[a.jsx(O,{fullWidth:!0,variant:"filled",type:"text",name:"firstname",label:"Firstname*",onBlur:e.handleBlur,onChange:e.handleChange,value:e.values.firstname,error:!!e.touched.firstname&&!!e.errors.firstname,helperText:e.touched.firstname&&e.errors.firstname}),a.jsx(O,{fullWidth:!0,variant:"filled",type:"text",name:"lastname",label:"Lastname*",onBlur:e.handleBlur,onChange:e.handleChange,value:e.values.lastname,error:!!e.touched.lastname&&!!e.errors.lastname,helperText:e.touched.lastname&&e.errors.lastname}),a.jsx(O,{fullWidth:!0,variant:"filled",type:"text",label:"Email*",name:"email",onBlur:e.handleBlur,onChange:e.handleChange,value:e.values.email,error:!!e.touched.email&&!!e.errors.email,helperText:e.touched.email&&e.errors.email,sx:{gridColumn:"span 2"}}),a.jsx(O,{fullWidth:!0,variant:"filled",type:"text",label:"Contact Number*",name:"contact_no",onBlur:e.handleBlur,onChange:e.handleChange,value:e.values.contact_no,error:!!e.touched.contact_no&&!!e.errors.contact_no,helperText:e.touched.contact_no&&e.errors.contact_no}),a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.nationality&&!!e.errors.nationality,children:[a.jsx(q,{children:"Nationality"}),a.jsx(M,{variant:"filled",name:"nationality",value:e.values.nationality,onChange:e.handleChange,children:Object.keys(L.nationality).map(s=>a.jsx(V,{value:s,children:L.nationality[s]},s))}),a.jsx(N,{children:e.touched.nationality&&e.errors.nationality})]}),a.jsx(O,{fullWidth:!0,variant:"filled",type:"text",label:"Religion",name:"religion",onBlur:e.handleBlur,onChange:e.handleChange,value:e.values.religion,error:!!e.touched.religion&&!!e.errors.religion,helperText:e.touched.religion&&e.errors.religion}),a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.blood_group&&!!e.errors.blood_group,children:[a.jsx(q,{children:"Blood Group"}),a.jsx(M,{variant:"filled",name:"blood_group",value:e.values.blood_group,onChange:e.handleChange,children:Object.keys(L.bloodGroups).map(s=>a.jsx(V,{value:s,children:L.bloodGroups[s]},s))}),a.jsx(N,{children:e.touched.blood_group&&e.errors.blood_group})]}),a.jsx(O,{fullWidth:!0,variant:"filled",type:"text",label:"Qualification",name:"qualification",onBlur:e.handleBlur,onChange:e.handleChange,value:e.values.qualification,error:!!e.touched.qualification&&!!e.errors.qualification,helperText:e.touched.qualification&&e.errors.qualification}),a.jsx(O,{fullWidth:!0,variant:"filled",type:"text",label:"Achievements",name:"achievements",onBlur:e.handleBlur,onChange:e.handleChange,value:e.values.achievements,error:!!e.touched.achievements&&!!e.errors.achievements,helperText:e.touched.achievements&&e.errors.achievements}),a.jsx(O,{fullWidth:!0,variant:"filled",type:"text",label:"Experience",name:"experience",onBlur:e.handleBlur,onChange:e.handleChange,value:e.values.experience,error:!!e.touched.experience&&!!e.errors.experience,helperText:e.touched.experience&&e.errors.experience}),a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.grade&&!!e.errors.grade,children:[a.jsx(q,{children:"Grade"}),a.jsx(M,{variant:"filled",name:"grade",value:e.values.grade,onChange:e.handleChange,children:Object.keys(L.grade).map(s=>a.jsx(V,{value:s,children:L.grade[s]},s))}),a.jsx(N,{children:e.touched.grade&&e.errors.grade})]}),a.jsx(ca,{dateAdapter:da,children:a.jsx(ua,{format:"DD MMMM YYYY",views:["day","month","year"],label:"Date Of Birth",name:"dob",required:!0,value:e.values.dob,onChange:s=>e.setFieldValue("dob",s)})}),a.jsx(Be,{label:"Is Specially Abled",sx:{gridColumn:Z?"span 2":""},control:a.jsx(Oe,{...le,color:"default",checked:!!e.values.is_specially_abled,name:"is_specially_abled",onChange:(s,l)=>e.setFieldValue("is_specially_abled",l),value:e.values.is_specially_abled})}),a.jsx(Be,{label:"Is Class Teacher",sx:{gridColumn:Z?"span 2":""},control:a.jsx(Oe,{...le,color:"default",checked:!!e.values.is_class_teacher,name:"is_class_teacher",onChange:(s,l)=>e.setFieldValue("is_class_teacher",l),value:e.values.is_class_teacher})}),e.values.is_class_teacher&&a.jsxs(a.Fragment,{children:[a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.class&&!!e.errors.class,children:[a.jsx(q,{id:"classField",children:"Class"}),a.jsx(M,{variant:"filled",labelId:"classField",name:"class",value:e.values.class,onChange:s=>{e.setFieldValue("class",s.target.value),e.values.section&&e.setFieldValue("section","")},children:(D=m==null?void 0:m.listData)!=null&&D.length?m.listData.map(s=>a.jsx(V,{value:s.class_id,name:s.class_name,children:s.class_name},s.class_name)):null}),a.jsx(N,{children:e.touched.class&&e.errors.class})]}),a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.section&&!!e.errors.section,children:[a.jsx(q,{id:"sectionField",children:"Section"}),a.jsx(M,{variant:"filled",labelId:"sectionField",name:"section",value:e.values.section,onChange:s=>e.setFieldValue("section",s.target.value),children:(ee=p==null?void 0:p.listData)!=null&&ee.length?p.listData.map(s=>a.jsx(V,{value:s.section_id,name:s.section_name,children:s.section_name},s.section_id)):null}),a.jsx(N,{children:e.touched.section&&e.errors.section})]})]}),a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.gender&&!!e.errors.gender,children:[a.jsx(q,{children:"Gender"}),a.jsx(M,{variant:"filled",name:"gender",value:e.values.gender,onChange:e.handleChange,children:Object.keys(L.gender).map(s=>a.jsx(V,{value:s,children:L.gender[s]},s))}),a.jsx(N,{children:e.touched.gender&&e.errors.gender})]}),a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.status&&!!e.errors.status,children:[a.jsx(q,{children:"Status"}),a.jsx(M,{variant:"filled",name:"status",value:e.values.status,onChange:e.handleChange,children:Object.keys(L.status).map(s=>a.jsx(V,{value:s,children:L.status[s]},s))}),a.jsx(N,{children:e.touched.status&&e.errors.status})]})]}),a.jsxs(me,{border:"2px solid #BADFE7",borderRadius:"12px",display:"grid",gap:"30px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",padding:"10px",marginBottom:"40px",children:[e.values.classes.map((s,l)=>{var I,o,f;let r=l+1;return a.jsxs(Ce.Fragment,{children:[a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.classes&&!!e.errors.classes,children:[a.jsx(q,{id:`classesField_${r}`,children:"Class"}),a.jsx(M,{variant:"filled",labelId:`classesField_${r}`,name:`classes.${r}`,value:e.values.classes[l],onChange:(c,g)=>{const y=[...e.values.classes];y[l]=g.props.value,e.setFieldValue("classes",y),e.values.sections&&e.setFieldValue("sections",[]),e.values.subjects&&e.setFieldValue("subjects",[[]])},children:(I=m==null?void 0:m.listData)!=null&&I.length?m.listData.map(c=>a.jsx(V,{value:c.class_id,name:c.class_name,children:c.class_name},c.class_id)):null}),a.jsx(N,{children:e.touched.classes&&e.errors.classes})]}),a.jsx(Ae,{multiple:!0,options:(p==null?void 0:p.listData)||[],getOptionLabel:c=>c.section_name,disableCloseOnSelect:!0,value:e.values.sections[l]||[],onChange:(c,g)=>{const y=[...e.values.sections];y[l]=g,console.log("sections",y),e.setFieldValue("sections",y)},sx:{gridColumn:"span 2"},renderInput:c=>a.jsx(O,{...c,variant:"filled",type:"text",name:`sections.${r}`,label:"Section",error:!!e.touched.sections&&!!e.errors.sections,helperText:e.touched.sections&&e.errors.sections})}),(f=(o=e==null?void 0:e.values)==null?void 0:o.sections[l])==null?void 0:f.map((c,g)=>{var y,x;return a.jsx(Ae,{multiple:!0,options:((x=(y=E==null?void 0:E.listData)==null?void 0:y[e.values.classes[l]])==null?void 0:x[c.section_id])||[],getOptionLabel:T=>T.name,disableCloseOnSelect:!0,value:e.values.subjects[l]?e.values.subjects[l][g]||[]:[],onChange:(T,_e)=>{const ue=[...e.values.subjects];l>0&&g===0&&(ue[l]=[]),ue[l][g]=_e,e.setFieldValue("subjects",ue)},sx:{gridColumn:"span 2"},renderInput:T=>a.jsx(O,{...T,variant:"filled",type:"text",name:`subjects.${l}.${g}`,label:`Subjects For Section ${c.section_name}`,error:!!e.touched.subjects&&!!e.errors.subjects,helperText:e.touched.subjects&&e.errors.subjects})},r+g)}),a.jsx(Ye,{sx:{borderBottomWidth:0,gridColumn:"span 4"}})]},r)}),a.jsxs(Ce.Fragment,{children:[a.jsxs(W,{variant:"filled",sx:{minWidth:120},error:!!e.touched.classes&&!!e.errors.classes,children:[a.jsx(q,{id:`classesField_${e.values.classes.length+1}`,children:"Class"}),a.jsx(M,{variant:"filled",labelId:`classesField_${e.values.classes.length+1}`,name:`classes${e.values.classes.length+1}`,value:[],onChange:(s,l)=>{const r=[...e.values.classes];r[e.values.classes.length]=l.props.value,e.setFieldValue("classes",r)},children:(ae=m==null?void 0:m.listData)!=null&&ae.length?m==null?void 0:m.listData.filter(s=>!e.values.classes.includes(s.class_id)).map(s=>a.jsx(V,{value:s.class_id,name:s.class_name,children:s.class_name},s.class_id)):null}),a.jsx(N,{children:e.touched.classes&&e.errors.classes})]}),a.jsx(Ae,{multiple:!0,options:(p==null?void 0:p.listData)||[],getOptionLabel:s=>s.section_name,disableCloseOnSelect:!0,value:[],onChange:(s,l)=>{const r=[...e.values.sections];r[e.values.classes.length]=l,e.setFieldValue("sections",r)},sx:{gridColumn:"span 2"},renderInput:s=>a.jsx(O,{...s,variant:"filled",type:"text",name:`sections${e.values.classes.length+1}`,label:"Section"})})]},e.values.classes.length+1)]})]})})};Le.propTypes={onChange:B.func,refId:B.shape({current:B.any}),setDirty:B.func,reset:B.bool,setReset:B.func,classData:B.array,setClassData:B.func,allSubjects:B.array,allSections:B.array,updatedValues:B.object};var va={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const fa=va,Ta=()=>{var Ie,Fe;const[J,ge]=n.useState("Create"),[be,_]=n.useState(!1),[w,A]=n.useState({teacherData:{values:null,validated:!1},addressData:{values:null,validated:!1},imageData:{values:null,validated:!0}}),[U,pe]=n.useState(null),[X,H]=n.useState([]),[F,je]=n.useState([]),[m,p]=n.useState([]),[E,te]=n.useState([]),[le,ne]=n.useState(!1),[Z,ve]=n.useState(!1),[re,G]=n.useState(!1),e=K(t=>t.allSections),i=K(t=>t.allSubjects),fe=K(t=>t.menuItems.selected),ie=K(t=>t.toastInfo),oe=n.useRef(),ce=n.useRef(),de=n.useRef(),P=He(),D=Re(),ee=Ge(),ae=Qe(),s=Ke(ae.palette.mode),{typography:l}=Je(ae.palette.mode),{state:r}=Xe(),{formatImageName:I,fetchAndSetAll:o,getLocalStorage:f,getIdsFromObject:c,generatePassword:g,isObjEmpty:y,toastAndNavigate:x}=$e();let T=(r==null?void 0:r.id)||(ee==null?void 0:ee.id);n.useEffect(()=>{const t=f("menu");D(Ze(t.selected))},[]);const _e=n.useCallback(async t=>{var b,S;_(!0);const k=["/update-teacher","/update-address"],u=[{...t.teacherData.values},{...t.addressData.values}];try{await j.CommonAPI.multipleAPICall("PATCH",k,u)&&ue(t)}catch(C){throw _(!1),x(D,!0,"error",C?(S=(b=C==null?void 0:C.response)==null?void 0:b.data)==null?void 0:S.msg:"An Error Occurred",P,0),C}},[w]),ue=n.useCallback(async t=>{var u,b,S,C,z,Y;j.ImageAPI.deleteImage({parent:"teacher",parent_id:T}),await j.TeacherAPI.deleteFromMappingTable({teacher_id:T});const k=t.teacherData.values.sections.map((v,h)=>{const d=t.teacherData.values.classes[h]||0;v.map((R,Q)=>{const xe=t.teacherData.values.subjects[h][Q]||[];j.TeacherAPI.insertIntoMappingTable([t.teacherData.values.id,d,R.section_id,c(xe,i==null?void 0:i.listData)])})});try{let v=null,h;await Promise.all(k),y(t.imageData.values)?v=!0:((S=(b=(u=t.imageData)==null?void 0:u.values)==null?void 0:b.Teacher)!=null&&S.length&&(Array.from(t.imageData.values.Teacher).map(d=>{h=I(d.name),j.ImageAPI.uploadImage({image:d,imageName:h}),j.ImageAPI.createImage({image_src:h,parent_id:t.teacherData.values.id,parent:"teacher",type:"normal"})}),v=!0),(C=t.imageData)!=null&&C.values&&(t.imageData.values.map(d=>{j.ImageAPI.createImage({image_src:d.image_src,school_id:d.school_id,parent_id:d.parent_id,parent:d.parent,type:d.type})}),v=!0)),v&&(_(!1),console.log("I have ended updating all fields"),x(D,!0,"info","Successfully Updated",P,"/teacher/listing"))}catch(v){throw _(!1),x(D,!0,"error",v?(Y=(z=v==null?void 0:v.response)==null?void 0:z.data)==null?void 0:Y.msg:"An Error Occurred",P,0),v}},[]),We=n.useCallback(t=>{_(!0);const k=[`/get-by-pk/teacher/${t}`,`/get-address/teacher/${t}`,`/get-teacher-detail/${t}`,`/get-image/teacher/${t}`];j.CommonAPI.multipleAPICall("GET",k).then(u=>{var S,C,z,Y,v,h;u[0].data.data&&(u[0].data.data.dob=ta(u[0].data.data.dob));const b={teacherData:{teacherData:u[0].data.data,selectedClass:(C=(S=u[2])==null?void 0:S.data)==null?void 0:C.data},addressData:(Y=(z=u[1])==null?void 0:z.data)==null?void 0:Y.data,imageData:(h=(v=u[3])==null?void 0:v.data)==null?void 0:h.data};pe(b),H(b==null?void 0:b.imageData),_(!1)}).catch(u=>{var b,S;throw _(!1),x(D,!0,"error",(S=(b=u==null?void 0:u.response)==null?void 0:b.data)==null?void 0:S.msg),u})},[]),qe=n.useCallback(t=>{var z,Y,v;let k,u,b;_(!0);const S=((z=t.teacherData.values)==null?void 0:z.firstname.toLowerCase())+((Y=t.teacherData.values)!=null&&Y.lastname?`${(v=t.teacherData.values)==null?void 0:v.lastname.toLowerCase()}`:""),C=g();j.UserAPI.register({username:S,password:C,email:t.teacherData.values.email,contact_no:t.teacherData.values.contact_no,role:4,designation:"teacher",status:"active"}).then(({data:h})=>{(h==null?void 0:h.status)==="Success"&&j.TeacherAPI.createTeacher({...t.teacherData.values,parent_id:h.data.id,password:C}).then(async({data:d})=>{var R,Q,xe;k=j.AddressAPI.createAddress({...t.addressData.values,parent_id:d.data.id,parent:"teacher"}),u=t.teacherData.values.sections.map(($,he)=>{const Te=t.teacherData.values.classes[he]||0;$.map((Se,Ve)=>{const ke=t.teacherData.values.subjects[he][Ve]||[];console.log(Te,Se.section_id,c(ke,i==null?void 0:i.listData),"teacherClass, sectionid, subjectids innerloop"),j.TeacherAPI.insertIntoMappingTable([d.data.id,Te,Se.section_id,c(ke,i==null?void 0:i.listData)])})}),(R=t.imageData.values.Teacher)!=null&&R.length&&(b=Array.from(t.imageData.values.Teacher).map(async $=>{let he=I($.name);j.ImageAPI.uploadImage({image:$,imageName:he}),j.ImageAPI.createImage({image_src:he,parent_id:d.data.id,parent:"teacher",type:"normal"})}));try{await Promise.all([k,u,b]),_(!1),x(D,!0,"success","Successfully Created",P,"/teacher/listing")}catch($){_(!1),x(D,!0,"error",$?(xe=(Q=$==null?void 0:$.response)==null?void 0:Q.data)==null?void 0:xe.msg:"An Error Occurred",P,0),console.log("Error in teacher create",$)}}).catch(d=>{var R,Q;_(!1),x(D,!0,"error",d?(Q=(R=d==null?void 0:d.response)==null?void 0:R.data)==null?void 0:Q.msg:"An Error Occurred",P,0),console.log("Error in teacher create",d)})}).catch(h=>{var d,R;_(!1),x(D,!0,"error",h?(R=(d=h==null?void 0:h.response)==null?void 0:d.data)==null?void 0:R.msg:"An Error Occurred",P,0),console.log("Error in teacher create",h)})},[]);n.useEffect(()=>{var t;(t=e==null?void 0:e.listData)!=null&&t.length||o(D,ra,j.SectionAPI)},[(Ie=e==null?void 0:e.listData)==null?void 0:Ie.length]),n.useEffect(()=>{var t;(t=i==null?void 0:i.listData)!=null&&t.length||o(D,oa,j.SubjectAPI)},[(Fe=i==null?void 0:i.listData)==null?void 0:Fe.length]),n.useEffect(()=>{var t;T&&!Z&&(i!=null&&i.listData)&&(ge("Update"),We(T)),w.teacherData.validated&&w.addressData.validated?(t=w.teacherData.values)!=null&&t.id?_e(w):qe(w):ve(!1)},[T,Z,i==null?void 0:i.listData]);const Me=async()=>{await oe.current.Submit(),await ce.current.Submit(),await de.current.Submit(),ve(!0)},ye=(t,k)=>{k==="teacher"?A({...w,teacherData:t}):k==="address"?A({...w,addressData:t}):k==="image"&&A({...w,imageData:t})};return a.jsxs(me,{m:"10px",sx:{backgroundImage:ae.palette.mode=="light"?`linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url(${Ee})`:`linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), url(${Ee})`,backgroundRepeat:"no-repeat",backgroundPosition:"start",backgroundSize:"cover",backgroundAttachment:"fixed"},children:[a.jsx(ea,{fontFamily:l.fontFamily,fontSize:l.h2.fontSize,color:s.grey[100],fontWeight:"bold",display:"inline-block",marginLeft:"20px",children:`${J} ${fe}`}),a.jsx(Le,{onChange:t=>{ye(t,"teacher")},refId:oe,setDirty:ne,reset:re,setReset:G,classData:E,setClassData:te,allSections:e==null?void 0:e.listData,allSubjects:i==null?void 0:i.listData,updatedValues:U==null?void 0:U.teacherData}),a.jsx(la,{onChange:t=>{ye(t,"address")},refId:ce,update:!!T,setDirty:ne,reset:re,setReset:G,updatedValues:U==null?void 0:U.addressData}),a.jsx(na,{onChange:t=>ye(t,"image"),refId:de,reset:re,setReset:G,setDirty:ne,preview:m,setPreview:p,deletedImage:F,setDeletedImage:je,updatedImage:X,setUpdatedImage:H,imageType:"Teacher",ENV:fa},"image"),a.jsxs(me,{display:"flex",justifyContent:"end",m:"20px",children:[J==="Update"?null:a.jsx(De,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!le||Z,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&G(!0)},children:"Reset"}),a.jsx(De,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>P(`/${fe.toLowerCase()}/listing`),children:"Cancel"}),a.jsx(De,{type:"submit",onClick:()=>Me(),disabled:!le,color:J==="Update"?"info":"success",variant:"contained",children:"Submit"}),a.jsx(aa,{alerting:ie.toastAlert,severity:ie.toastSeverity,message:ie.toastMessage})]}),be===!0?a.jsx(sa,{}):null]})};export{Ta as default};
