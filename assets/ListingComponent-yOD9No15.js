import{u as M,t as R,d as D,a as m,h as L,b as z,k,l as X,e as Z,s as _,m as P,j as e,T as O,n as ee,B as S,o as te,F as ae,I as ne,S as se,M as U,D as oe,p as A,q as ie,L as le,U as q,A as ce}from"./index-MsP7Yzml.js";import{d as re,u as de,S as ue,a as he,b as me}from"./index-9BU2f8bX.js";import{c as pe,a as xe}from"./index.esm-JiYwYH4D.js";import{D as ge}from"./Dialog-9w6WfMaz.js";import"./FormControlLabel-c6D5vxEv.js";import"./Autocomplete-UT5QdtF-.js";import"./index-a8hLBBUR.js";const fe=pe().shape({name:xe().min(0,"Name is Too Short!").max(20,"Name is Too Long!").required("This Field is Required")}),B={name:"",status:"inactive"},Se=({openDialog:p,setOpenDialog:v})=>{const c=M(),x=R(c.palette.mode),y=D(c.breakpoints.down("md")),C=D("(max-width:480px)"),s=D("(max-width:920px)"),j=()=>{v(!1)},[g,T]=m.useState("Create"),[E,o]=m.useState(!1),[d,f]=m.useState(B),r=L(),i=z(),F=k(t=>t.menuItems.selected),w=k(t=>t.toastInfo),{state:b}=X(),{typography:u}=Z(c.palette.mode),{toastAndNavigate:h,getLocalStorage:G}=q();let N=b==null?void 0:b.id;m.useEffect(()=>{const t=G("menu");i(_(t.selected)),N?(T("Update"),V(N)):(T("Create"),f(B))},[N]);const Q=t=>{o(!0),P.SectionAPI.updateSection(t).then(({data:a})=>{a.status==="Success"?(o(!1),h(i,!0,"info","Successfully Updated"),setTimeout(()=>{j(),location.href="/section/listing"},2e3)):(o(!1),h(i,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(a=>{var n,l;throw o(!1),h(i,!0,"error",(l=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:l.msg,r,location.reload()),a})},V=t=>{o(!0);const a=[`/get-by-pk/section/${t}`];P.CommonAPI.multipleAPICall("GET",a).then(n=>{n[0].data.status==="Success"?(f(n[0].data.data),o(!1)):(o(!1),h(i,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(n=>{var l,I;throw o(!1),h(i,!0,"error",(I=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:I.msg,r,location.reload()),n})},Y=t=>{o(!0),P.SectionAPI.createSection(t).then(({data:a})=>{a.status==="Success"?(o(!1),h(i,!0,"success","Successfully Created"),setTimeout(()=>{j(),r(0)},2e3)):(o(!1),h(i,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(a=>{var n,l;throw o(!1),h(i,!0,a?(l=(n=a.response)==null?void 0:n.data)==null?void 0:l.msg:"An Error Occurred",r,location.reload()),a})};return e.jsx("div",{children:e.jsxs(ge,{fullScreen:y,open:p,onClose:j,"aria-labelledby":"responsive-dialog-title",sx:{top:C?"33%":s?"25%":"20%",height:C?"49%":s?"39%":"60%","& .MuiPaper-root":{width:"100%"}},children:[e.jsx(O,{fontFamily:u.fontFamily,fontSize:u.h2.fontSize,color:x.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${g} ${F}`}),e.jsx(ee,{initialValues:d,enableReinitialize:!0,validationSchema:fe,onSubmit:t=>{t.id?Q(t):Y(t)},children:({values:t,errors:a,touched:n,dirty:l,isSubmitting:I,handleBlur:H,handleChange:W,handleSubmit:J,resetForm:K})=>e.jsxs("form",{onSubmit:J,children:[e.jsxs(S,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(te,{variant:"filled",type:"text",name:"name",label:"Name*",autoComplete:"new-name",onBlur:H,onChange:W,value:t.name,error:!!n.name&&!!a.name,helperText:n.name&&a.name}),e.jsxs(ae,{variant:"filled",sx:{minWidth:120},error:!!n.status&&!!a.status,children:[e.jsx(ne,{id:"statusField",children:"Status"}),e.jsxs(se,{variant:"filled",labelId:"statusField",label:"Status",name:"status",autoComplete:"new-status",value:t.status,onChange:W,children:[e.jsx(U,{value:"active",children:"Active"}),e.jsx(U,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx(oe,{}),e.jsxs(S,{display:"flex",justifyContent:"end",p:"20px",children:[g==="Update"?null:e.jsx(A,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!l||I,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&K()},children:"Reset"}),e.jsx(A,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>j(),children:"Cancel"}),e.jsx(A,{type:"submit",disabled:!l||I,color:g==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(ie,{alerting:w.toastAlert,severity:w.toastSeverity,message:w.toastMessage})]})]})}),E===!0?e.jsx(le,{}):null]})})},ve=p=>{const v=M(),c=R(v.palette.mode),x=L(),y=s=>{p(),x("#",{state:{id:s}})};return[{field:"name",headerName:"NAME",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"status",headerName:"STATUS",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:s}})=>e.jsx(S,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:s==="active"?c.greenAccent[600]:c.redAccent[700],borderRadius:"4px",children:e.jsx(O,{color:c.grey[100],sx:{ml:"5px"},children:s})})},{field:"updated_at",headerName:"UPDATED AT",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:s=>s==null?void 0:s.value.substring(0,10)},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{id:s}})=>e.jsx(S,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(A,{color:"info",variant:"contained",onClick:()=>y(s),sx:{minWidth:"50px"},children:e.jsx(re,{})})})}]},$=p=>({type:ce.SET_SECTIONS,payload:p}),ye=[5,10,20],De=()=>{const[p,v]=m.useState(!1),[c,x]=m.useState({search:!1,searching:!1}),[y,C]=m.useState(),s=L(),j=z(),g=k(u=>u.menuItems.selected),{listData:T}=k(u=>u.allSections),E=M(),o=R(E.palette.mode),d=D("(max-width:480px)"),f=D("(max-width:920px)"),r=document.getElementById("reload-btn"),{getPaginatedData:i}=de(),{getLocalStorage:F}=q();m.useEffect(()=>{const u=F("menu");j(_(u.selected))},[]);const w=()=>{r.style.display="none",x({search:!1,searching:!1,oldPagination:y})},b=()=>{v(!0)};return e.jsxs(S,{m:"10px",position:"relative",children:[e.jsx(S,{height:d?"19vh":f?"8vh":"11vh",borderRadius:"4px",padding:d?"1vh":"2vh",backgroundColor:o.blueAccent[700],children:e.jsxs(S,{display:"flex",height:d?"16vh":"7vh",flexDirection:d?"column":"row",justifyContent:"space-between",alignItems:d?"center":"normal",children:[e.jsx(O,{component:"h2",variant:"h2",color:o.grey[100],fontWeight:"bold",children:g}),e.jsx(ue,{action:$,api:P.SectionAPI,getSearchData:i,oldPagination:y,reloadBtn:r,setSearchFlag:x}),e.jsxs(A,{type:"submit",color:"success",variant:"contained",onClick:()=>{s("#",{state:{id:void 0}}),b()},sx:{height:f?"4vh":"auto"},children:["Create New ",g]})]})}),e.jsxs(A,{sx:{display:"none",position:"absolute",top:d?"23vh":f?"10.5vh":"16.5vh",left:d?"80vw":f?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:o.grey[100]},id:"reload-btn",type:"button",onClick:w,children:[e.jsx("span",{style:{display:"inherit",marginRight:"5px",marginLeft:"-2px"},children:e.jsx(he,{})}),"Back"]}),e.jsx(me,{action:$,api:P.SectionAPI,getQuery:i,columns:ve(b),rows:T.rows,count:T.count,selected:g,pageSizeOptions:ye,setOldPagination:C,searchFlag:c,setSearchFlag:x}),e.jsx(Se,{openDialog:p,setOpenDialog:v})]})};export{De as default};
