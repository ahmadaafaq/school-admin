import{u as N,t as L,d as I,a as h,h as M,b as q,k as P,l as Z,e as ee,s as G,m as U,j as e,T as O,n as te,B as y,o as B,F as ae,I as se,S as ne,M as $,D as oe,p as A,q as ie,L as le,U as Q,A as re}from"./index-MsP7Yzml.js";import{d as ce,u as de,S as ue,a as me,b as he}from"./index-9BU2f8bX.js";import{c as pe,a as xe}from"./index.esm-JiYwYH4D.js";import{D as ge}from"./Dialog-9w6WfMaz.js";import"./FormControlLabel-c6D5vxEv.js";import"./Autocomplete-UT5QdtF-.js";import"./index-a8hLBBUR.js";const fe=pe().shape({name:xe().min(2,"Name is Too Short!").max(20,"Name is Too Long!").required("This Field is Required")}),z={name:"",priority:0,status:"inactive"},ye=({openDialog:p,setOpenDialog:v})=>{const r=N(),x=L(r.palette.mode),j=I(r.breakpoints.down("md")),C=I("(max-width:480px)"),n=I("(max-width:920px)"),S=()=>{v(!1)},[g,T]=h.useState("Create"),[D,o]=h.useState(!1),[d,f]=h.useState(z),c=M(),i=q(),E=P(a=>a.menuItems.selected),w=P(a=>a.toastInfo),{state:b}=Z(),{typography:u}=ee(r.palette.mode),{toastAndNavigate:m,getLocalStorage:V}=Q();let k=b==null?void 0:b.id;h.useEffect(()=>{const a=V("menu");i(G(a.selected)),k?(T("Update"),H(k)):(T("Create"),f(z))},[k]);const Y=a=>{o(!0),U.UserRoleAPI.updateUserRole(a).then(({data:t})=>{t.status==="Success"?(o(!1),m(i,!0,"info","Successfully Updated"),setTimeout(()=>{S(),location.href="/role/listing"},2e3)):(o(!1),m(i,!0,"error","An Error Occurred, Please Try Again",c,location.reload()))}).catch(t=>{var s,l;throw o(!1),m(i,!0,"error",(l=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:l.msg,c,location.reload()),t})},H=a=>{o(!0);const t=[`/get-by-pk/role/${a}`];U.CommonAPI.multipleAPICall("GET",t).then(s=>{s[0].data.status==="Success"?(f(s[0].data.data),o(!1)):(o(!1),m(i,!0,"error","An Error Occurred, Please Try Again",c,location.reload()))}).catch(s=>{var l,R;throw o(!1),m(i,!0,"error",(R=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:R.msg,c,location.reload()),s})},J=a=>{o(!0),U.UserRoleAPI.createUserRole(a).then(({data:t})=>{t.status==="Success"?(o(!1),m(i,!0,"success","Successfully Created"),setTimeout(()=>{S(),c(0)},2e3)):(o(!1),m(i,!0,"error","An Error Occurred, Please Try Again",c,location.reload()))}).catch(t=>{var s,l;throw o(!1),m(i,!0,t?(l=(s=t.response)==null?void 0:s.data)==null?void 0:l.msg:"An Error Occurred",c,location.reload()),t})};return e.jsx("div",{children:e.jsxs(ge,{fullScreen:j,open:p,onClose:S,"aria-labelledby":"responsive-dialog-title",sx:{top:C?"33%":n?"25%":"20%",height:C?"49%":n?"39%":"60%","& .MuiPaper-root":{width:"100%"}},children:[e.jsx(O,{fontFamily:u.fontFamily,fontSize:u.h2.fontSize,color:x.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${g} ${E}`}),e.jsx(te,{initialValues:d,enableReinitialize:!0,validationSchema:fe,onSubmit:a=>{a.id?Y(a):J(a)},children:({values:a,errors:t,touched:s,dirty:l,isSubmitting:R,handleBlur:W,handleChange:F,handleSubmit:K,resetForm:X})=>e.jsxs("form",{onSubmit:K,children:[e.jsxs(y,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(B,{variant:"filled",type:"text",name:"name",label:"Name*",autoComplete:"new-name",onBlur:W,onChange:F,value:a.name,error:!!s.name&&!!t.name,helperText:s.name&&t.name}),e.jsx(B,{variant:"filled",type:"text",label:"Priority",name:"priority",autoComplete:"new-priority",onBlur:W,onChange:F,value:a.priority,error:!!s.priority&&!!t.priority,helperText:s.priority&&t.priority}),e.jsxs(ae,{variant:"filled",sx:{minWidth:120},error:!!s.status&&!!t.status,children:[e.jsx(se,{id:"statusField",children:"Status"}),e.jsxs(ne,{variant:"filled",labelId:"statusField",label:"Status",name:"status",autoComplete:"new-status",value:a.status,onChange:F,children:[e.jsx($,{value:"active",children:"Active"}),e.jsx($,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx(oe,{}),e.jsxs(y,{display:"flex",justifyContent:"end",p:"20px",children:[g==="Update"?null:e.jsx(A,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!l||R,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&X()},children:"Reset"}),e.jsx(A,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>S(),children:"Cancel"}),e.jsx(A,{type:"submit",disabled:!l||R,color:g==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(ie,{alerting:w.toastAlert,severity:w.toastSeverity,message:w.toastMessage})]})]})}),D===!0?e.jsx(le,{}):null]})})},ve=p=>{const v=N(),r=L(v.palette.mode),x=M(),j=n=>{p(),x("#",{state:{id:n}})};return[{field:"name",headerName:"NAME",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"priority",headerName:"PRIORITY",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"updated_at",headerName:"UPDATED AT",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:n=>n==null?void 0:n.value.substring(0,10)},{field:"status",headerName:"STATUS",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:n}})=>e.jsx(y,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:n==="active"?r.greenAccent[600]:r.redAccent[700],borderRadius:"4px",children:e.jsx(O,{color:r.grey[100],sx:{ml:"5px"},children:n})})},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{id:n}})=>e.jsx(y,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(A,{color:"info",variant:"contained",onClick:()=>j(n),sx:{minWidth:"50px"},children:e.jsx(ce,{})})})}]},_=p=>({type:re.SET_USER_ROLES,payload:p}),je=[5,10,20],Ie=()=>{const[p,v]=h.useState(!1),[r,x]=h.useState({search:!1,searching:!1}),[j,C]=h.useState(),n=M(),S=q(),g=P(u=>u.menuItems.selected),{listData:T}=P(u=>u.allUserRoles),D=N(),o=L(D.palette.mode),d=I("(max-width:480px)"),f=I("(max-width:920px)"),c=document.getElementById("reload-btn"),{getPaginatedData:i}=de(),{getLocalStorage:E}=Q();h.useEffect(()=>{const u=E("menu");S(G(u.selected))},[]);const w=()=>{c.style.display="none",x({search:!1,searching:!1,oldPagination:j})},b=()=>{v(!0)};return e.jsxs(y,{m:"10px",position:"relative",children:[e.jsx(y,{height:d?"19vh":f?"8vh":"11vh",borderRadius:"4px",padding:d?"1vh":"2vh",backgroundColor:o.blueAccent[700],children:e.jsxs(y,{display:"flex",height:d?"16vh":"7vh",flexDirection:d?"column":"row",justifyContent:"space-between",alignItems:d?"center":"normal",children:[e.jsx(O,{component:"h2",variant:"h2",color:o.grey[100],fontWeight:"bold",children:g}),e.jsx(ue,{action:_,api:U.UserRoleAPI,getSearchData:i,oldPagination:j,reloadBtn:c,setSearchFlag:x}),e.jsxs(A,{type:"submit",color:"success",variant:"contained",onClick:()=>{n("#",{state:{id:void 0}}),b()},sx:{height:f?"4vh":"auto"},children:["Create New ",g]})]})}),e.jsxs(A,{sx:{display:"none",position:"absolute",top:d?"23vh":f?"10.5vh":"16.5vh",left:d?"80vw":f?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:o.grey[100]},id:"reload-btn",type:"button",onClick:w,children:[e.jsx("span",{style:{display:"inherit",marginRight:"5px",marginLeft:"-2px"},children:e.jsx(me,{})}),"Back"]}),e.jsx(he,{action:_,api:U.UserRoleAPI,getQuery:i,columns:ve(b),rows:T.rows,count:T.count,selected:g,pageSizeOptions:je,setOldPagination:C,searchFlag:r,setSearchFlag:x}),e.jsx(ye,{openDialog:p,setOpenDialog:v})]})};export{Ie as default};
