import{u as R,t as L,d as D,a as p,h as O,b as G,k,l as ee,e as te,s as Q,m as E,j as e,T as W,n as ae,B as y,o as B,F as ne,I as se,S as ie,M as $,D as oe,p as b,q as le,L as re,U as V,A as ce}from"./index-MsP7Yzml.js";import{d as de,u as ue,S as me,a as pe,b as he}from"./index-9BU2f8bX.js";import{c as xe,a as z}from"./index.esm-JiYwYH4D.js";import{D as ge}from"./Dialog-9w6WfMaz.js";import"./FormControlLabel-c6D5vxEv.js";import"./Autocomplete-UT5QdtF-.js";import"./index-a8hLBBUR.js";const fe=xe().shape({name:z().min(2,"Name is Too Short!").max(40,"Name is Too Long!").required("This Field is Required"),description:z()}),_={name:"",description:"",status:"inactive"},ye=({openDialog:h,setOpenDialog:v})=>{const r=R(),x=L(r.palette.mode),A=D(r.breakpoints.down("md")),C=D("(max-width:480px)"),s=D("(max-width:920px)"),j=()=>{v(!1)},[g,T]=p.useState("Create"),[N,i]=p.useState(!1),[d,f]=p.useState(_),c=O(),o=G(),F=k(a=>a.menuItems.selected),w=k(a=>a.toastInfo),{state:S}=ee(),{typography:u}=te(r.palette.mode),{toastAndNavigate:m,getLocalStorage:Y}=V();let P=S==null?void 0:S.id;console.log("state.id=>",P),p.useEffect(()=>{const a=Y("menu");o(Q(a.selected)),P?(T("Update"),J(P)):(T("Create"),f(_))},[P]);const H=a=>{i(!0),E.AmenityAPI.updateAmenity(a).then(({data:t})=>{(t==null?void 0:t.status)==="Success"?(i(!1),m(o,!0,"info","Successfully Updated"),setTimeout(()=>{j(),location.href="/amenity/listing"},2e3)):(i(!1),m(o,!0,"error","An Error Occurred, Please Try Again",c,location.reload()))}).catch(t=>{var n,l;throw i(!1),m(o,!0,"error",(l=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:l.msg,c,location.reload()),t})},J=a=>{i(!0);const t=[`/get-by-pk/amenity/${a}`];E.CommonAPI.multipleAPICall("GET",t).then(n=>{n[0].data.status==="Success"?(f(n[0].data.data),i(!1)):(i(!1),m(o,!0,"error","An Error Occurred, Please Try Again",c,location.reload()))}).catch(n=>{var l,I;throw i(!1),m(o,!0,"error",(I=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:I.msg,c,location.reload()),n})},K=a=>{i(!0),E.AmenityAPI.createAmenity(a).then(({data:t})=>{(t==null?void 0:t.status)==="Success"?(i(!1),m(o,!0,"success","Successfully Created"),setTimeout(()=>{j(),c(0)},2e3)):(i(!1),m(o,!0,"error","An Error Occurred, Please Try Again",c,location.reload()))}).catch(t=>{var n,l;throw i(!1),m(o,!0,t?(l=(n=t.response)==null?void 0:n.data)==null?void 0:l.msg:"An Error Occurred",c,location.reload()),t})};return e.jsx("div",{children:e.jsxs(ge,{fullScreen:A,open:h,onClose:j,"aria-labelledby":"responsive-dialog-title",sx:{top:C?"33%":s?"25%":"20%",height:C?"49%":s?"39%":"60%","& .MuiPaper-root":{width:"100%"}},children:[e.jsx(W,{fontFamily:u.fontFamily,fontSize:u.h2.fontSize,color:x.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${g} ${F}`}),e.jsx(ae,{initialValues:d,enableReinitialize:!0,validationSchema:fe,onSubmit:a=>{a.id?H(a):K(a)},children:({values:a,errors:t,touched:n,dirty:l,isSubmitting:I,handleBlur:U,handleChange:M,handleSubmit:X,resetForm:Z})=>e.jsxs("form",{onSubmit:X,children:[e.jsxs(y,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(B,{variant:"filled",type:"text",name:"name",label:"Name*",autoComplete:"new-name",onBlur:U,onChange:M,value:a.name,error:!!n.name&&!!t.name,helperText:n.name&&t.name}),e.jsx(B,{variant:"filled",type:"text",label:"Description",name:"description",autoComplete:"new-description",onBlur:U,onChange:M,value:a.description,error:!!n.description&&!!t.description,helperText:n.description&&t.description}),e.jsxs(ne,{variant:"filled",sx:{minWidth:120},error:!!n.status&&!!t.status,children:[e.jsx(se,{id:"statusField",children:"Status"}),e.jsxs(ie,{variant:"filled",labelId:"statusField",label:"Status",name:"status",autoComplete:"new-status",value:a.status,onChange:M,children:[e.jsx($,{value:"active",children:"Active"}),e.jsx($,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx(oe,{}),e.jsxs(y,{display:"flex",justifyContent:"end",p:"20px",children:[g==="Update"?null:e.jsx(b,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!l||I,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&Z()},children:"Reset"}),e.jsx(b,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>j(),children:"Cancel"}),e.jsx(b,{type:"submit",disabled:!l||I,color:g==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(le,{alerting:w.toastAlert,severity:w.toastSeverity,message:w.toastMessage})]})]})}),N===!0?e.jsx(re,{}):null]})})},ve=h=>{const v=R(),r=L(v.palette.mode),x=O(),A=s=>{h(),x("#",{state:{id:s}})};return[{field:"name",headerName:"NAME",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"description",headerName:"DESCRIPTION",headerAlign:"center",align:"center",flex:1,minWidth:280},{field:"updated_at",headerName:"UPDATED AT",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:s=>s==null?void 0:s.value.substring(0,10)},{field:"status",headerName:"STATUS",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:s}})=>e.jsx(y,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:s==="active"?r.greenAccent[600]:r.redAccent[700],borderRadius:"4px",children:e.jsx(W,{color:r.grey[100],sx:{ml:"5px"},children:s})})},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{id:s}})=>e.jsx(y,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(b,{color:"info",variant:"contained",onClick:()=>A(s),sx:{minWidth:"50px"},children:e.jsx(de,{})})})}]},q=h=>({type:ce.SET_AMENITIES,payload:h}),Ae=[5,10,20],De=()=>{const[h,v]=p.useState(!1),[r,x]=p.useState({search:!1,searching:!1}),[A,C]=p.useState(),s=O(),j=G(),g=k(u=>u.menuItems.selected),{listData:T}=k(u=>u.allAmenities),N=R(),i=L(N.palette.mode),d=D("(max-width:480px)"),f=D("(max-width:920px)"),c=document.getElementById("reload-btn"),{getPaginatedData:o}=ue(),{getLocalStorage:F}=V();p.useEffect(()=>{const u=F("menu");j(Q(u.selected))},[]);const w=()=>{c.style.display="none",x({search:!1,searching:!1,oldPagination:A})},S=()=>{v(!0)};return e.jsxs(y,{m:"10px",position:"relative",children:[e.jsx(y,{height:d?"19vh":f?"8vh":"11vh",borderRadius:"4px",padding:d?"1vh":"2vh",backgroundColor:i.blueAccent[700],children:e.jsxs(y,{display:"flex",height:d?"16vh":"7vh",flexDirection:d?"column":"row",justifyContent:"space-between",alignItems:d?"center":"normal",children:[e.jsx(W,{component:"h2",variant:"h2",color:i.grey[100],fontWeight:"bold",children:g}),e.jsx(me,{action:q,api:E.AmenityAPI,getSearchData:o,oldPagination:A,reloadBtn:c,setSearchFlag:x}),e.jsxs(b,{type:"submit",color:"success",variant:"contained",onClick:()=>{s("#",{state:{id:void 0}}),S()},sx:{height:f?"4vh":"auto"},children:["Create New ",g]})]})}),e.jsxs(b,{sx:{display:"none",position:"absolute",top:d?"23vh":f?"10.5vh":"16.5vh",left:d?"80vw":f?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:i.grey[100]},id:"reload-btn",type:"button",onClick:w,children:[e.jsx("span",{style:{display:"inherit",marginRight:"5px",marginLeft:"-2px"},children:e.jsx(pe,{})}),"Back"]}),e.jsx(he,{action:q,api:E.AmenityAPI,getQuery:o,columns:ve(S),rows:T.rows,count:T.count,selected:g,pageSizeOptions:Ae,setOldPagination:C,searchFlag:r,setSearchFlag:x}),e.jsx(ye,{openDialog:h,setOpenDialog:v})]})};export{De as default};
