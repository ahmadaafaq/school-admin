import{f as w,k as I,u as W,t as B,h as F,a as d,A as y,j as s,B as j,T as L,o as _,U as $,b as P,s as Y}from"./index-j0XQm0-z.js";import{d as G,S as K,a as q,b as H}from"./DriveFileRenameOutlineOutlined-4CHf_UY8.js";import{s as T,D as J}from"./DropDown-UlFPQjKx.js";import{a as V}from"./SubjectAction-53mu3OIK.js";import{s as X}from"./StudentAction-K8wp7BqC.js";import{u as U}from"./index-WHxx72WB.js";import"./FormControlLabel-vP-JM7OO.js";import"./Chip-tKtg7KcT.js";import"./index-CJPbghPq.js";import"./ListItemText-e9tRpIBM.js";import"./SectionAction-WxHnx6S2.js";const Z=(b=null)=>{var N,r,f,k;const p=w(e=>e.allFormClasses),x=w(e=>e.allFormSections),a=w(e=>e.allSubjects),l=w(e=>e.allStudents);I();const D=W(),m=B(D.palette.mode),A=F(),{getPaginatedData:o}=U(),{appendSuffix:E,findById:u}=$(),C=(e,t)=>{A(`/marksheet/update/${e}`,{state:{id:e,student_id:t}})};return d.useEffect(()=>{var e,t;(t=(e=a==null?void 0:a.listData)==null?void 0:e.rows)!=null&&t.length||o(0,50,V,y.SubjectAPI)},[(r=(N=a==null?void 0:a.listData)==null?void 0:N.rows)==null?void 0:r.length]),d.useEffect(()=>{var e,t;(t=(e=l==null?void 0:l.listData)==null?void 0:e.rows)!=null&&t.length||o(0,50,X,y.StudentAPI)},[(k=(f=l==null?void 0:l.listData)==null?void 0:f.rows)==null?void 0:k.length]),[{field:"NAME",headerName:"NAME",headerAlign:"center",align:"center",flex:1,minWidth:100,renderCell:e=>{var h,c;let t=u((h=e==null?void 0:e.row)==null?void 0:h.student_id,(c=l==null?void 0:l.listData)==null?void 0:c.rows);return s.jsx("div",{children:t?`${t.firstname} ${t.lastname}`:"/"})}},{field:"class",headerName:"CLASS",headerAlign:"center",align:"center",flex:1,minWidth:100,renderCell:e=>{var c,g,v,S;let t=(g=u((c=e==null?void 0:e.row)==null?void 0:c.class_id,p==null?void 0:p.listData))==null?void 0:g.class_name,h=(S=u((v=e==null?void 0:e.row)==null?void 0:v.section_id,x==null?void 0:x.listData))==null?void 0:S.name;return s.jsxs("div",{children:[t?E(t):"/"," ",h]})}},{field:"subjects",headerName:"Subjects",headerAlign:"center",align:"center",flex:2,minWidth:120,renderCell:e=>{var h,c,g;let t=(g=u(parseInt((h=e==null?void 0:e.row)==null?void 0:h.subject_id),(c=a==null?void 0:a.listData)==null?void 0:c.rows))==null?void 0:g.name;return s.jsx("div",{children:t})}},{field:"term",headerName:"Term",headerAlign:"center",align:"center",flex:2,minWidth:80},{field:"result",headerName:"RESULT",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{result:e}})=>s.jsx(j,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:e==="pass"?m.greenAccent[600]:e==="fail"?m.redAccent[700]:e==="Not Declared Yet"?m.greenAccent[400]:m.redAccent[700],borderRadius:"4px",children:s.jsx(L,{color:m.grey[100],sx:{ml:"5px"},children:e})})},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{id:e,student_id:t}})=>s.jsx(j,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:s.jsx(_,{color:"info",variant:"contained",disabled:b,onClick:()=>C(e),sx:{minWidth:"50px"},children:s.jsx(G,{})})})}]},O=[5,10,20],de=({rolePriority:b=null})=>{const[p,x]=d.useState(null),[a,l]=d.useState(null),[D,m]=d.useState({}),A=w(i=>i.menuItems.selected),{listData:o,loading:E,marksheetClass:u,marksheetSection:C}=w(i=>i.allMarksheets),M=F(),N=I(),r=P("(max-width:480px)"),f=P("(max-width:920px)"),[k,e]=d.useState({search:!1,searching:!1}),[t,h]=d.useState(),c=W(),g=B(c.palette.mode),v=document.getElementById("reload-btn"),{getPaginatedData:S}=U(),{getLocalStorage:z}=$();let n=u.class_id?{classId:u.class_id}:null;n=C.id?{...n,sectionId:C.id}:null,d.useEffect(()=>{n!=null&&n.classId&&(n!=null&&n.sectionId)&&(S(0,5,T,y.MarksheetAPI,n),m(n))},[n==null?void 0:n.classId,n==null?void 0:n.sectionId]),d.useEffect(()=>{const i=z("menu");N(Y(i.selected))},[]),d.useEffect(()=>{var i;(i=o==null?void 0:o.rows)!=null&&i.length&&(x(o.rows[0].class_id),l(o.rows[0].section_id),console.log("SET DEFAYKT CLASS AND SECTION"))},[o==null?void 0:o.rows]);const Q=()=>{v.style.display="none",e({search:!1,searching:!1,oldPagination:t})};return console.log("selec=>",o),s.jsxs(j,{m:"8px",position:"relative",children:[s.jsx(j,{height:r?"19vh":f?"8vh":"11vh",borderRadius:"4px",padding:r?"1vh":"2vh",backgroundColor:g.blueAccent[700],children:s.jsxs(j,{display:"flex",height:r?"16vh":"7vh",flexDirection:r?"column":"row",justifyContent:"space-between",alignItems:r?"center":"normal",children:[s.jsx(L,{component:"h2",variant:"h2",color:g.grey[100],fontWeight:"bold",marginRight:"15px",children:A}),s.jsx(K,{action:T,api:y.MarksheetAPI,getSearchData:S,oldPagination:t,reloadBtn:v,setSearchFlag:e}),s.jsx(J,{onSelectClass:i=>x(i),onSelectSection:i=>l(i),selectedClass:p,selectedSection:a}),s.jsxs(_,{type:"submit",color:"success",variant:"contained",onClick:()=>{M("/marksheet/create")},disabled:!p||!a,sx:{height:f?"4vh":"auto"},children:["Create New ",A]})]})}),s.jsxs(_,{sx:{display:"none",position:"absolute",top:r?"23vh":f?"10.5vh":"16.5vh",left:r?"80vw":f?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:g.grey[100]},id:"reload-btn",type:"button",onClick:Q,children:[s.jsx("span",{style:{display:"inherit",marginRight:"5px"},children:s.jsx(q,{})}),"Back"]}),s.jsx(H,{action:T,api:y.MarksheetAPI,getQuery:S,columns:Z(b),rows:o.rows,count:o.count,loading:E,selected:A,pageSizeOptions:O,setOldPagination:h,searchFlag:k,setSearchFlag:e,condition:D})]})};export{de as default};
