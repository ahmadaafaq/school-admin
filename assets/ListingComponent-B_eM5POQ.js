import{k as ne,l as se,P as W,u as M,t as O,b as I,a as u,n as $,o as Q,m as E,p as oe,d as ie,s as V,A as P,j as e,D as le,f as U,T as B,F as re,B as g,q as ce,v as de,I as ue,S as pe,M as me,w as he,h as S,x as ge,y as xe,U as Y}from"./index-dsWAcX1f.js";import{d as fe,l as z,S as be,a as Se,b as ye}from"./listBG-dw88K66u.js";import{c as _}from"./index-mbUFVO5S.js";import{b as q}from"./SectionAction-OMdiSl6G.js";import{u as ve}from"./index-uKa1WJb8.js";import"./FormControlLabel-GbaKk4ky.js";import"./toPropertyKey-Z1a84DJL.js";import"./typeof-LnL08gqA.js";import"./CircularProgress-4dZqOr9B.js";const je=ne().shape({name:se().min(0,"Name is Too Short!").max(20,"Name is Too Long!").required("This Field is Required")}),G={name:"",status:"inactive"},H=({openDialog:y,setOpenDialog:x})=>{const c=M(),m=O(c.palette.mode),f=I(c.breakpoints.down("md")),v=I("(max-width:480px)"),s=I("(max-width:920px)"),b=()=>{x(!1)},[h,j]=u.useState("Create"),[F,o]=u.useState(!1),[C,p]=u.useState(G),l=$(),r=Q(),D=E(t=>t.menuItems.selected),A=E(t=>t.toastInfo),{state:T}=oe(),{typography:k}=ie(c.palette.mode),{toastAndNavigate:i,getLocalStorage:J}=Y();let R=T==null?void 0:T.id;u.useEffect(()=>{const t=J("menu");r(V(t.selected)),R?(j("Update"),X(R)):(j("Create"),p(G))},[R]);const K=u.useCallback(t=>{o(!0),P.SectionAPI.updateSection(t).then(({data:a})=>{a.status==="Success"?(o(!1),i(r,!0,"info","Successfully Updated"),setTimeout(()=>{b(),location.href="/section/listing"},2e3)):(o(!1),i(r,!0,"error","An Error Occurred, Please Try Again",l,location.reload()))}).catch(a=>{var n,d;throw o(!1),i(r,!0,"error",(d=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:d.msg,l,location.reload()),a})},[]),X=u.useCallback(t=>{o(!0);const a=[`/get-by-pk/section/${t}`];P.CommonAPI.multipleAPICall("GET",a).then(n=>{n[0].data.status==="Success"?(p(n[0].data.data),o(!1)):(o(!1),i(r,!0,"error","An Error Occurred, Please Try Again",l,location.reload()))}).catch(n=>{var d,w;throw o(!1),i(r,!0,"error",(w=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:w.msg,l,location.reload()),n})},[R]),Z=u.useCallback(t=>{o(!0),P.SectionAPI.createSection(t).then(({data:a})=>{a.status==="Success"?(o(!1),i(r,!0,"success","Successfully Created"),setTimeout(()=>{b(),l(0)},2e3)):(o(!1),i(r,!0,"error","An Error Occurred, Please Try Again",l,location.reload()))}).catch(a=>{var n,d;throw o(!1),i(r,!0,a?(d=(n=a.response)==null?void 0:n.data)==null?void 0:d.msg:"An Error Occurred",l,location.reload()),a})},[]);return e.jsx("div",{children:e.jsxs(le,{fullScreen:f,open:y,onClose:b,"aria-labelledby":"responsive-dialog-title",sx:{top:v?"33%":s?"25%":"20%",height:v?"49%":s?"39%":"60%","& .MuiPaper-root":{width:"100%",backgroundImage:c.palette.mode=="light"?`linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url(${U})`:`linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), url(${U})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}},children:[e.jsx(B,{fontFamily:k.fontFamily,fontSize:k.h2.fontSize,color:m.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${h} ${D}`}),e.jsx(re,{initialValues:C,enableReinitialize:!0,validationSchema:je,onSubmit:t=>{t.id?K(t):Z(t)},children:({values:t,errors:a,touched:n,dirty:d,isSubmitting:w,handleBlur:ee,handleChange:L,handleSubmit:te,resetForm:ae})=>e.jsxs("form",{onSubmit:te,children:[e.jsxs(g,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(ce,{variant:"filled",type:"text",name:"name",label:"Name*",autoComplete:"new-name",onBlur:ee,onChange:L,value:t.name,error:!!n.name&&!!a.name,helperText:n.name&&a.name}),e.jsxs(de,{variant:"filled",sx:{minWidth:120},error:!!n.status&&!!a.status,children:[e.jsx(ue,{id:"statusField",children:"Status"}),e.jsx(pe,{variant:"filled",labelId:"statusField",label:"Status",name:"status",autoComplete:"new-status",value:t.status,onChange:L,children:Object.keys(_.status).map(N=>e.jsx(me,{value:N,children:_.status[N]},N))})]})]}),e.jsx(he,{}),e.jsxs(g,{display:"flex",justifyContent:"end",p:"20px",children:[h==="Update"?null:e.jsx(S,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!d||w,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&ae()},children:"Reset"}),e.jsx(S,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>b(),children:"Cancel"}),e.jsx(S,{type:"submit",disabled:!d||w,color:h==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(ge,{alerting:A.toastAlert,severity:A.toastSeverity,message:A.toastMessage})]})]})}),F===!0?e.jsx(xe,{}):null]})})};H.propTypes={openDialog:W.bool,setOpenDialog:W.func};const Ce=y=>{const x=M(),c=O(x.palette.mode),m=$(),f=s=>{y(),m("#",{state:{id:s}})};return[{field:"section_name",headerName:"NAME",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"status",headerName:"STATUS",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:s}})=>e.jsx(g,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:s==="active"?c.greenAccent[600]:c.redAccent[700],borderRadius:"4px",children:e.jsx(B,{color:c.grey[100],sx:{ml:"5px"},children:s})})},{field:"updated_at",headerName:"UPDATED AT",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:s=>s==null?void 0:s.value.substring(0,10)},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{section_id:s}})=>e.jsx(g,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(S,{color:"info",variant:"contained",onClick:()=>f(s),sx:{minWidth:"50px"},children:e.jsx(fe,{})})})}]},Ae=[5,10,20],Ne=()=>{const[y,x]=u.useState(!1),[c,m]=u.useState({search:!1,searching:!1}),[f,v]=u.useState(),s=$(),b=Q(),h=E(i=>i.menuItems.selected),{listData:j,loading:F}=E(i=>i.listingSections),o=M(),C=O(o.palette.mode),p=I("(max-width:480px)"),l=I("(max-width:920px)"),r=document.getElementById("reload-btn"),{getPaginatedData:D}=ve(),{getLocalStorage:A}=Y();u.useEffect(()=>{const i=A("menu");b(V(i.selected))},[]);const T=()=>{r.style.display="none",m({search:!1,searching:!1,oldPagination:f})},k=()=>{x(!0)};return e.jsxs(g,{m:"10px",position:"relative",sx:{borderRadius:"20px",border:"0.5px solid black",overflow:"hidden",boxShadow:"1px 1px 10px black",backgroundImage:o.palette.mode==="light"?`linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url(${z})`:`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${z})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:[e.jsx(g,{height:p?"19vh":l?"8vh":"11vh",borderRadius:"4px",padding:p?"1vh":"2vh",backgroundColor:C.blueAccent[700],children:e.jsxs(g,{display:"flex",height:p?"16vh":"7vh",flexDirection:p?"column":"row",justifyContent:"space-between",alignItems:p?"center":"normal",children:[e.jsx(B,{component:"h2",variant:"h2",color:C.grey[100],fontWeight:"bold",children:h}),e.jsx(be,{action:q,api:P.SectionAPI,getSearchData:D,oldPagination:f,reloadBtn:r,setSearchFlag:m}),e.jsxs(S,{type:"submit",color:"success",variant:"contained",onClick:()=>{s("#",{state:{id:void 0}}),k()},sx:{height:l?"4vh":"auto"},children:["Create New ",h]})]})}),e.jsxs(S,{sx:{display:"none",position:"absolute",top:p?"23vh":l?"10.5vh":"16.5vh",left:p?"80vw":l?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:C.grey[100]},id:"reload-btn",type:"button",onClick:T,children:[e.jsx("span",{style:{display:"inherit",marginRight:"5px"},children:e.jsx(Se,{})}),"Back"]}),e.jsx(ye,{action:q,api:P.SectionAPI,getQuery:D,columns:Ce(k),rows:j.rows,count:j.count,loading:F,selected:h,pageSizeOptions:Ae,setOldPagination:v,searchFlag:c,setSearchFlag:m}),e.jsx(H,{openDialog:y,setOpenDialog:x})]})};export{Ne as default};
