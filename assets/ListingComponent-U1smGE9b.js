import{u as M,t as R,d as D,a as m,h as L,b as z,k,l as X,e as Z,s as _,m as P,j as e,T as O,n as ee,B as j,o as te,F as ae,I as se,S as ne,M as W,D as oe,p as A,q as ie,L as le,U as q,A as ce}from"./index-MsP7Yzml.js";import{d as re,u as de,S as ue,a as he,b as me}from"./index-9BU2f8bX.js";import{c as pe,a as xe}from"./index.esm-JiYwYH4D.js";import{D as ge}from"./Dialog-9w6WfMaz.js";import"./FormControlLabel-c6D5vxEv.js";import"./Autocomplete-UT5QdtF-.js";import"./index-a8hLBBUR.js";const fe=pe().shape({name:xe().min(0,"Name is Too Short!").max(40,"Name is Too Long!").required("This Field is Required")}),B={name:"",status:"inactive"},je=({openDialog:p,setOpenDialog:S})=>{const c=M(),x=R(c.palette.mode),b=D(c.breakpoints.down("md")),C=D("(max-width:480px)"),n=D("(max-width:920px)"),v=()=>{S(!1)},[g,T]=m.useState("Create"),[E,o]=m.useState(!1),[d,f]=m.useState(B),r=L(),i=z(),F=k(t=>t.menuItems.selected),w=k(t=>t.toastInfo),{state:y}=X(),{typography:u}=Z(c.palette.mode),{toastAndNavigate:h,getLocalStorage:G}=q();let N=y==null?void 0:y.id;m.useEffect(()=>{const t=G("menu");i(_(t.selected)),N?(T("Update"),V(N)):(T("Create"),f(B))},[N]);const Q=t=>{o(!0),P.SubjectAPI.updateSubject(t).then(({data:a})=>{a.status==="Success"?(o(!1),h(i,!0,"info","Successfully Updated"),setTimeout(()=>{v(),location.href="/subject/listing"},2e3)):(o(!1),h(i,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(a=>{var s,l;throw o(!1),h(i,!0,"error",(l=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:l.msg,r,location.reload()),a})},V=t=>{o(!0);const a=[`/get-by-pk/subject/${t}`];P.CommonAPI.multipleAPICall("GET",a).then(s=>{s[0].data.status==="Success"?(f(s[0].data.data),o(!1)):(o(!1),h(i,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(s=>{var l,I;throw o(!1),h(i,!0,"error",(I=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:I.msg,r,location.reload()),s})},J=t=>{o(!0),P.SubjectAPI.createSubject(t).then(({data:a})=>{a.status==="Success"?(o(!1),h(i,!0,"success","Successfully Created"),setTimeout(()=>{v(),r(0)},2e3)):(o(!1),h(i,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(a=>{var s,l;throw o(!1),h(i,!0,a?(l=(s=a.response)==null?void 0:s.data)==null?void 0:l.msg:"An Error Occurred",r,location.reload()),a})};return e.jsx("div",{children:e.jsxs(ge,{fullScreen:b,open:p,onClose:v,"aria-labelledby":"responsive-dialog-title",sx:{top:C?"33%":n?"25%":"20%",height:C?"49%":n?"39%":"60%","& .MuiPaper-root":{width:"100%"}},children:[e.jsx(O,{fontFamily:u.fontFamily,fontSize:u.h2.fontSize,color:x.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${g} ${F}`}),e.jsx(ee,{initialValues:d,enableReinitialize:!0,validationSchema:fe,onSubmit:t=>{t.id?Q(t):J(t)},children:({values:t,errors:a,touched:s,dirty:l,isSubmitting:I,handleBlur:Y,handleChange:U,handleSubmit:H,resetForm:K})=>e.jsxs("form",{onSubmit:H,children:[e.jsxs(j,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(te,{variant:"filled",type:"text",name:"name",label:"Name*",autoComplete:"new-name",onBlur:Y,onChange:U,value:t.name,error:!!s.name&&!!a.name,helperText:s.name&&a.name}),e.jsxs(ae,{variant:"filled",sx:{minWidth:120},error:!!s.status&&!!a.status,children:[e.jsx(se,{id:"statusField",children:"Status"}),e.jsxs(ne,{variant:"filled",labelId:"statusField",label:"Status",name:"status",autoComplete:"new-status",value:t.status,onChange:U,children:[e.jsx(W,{value:"active",children:"Active"}),e.jsx(W,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx(oe,{}),e.jsxs(j,{display:"flex",justifyContent:"end",p:"20px",children:[g==="Update"?null:e.jsx(A,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!l||I,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&K()},children:"Reset"}),e.jsx(A,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>v(),children:"Cancel"}),e.jsx(A,{type:"submit",disabled:!l||I,color:g==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(ie,{alerting:w.toastAlert,severity:w.toastSeverity,message:w.toastMessage})]})]})}),E===!0?e.jsx(le,{}):null]})})},Se=p=>{const S=M(),c=R(S.palette.mode),x=L(),b=n=>{p(),x("#",{state:{id:n}})};return[{field:"name",headerName:"NAME",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"status",headerName:"STATUS",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:n}})=>e.jsx(j,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:n==="active"?c.greenAccent[600]:c.redAccent[700],borderRadius:"4px",children:e.jsx(O,{color:c.grey[100],sx:{ml:"5px"},children:n})})},{field:"updated_at",headerName:"UPDATED AT",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:n=>n==null?void 0:n.value.substring(0,10)},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{id:n}})=>e.jsx(j,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(A,{color:"info",variant:"contained",onClick:()=>b(n),sx:{minWidth:"50px"},children:e.jsx(re,{})})})}]},$=p=>({type:ce.SET_SUBJECTS,payload:p}),be=[5,10,20],De=()=>{const[p,S]=m.useState(!1),[c,x]=m.useState({search:!1,searching:!1}),[b,C]=m.useState(),n=L(),v=z(),g=k(u=>u.menuItems.selected),{listData:T}=k(u=>u.allSubjects),E=M(),o=R(E.palette.mode),d=D("(max-width:480px)"),f=D("(max-width:920px)"),r=document.getElementById("reload-btn"),{getPaginatedData:i}=de(),{getLocalStorage:F}=q();m.useEffect(()=>{const u=F("menu");v(_(u.selected))},[]);const w=()=>{r.style.display="none",x({search:!1,searching:!1,oldPagination:b})},y=()=>{S(!0)};return e.jsxs(j,{m:"10px",position:"relative",children:[e.jsx(j,{height:d?"19vh":f?"8vh":"11vh",borderRadius:"4px",padding:d?"1vh":"2vh",backgroundColor:o.blueAccent[700],children:e.jsxs(j,{display:"flex",height:d?"16vh":"7vh",flexDirection:d?"column":"row",justifyContent:"space-between",alignItems:d?"center":"normal",children:[e.jsx(O,{component:"h2",variant:"h2",color:o.grey[100],fontWeight:"bold",children:g}),e.jsx(ue,{action:$,api:P.SubjectAPI,getSearchData:i,oldPagination:b,reloadBtn:r,setSearchFlag:x}),e.jsxs(A,{type:"submit",color:"success",variant:"contained",onClick:()=>{n("#",{state:{id:void 0}}),y()},sx:{height:f?"4vh":"auto"},children:["Create New ",g]})]})}),e.jsxs(A,{sx:{display:"none",position:"absolute",top:d?"23vh":f?"10.5vh":"16.5vh",left:d?"80vw":f?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:o.grey[100]},id:"reload-btn",type:"button",onClick:w,children:[e.jsx("span",{style:{display:"inherit",marginRight:"5px",marginLeft:"-2px"},children:e.jsx(he,{})}),"Back"]}),e.jsx(me,{action:$,api:P.SubjectAPI,getQuery:i,columns:Se(y),rows:T.rows,count:T.count,selected:g,pageSizeOptions:be,setOldPagination:C,searchFlag:c,setSearchFlag:x}),e.jsx(je,{openDialog:p,setOpenDialog:S})]})};export{De as default};
