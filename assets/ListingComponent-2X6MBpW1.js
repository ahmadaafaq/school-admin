import{k as ne,l as se,P as B,u as F,t as O,b as R,a as u,n as M,o as V,m as D,p as oe,d as ie,s as Y,A as I,j as e,D as re,f as L,T as W,F as le,B as x,q as z,v as ce,I as de,S as ue,M as _,w as pe,h as v,x as me,y as he,U as H,N as ge}from"./index-dsWAcX1f.js";import{d as xe,l as q,S as fe,a as be,b as ye}from"./listBG-dw88K66u.js";import{u as ve}from"./index-uKa1WJb8.js";import"./FormControlLabel-GbaKk4ky.js";import"./toPropertyKey-Z1a84DJL.js";import"./typeof-LnL08gqA.js";import"./CircularProgress-4dZqOr9B.js";const Se=ne().shape({name:se().min(2,"Name is Too Short!").max(20,"Name is Too Long!").required("This Field is Required")}),G={name:"",priority:0,status:"inactive"},J=({openDialog:m,setOpenDialog:f})=>{const c=F(),h=O(c.palette.mode),b=R(c.breakpoints.down("md")),S=R("(max-width:480px)"),s=R("(max-width:920px)"),y=()=>{f(!1)},[g,j]=u.useState("Create"),[E,o]=u.useState(!1),[C,p]=u.useState(G),r=M(),l=V(),P=D(a=>a.menuItems.selected),A=D(a=>a.toastInfo),{state:T}=oe(),{typography:w}=ie(c.palette.mode),{toastAndNavigate:i,getLocalStorage:K}=H();let U=T==null?void 0:T.id;u.useEffect(()=>{const a=K("menu");l(Y(a.selected)),U?(j("Update"),Z(U)):(j("Create"),p(G))},[U]);const X=u.useCallback(a=>{o(!0),I.UserRoleAPI.updateUserRole(a).then(({data:t})=>{t.status==="Success"?(o(!1),i(l,!0,"info","Successfully Updated"),setTimeout(()=>{y(),location.href="/role/listing"},2e3)):(o(!1),i(l,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(t=>{var n,d;throw o(!1),i(l,!0,"error",(d=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:d.msg,r,location.reload()),t})},[]),Z=u.useCallback(a=>{o(!0);const t=[`/get-by-pk/role/${a}`];I.CommonAPI.multipleAPICall("GET",t).then(n=>{n[0].data.status==="Success"?(p(n[0].data.data),o(!1)):(o(!1),i(l,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(n=>{var d,k;throw o(!1),i(l,!0,"error",(k=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:k.msg,r,location.reload()),n})},[U]),ee=u.useCallback(a=>{o(!0),I.UserRoleAPI.createUserRole(a).then(({data:t})=>{t.status==="Success"?(o(!1),i(l,!0,"success","Successfully Created"),setTimeout(()=>{y(),r(0)},2e3)):(o(!1),i(l,!0,"error","An Error Occurred, Please Try Again",r,location.reload()))}).catch(t=>{var n,d;throw o(!1),i(l,!0,t?(d=(n=t.response)==null?void 0:n.data)==null?void 0:d.msg:"An Error Occurred",r,location.reload()),t})},[]);return e.jsx("div",{children:e.jsxs(re,{fullScreen:b,open:m,onClose:y,"aria-labelledby":"responsive-dialog-title",sx:{top:S?"33%":s?"25%":"20%",height:S?"49%":s?"39%":"60%","& .MuiPaper-root":{width:"100%",backgroundImage:c.palette.mode=="light"?`linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url(${L})`:`linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), url(${L})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}},children:[e.jsx(W,{fontFamily:w.fontFamily,fontSize:w.h2.fontSize,color:h.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${g} ${P}`}),e.jsx(le,{initialValues:C,enableReinitialize:!0,validationSchema:Se,onSubmit:a=>{a.id?X(a):ee(a)},children:({values:a,errors:t,touched:n,dirty:d,isSubmitting:k,handleBlur:$,handleChange:N,handleSubmit:te,resetForm:ae})=>e.jsxs("form",{onSubmit:te,children:[e.jsxs(x,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(z,{variant:"filled",type:"text",name:"name",label:"Name*",autoComplete:"new-name",onBlur:$,onChange:N,value:a.name,error:!!n.name&&!!t.name,helperText:n.name&&t.name}),e.jsx(z,{variant:"filled",type:"text",label:"Priority",name:"priority",autoComplete:"new-priority",onBlur:$,onChange:N,value:a.priority,error:!!n.priority&&!!t.priority,helperText:n.priority&&t.priority}),e.jsxs(ce,{variant:"filled",sx:{minWidth:120},error:!!n.status&&!!t.status,children:[e.jsx(de,{id:"statusField",children:"Status"}),e.jsxs(ue,{variant:"filled",labelId:"statusField",label:"Status",name:"status",autoComplete:"new-status",value:a.status,onChange:N,children:[e.jsx(_,{value:"active",children:"Active"}),e.jsx(_,{value:"inactive",children:"Inactive"})]})]})]}),e.jsx(pe,{}),e.jsxs(x,{display:"flex",justifyContent:"end",p:"20px",children:[g==="Update"?null:e.jsx(v,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!d||k,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&ae()},children:"Reset"}),e.jsx(v,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>y(),children:"Cancel"}),e.jsx(v,{type:"submit",disabled:!d||k,color:g==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(me,{alerting:A.toastAlert,severity:A.toastSeverity,message:A.toastMessage})]})]})}),E===!0?e.jsx(he,{}):null]})})};J.propTypes={openDialog:B.bool,setOpenDialog:B.func};const je=m=>{const f=F(),c=O(f.palette.mode),h=M(),b=s=>{m(),h("#",{state:{id:s}})};return[{field:"name",headerName:"NAME",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"priority",headerName:"PRIORITY",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"updated_at",headerName:"UPDATED AT",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:s=>s==null?void 0:s.value.substring(0,10)},{field:"status",headerName:"STATUS",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:s}})=>e.jsx(x,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:s==="active"?c.greenAccent[600]:c.redAccent[700],borderRadius:"4px",children:e.jsx(W,{color:c.grey[100],sx:{ml:"5px"},children:s})})},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{id:s}})=>e.jsx(x,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(v,{color:"info",variant:"contained",onClick:()=>b(s),sx:{minWidth:"50px"},children:e.jsx(xe,{})})})}]},Q=m=>({type:ge.SET_USER_ROLES,payload:m}),Ce=[5,10,20],Ue=()=>{const[m,f]=u.useState(!1),[c,h]=u.useState({search:!1,searching:!1}),[b,S]=u.useState(),s=M(),y=V(),g=D(i=>i.menuItems.selected),{listData:j,loading:E}=D(i=>i.allUserRoles),o=F(),C=O(o.palette.mode),p=R("(max-width:480px)"),r=R("(max-width:920px)"),l=document.getElementById("reload-btn"),{getPaginatedData:P}=ve(),{getLocalStorage:A}=H();u.useEffect(()=>{const i=A("menu");y(Y(i.selected))},[]);const T=()=>{l.style.display="none",h({search:!1,searching:!1,oldPagination:b})},w=()=>{f(!0)};return e.jsxs(x,{m:"10px",position:"relative",sx:{borderRadius:"20px",border:"0.5px solid black",overflow:"hidden",boxShadow:"1px 1px 10px black",backgroundImage:o.palette.mode==="light"?`linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url(${q})`:`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${q})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:[e.jsx(x,{height:p?"19vh":r?"8vh":"11vh",borderRadius:"4px",padding:p?"1vh":"2vh",backgroundColor:C.blueAccent[700],children:e.jsxs(x,{display:"flex",height:p?"16vh":"7vh",flexDirection:p?"column":"row",justifyContent:"space-between",alignItems:p?"center":"normal",children:[e.jsx(W,{component:"h2",variant:"h2",color:C.grey[100],fontWeight:"bold",children:g}),e.jsx(fe,{action:Q,api:I.UserRoleAPI,getSearchData:P,oldPagination:b,reloadBtn:l,setSearchFlag:h}),e.jsxs(v,{type:"submit",color:"success",variant:"contained",onClick:()=>{s("#",{state:{id:void 0}}),w()},sx:{height:r?"4vh":"auto"},children:["Create New ",g]})]})}),e.jsxs(v,{sx:{display:"none",position:"absolute",top:p?"23vh":r?"10.5vh":"16.5vh",left:p?"80vw":r?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:C.grey[100]},id:"reload-btn",type:"button",onClick:T,children:[e.jsx("span",{style:{display:"inherit",marginRight:"5px"},children:e.jsx(be,{})}),"Back"]}),e.jsx(ye,{action:Q,api:I.UserRoleAPI,getQuery:P,columns:je(w),rows:j.rows,count:j.count,loading:E,selected:g,pageSizeOptions:Ce,setOldPagination:S,searchFlag:c,setSearchFlag:h}),e.jsx(J,{openDialog:m,setOpenDialog:f})]})};export{Ue as default};
