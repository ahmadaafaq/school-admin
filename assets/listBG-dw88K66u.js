import{aF as wu,a5 as Ln,a1 as mn,a2 as Nn,a3 as je,aG as et,a as x,a6 as me,a4 as k,aq as Ei,a7 as Ue,j as I,a8 as Le,ay as Qe,aH as Cu,ak as Wt,aI as Ti,aJ as vl,aK as wl,u as Yr,Z as ln,S as bu,M as kr,at as tt,aL as ss,ax as Tf,r as to,i as ro,P as J,t as Cl,b as Ma,B as gn,am as Mt,al as qr,aD as ls,aA as bl,aM as Su,aB as yf,a9 as ku,av as is,ap as Er,w as Eu,aN as Tn,aC as _f,O as Tu,aO as Ff,q as Sl,aP as kl,aQ as If,aR as yu,v as Pf,h as Ro,ad as Af,$ as Mf,I as Df,aE as Of,m as yi,d as Rf,A as _i,D as Lf,f as Fi,T as Nf,x as Bf}from"./index-dsWAcX1f.js";import{S as Hf,s as Ft,F as $f,C as Vf}from"./FormControlLabel-GbaKk4ky.js";import{t as Ua}from"./toPropertyKey-Z1a84DJL.js";import{L as oa}from"./typeof-LnL08gqA.js";import{C as Gf}from"./CircularProgress-4dZqOr9B.js";function Uf(e,t){return()=>null}function zf(e){return String(e).match(/[\d.\-+]*\s*(.*)/)[1]||""}function jf(e){return parseFloat(e)}function Wf(e){const{badgeContent:t,invisible:r=!1,max:n=99,showZero:a=!1}=e,o=wu({badgeContent:t,max:n});let s=r;r===!1&&t===0&&!a&&(s=!0);const{badgeContent:l,max:i=n}=s?o:e,u=l&&Number(l)>i?`${i}+`:l;return{badgeContent:l,invisible:s,max:i,displayValue:u}}function Kf(e){return Ln}function Xf(e){return Nn("MuiBadge",e)}const Yf=mn("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),Jr=Yf,qf=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],Ms=10,Ds=4,Zf=Kf(),Qf=e=>{const{color:t,anchorOrigin:r,invisible:n,overlap:a,variant:o,classes:s={}}=e,l={root:["root"],badge:["badge",o,n&&"invisible",`anchorOrigin${et(r.vertical)}${et(r.horizontal)}`,`anchorOrigin${et(r.vertical)}${et(r.horizontal)}${et(a)}`,`overlap${et(a)}`,t!=="default"&&`color${et(t)}`]};return Le(l,Xf,s)},Jf=je("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),eh=je("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.badge,t[r.variant],t[`anchorOrigin${et(r.anchorOrigin.vertical)}${et(r.anchorOrigin.horizontal)}${et(r.overlap)}`],r.color!=="default"&&t[`color${et(r.color)}`],r.invisible&&t.invisible]}})(({theme:e})=>{var t;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:Ms*2,lineHeight:1,padding:"0 6px",height:Ms*2,borderRadius:Ms,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.keys(((t=e.vars)!=null?t:e).palette).filter(r=>{var n,a;return((n=e.vars)!=null?n:e).palette[r].main&&((a=e.vars)!=null?a:e).palette[r].contrastText}).map(r=>({props:{color:r},style:{backgroundColor:(e.vars||e).palette[r].main,color:(e.vars||e).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:Ds,height:Ds*2,minWidth:Ds*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Jr.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Jr.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Jr.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Jr.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Jr.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Jr.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Jr.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Jr.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]}}),th=x.forwardRef(function(t,r){var n,a,o,s,l,i;const u=Zf({props:t,name:"MuiBadge"}),{anchorOrigin:c={vertical:"top",horizontal:"right"},className:d,component:f,components:p={},componentsProps:h={},children:g,overlap:m="rectangular",color:w="default",invisible:v=!1,max:C=99,badgeContent:E,slots:R,slotProps:S,showZero:b=!1,variant:T="standard"}=u,A=me(u,qf),{badgeContent:N,invisible:y,max:D,displayValue:L}=Wf({max:C,invisible:v,badgeContent:E,showZero:b}),M=wu({anchorOrigin:c,color:w,overlap:m,variant:T,badgeContent:E}),F=y||N==null&&T!=="dot",{color:B=w,overlap:H=m,anchorOrigin:G=c,variant:_=T}=F?M:u,Z=_!=="dot"?L:void 0,ee=k({},u,{badgeContent:N,invisible:F,max:D,displayValue:Z,showZero:b,anchorOrigin:G,color:B,overlap:H,variant:_}),P=Qf(ee),q=(n=(a=R==null?void 0:R.root)!=null?a:p.Root)!=null?n:Jf,K=(o=(s=R==null?void 0:R.badge)!=null?s:p.Badge)!=null?o:eh,X=(l=S==null?void 0:S.root)!=null?l:h.root,te=(i=S==null?void 0:S.badge)!=null?i:h.badge,le=Ei({elementType:q,externalSlotProps:X,externalForwardedProps:A,additionalProps:{ref:r,as:f},ownerState:ee,className:Ue(X==null?void 0:X.className,P.root,d)}),fe=Ei({elementType:K,externalSlotProps:te,ownerState:ee,className:Ue(P.badge,te==null?void 0:te.className)});return I.jsxs(q,k({},le,{children:[g,I.jsx(K,k({},fe,{children:Z}))]}))}),El=th,rh=Qe(I.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),nh=Qe(I.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage");function ah(e){return Nn("MuiSkeleton",e)}mn("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const oh=["animation","className","component","height","style","variant","width"];let Lo=e=>e,Ii,Pi,Ai,Mi;const sh=e=>{const{classes:t,variant:r,animation:n,hasChildren:a,width:o,height:s}=e;return Le({root:["root",r,n,a&&"withChildren",a&&!o&&"fitContent",a&&!s&&"heightAuto"]},ah,t)},lh=Cu(Ii||(Ii=Lo`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`)),ih=Cu(Pi||(Pi=Lo`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`)),ch=je("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],r.animation!==!1&&t[r.animation],r.hasChildren&&t.withChildren,r.hasChildren&&!r.width&&t.fitContent,r.hasChildren&&!r.height&&t.heightAuto]}})(({theme:e,ownerState:t})=>{const r=zf(e.shape.borderRadius)||"px",n=jf(e.shape.borderRadius);return k({display:"block",backgroundColor:e.vars?e.vars.palette.Skeleton.bg:Wt(e.palette.text.primary,e.palette.mode==="light"?.11:.13),height:"1.2em"},t.variant==="text"&&{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${n}${r}/${Math.round(n/.6*10)/10}${r}`,"&:empty:before":{content:'"\\00a0"'}},t.variant==="circular"&&{borderRadius:"50%"},t.variant==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius},t.hasChildren&&{"& > *":{visibility:"hidden"}},t.hasChildren&&!t.width&&{maxWidth:"fit-content"},t.hasChildren&&!t.height&&{height:"auto"})},({ownerState:e})=>e.animation==="pulse"&&Ti(Ai||(Ai=Lo`
      animation: ${0} 2s ease-in-out 0.5s infinite;
    `),lh),({ownerState:e,theme:t})=>e.animation==="wave"&&Ti(Mi||(Mi=Lo`
      position: relative;
      overflow: hidden;

      /* Fix bug in Safari https://bugs.webkit.org/show_bug.cgi?id=68196 */
      -webkit-mask-image: -webkit-radial-gradient(white, black);

      &::after {
        animation: ${0} 2s linear 0.5s infinite;
        background: linear-gradient(
          90deg,
          transparent,
          ${0},
          transparent
        );
        content: '';
        position: absolute;
        transform: translateX(-100%); /* Avoid flash during server-side hydration */
        bottom: 0;
        left: 0;
        right: 0;
        top: 0;
      }
    `),ih,(t.vars||t).palette.action.hover)),uh=x.forwardRef(function(t,r){const n=Ln({props:t,name:"MuiSkeleton"}),{animation:a="pulse",className:o,component:s="span",height:l,style:i,variant:u="text",width:c}=n,d=me(n,oh),f=k({},n,{animation:a,component:s,variant:u,hasChildren:!!d.children}),p=sh(f);return I.jsx(ch,k({as:s,ref:r,className:Ue(p.root,o),ownerState:f},d,{style:k({width:c,height:l},i)}))}),_u=uh;function dh(e){return Nn("MuiSwitch",e)}const fh=mn("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Nt=fh,hh=["className","color","edge","size","sx"],gh=e=>{const{classes:t,edge:r,size:n,color:a,checked:o,disabled:s}=e,l={root:["root",r&&`edge${et(r)}`,`size${et(n)}`],switchBase:["switchBase",`color${et(a)}`,o&&"checked",s&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},i=Le(l,dh,t);return k({},t,i)},ph=je("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.edge&&t[`edge${et(r.edge)}`],t[`size${et(r.size)}`]]}})(({ownerState:e})=>k({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},e.edge==="start"&&{marginLeft:-8},e.edge==="end"&&{marginRight:-8},e.size==="small"&&{width:40,height:24,padding:7,[`& .${Nt.thumb}`]:{width:16,height:16},[`& .${Nt.switchBase}`]:{padding:4,[`&.${Nt.checked}`]:{transform:"translateX(16px)"}}})),xh=je(Hf,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.switchBase,{[`& .${Nt.input}`]:t.input},r.color!=="default"&&t[`color${et(r.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${Nt.checked}`]:{transform:"translateX(20px)"},[`&.${Nt.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${Nt.checked} + .${Nt.track}`]:{opacity:.5},[`&.${Nt.disabled} + .${Nt.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${Nt.input}`]:{left:"-100%",width:"300%"}}),({theme:e,ownerState:t})=>k({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Wt(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${Nt.checked}`]:{color:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Wt(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Nt.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t.color}DisabledColor`]:`${e.palette.mode==="light"?vl(e.palette[t.color].main,.62):wl(e.palette[t.color].main,.55)}`}},[`&.${Nt.checked} + .${Nt.track}`]:{backgroundColor:(e.vars||e).palette[t.color].main}})),mh=je("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`})),vh=je("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),wh=x.forwardRef(function(t,r){const n=Ln({props:t,name:"MuiSwitch"}),{className:a,color:o="primary",edge:s=!1,size:l="medium",sx:i}=n,u=me(n,hh),c=k({},n,{color:o,edge:s,size:l}),d=gh(c),f=I.jsx(vh,{className:d.thumb,ownerState:c});return I.jsxs(ph,{className:Ue(d.root,a),sx:i,ownerState:c,children:[I.jsx(xh,k({type:"checkbox",icon:f,checkedIcon:f,ref:r,ownerState:c},u,{classes:k({},d,{root:d.switchBase})})),I.jsx(mh,{className:d.track,ownerState:c})]})}),Ch=wh,bh=x.createContext(),Sh=bh,kh=x.createContext(),Eh=kh;function Th(e){return Nn("MuiTableCell",e)}const yh=mn("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),_h=yh,Fh=["align","className","component","padding","scope","size","sortDirection","variant"],Ih=e=>{const{classes:t,variant:r,align:n,padding:a,size:o,stickyHeader:s}=e,l={root:["root",r,s&&"stickyHeader",n!=="inherit"&&`align${et(n)}`,a!=="normal"&&`padding${et(a)}`,`size${et(o)}`]};return Le(l,Th,t)},Ph=je("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`size${et(r.size)}`],r.padding!=="normal"&&t[`padding${et(r.padding)}`],r.align!=="inherit"&&t[`align${et(r.align)}`],r.stickyHeader&&t.stickyHeader]}})(({theme:e,ownerState:t})=>k({},e.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?vl(Wt(e.palette.divider,1),.88):wl(Wt(e.palette.divider,1),.68)}`,textAlign:"left",padding:16},t.variant==="head"&&{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium},t.variant==="body"&&{color:(e.vars||e).palette.text.primary},t.variant==="footer"&&{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)},t.size==="small"&&{padding:"6px 16px",[`&.${_h.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}},t.padding==="checkbox"&&{width:48,padding:"0 0 0 4px"},t.padding==="none"&&{padding:0},t.align==="left"&&{textAlign:"left"},t.align==="center"&&{textAlign:"center"},t.align==="right"&&{textAlign:"right",flexDirection:"row-reverse"},t.align==="justify"&&{textAlign:"justify"},t.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default})),Ah=x.forwardRef(function(t,r){const n=Ln({props:t,name:"MuiTableCell"}),{align:a="inherit",className:o,component:s,padding:l,scope:i,size:u,sortDirection:c,variant:d}=n,f=me(n,Fh),p=x.useContext(Sh),h=x.useContext(Eh),g=h&&h.variant==="head";let m;s?m=s:m=g?"th":"td";let w=i;m==="td"?w=void 0:!w&&g&&(w="col");const v=d||h&&h.variant,C=k({},n,{align:a,component:m,padding:l||(p&&p.padding?p.padding:"normal"),size:u||(p&&p.size?p.size:"medium"),sortDirection:c,stickyHeader:v==="head"&&p&&p.stickyHeader,variant:v}),E=Ih(C);let R=null;return c&&(R=c==="asc"?"ascending":"descending"),I.jsx(Ph,k({as:m,ref:r,className:Ue(E.root,o),"aria-sort":R,scope:w,ownerState:C},f))}),Xs=Ah;function Mh(e){return Nn("MuiToolbar",e)}mn("MuiToolbar",["root","gutters","regular","dense"]);const Dh=["className","component","disableGutters","variant"],Oh=e=>{const{classes:t,disableGutters:r,variant:n}=e;return Le({root:["root",!r&&"gutters",n]},Mh,t)},Rh=je("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableGutters&&t.gutters,t[r.variant]]}})(({theme:e,ownerState:t})=>k({position:"relative",display:"flex",alignItems:"center"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}},t.variant==="dense"&&{minHeight:48}),({theme:e,ownerState:t})=>t.variant==="regular"&&e.mixins.toolbar),Lh=x.forwardRef(function(t,r){const n=Ln({props:t,name:"MuiToolbar"}),{className:a,component:o="div",disableGutters:s=!1,variant:l="regular"}=n,i=me(n,Dh),u=k({},n,{component:o,disableGutters:s,variant:l}),c=Oh(u);return I.jsx(Rh,k({as:o,className:Ue(c.root,a),ref:r,ownerState:u},i))}),Nh=Lh,Bh=Qe(I.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),Hh=Qe(I.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight"),$h=["backIconButtonProps","count","disabled","getItemAriaLabel","nextIconButtonProps","onPageChange","page","rowsPerPage","showFirstButton","showLastButton","slots","slotProps"],Vh=x.forwardRef(function(t,r){var n,a,o,s,l,i,u,c;const{backIconButtonProps:d,count:f,disabled:p=!1,getItemAriaLabel:h,nextIconButtonProps:g,onPageChange:m,page:w,rowsPerPage:v,showFirstButton:C,showLastButton:E,slots:R={},slotProps:S={}}=t,b=me(t,$h),T=Yr(),A=de=>{m(de,0)},N=de=>{m(de,w-1)},y=de=>{m(de,w+1)},D=de=>{m(de,Math.max(0,Math.ceil(f/v)-1))},L=(n=R.firstButton)!=null?n:ln,M=(a=R.lastButton)!=null?a:ln,F=(o=R.nextButton)!=null?o:ln,B=(s=R.previousButton)!=null?s:ln,H=(l=R.firstButtonIcon)!=null?l:rh,G=(i=R.lastButtonIcon)!=null?i:nh,_=(u=R.nextButtonIcon)!=null?u:Hh,Z=(c=R.previousButtonIcon)!=null?c:Bh,ee=T.direction==="rtl"?M:L,P=T.direction==="rtl"?F:B,q=T.direction==="rtl"?B:F,K=T.direction==="rtl"?L:M,X=T.direction==="rtl"?S.lastButton:S.firstButton,te=T.direction==="rtl"?S.nextButton:S.previousButton,le=T.direction==="rtl"?S.previousButton:S.nextButton,fe=T.direction==="rtl"?S.firstButton:S.lastButton;return I.jsxs("div",k({ref:r},b,{children:[C&&I.jsx(ee,k({onClick:A,disabled:p||w===0,"aria-label":h("first",w),title:h("first",w)},X,{children:T.direction==="rtl"?I.jsx(G,k({},S.lastButtonIcon)):I.jsx(H,k({},S.firstButtonIcon))})),I.jsx(P,k({onClick:N,disabled:p||w===0,color:"inherit","aria-label":h("previous",w),title:h("previous",w)},te??d,{children:T.direction==="rtl"?I.jsx(_,k({},S.nextButtonIcon)):I.jsx(Z,k({},S.previousButtonIcon))})),I.jsx(q,k({onClick:y,disabled:p||(f!==-1?w>=Math.ceil(f/v)-1:!1),color:"inherit","aria-label":h("next",w),title:h("next",w)},le??g,{children:T.direction==="rtl"?I.jsx(Z,k({},S.previousButtonIcon)):I.jsx(_,k({},S.nextButtonIcon))})),E&&I.jsx(K,k({onClick:D,disabled:p||w>=Math.ceil(f/v)-1,"aria-label":h("last",w),title:h("last",w)},fe,{children:T.direction==="rtl"?I.jsx(H,k({},S.firstButtonIcon)):I.jsx(G,k({},S.lastButtonIcon))}))]}))}),Gh=Vh;function Uh(e){return Nn("MuiTablePagination",e)}const zh=mn("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]),yn=zh;var Di;const jh=["ActionsComponent","backIconButtonProps","className","colSpan","component","count","disabled","getItemAriaLabel","labelDisplayedRows","labelRowsPerPage","nextIconButtonProps","onPageChange","onRowsPerPageChange","page","rowsPerPage","rowsPerPageOptions","SelectProps","showFirstButton","showLastButton","slotProps","slots"],Wh=je(Xs,{name:"MuiTablePagination",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({overflow:"auto",color:(e.vars||e).palette.text.primary,fontSize:e.typography.pxToRem(14),"&:last-child":{padding:0}})),Kh=je(Nh,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(e,t)=>k({[`& .${yn.actions}`]:t.actions},t.toolbar)})(({theme:e})=>({minHeight:52,paddingRight:2,[`${e.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[e.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${yn.actions}`]:{flexShrink:0,marginLeft:20}})),Xh=je("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(e,t)=>t.spacer})({flex:"1 1 100%"}),Yh=je("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(e,t)=>t.selectLabel})(({theme:e})=>k({},e.typography.body2,{flexShrink:0})),qh=je(bu,{name:"MuiTablePagination",slot:"Select",overridesResolver:(e,t)=>k({[`& .${yn.selectIcon}`]:t.selectIcon,[`& .${yn.select}`]:t.select},t.input,t.selectRoot)})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${yn.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),Zh=je(kr,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(e,t)=>t.menuItem})({}),Qh=je("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(e,t)=>t.displayedRows})(({theme:e})=>k({},e.typography.body2,{flexShrink:0}));function Jh({from:e,to:t,count:r}){return`${e}â€“${t} of ${r!==-1?r:`more than ${t}`}`}function eg(e){return`Go to ${e} page`}const tg=e=>{const{classes:t}=e;return Le({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},Uh,t)},rg=x.forwardRef(function(t,r){var n;const a=Ln({props:t,name:"MuiTablePagination"}),{ActionsComponent:o=Gh,backIconButtonProps:s,className:l,colSpan:i,component:u=Xs,count:c,disabled:d=!1,getItemAriaLabel:f=eg,labelDisplayedRows:p=Jh,labelRowsPerPage:h="Rows per page:",nextIconButtonProps:g,onPageChange:m,onRowsPerPageChange:w,page:v,rowsPerPage:C,rowsPerPageOptions:E=[10,25,50,100],SelectProps:R={},showFirstButton:S=!1,showLastButton:b=!1,slotProps:T={},slots:A={}}=a,N=me(a,jh),y=a,D=tg(y),L=(n=T==null?void 0:T.select)!=null?n:R,M=L.native?"option":Zh;let F;(u===Xs||u==="td")&&(F=i||1e3);const B=tt(L.id),H=tt(L.labelId),G=()=>c===-1?(v+1)*C:C===-1?c:Math.min(c,(v+1)*C);return I.jsx(Wh,k({colSpan:F,ref:r,as:u,ownerState:y,className:Ue(D.root,l)},N,{children:I.jsxs(Kh,{className:D.toolbar,children:[I.jsx(Xh,{className:D.spacer}),E.length>1&&I.jsx(Yh,{className:D.selectLabel,id:H,children:h}),E.length>1&&I.jsx(qh,k({variant:"standard"},!L.variant&&{input:Di||(Di=I.jsx(ss,{}))},{value:C,onChange:w,id:B,labelId:H},L,{classes:k({},L.classes,{root:Ue(D.input,D.selectRoot,(L.classes||{}).root),select:Ue(D.select,(L.classes||{}).select),icon:Ue(D.selectIcon,(L.classes||{}).icon)}),disabled:d,children:E.map(_=>x.createElement(M,k({},!Tf(M)&&{ownerState:y},{className:D.menuItem,key:_.label?_.label:_,value:_.value?_.value:_}),_.label?_.label:_))})),I.jsx(Qh,{className:D.displayedRows,children:p({from:c===0?0:v*C+1,to:G(),count:c===-1?-1:c,page:v})}),I.jsx(o,{className:D.actions,backIconButtonProps:s,count:c,nextIconButtonProps:g,onPageChange:m,page:v,rowsPerPage:C,showFirstButton:S,showLastButton:b,slotProps:T.actions,slots:A.actions,getItemAriaLabel:f,disabled:d})]})}))}),ng=rg;var Tl={},ag=ro;Object.defineProperty(Tl,"__esModule",{value:!0});var og=Tl.default=void 0,sg=ag(to()),lg=I;og=Tl.default=(0,sg.default)((0,lg.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay");var yl={},ig=ro;Object.defineProperty(yl,"__esModule",{value:!0});var Fu=yl.default=void 0,cg=ig(to()),ug=I;Fu=yl.default=(0,cg.default)((0,ug.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");const dg=({getSearchData:e,condition:t,setSearchFlag:r,reloadBtn:n,action:a,api:o})=>{const[s,l]=x.useState(""),i=Yr(),u=Cl(i.palette.mode),c=Ma("(max-width:480px)"),d=Ma("(max-width:920px)"),f=g=>{l(g.target.value)},p=()=>{e(0,5,a,o,t,s),l(""),r({search:!0,searching:!0}),n.style.display="inline-flex"},h=g=>{g.keyCode==13&&p()};return I.jsxs(gn,{backgroundColor:u.primary[400],borderRadius:"10px",width:"40vw",height:d?"4vh":"auto",position:"relative",children:[I.jsx(ss,{sx:{ml:2,flex:1,width:"88%",position:"absolute",mt:c?0:1},placeholder:"Search",id:"input",value:s,onChange:f,onKeyDown:h}),I.jsx(ln,{sx:{p:1,position:"absolute",top:d?"0":"6px",right:"2px","&:hover":{backgroundColor:u.greenAccent[600]}},onClick:p,children:I.jsx(Fu,{})})]})};dg.propTypes={getSearchData:J.func,condition:J.any,setSearchFlag:J.func,reloadBtn:J.object,action:J.func,api:J.object};const Iu=x.createContext(void 0);function $e(){const e=x.useContext(Iu);if(e===void 0)throw new Error(["MUI: Could not find the data grid context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the data grid."].join(`
`));return e}const Pu=x.createContext(void 0),ke=()=>{const e=x.useContext(Pu);if(!e)throw new Error("MUI: useGridRootProps should only be used inside the DataGrid, DataGridPro or DataGridPremium component.");return e},Au=x.createContext(void 0);function vn(){const e=x.useContext(Au);if(e===void 0)throw new Error(["MUI: Could not find the data grid private context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the data grid."].join(`
`));return e}const Oi={};function _l(e,t){const r=x.useRef(Oi);return r.current===Oi&&(r.current=e(t)),r}const fg=[];function Mu(e){x.useEffect(e,fg)}const Nr=(e,t="warning")=>{let r=!1;const n=Array.isArray(e)?e.join(`
`):e;return()=>{r||(r=!0,t==="error"?console.error(n):console.warn(n))}},hg=Object.is;function Du(e,t){if(e===t)return!0;if(!(e instanceof Object)||!(t instanceof Object))return!1;let r=0,n=0;for(const a in e)if(r+=1,!hg(e[a],t[a])||!(a in t))return!1;for(const a in t)n+=1;return r===n}Nr(["MUI: `useGridSelector` has been called before the initialization of the state.","This hook can only be used inside the context of the grid."]);function gg(e){return e.acceptsApiRef}function Ri(e,t){return gg(t)?t(e):t(e.current.state)}const pg=Object.is,Fl=Du,xg=()=>({state:null,equals:null,selector:null}),Ce=(e,t,r=pg)=>{const n=_l(xg),a=n.current.selector!==null,[o,s]=x.useState(a?null:Ri(e,t));return n.current.state=o,n.current.equals=r,n.current.selector=t,Mu(()=>e.current.store.subscribe(()=>{const l=Ri(e,n.current.selector);n.current.equals(n.current.state,l)||(n.current.state=l,s(l))})),o};function We(e){return Nn("MuiDataGrid",e)}const Q=mn("MuiDataGrid",["actionsCell","aggregationColumnHeader","aggregationColumnHeader--alignLeft","aggregationColumnHeader--alignCenter","aggregationColumnHeader--alignRight","aggregationColumnHeaderLabel","autoHeight","autosizing","booleanCell","cell--editable","cell--editing","cell--textCenter","cell--textLeft","cell--textRight","cell--withRenderer","cell--rangeTop","cell--rangeBottom","cell--rangeLeft","cell--rangeRight","cell--selectionMode","cell","cellContent","cellCheckbox","cellSkeleton","checkboxInput","columnHeader--alignCenter","columnHeader--alignLeft","columnHeader--alignRight","columnHeader--dragging","columnHeader--moving","columnHeader--numeric","columnHeader--sortable","columnHeader--sorted","columnHeader--filtered","columnHeader","columnHeaderCheckbox","columnHeaderDraggableContainer","columnHeaderDropZone","columnHeaderTitle","columnHeaderTitleContainer","columnHeaderTitleContainerContent","columnGroupHeader","columnHeader--filledGroup","columnHeader--emptyGroup","columnHeader--showColumnBorder","columnHeaders","columnHeadersInner","columnHeadersInner--scrollable","columnSeparator--resizable","columnSeparator--resizing","columnSeparator--sideLeft","columnSeparator--sideRight","columnSeparator","columnsPanel","columnsPanelRow","detailPanel","detailPanels","detailPanelToggleCell","detailPanelToggleCell--expanded","footerCell","panel","panelHeader","panelWrapper","panelContent","panelFooter","paper","editBooleanCell","editInputCell","filterForm","filterFormDeleteIcon","filterFormLogicOperatorInput","filterFormColumnInput","filterFormOperatorInput","filterFormValueInput","filterIcon","footerContainer","headerFilterRow","iconButtonContainer","iconSeparator","main","menu","menuIcon","menuIconButton","menuOpen","menuList","overlay","overlayWrapper","overlayWrapperInner","root","root--densityStandard","root--densityComfortable","root--densityCompact","root--disableUserSelection","row","row--editable","row--editing","row--lastVisible","row--dragging","row--dynamicHeight","row--detailPanelExpanded","rowReorderCellPlaceholder","rowCount","rowReorderCellContainer","rowReorderCell","rowReorderCell--draggable","scrollArea--left","scrollArea--right","scrollArea","selectedRowCount","sortIcon","toolbarContainer","toolbarFilterList","virtualScroller","virtualScrollerContent","virtualScrollerContent--overflowed","virtualScrollerRenderZone","pinnedColumns","pinnedColumns--left","pinnedColumns--right","pinnedColumnHeaders","pinnedColumnHeaders--left","pinnedColumnHeaders--right","withBorderColor","cell--withRightBorder","columnHeader--withRightBorder","treeDataGroupingCell","treeDataGroupingCellToggle","groupingCriteriaCell","groupingCriteriaCellToggle","pinnedRows","pinnedRows--top","pinnedRows--bottom","pinnedRowsRenderZone"]);var No="NOT_FOUND";function mg(e){var t;return{get:function(n){return t&&e(t.key,n)?t.value:No},put:function(n,a){t={key:n,value:a}},getEntries:function(){return t?[t]:[]},clear:function(){t=void 0}}}function vg(e,t){var r=[];function n(l){var i=r.findIndex(function(c){return t(l,c.key)});if(i>-1){var u=r[i];return i>0&&(r.splice(i,1),r.unshift(u)),u.value}return No}function a(l,i){n(l)===No&&(r.unshift({key:l,value:i}),r.length>e&&r.pop())}function o(){return r}function s(){r=[]}return{get:n,put:a,getEntries:o,clear:s}}var wg=function(t,r){return t===r};function Cg(e){return function(r,n){if(r===null||n===null||r.length!==n.length)return!1;for(var a=r.length,o=0;o<a;o++)if(!e(r[o],n[o]))return!1;return!0}}function cs(e,t){var r=typeof t=="object"?t:{equalityCheck:t},n=r.equalityCheck,a=n===void 0?wg:n,o=r.maxSize,s=o===void 0?1:o,l=r.resultEqualityCheck,i=Cg(a),u=s===1?mg(i):vg(s,i);function c(){var d=u.get(arguments);if(d===No){if(d=e.apply(null,arguments),l){var f=u.getEntries(),p=f.find(function(h){return l(h.value,d)});p&&(d=p.value)}u.put(arguments,d)}return d}return c.clearCache=function(){return u.clear()},c}function bg(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(n){return typeof n=="function"})){var r=t.map(function(n){return typeof n=="function"?"function "+(n.name||"unnamed")+"()":typeof n}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+r+"]")}return t}function Sg(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=function(){for(var s=arguments.length,l=new Array(s),i=0;i<s;i++)l[i]=arguments[i];var u=0,c,d={memoizeOptions:void 0},f=l.pop();if(typeof f=="object"&&(d=f,f=l.pop()),typeof f!="function")throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof f+"]");var p=d,h=p.memoizeOptions,g=h===void 0?r:h,m=Array.isArray(g)?g:[g],w=bg(l),v=e.apply(void 0,[function(){return u++,f.apply(null,arguments)}].concat(m)),C=e(function(){for(var R=[],S=w.length,b=0;b<S;b++)R.push(w[b].apply(null,arguments));return c=v.apply(null,R),c});return Object.assign(C,{resultFunc:f,memoizedResultFunc:v,dependencies:w,lastResult:function(){return c},recomputations:function(){return u},resetRecomputations:function(){return u=0}}),C};return a}var kg=Sg(cs);const Eg={cache:new WeakMap};Nr(["MUI: A selector was called without passing the instance ID, which may impact the performance of the grid.","To fix, call it with `apiRef`, e.g. `mySelector(apiRef)`, or pass the instance ID explicitly, e.g. `mySelector(state, apiRef.current.instanceId)`."]);function Jn(e){return"current"in e&&"instanceId"in e.current}const ea={id:"default"},Ve=(e,t,r,n,a,o,...s)=>{if(s.length>0)throw new Error("Unsupported number of selectors");let l;if(e&&t&&r&&n&&a&&o)l=(i,u)=>{const c=Jn(i),d=u??(c?i.current.instanceId:ea),f=c?i.current.state:i,p=e(f,d),h=t(f,d),g=r(f,d),m=n(f,d),w=a(f,d);return o(p,h,g,m,w)};else if(e&&t&&r&&n&&a)l=(i,u)=>{const c=Jn(i),d=u??(c?i.current.instanceId:ea),f=c?i.current.state:i,p=e(f,d),h=t(f,d),g=r(f,d),m=n(f,d);return a(p,h,g,m)};else if(e&&t&&r&&n)l=(i,u)=>{const c=Jn(i),d=u??(c?i.current.instanceId:ea),f=c?i.current.state:i,p=e(f,d),h=t(f,d),g=r(f,d);return n(p,h,g)};else if(e&&t&&r)l=(i,u)=>{const c=Jn(i),d=u??(c?i.current.instanceId:ea),f=c?i.current.state:i,p=e(f,d),h=t(f,d);return r(p,h)};else if(e&&t)l=(i,u)=>{const c=Jn(i),d=u??(c?i.current.instanceId:ea),f=c?i.current.state:i,p=e(f,d);return t(p)};else throw new Error("Missing arguments");return l.acceptsApiRef=!0,l},ct=(...e)=>{const t=(...r)=>{var n,a;const[o,s]=r,l=Jn(o),i=l?o.current.instanceId:s??ea,u=l?o.current.state:o,{cache:c}=Eg;if(c.get(i)&&(n=c.get(i))!=null&&n.get(e)){var d;return(d=c.get(i))==null?void 0:d.get(e)(u,i)}const f=kg(...e);return c.get(i)||c.set(i,new Map),(a=c.get(i))==null||a.set(e,f),f(u,i)};return t.acceptsApiRef=!0,t},_n=e=>e.columns,zr=Ve(_n,e=>e.orderedFields),Bn=Ve(_n,e=>e.lookup),Dr=ct(zr,Bn,(e,t)=>e.map(r=>t[r])),Cr=Ve(_n,e=>e.columnVisibilityModel),At=ct(Dr,Cr,(e,t)=>e.filter(r=>t[r.field]!==!1)),us=ct(At,e=>e.map(t=>t.field)),da=ct(At,e=>{const t=[];let r=0;for(let n=0;n<e.length;n+=1)t.push(r),r+=e[n].computedWidth;return t}),Il=Ve(At,da,(e,t)=>{const r=e.length;return r===0?0:t[r-1]+e[r-1].computedWidth}),Ou=ct(Dr,e=>e.filter(t=>t.filterable)),Tg=ct(Dr,e=>e.reduce((t,r)=>(r.filterable&&(t[r.field]=r),t),{})),ds=e=>e.columnGrouping,yg=ct(ds,e=>{var t;return(t=e==null?void 0:e.unwrappedGroupingModel)!=null?t:{}}),Ru=ct(ds,e=>{var t;return(t=e==null?void 0:e.lookup)!=null?t:{}}),_g=ct(ds,e=>{var t;return(t=e==null?void 0:e.headerStructure)!=null?t:[]}),no=Ve(ds,e=>{var t;return(t=e==null?void 0:e.maxDepth)!=null?t:0}),Fr=e=>e.rows,fs=Ve(Fr,e=>e.totalRowCount),Fg=Ve(Fr,e=>e.loading),Ig=Ve(Fr,e=>e.totalTopLevelRowCount),cn=Ve(Fr,e=>e.dataRowIdToModelLookup),Bo=Ve(Fr,e=>e.dataRowIdToIdLookup),vr=Ve(Fr,e=>e.tree),Pg=Ve(Fr,e=>e.groupingName),Li=Ve(Fr,e=>e.treeDepths),hs=ct(Fr,e=>{const t=Object.entries(e.treeDepths);return t.length===0?1:t.filter(([,r])=>r>0).map(([r])=>Number(r)).sort((r,n)=>n-r)[0]+1}),So=Ve(Fr,e=>e.dataRowIds),Ag=Ve(Fr,e=>e==null?void 0:e.additionalRowGroups),pa=ct(Ag,e=>{var t,r;const n=e==null?void 0:e.pinnedRows;return{bottom:n==null||(t=n.bottom)==null?void 0:t.map(a=>{var o;return{id:a.id,model:(o=a.model)!=null?o:{}}}),top:n==null||(r=n.top)==null?void 0:r.map(a=>{var o;return{id:a.id,model:(o=a.model)!=null?o:{}}})}}),Mg=Ve(pa,e=>{var t,r;return((e==null||(t=e.top)==null?void 0:t.length)||0)+((e==null||(r=e.bottom)==null?void 0:r.length)||0)}),Lu=()=>{var e;const t=vn(),r=ke(),n=Ce(t,At),a=Ce(t,fs),o=Ce(t,no),s=Ce(t,Mg);let l="grid";return(e=r.experimentalFeatures)!=null&&e.ariaV7&&r.treeData&&(l="treegrid"),{role:l,"aria-colcount":n.length,"aria-rowcount":o+1+s+a,"aria-multiselectable":!r.disableMultipleRowSelection}},Dg=e=>{const{classes:t}=e;return Le({root:["main"]},We,t)},Og=Ft("div",{name:"MuiDataGrid",slot:"Main",overridesResolver:(e,t)=>t.main})(()=>({position:"relative",flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"})),Rg=x.forwardRef((e,t)=>{var r;const n=ke(),a=Dg(n),o=(r=n.experimentalFeatures)!=null&&r.ariaV7?Lu:null,s=typeof o=="function"?o():null;return I.jsx(Og,k({ref:t,className:a.root,ownerState:n},s,{children:e.children}))}),Nu=e=>e.sorting,Pl=Ve(Nu,e=>e.sortedRows),Al=ct(Pl,cn,(e,t)=>e.map(r=>{var n;return{id:r,model:(n=t[r])!=null?n:{}}})),ur=Ve(Nu,e=>e.sortModel),Lg=ct(ur,e=>e.reduce((r,n,a)=>(r[n.field]={sortDirection:n.sort,sortIndex:e.length>1?a+1:void 0},r),{})),Ml=e=>e.filter,It=Ve(Ml,e=>e.filterModel),Ng=Ve(It,e=>e.quickFilterValues),Bg=e=>e.visibleRowsLookup,Bu=Ve(Ml,e=>e.filteredRowsLookup);Ve(Ml,e=>e.filteredDescendantCountLookup);const wn=ct(Bg,Al,(e,t)=>t.filter(r=>e[r.id]!==!1)),Da=ct(wn,e=>e.map(t=>t.id)),Hg=ct(Bu,Al,(e,t)=>t.filter(r=>e[r.id]!==!1)),$g=ct(Hg,e=>e.map(t=>t.id)),Hu=ct(wn,vr,hs,(e,t,r)=>r<2?e:e.filter(n=>{var a;return((a=t[n.id])==null?void 0:a.depth)===0})),$u=Ve(wn,e=>e.length),gs=Ve(Hu,e=>e.length),Vu=ct(It,Bn,(e,t)=>{var r;return(r=e.items)==null?void 0:r.filter(n=>{var a,o;if(!n.field)return!1;const s=t[n.field];if(!(s!=null&&s.filterOperators)||(s==null||(a=s.filterOperators)==null?void 0:a.length)===0)return!1;const l=s.filterOperators.find(i=>i.value===n.operator);return l?!l.InputComponent||n.value!=null&&((o=n.value)==null?void 0:o.toString())!=="":!1})}),Vg=ct(Vu,e=>e.reduce((r,n)=>(r[n.field]?r[n.field].push(n):r[n.field]=[n],r),{})),ps=e=>e.focus,nr=Ve(ps,e=>e.cell),Gg=Ve(ps,e=>e.columnHeader);Ve(ps,e=>e.columnHeaderFilter);const Ho=Ve(ps,e=>e.columnGroupHeader),xs=e=>e.tabIndex,$o=Ve(xs,e=>e.cell),Gu=Ve(xs,e=>e.columnHeader);Ve(xs,e=>e.columnHeaderFilter);const Ug=Ve(xs,e=>e.columnGroupHeader),Dl=e=>e.density,Uu=Ve(Dl,e=>e.value),xa=Ve(Dl,e=>e.factor),Ys=e=>e.columnMenu;function zg(e){const{VirtualScrollerComponent:t,ColumnHeadersProps:r,children:n}=e,a=vn(),o=ke(),s=x.useRef(null),l=Ce(a,At),i=Ce(a,Vg),u=Ce(a,Lg),c=Ce(a,da),d=Ce(a,Gu),f=Ce(a,$o),p=Ce(a,Ug),h=Ce(a,Gg),g=Ce(a,Ho),m=Ce(a,xa),w=Ce(a,no),v=Ce(a,Ys),C=Ce(a,Cr),E=Ce(a,_g),R=!(p===null&&d===null&&f===null);Mt(()=>{a.current.computeSizeAndPublishResizeEvent();const N=s.current;if(typeof ResizeObserver>"u")return()=>{};let y;const D=new ResizeObserver(()=>{y=requestAnimationFrame(()=>{a.current.computeSizeAndPublishResizeEvent()})});return N&&D.observe(N),()=>{y&&window.cancelAnimationFrame(y),N&&D.unobserve(N)}},[a]);const S=x.useRef(null),b=x.useRef(null),T=x.useRef(null);a.current.register("private",{columnHeadersContainerElementRef:b,columnHeadersElementRef:S,virtualScrollerRef:T,mainElementRef:s});const A=!!a.current.getRootDimensions();return I.jsxs(Rg,{ref:s,children:[I.jsx(o.slots.columnHeaders,k({ref:b,innerRef:S,visibleColumns:l,filterColumnLookup:i,sortColumnLookup:u,columnPositions:c,columnHeaderTabIndexState:d,columnGroupHeaderTabIndexState:p,columnHeaderFocus:h,columnGroupHeaderFocus:g,densityFactor:m,headerGroupingMaxDepth:w,columnMenuState:v,columnVisibility:C,columnGroupsHeaderStructure:E,hasOtherElementInTabSequence:R},r)),A&&I.jsx(t,{ref:T}),n]})}function jg(){var e;const t=ke();return t.hideFooter?null:I.jsx(t.slots.footer,k({},(e=t.slotProps)==null?void 0:e.footer))}const Yt="auto-generated-group-node-root",sa=Symbol("mui.id_autogenerated"),Wg=()=>({type:"group",id:Yt,depth:-1,groupingField:null,groupingKey:null,isAutoGenerated:!0,children:[],childrenFromPath:{},childrenExpanded:!0,parent:null});function Kg(e,t,r="A row was provided without id in the rows prop:"){if(e==null)throw new Error(["MUI: The data grid component requires all rows to have a unique `id` property.","Alternatively, you can use the `getRowId` prop to specify a custom id for each row.",r,JSON.stringify(t)].join(`
`))}const Vo=(e,t,r)=>{const n=t?t(e):e.id;return Kg(n,e,r),n},Mo=({rows:e,getRowId:t,loading:r,rowCount:n})=>{const a={type:"full",rows:[]},o={},s={};for(let l=0;l<e.length;l+=1){const i=e[l],u=Vo(i,t);o[u]=i,s[u]=u,a.rows.push(u)}return{rowsBeforePartialUpdates:e,loadingPropBeforePartialUpdates:r,rowCountPropBeforePartialUpdates:n,updates:a,dataRowIdToIdLookup:s,dataRowIdToModelLookup:o}},zu=({tree:e,rowCountProp:t=0})=>{const r=e[Yt];return Math.max(t,r.children.length+(r.footerId==null?0:1))},ju=({apiRef:e,rowCountProp:t=0,loadingProp:r,previousTree:n,previousTreeDepths:a})=>{const o=e.current.caches.rows,{tree:s,treeDepths:l,dataRowIds:i,groupingName:u}=e.current.applyStrategyProcessor("rowTreeCreation",{previousTree:n,previousTreeDepths:a,updates:o.updates,dataRowIdToIdLookup:o.dataRowIdToIdLookup,dataRowIdToModelLookup:o.dataRowIdToModelLookup}),c=e.current.unstable_applyPipeProcessors("hydrateRows",{tree:s,treeDepths:l,dataRowIdToIdLookup:o.dataRowIdToIdLookup,dataRowIds:i,dataRowIdToModelLookup:o.dataRowIdToModelLookup});return e.current.caches.rows.updates={type:"partial",actions:{insert:[],modify:[],remove:[]},idToActionLookup:{}},k({},c,{totalRowCount:Math.max(t,c.dataRowIds.length),totalTopLevelRowCount:zu({tree:c.tree,rowCountProp:t}),groupingName:u,loading:r})},za=e=>e.type==="skeletonRow"||e.type==="footer"||e.type==="group"&&e.isAutoGenerated||e.type==="pinnedRow"&&e.isAutoGenerated,Ol=(e,t,r)=>{const n=e[t];if(n.type!=="group")return[];const a=[];for(let o=0;o<n.children.length;o+=1){const s=n.children[o];(!r||!za(e[s]))&&a.push(s);const l=Ol(e,s,r);for(let i=0;i<l.length;i+=1)a.push(l[i])}return!r&&n.footerId!=null&&a.push(n.footerId),a},Xg=({previousCache:e,getRowId:t,updates:r})=>{var n,a,o;if(e.updates.type==="full")throw new Error("MUI: Unable to prepare a partial update if a full update is not applied yet");const s=new Map;r.forEach(f=>{const p=Vo(f,t,"A row was provided without id when calling updateRows():");s.has(p)?s.set(p,k({},s.get(p),f)):s.set(p,f)});const l={type:"partial",actions:{insert:[...(n=e.updates.actions.insert)!=null?n:[]],modify:[...(a=e.updates.actions.modify)!=null?a:[]],remove:[...(o=e.updates.actions.remove)!=null?o:[]]},idToActionLookup:k({},e.updates.idToActionLookup)},i=k({},e.dataRowIdToModelLookup),u=k({},e.dataRowIdToIdLookup),c={insert:{},modify:{},remove:{}};s.forEach((f,p)=>{const h=l.idToActionLookup[p];if(f._action==="delete"){if(h==="remove"||!i[p])return;h!=null&&(c[h][p]=!0),l.actions.remove.push(p),delete i[p],delete u[p];return}const g=i[p];if(g){h==="remove"?(c.remove[p]=!0,l.actions.modify.push(p)):h==null&&l.actions.modify.push(p),i[p]=k({},g,f);return}h==="remove"?(c.remove[p]=!0,l.actions.insert.push(p)):h==null&&l.actions.insert.push(p),i[p]=f,u[p]=p});const d=Object.keys(c);for(let f=0;f<d.length;f+=1){const p=d[f],h=c[p];Object.keys(h).length>0&&(l.actions[p]=l.actions[p].filter(g=>!h[g]))}return{dataRowIdToModelLookup:i,dataRowIdToIdLookup:u,updates:l,rowsBeforePartialUpdates:e.rowsBeforePartialUpdates,loadingPropBeforePartialUpdates:e.loadingPropBeforePartialUpdates,rowCountPropBeforePartialUpdates:e.rowCountPropBeforePartialUpdates}};function Wu(e){var t,r;const n=pa(e),a=(n==null||(t=n.top)==null?void 0:t.reduce((s,l)=>(s+=e.current.unstable_getRowHeight(l.id),s),0))||0,o=(n==null||(r=n.bottom)==null?void 0:r.reduce((s,l)=>(s+=e.current.unstable_getRowHeight(l.id),s),0))||0;return{top:a,bottom:o}}function Ku(e,t){const r=xa(e);return`var(--DataGrid-overlayHeight, ${2*Math.floor(t*r)}px)`}const Yg=Ft("div",{name:"MuiDataGrid",slot:"OverlayWrapper",shouldForwardProp:e=>e!=="overlayType",overridesResolver:(e,t)=>t.overlayWrapper})(({overlayType:e})=>({position:"sticky",top:0,left:0,width:0,height:0,zIndex:e==="loadingOverlay"?5:4})),qg=Ft("div",{name:"MuiDataGrid",slot:"OverlayWrapperInner",shouldForwardProp:e=>e!=="overlayType",overridesResolver:(e,t)=>t.overlayWrapperInner})({}),Zg=e=>{const{classes:t}=e;return Le({root:["overlayWrapper"],inner:["overlayWrapperInner"]},We,t)};function Qg(e){var t,r;const n=$e(),a=ke(),[o,s]=x.useState(()=>{var c,d;return(c=(d=n.current.getRootDimensions())==null?void 0:d.viewportInnerSize)!=null?c:null}),l=x.useCallback(()=>{var c,d;s((c=(d=n.current.getRootDimensions())==null?void 0:d.viewportInnerSize)!=null?c:null)},[n]);Mt(()=>n.current.subscribeEvent("viewportInnerSizeChange",l),[n,l]);let i=(t=o==null?void 0:o.height)!=null?t:0;a.autoHeight&&i===0&&(i=Ku(n,a.rowHeight));const u=Zg(k({},e,{classes:a.classes}));return o?I.jsx(Yg,{className:Ue(u.root),overlayType:e.overlayType,children:I.jsx(qg,k({className:Ue(u.inner),style:{height:i,width:(r=o==null?void 0:o.width)!=null?r:0}},e))}):null}function Jg(){const e=$e(),t=ke(),r=Ce(e,fs),n=Ce(e,$u),a=Ce(e,Fg),o=!a&&r===0,s=!a&&r>0&&n===0;let l=null,i="";if(o){var u;l=I.jsx(t.slots.noRowsOverlay,k({},(u=t.slotProps)==null?void 0:u.noRowsOverlay)),i="noRowsOverlay"}if(s){var c;l=I.jsx(t.slots.noResultsOverlay,k({},(c=t.slotProps)==null?void 0:c.noResultsOverlay)),i="noResultsOverlay"}if(a){var d;l=I.jsx(t.slots.loadingOverlay,k({},(d=t.slotProps)==null?void 0:d.loadingOverlay)),i="loadingOverlay"}return l===null?null:I.jsx(Qg,{overlayType:i,children:l})}function ms(e){return x.memo(e,Du)}let Os;function e1(){return Os===void 0&&document.createElement("div").focus({get preventScroll(){return Os=!0,!1}}),Os}var Rr=function(e){return e.Cell="cell",e.Row="row",e}(Rr||{}),at=function(e){return e.Edit="edit",e.View="view",e}(at||{}),ot=function(e){return e.Edit="edit",e.View="view",e}(ot||{}),rr=function(e){return e.And="and",e.Or="or",e}(rr||{}),Vr=function(e){return e.enterKeyDown="enterKeyDown",e.cellDoubleClick="cellDoubleClick",e.printableKeyDown="printableKeyDown",e.deleteKeyDown="deleteKeyDown",e.pasteKeyDown="pasteKeyDown",e}(Vr||{}),mr=function(e){return e.cellFocusOut="cellFocusOut",e.escapeKeyDown="escapeKeyDown",e.enterKeyDown="enterKeyDown",e.tabKeyDown="tabKeyDown",e.shiftTabKeyDown="shiftTabKeyDown",e}(mr||{}),tn=function(e){return e.enterKeyDown="enterKeyDown",e.cellDoubleClick="cellDoubleClick",e.printableKeyDown="printableKeyDown",e.deleteKeyDown="deleteKeyDown",e}(tn||{}),Gr=function(e){return e.rowFocusOut="rowFocusOut",e.escapeKeyDown="escapeKeyDown",e.enterKeyDown="enterKeyDown",e.tabKeyDown="tabKeyDown",e.shiftTabKeyDown="shiftTabKeyDown",e}(Gr||{});function Xu(e){return e.field!==void 0}function t1(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}function r1(e,t){return e.closest(`.${t}`)}function Rl(e){return e.replace(/["\\]/g,"\\$&")}function n1(e,t){return e.querySelector(`[role="columnheader"][data-field="${Rl(t)}"]`)}function Yu(e){return`.${Q.row}[data-id="${Rl(String(e))}"]`}function a1(e,t){return e.querySelector(Yu(t))}function o1(e,{id:t,field:r}){const n=Yu(t),a=`.${Q.cell}[data-field="${Rl(r)}"]`,o=`${n} ${a}`;return e.querySelector(o)}function ao(e){return e.target.nodeType===1&&!e.currentTarget.contains(e.target)}function ze(e,t,r){const n=x.useRef(!0);x.useEffect(()=>{n.current=!1,e.current.register(r,t)},[e,r,t]),n.current&&e.current.register(r,t)}class na extends Error{}function s1(e,t){const{getRowId:r}=t,n=x.useCallback(h=>({field:h,colDef:e.current.getColumn(h)}),[e]),a=x.useCallback(h=>{const g=e.current.getRow(h);if(!g)throw new na(`No row with id #${h} found`);return{id:h,columns:e.current.getAllColumns(),row:g}},[e]),o=x.useCallback((h,g)=>{const m=e.current.getRow(h),w=e.current.getRowNode(h);if(!m||!w)throw new na(`No row with id #${h} found`);const v=nr(e),C=$o(e);return{id:h,field:g,row:m,rowNode:w,value:m[g],colDef:e.current.getColumn(g),cellMode:e.current.getCellMode(h,g),api:e.current,hasFocus:v!==null&&v.field===g&&v.id===h,tabIndex:C&&C.field===g&&C.id===h?0:-1}},[e]),s=x.useCallback((h,g)=>{const m=e.current.getColumn(g),w=e.current.getCellValue(h,g),v=e.current.getRow(h),C=e.current.getRowNode(h);if(!v||!C)throw new na(`No row with id #${h} found`);const E=nr(e),R=$o(e),S={id:h,field:g,row:v,rowNode:C,colDef:m,cellMode:e.current.getCellMode(h,g),hasFocus:E!==null&&E.field===g&&E.id===h,tabIndex:R&&R.field===g&&R.id===h?0:-1,value:w,formattedValue:w,isEditable:!1};return m&&m.valueFormatter&&(S.formattedValue=m.valueFormatter({id:h,field:S.field,value:S.value,api:e.current})),S.isEditable=m&&e.current.isCellEditable(S),S},[e]),l=x.useCallback((h,g)=>{const m=e.current.getColumn(g);if(!m||!m.valueGetter){const w=e.current.getRow(h);if(!w)throw new na(`No row with id #${h} found`);return w[g]}return m.valueGetter(o(h,g))},[e,o]),i=x.useCallback((h,g)=>{var m;const w=sa in h?h[sa]:(m=r==null?void 0:r(h))!=null?m:h.id,v=g.field;return!g||!g.valueGetter?h[v]:g.valueGetter(o(w,v))},[o,r]),u=x.useCallback((h,g)=>{var m;const w=i(h,g);if(!g||!g.valueFormatter)return w;const v=(m=r?r(h):h.id)!=null?m:h[sa],C=g.field;return g.valueFormatter({id:v,field:C,value:w,api:e.current})},[e,r,i]),c=x.useCallback(h=>e.current.rootElementRef.current?n1(e.current.rootElementRef.current,h):null,[e]),d=x.useCallback(h=>e.current.rootElementRef.current?a1(e.current.rootElementRef.current,h):null,[e]),f=x.useCallback((h,g)=>e.current.rootElementRef.current?o1(e.current.rootElementRef.current,{id:h,field:g}):null,[e]);ze(e,{getCellValue:l,getCellParams:s,getCellElement:f,getRowValue:i,getRowFormattedValue:u,getRowParams:a,getRowElement:d,getColumnHeaderParams:n,getColumnHeaderElement:c},"public")}const l1=["changeReason","unstable_updateValueOnRender"],i1=["column","rowId","editCellState","align","children","colIndex","height","width","className","showRightBorder","extendRowFullWidth","row","colSpan","disableDragEvents","isNotVisible","onClick","onDoubleClick","onMouseDown","onMouseUp","onMouseOver","onKeyDown","onKeyUp","onDragEnter","onDragOver","style"],c1=["changeReason","unstable_updateValueOnRender"],Go={id:-1,field:"__unset__",row:{},rowNode:{id:-1,depth:0,type:"leaf",parent:-1,groupingKey:null},colDef:{type:"string",field:"__unset__",computedWidth:0},cellMode:at.View,hasFocus:!1,tabIndex:-1,value:null,formattedValue:"__unset__",isEditable:!1,api:{}},u1=e=>{const{align:t,showRightBorder:r,isEditable:n,isSelected:a,isSelectionMode:o,classes:s}=e,l={root:["cell",`cell--text${et(t)}`,n&&"cell--editable",a&&"selected",r&&"cell--withRightBorder",o&&!n&&"cell--selectionMode","withBorderColor"],content:["cellContent"]};return Le(l,We,s)},d1=x.forwardRef((e,t)=>{const{column:r,rowId:n,editCellState:a}=e,o=$e(),s=ke(),l=r.field,i=Ce(o,()=>{try{const A=o.current.getCellParams(n,l);return A.api=o.current,A}catch(T){if(T instanceof na)return Go;throw T}},Fl),u=Ce(o,()=>o.current.unstable_applyPipeProcessors("isCellSelected",!1,{id:n,field:l}));if(i===Go)return null;const{cellMode:c,hasFocus:d,isEditable:f,value:p,formattedValue:h}=i,g=r.type==="actions",m=(c==="view"||!f)&&!g?i.tabIndex:-1,{classes:w,getCellClassName:v}=s,C=o.current.unstable_applyPipeProcessors("cellClassName",[],{id:n,field:l});r.cellClassName&&C.push(typeof r.cellClassName=="function"?r.cellClassName(i):r.cellClassName),v&&C.push(v(i));let E;if(a==null&&r.renderCell&&(E=r.renderCell(i),C.push(Q["cell--withRenderer"]),C.push(w==null?void 0:w["cell--withRenderer"])),a!=null&&r.renderEditCell){const T=o.current.getRowWithUpdatedValues(n,r.field),A=me(a,l1),N=k({},i,{row:T},A);E=r.renderEditCell(N),C.push(Q["cell--editing"]),C.push(w==null?void 0:w["cell--editing"])}const{slots:R}=s,S=R.cell,b=k({},e,{ref:t,field:l,formattedValue:h,hasFocus:d,isEditable:f,isSelected:u,value:p,cellMode:c,children:E,tabIndex:m,className:Ue(C)});return x.createElement(S,b)}),f1=ms(d1),h1=x.forwardRef((e,t)=>{var r,n,a,o;const{column:s,rowId:l,editCellState:i,align:u,colIndex:c,height:d,width:f,className:p,showRightBorder:h,colSpan:g,disableDragEvents:m,isNotVisible:w,onClick:v,onDoubleClick:C,onMouseDown:E,onMouseUp:R,onMouseOver:S,onKeyDown:b,onKeyUp:T,onDragEnter:A,onDragOver:N,style:y}=e,D=me(e,i1),L=$e(),M=ke(),F=s.field,B=Ce(L,()=>{try{const ve=L.current.getCellParams(l,F);return ve.api=L.current,ve}catch(he){if(he instanceof na)return Go;throw he}},Fl),H=Ce(L,()=>L.current.unstable_applyPipeProcessors("isCellSelected",!1,{id:l,field:F})),{cellMode:G,hasFocus:_,isEditable:Z,value:ee,formattedValue:P}=B,q=s.type==="actions"&&((r=(n=s).getActions)==null?void 0:r.call(n,L.current.getRowParams(l)).some(he=>!he.props.disabled)),K=(G==="view"||!Z)&&!q?B.tabIndex:-1,{classes:X,getCellClassName:te}=M,le=L.current.unstable_applyPipeProcessors("cellClassName",[],{id:l,field:F});s.cellClassName&&le.push(typeof s.cellClassName=="function"?s.cellClassName(B):s.cellClassName),te&&le.push(te(B));const fe=P??ee,de=x.useRef(null),ie=qr(t,de),xe=x.useRef(null),z=(a=M.unstable_cellSelection)!=null?a:!1,Pe={align:u,showRightBorder:h,isEditable:Z,classes:M.classes,isSelected:H,isSelectionMode:z},_e=u1(Pe),Ie=x.useCallback(he=>ve=>{const Ee=L.current.getCellParams(l,F||"");L.current.publishEvent(he,Ee,ve),R&&R(ve)},[L,F,R,l]),ce=x.useCallback(he=>ve=>{const Ee=L.current.getCellParams(l,F||"");L.current.publishEvent(he,Ee,ve),E&&E(ve)},[L,F,E,l]),ne=x.useCallback((he,ve)=>Ee=>{if(!L.current.getRow(l))return;const Ne=L.current.getCellParams(l,F||"");L.current.publishEvent(he,Ne,Ee),ve&&ve(Ee)},[L,F,l]),be=x.useMemo(()=>w?k({padding:0,opacity:0,width:0,border:0},y):k({minWidth:f,maxWidth:f,minHeight:d,maxHeight:d==="auto"?"none":d},y),[f,d,w,y]);if(x.useEffect(()=>{if(!_||G===at.Edit)return;const he=ls(L.current.rootElementRef.current);if(de.current&&!de.current.contains(he.activeElement)){const ve=de.current.querySelector('[tabindex="0"]'),Ee=xe.current||ve||de.current;if(e1())Ee.focus({preventScroll:!0});else{const Ne=L.current.getScrollPosition();Ee.focus(),L.current.scroll(Ne)}}},[_,G,L]),B===Go)return null;let Ae=D.onFocus,Me;if(i==null&&s.renderCell&&(Me=s.renderCell(B),le.push(Q["cell--withRenderer"]),le.push(X==null?void 0:X["cell--withRenderer"])),i!=null&&s.renderEditCell){const he=L.current.getRowWithUpdatedValues(l,s.field),ve=me(i,c1),Ee=k({},B,{row:he},ve);Me=s.renderEditCell(Ee),le.push(Q["cell--editing"]),le.push(X==null?void 0:X["cell--editing"])}if(Me===void 0){const he=fe==null?void 0:fe.toString();Me=I.jsx("div",{className:_e.content,title:he,role:"presentation",children:he})}x.isValidElement(Me)&&q&&(Me=x.cloneElement(Me,{focusElementRef:xe}));const Oe=m?null:{onDragEnter:ne("cellDragEnter",A),onDragOver:ne("cellDragOver",N)},ye=(o=M.experimentalFeatures)==null?void 0:o.ariaV7;return I.jsx("div",k({ref:ie,className:Ue(p,le,_e.root),role:ye?"gridcell":"cell","data-field":F,"data-colindex":c,"aria-colindex":c+1,"aria-colspan":g,style:be,tabIndex:K,onClick:ne("cellClick",v),onDoubleClick:ne("cellDoubleClick",C),onMouseOver:ne("cellMouseOver",S),onMouseDown:ce("cellMouseDown"),onMouseUp:Ie("cellMouseUp"),onKeyDown:ne("cellKeyDown",b),onKeyUp:ne("cellKeyUp",T)},Oe,D,{onFocus:Ae,children:Me}))}),qs=ms(h1),g1=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","hasFocus","tabIndex"],p1=e=>{const{classes:t}=e;return Le({root:["booleanCell"]},We,t)};function x1(e){const{value:t}=e,r=me(e,g1),n=$e(),a=ke(),o={classes:a.classes},s=p1(o),l=x.useMemo(()=>t?a.slots.booleanCellTrueIcon:a.slots.booleanCellFalseIcon,[a.slots.booleanCellFalseIcon,a.slots.booleanCellTrueIcon,t]);return I.jsx(l,k({fontSize:"small",className:s.root,titleAccess:n.current.getLocaleText(t?"booleanCellTrueLabel":"booleanCellFalseLabel"),"data-value":!!t},r))}const m1=x.memo(x1),v1=e=>za(e.rowNode)?"":I.jsx(m1,k({},e)),w1=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","className","hasFocus","isValidating","isProcessingProps","error","onValueChange"],C1=e=>{const{classes:t}=e;return Le({root:["editBooleanCell"]},We,t)};function b1(e){var t;const{id:r,value:n,field:a,className:o,hasFocus:s,onValueChange:l}=e,i=me(e,w1),u=$e(),c=x.useRef(null),d=tt(),[f,p]=x.useState(n),h=ke(),g={classes:h.classes},m=C1(g),w=x.useCallback(async v=>{const C=v.target.checked;l&&await l(v,C),p(C),await u.current.setEditCellValue({id:r,field:a,value:C},v)},[u,a,r,l]);return x.useEffect(()=>{p(n)},[n]),Mt(()=>{s&&c.current.focus()},[s]),I.jsx("label",k({htmlFor:d,className:Ue(m.root,o)},i,{children:I.jsx(h.slots.baseCheckbox,k({id:d,inputRef:c,checked:!!f,onChange:w,size:"small"},(t=h.slotProps)==null?void 0:t.baseCheckbox))}))}const S1=e=>I.jsx(b1,k({},e)),k1=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","inputProps","isValidating","isProcessingProps","onValueChange"],E1=je(ss)({fontSize:"inherit"}),T1=e=>{const{classes:t}=e;return Le({root:["editInputCell"]},We,t)};function y1(e){const{id:t,value:r,field:n,colDef:a,hasFocus:o,inputProps:s,onValueChange:l}=e,i=me(e,k1),u=a.type==="dateTime",c=$e(),d=x.useRef(),f=x.useMemo(()=>{let E;r==null?E=null:r instanceof Date?E=r:E=new Date((r??"").toString());let R;return E==null||Number.isNaN(E.getTime())?R="":R=new Date(E.getTime()-E.getTimezoneOffset()*60*1e3).toISOString().substr(0,u?16:10),{parsed:E,formatted:R}},[r,u]),[p,h]=x.useState(f),m={classes:ke().classes},w=T1(m),v=x.useCallback(E=>{if(E==="")return null;const[R,S]=E.split("T"),[b,T,A]=R.split("-"),N=new Date;if(N.setFullYear(Number(b),Number(T)-1,Number(A)),N.setHours(0,0,0,0),S){const[y,D]=S.split(":");N.setHours(Number(y),Number(D),0,0)}return N},[]),C=x.useCallback(async E=>{const R=E.target.value,S=v(R);l&&await l(E,S),h({parsed:S,formatted:R}),c.current.setEditCellValue({id:t,field:n,value:S},E)},[c,n,t,l,v]);return x.useEffect(()=>{h(E=>{var R,S;return f.parsed!==E.parsed&&((R=f.parsed)==null?void 0:R.getTime())!==((S=E.parsed)==null?void 0:S.getTime())?f:E})},[f]),Mt(()=>{o&&d.current.focus()},[o]),I.jsx(E1,k({inputRef:d,fullWidth:!0,className:w.root,type:u?"datetime-local":"date",inputProps:k({max:u?"9999-12-31T23:59":"9999-12-31"},s),value:p.formatted,onChange:C},i))}const qu=e=>I.jsx(y1,k({},e)),_1=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","isValidating","debounceMs","isProcessingProps","onValueChange"],F1=e=>{const{classes:t}=e;return Le({root:["editInputCell"]},We,t)},I1=je(ss,{name:"MuiDataGrid",slot:"EditInputCell",overridesResolver:(e,t)=>t.editInputCell})(({theme:e})=>k({},e.typography.body2,{padding:"1px 0","& input":{padding:"0 16px",height:"100%"}})),P1=x.forwardRef((e,t)=>{const r=ke(),{id:n,value:a,field:o,colDef:s,hasFocus:l,debounceMs:i=200,isProcessingProps:u,onValueChange:c}=e,d=me(e,_1),f=$e(),p=x.useRef(),[h,g]=x.useState(a),m=F1(r),w=x.useCallback(async C=>{const E=C.target.value;c&&await c(C,E);const R=f.current.getColumn(o);let S=E;R.valueParser&&(S=R.valueParser(E,f.current.getCellParams(n,o))),g(S),f.current.setEditCellValue({id:n,field:o,value:S,debounceMs:i,unstable_skipValueParser:!0},C)},[f,i,o,n,c]),v=f.current.unstable_getEditCellMeta(n,o);return x.useEffect(()=>{(v==null?void 0:v.changeReason)!=="debouncedSetEditCellValue"&&g(a)},[v,a]),Mt(()=>{l&&p.current.focus()},[l]),I.jsx(I1,k({ref:t,inputRef:p,className:m.root,ownerState:r,fullWidth:!0,type:s.type==="number"?s.type:"text",value:h??"",onChange:w,endAdornment:u?I.jsx(r.slots.loadIcon,{fontSize:"small",color:"action"}):void 0},d))}),A1=e=>I.jsx(P1,k({},e)),Uo=e=>e==="Escape",M1=e=>e==="Enter",vs=e=>e==="Tab",Zu=e=>e===" ",D1=e=>e.indexOf("Arrow")===0,O1=e=>e==="Home"||e==="End",R1=e=>e.indexOf("Page")===0;function Qu(e){return e.key.length===1&&!e.ctrlKey&&!e.metaKey}const zo=e=>O1(e)||D1(e)||R1(e)||Zu(e),L1=e=>!!e.key,Ll=e=>vs(e)||Uo(e);function Fn(e){return(e==null?void 0:e.type)==="singleSelect"}function Zs(e,t,r){if(t===void 0)return;const n=t.find(a=>{const o=r(a);return String(o)===String(e)});return r(n)}const N1=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","className","hasFocus","isValidating","isProcessingProps","error","onValueChange","initialOpen","getOptionLabel","getOptionValue"],B1=["MenuProps"];function H1(e){return!!e.key}function $1(e){var t,r,n;const a=ke(),{id:o,value:s,field:l,row:i,colDef:u,hasFocus:c,error:d,onValueChange:f,initialOpen:p=a.editMode===Rr.Cell,getOptionLabel:h,getOptionValue:g}=e,m=me(e,N1),w=$e(),v=x.useRef(),C=x.useRef(),[E,R]=x.useState(p),b=(r=(((t=a.slotProps)==null?void 0:t.baseSelect)||{}).native)!=null?r:!1,T=((n=a.slotProps)==null?void 0:n.baseSelect)||{},{MenuProps:A}=T,N=me(T,B1);if(Mt(()=>{if(c){var H;(H=C.current)==null||H.focus()}},[c]),!Fn(u))return null;let y;if(typeof(u==null?void 0:u.valueOptions)=="function"?y=u==null?void 0:u.valueOptions({id:o,row:i,field:l}):y=u==null?void 0:u.valueOptions,!y)return null;const D=g||u.getOptionValue,L=h||u.getOptionLabel,M=async H=>{if(!Fn(u)||!y)return;R(!1);const G=H.target,_=Zs(G.value,y,D);f&&await f(H,_),await w.current.setEditCellValue({id:o,field:l,value:_},H)},F=(H,G)=>{if(a.editMode===Rr.Row){R(!1);return}if(G==="backdropClick"||Uo(H.key)){const _=w.current.getCellParams(o,l);w.current.publishEvent("cellEditStop",k({},_,{reason:Uo(H.key)?mr.escapeKeyDown:mr.cellFocusOut}))}},B=H=>{H1(H)&&H.key==="Enter"||R(!0)};return!y||!u?null:I.jsx(a.slots.baseSelect,k({ref:v,inputRef:C,value:s,onChange:M,open:E,onOpen:B,MenuProps:k({onClose:F},A),error:d,native:b,fullWidth:!0},m,N,{children:y.map(H=>{var G;const _=D(H);return x.createElement(a.slots.baseSelectOption,k({},((G=a.slotProps)==null?void 0:G.baseSelectOption)||{},{native:b,key:_,value:_}),L(H))})}))}const V1=e=>I.jsx($1,k({},e)),G1=["open","target","onClose","children","position","className","onExited"],U1=e=>{const{classes:t}=e;return Le({root:["menu"]},We,t)},z1=je(bl,{name:"MuiDataGrid",slot:"Menu",overridesResolver:(e,t)=>t.menu})(({theme:e})=>({zIndex:e.zIndex.modal,[`& .${Q.menuList}`]:{outline:0}})),j1={"bottom-start":"top left","bottom-end":"top right"};function ws(e){var t;const{open:r,target:n,onClose:a,children:o,position:s,className:l,onExited:i}=e,u=me(e,G1),c=$e(),d=ke(),f=U1(d),p=x.useRef(null);Mt(()=>{if(r)p.current=document.activeElement instanceof HTMLElement?document.activeElement:null;else{var m,w;(m=p.current)==null||(w=m.focus)==null||w.call(m),p.current=null}},[r]),x.useEffect(()=>{const m=r?"menuOpen":"menuClose";c.current.publishEvent(m,{target:n})},[c,r,n]);const h=m=>w=>{m&&m(),i&&i(w)},g=m=>{m.target&&(n===m.target||n!=null&&n.contains(m.target))||a(m)};return I.jsx(z1,k({as:d.slots.basePopper,className:Ue(l,f.root),ownerState:d,open:r,anchorEl:n,transition:!0,placement:s},u,(t=d.slotProps)==null?void 0:t.basePopper,{children:({TransitionProps:m,placement:w})=>I.jsx(Su,{onClickAway:g,mouseEvent:"onMouseDown",children:I.jsx(yf,k({},m,{style:{transformOrigin:j1[w]},onExited:h(m==null?void 0:m.onExited),children:I.jsx(ku,{children:o})}))})}))}const W1=["api","colDef","id","hasFocus","isEditable","field","value","formattedValue","row","rowNode","cellMode","tabIndex","position","focusElementRef"],K1=e=>typeof e.getActions=="function";function X1(e){var t;const{colDef:r,id:n,hasFocus:a,tabIndex:o,position:s="bottom-end",focusElementRef:l}=e,i=me(e,W1),[u,c]=x.useState(-1),[d,f]=x.useState(!1),p=$e(),h=x.useRef(null),g=x.useRef(null),m=x.useRef(!1),w=x.useRef({}),v=Yr(),C=tt(),E=tt(),R=ke();if(!K1(r))throw new Error("MUI: Missing the `getActions` property in the `GridColDef`.");const S=r.getActions(p.current.getRowParams(n)),b=S.filter(B=>!B.props.showInMenu),T=S.filter(B=>B.props.showInMenu),A=b.length+(T.length?1:0);x.useLayoutEffect(()=>{a||Object.entries(w.current).forEach(([B,H])=>{H==null||H.stop({},()=>{delete w.current[B]})})},[a]),x.useEffect(()=>{if(u<0||!h.current||u>=h.current.children.length)return;h.current.children[u].focus({preventScroll:!0})},[u]),x.useEffect(()=>{a||(c(-1),m.current=!1)},[a]),x.useImperativeHandle(l,()=>({focus(){if(!m.current){const B=S.findIndex(H=>!H.props.disabled);c(B)}}}),[S]),x.useEffect(()=>{u>=A&&c(A-1)},[u,A]);const N=()=>{f(!0),c(A-1),m.current=!0},y=()=>{f(!1)},D=B=>H=>{w.current[B]=H},L=(B,H)=>G=>{c(B),m.current=!0,H&&H(G)},M=B=>{if(A<=1)return;const H=(_,Z)=>{var ee;if(_<0||_>S.length)return _;const P=v.direction==="rtl"?-1:1,q=(Z==="left"?-1:1)*P;return(ee=S[_+q])!=null&&ee.props.disabled?H(_+q,Z):_+q};let G=u;B.key==="ArrowRight"?G=H(u,"right"):B.key==="ArrowLeft"&&(G=H(u,"left")),!(G<0||G>=A)&&G!==u&&(B.preventDefault(),B.stopPropagation(),c(G))},F=B=>{B.key==="Tab"&&B.preventDefault(),["Tab","Enter","Escape"].includes(B.key)&&y()};return I.jsxs("div",k({role:"menu",ref:h,tabIndex:-1,className:Q.actionsCell,onKeyDown:M},i,{children:[b.map((B,H)=>x.cloneElement(B,{key:H,touchRippleRef:D(H),onClick:L(H,B.props.onClick),tabIndex:u===H?o:-1})),T.length>0&&E&&I.jsx(R.slots.baseIconButton,k({ref:g,id:E,"aria-label":p.current.getLocaleText("actionsCellMore"),"aria-haspopup":"menu","aria-expanded":d,"aria-controls":d?C:void 0,role:"menuitem",size:"small",onClick:N,touchRippleRef:D(E),tabIndex:u===b.length?o:-1},(t=R.slotProps)==null?void 0:t.baseIconButton,{children:I.jsx(R.slots.moreActionsIcon,{fontSize:"small"})})),T.length>0&&I.jsx(ws,{open:d,target:g.current,position:s,onClose:y,onClick:y,children:I.jsx(is,{id:C,className:Q.menuList,onKeyDown:F,"aria-labelledby":E,variant:"menu",autoFocusItem:!0,children:T.map((B,H)=>x.cloneElement(B,{key:H}))})})]}))}const Y1=e=>I.jsx(X1,k({},e)),q1=["field","align","width","contentWidth"],Z1=e=>{const{align:t,classes:r}=e,n={root:["cell","cellSkeleton",`cell--text${et(t)}`,"withBorderColor"]};return Le(n,We,r)};function Q1(e){const{align:t,width:r,contentWidth:n}=e,a=me(e,q1),s={classes:ke().classes,align:t},l=Z1(s);return I.jsx("div",k({className:l.root,style:{width:r}},a,{children:I.jsx(_u,{width:`${n}%`})}))}function J1(e){return e.vars?e.vars.palette.TableCell.border:e.palette.mode==="light"?vl(Wt(e.palette.divider,1),.88):wl(Wt(e.palette.divider,1),.68)}const Ni={[`.${Q.columnSeparator}, .${Q["columnSeparator--resizing"]}`]:{visibility:"visible",width:"auto"}},Bi={[`& .${Q.iconButtonContainer}`]:{visibility:"visible",width:"auto"},[`& .${Q.menuIcon}`]:{width:"auto",visibility:"visible"}},ep=je("div",{name:"MuiDataGrid",slot:"Root",overridesResolver:(e,t)=>[{[`&.${Q.autoHeight}`]:t.autoHeight},{[`&.${Q.aggregationColumnHeader}`]:t.aggregationColumnHeader},{[`&.${Q["aggregationColumnHeader--alignLeft"]}`]:t["aggregationColumnHeader--alignLeft"]},{[`&.${Q["aggregationColumnHeader--alignCenter"]}`]:t["aggregationColumnHeader--alignCenter"]},{[`&.${Q["aggregationColumnHeader--alignRight"]}`]:t["aggregationColumnHeader--alignRight"]},{[`&.${Q.aggregationColumnHeaderLabel}`]:t.aggregationColumnHeaderLabel},{[`&.${Q["root--disableUserSelection"]} .${Q.cell}`]:t["root--disableUserSelection"]},{[`&.${Q.autosizing}`]:t.autosizing},{[`& .${Q.editBooleanCell}`]:t.editBooleanCell},{[`& .${Q["cell--editing"]}`]:t["cell--editing"]},{[`& .${Q["cell--textCenter"]}`]:t["cell--textCenter"]},{[`& .${Q["cell--textLeft"]}`]:t["cell--textLeft"]},{[`& .${Q["cell--textRight"]}`]:t["cell--textRight"]},{[`& .${Q["cell--withRenderer"]}`]:t["cell--withRenderer"]},{[`& .${Q.cell}`]:t.cell},{[`& .${Q["cell--rangeTop"]}`]:t["cell--rangeTop"]},{[`& .${Q["cell--rangeBottom"]}`]:t["cell--rangeBottom"]},{[`& .${Q["cell--rangeLeft"]}`]:t["cell--rangeLeft"]},{[`& .${Q["cell--rangeRight"]}`]:t["cell--rangeRight"]},{[`& .${Q["cell--withRightBorder"]}`]:t["cell--withRightBorder"]},{[`& .${Q.cellContent}`]:t.cellContent},{[`& .${Q.cellCheckbox}`]:t.cellCheckbox},{[`& .${Q.cellSkeleton}`]:t.cellSkeleton},{[`& .${Q.checkboxInput}`]:t.checkboxInput},{[`& .${Q["columnHeader--alignCenter"]}`]:t["columnHeader--alignCenter"]},{[`& .${Q["columnHeader--alignLeft"]}`]:t["columnHeader--alignLeft"]},{[`& .${Q["columnHeader--alignRight"]}`]:t["columnHeader--alignRight"]},{[`& .${Q["columnHeader--dragging"]}`]:t["columnHeader--dragging"]},{[`& .${Q["columnHeader--moving"]}`]:t["columnHeader--moving"]},{[`& .${Q["columnHeader--numeric"]}`]:t["columnHeader--numeric"]},{[`& .${Q["columnHeader--sortable"]}`]:t["columnHeader--sortable"]},{[`& .${Q["columnHeader--sorted"]}`]:t["columnHeader--sorted"]},{[`& .${Q["columnHeader--withRightBorder"]}`]:t["columnHeader--withRightBorder"]},{[`& .${Q.columnHeader}`]:t.columnHeader},{[`& .${Q.headerFilterRow}`]:t.headerFilterRow},{[`& .${Q.columnHeaderCheckbox}`]:t.columnHeaderCheckbox},{[`& .${Q.columnHeaderDraggableContainer}`]:t.columnHeaderDraggableContainer},{[`& .${Q.columnHeaderTitleContainer}`]:t.columnHeaderTitleContainer},{[`& .${Q["columnSeparator--resizable"]}`]:t["columnSeparator--resizable"]},{[`& .${Q["columnSeparator--resizing"]}`]:t["columnSeparator--resizing"]},{[`& .${Q.columnSeparator}`]:t.columnSeparator},{[`& .${Q.filterIcon}`]:t.filterIcon},{[`& .${Q.iconSeparator}`]:t.iconSeparator},{[`& .${Q.menuIcon}`]:t.menuIcon},{[`& .${Q.menuIconButton}`]:t.menuIconButton},{[`& .${Q.menuOpen}`]:t.menuOpen},{[`& .${Q.menuList}`]:t.menuList},{[`& .${Q["row--editable"]}`]:t["row--editable"]},{[`& .${Q["row--editing"]}`]:t["row--editing"]},{[`& .${Q["row--dragging"]}`]:t["row--dragging"]},{[`& .${Q.row}`]:t.row},{[`& .${Q.rowReorderCellPlaceholder}`]:t.rowReorderCellPlaceholder},{[`& .${Q.rowReorderCell}`]:t.rowReorderCell},{[`& .${Q["rowReorderCell--draggable"]}`]:t["rowReorderCell--draggable"]},{[`& .${Q.sortIcon}`]:t.sortIcon},{[`& .${Q.withBorderColor}`]:t.withBorderColor},{[`& .${Q.treeDataGroupingCell}`]:t.treeDataGroupingCell},{[`& .${Q.treeDataGroupingCellToggle}`]:t.treeDataGroupingCellToggle},{[`& .${Q.detailPanelToggleCell}`]:t.detailPanelToggleCell},{[`& .${Q["detailPanelToggleCell--expanded"]}`]:t["detailPanelToggleCell--expanded"]},t.root]})(({theme:e})=>{const t=J1(e),r=e.shape.borderRadius;return k({"--unstable_DataGrid-radius":typeof r=="number"?`${r}px`:r,"--unstable_DataGrid-headWeight":e.typography.fontWeightMedium,"--unstable_DataGrid-overlayBackground":e.vars?`rgba(${e.vars.palette.background.defaultChannel} / ${e.vars.palette.action.disabledOpacity})`:Wt(e.palette.background.default,e.palette.action.disabledOpacity),"--DataGrid-cellOffsetMultiplier":2,flex:1,boxSizing:"border-box",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:t,borderRadius:"var(--unstable_DataGrid-radius)",color:(e.vars||e).palette.text.primary},e.typography.body2,{outline:"none",height:"100%",display:"flex",minWidth:0,minHeight:0,flexDirection:"column",overflowAnchor:"none",[`&.${Q.autoHeight}`]:{height:"auto",[`& .${Q["row--lastVisible"]} .${Q.cell}`]:{borderBottomColor:"transparent"}},[`&.${Q.autosizing}`]:{[`& .${Q.columnHeaderTitleContainerContent} > *`]:{overflow:"visible !important"},[`& .${Q.cell} > *`]:{overflow:"visible !important",whiteSpace:"nowrap"}},[`& .${Q["virtualScrollerContent--overflowed"]} .${Q["row--lastVisible"]} .${Q.cell}`]:{borderBottomColor:"transparent"},[`& .${Q.columnHeader}, & .${Q.cell}`]:{WebkitTapHighlightColor:"transparent",lineHeight:null,padding:"0 10px",boxSizing:"border-box"},[`& .${Q.columnHeader}:focus-within, & .${Q.cell}:focus-within`]:{outline:`solid ${e.vars?`rgba(${e.vars.palette.primary.mainChannel} / 0.5)`:Wt(e.palette.primary.main,.5)} 1px`,outlineWidth:1,outlineOffset:-1},[`& .${Q.columnHeader}:focus, & .${Q.cell}:focus`]:{outline:`solid ${e.palette.primary.main} 1px`},[`& .${Q.columnHeaderCheckbox}, & .${Q.cellCheckbox}`]:{padding:0,justifyContent:"center",alignItems:"center"},[`& .${Q.columnHeader}`]:{position:"relative",display:"flex",alignItems:"center"},[`& .${Q["columnHeader--sorted"]} .${Q.iconButtonContainer}, & .${Q["columnHeader--filtered"]} .${Q.iconButtonContainer}`]:{visibility:"visible",width:"auto"},[`& .${Q.columnHeader}:not(.${Q["columnHeader--sorted"]}) .${Q.sortIcon}`]:{opacity:0,transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.shorter})},[`& .${Q.columnHeaderTitleContainer}`]:{display:"flex",alignItems:"center",minWidth:0,flex:1,whiteSpace:"nowrap",overflow:"hidden",position:"relative"},[`& .${Q.columnHeaderTitleContainerContent}`]:{overflow:"hidden",display:"flex",alignItems:"center"},[`& .${Q["columnHeader--filledGroup"]} .${Q.columnHeaderTitleContainer}`]:{borderBottomWidth:"1px",borderBottomStyle:"solid",boxSizing:"border-box"},[`& .${Q["columnHeader--filledGroup"]}.${Q["columnHeader--showColumnBorder"]} .${Q.columnHeaderTitleContainer}`]:{borderBottom:"none"},[`& .${Q["columnHeader--filledGroup"]}.${Q["columnHeader--showColumnBorder"]}`]:{borderBottomWidth:"1px",borderBottomStyle:"solid",boxSizing:"border-box"},[`& .${Q.headerFilterRow}`]:{borderTop:`1px solid ${t}`},[`& .${Q.sortIcon}, & .${Q.filterIcon}`]:{fontSize:"inherit"},[`& .${Q["columnHeader--sortable"]}`]:{cursor:"pointer"},[`& .${Q["columnHeader--alignCenter"]} .${Q.columnHeaderTitleContainer}`]:{justifyContent:"center"},[`& .${Q["columnHeader--alignRight"]} .${Q.columnHeaderDraggableContainer}, & .${Q["columnHeader--alignRight"]} .${Q.columnHeaderTitleContainer}`]:{flexDirection:"row-reverse"},[`& .${Q["columnHeader--alignCenter"]} .${Q.menuIcon}, & .${Q["columnHeader--alignRight"]} .${Q.menuIcon}`]:{marginRight:"auto",marginLeft:-6},[`& .${Q["columnHeader--alignRight"]} .${Q.menuIcon}, & .${Q["columnHeader--alignRight"]} .${Q.menuIcon}`]:{marginRight:"auto",marginLeft:-10},[`& .${Q["columnHeader--moving"]}`]:{backgroundColor:(e.vars||e).palette.action.hover},[`& .${Q.columnSeparator}`]:{visibility:"hidden",position:"absolute",zIndex:100,display:"flex",flexDirection:"column",justifyContent:"center",color:t},"@media (hover: hover)":{[`& .${Q.columnHeaders}:hover`]:Ni,[`& .${Q.columnHeader}:hover`]:Bi,[`& .${Q.columnHeader}:not(.${Q["columnHeader--sorted"]}):hover .${Q.sortIcon}`]:{opacity:.5}},"@media (hover: none)":{[`& .${Q.columnHeaders}`]:Ni,[`& .${Q.columnHeader}`]:Bi},[`& .${Q["columnSeparator--sideLeft"]}`]:{left:-12},[`& .${Q["columnSeparator--sideRight"]}`]:{right:-12},[`& .${Q["columnSeparator--resizable"]}`]:{cursor:"col-resize",touchAction:"none","&:hover":{color:(e.vars||e).palette.text.primary,"@media (hover: none)":{color:t}},[`&.${Q["columnSeparator--resizing"]}`]:{color:(e.vars||e).palette.text.primary},"& svg":{pointerEvents:"none"}},[`& .${Q.iconSeparator}`]:{color:"inherit"},[`& .${Q.menuIcon}`]:{width:0,visibility:"hidden",fontSize:20,marginRight:-10,display:"flex",alignItems:"center"},[`.${Q.menuOpen}`]:{visibility:"visible",width:"auto"},[`& .${Q.row}`]:{display:"flex",width:"fit-content",breakInside:"avoid","&:hover, &.Mui-hovered":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Wt(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(
                ${e.vars.palette.action.selectedOpacity} + 
                ${e.vars.palette.action.hoverOpacity}
              ))`:Wt(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Wt(e.palette.primary.main,e.palette.action.selectedOpacity)}}}},[`& .${Q.cell}`]:{display:"flex",alignItems:"center",borderBottom:"1px solid","&.Mui-selected":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Wt(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity+e.palette.action.hoverOpacity})`:Wt(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Wt(e.palette.primary.main,e.palette.action.selectedOpacity)}}}},[`&.${Q["root--disableUserSelection"]} .${Q.cell}`]:{userSelect:"none"},[`& .${Q.row}:not(.${Q["row--dynamicHeight"]}) > .${Q.cell}`]:{overflow:"hidden",whiteSpace:"nowrap"},[`& .${Q.cellContent}`]:{overflow:"hidden",textOverflow:"ellipsis"},[`& .${Q.cell}.${Q["cell--selectionMode"]}`]:{cursor:"default"},[`& .${Q.cell}.${Q["cell--editing"]}`]:{padding:1,display:"flex",boxShadow:e.shadows[2],backgroundColor:(e.vars||e).palette.background.paper,"&:focus-within":{outline:`solid ${(e.vars||e).palette.primary.main} 1px`,outlineOffset:"-1px"}},[`& .${Q["row--editing"]}`]:{boxShadow:e.shadows[2]},[`& .${Q["row--editing"]} .${Q.cell}`]:{boxShadow:e.shadows[0],backgroundColor:(e.vars||e).palette.background.paper},[`& .${Q.editBooleanCell}`]:{display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},[`& .${Q.booleanCell}[data-value="true"]`]:{color:(e.vars||e).palette.text.secondary},[`& .${Q.booleanCell}[data-value="false"]`]:{color:(e.vars||e).palette.text.disabled},[`& .${Q.actionsCell}`]:{display:"inline-flex",alignItems:"center",gridGap:e.spacing(1)},[`& .${Q.rowReorderCell}`]:{display:"inline-flex",flex:1,alignItems:"center",justifyContent:"center",opacity:(e.vars||e).palette.action.disabledOpacity},[`& .${Q["rowReorderCell--draggable"]}`]:{cursor:"move",opacity:1},[`& .${Q.rowReorderCellContainer}`]:{padding:0,alignItems:"stretch"},[`.${Q.withBorderColor}`]:{borderColor:t},[`& .${Q["cell--withRightBorder"]}`]:{borderRightWidth:"1px",borderRightStyle:"solid"},[`& .${Q["columnHeader--withRightBorder"]}`]:{borderRightWidth:"1px",borderRightStyle:"solid"},[`& .${Q["cell--textLeft"]}`]:{justifyContent:"flex-start"},[`& .${Q["cell--textRight"]}`]:{justifyContent:"flex-end"},[`& .${Q["cell--textCenter"]}`]:{justifyContent:"center"},[`& .${Q.columnHeaderDraggableContainer}`]:{display:"flex",width:"100%",height:"100%"},[`& .${Q.rowReorderCellPlaceholder}`]:{display:"none"},[`& .${Q["columnHeader--dragging"]}, & .${Q["row--dragging"]}`]:{background:(e.vars||e).palette.background.paper,padding:"0 12px",borderRadius:"var(--unstable_DataGrid-radius)",opacity:(e.vars||e).palette.action.disabledOpacity},[`& .${Q["row--dragging"]}`]:{background:(e.vars||e).palette.background.paper,padding:"0 12px",borderRadius:"var(--unstable_DataGrid-radius)",opacity:(e.vars||e).palette.action.disabledOpacity,[`& .${Q.rowReorderCellPlaceholder}`]:{display:"flex"}},[`& .${Q.treeDataGroupingCell}`]:{display:"flex",alignItems:"center",width:"100%"},[`& .${Q.treeDataGroupingCellToggle}`]:{flex:"0 0 28px",alignSelf:"stretch",marginRight:e.spacing(2)},[`& .${Q.groupingCriteriaCell}`]:{display:"flex",alignItems:"center",width:"100%"},[`& .${Q.groupingCriteriaCellToggle}`]:{flex:"0 0 28px",alignSelf:"stretch",marginRight:e.spacing(2)}})}),tp=["children","className"],rp=e=>{const{autoHeight:t,density:r,classes:n}=e,a={root:["root",t&&"autoHeight",`root--density${et(r)}`,"withBorderColor"]};return Le(a,We,n)},np=x.forwardRef(function(t,r){var n;const a=ke(),{children:o,className:s}=t,l=me(t,tp),i=vn(),u=Ce(i,Uu),c=x.useRef(null),d=qr(c,r),f=(n=a.experimentalFeatures)!=null&&n.ariaV7?null:Lu,p=typeof f=="function"?f():null,h=k({},a,{density:u}),g=rp(h);i.current.register("public",{rootElementRef:c});const[m,w]=x.useState(!1);return Mt(()=>{w(!0)},[]),m?I.jsx(ep,k({ref:d,className:Ue(s,g.root),ownerState:h},p,l,{children:o})):null}),ap=["className"],op=e=>{const{classes:t}=e;return Le({root:["footerContainer","withBorderColor"]},We,t)},sp=Ft("div",{name:"MuiDataGrid",slot:"FooterContainer",overridesResolver:(e,t)=>t.footerContainer})({display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:52,borderTop:"1px solid"}),lp=x.forwardRef(function(t,r){const{className:n}=t,a=me(t,ap),o=ke(),s=op(o);return I.jsx(sp,k({ref:r,className:Ue(s.root,n),ownerState:o},a))}),ip=["className"],cp=e=>{const{classes:t}=e;return Le({root:["overlay"]},We,t)},up=Ft("div",{name:"MuiDataGrid",slot:"Overlay",overridesResolver:(e,t)=>t.overlay})({width:"100%",height:"100%",display:"flex",alignSelf:"center",alignItems:"center",justifyContent:"center",backgroundColor:"var(--unstable_DataGrid-overlayBackground)"}),Nl=x.forwardRef(function(t,r){const{className:n}=t,a=me(t,ip),o=ke(),s=cp(o);return I.jsx(up,k({ref:r,className:Ue(s.root,n),ownerState:o},a))}),dp=["className","children"],fp=e=>{const{classes:t}=e;return Le({root:["toolbarContainer"]},We,t)},hp=Ft("div",{name:"MuiDataGrid",slot:"ToolbarContainer",overridesResolver:(e,t)=>t.toolbarContainer})(({theme:e})=>({display:"flex",alignItems:"center",flexWrap:"wrap",gap:e.spacing(1),padding:e.spacing(.5,.5,0)})),Ju=x.forwardRef(function(t,r){const{className:n,children:a}=t,o=me(t,dp),s=ke(),l=fp(s);return a?I.jsx(hp,k({ref:r,className:Ue(n,l.root),ownerState:s},o,{children:a})):null}),gp=["className"],pp=e=>{const{classes:t}=e;return Le({root:["iconButtonContainer"]},We,t)},xp=Ft("div",{name:"MuiDataGrid",slot:"IconButtonContainer",overridesResolver:(e,t)=>t.iconButtonContainer})(()=>({display:"flex",visibility:"hidden",width:0})),e0=x.forwardRef(function(t,r){const{className:n}=t,a=me(t,gp),o=ke(),s=pp(o);return I.jsx(xp,k({ref:r,className:Ue(s.root,n),ownerState:o},a))}),mp=e=>{const{classes:t}=e;return Le({icon:["sortIcon"]},We,t)};function vp(e,t,r,n){let a;const o={};return t==="asc"?a=e.columnSortedAscendingIcon:t==="desc"?a=e.columnSortedDescendingIcon:(a=e.columnUnsortedIcon,o.sortingOrder=n),a?I.jsx(a,k({fontSize:"small",className:r},o)):null}function wp(e){var t;const{direction:r,index:n,sortingOrder:a}=e,o=$e(),s=ke(),l=k({},e,{classes:s.classes}),i=mp(l),u=vp(s.slots,r,i.icon,a);if(!u)return null;const c=I.jsx(s.slots.baseIconButton,k({tabIndex:-1,"aria-label":o.current.getLocaleText("columnHeaderSortIconLabel"),title:o.current.getLocaleText("columnHeaderSortIconLabel"),size:"small"},(t=s.slotProps)==null?void 0:t.baseIconButton,{children:u}));return I.jsxs(e0,{children:[n!=null&&I.jsx(El,{badgeContent:n,color:"default",children:c}),n==null&&c]})}const Cp=x.memo(wp),bp=e=>{const{classes:t,open:r}=e;return Le({root:["menuIcon",r&&"menuOpen"],button:["menuIconButton"]},We,t)},Sp=x.memo(e=>{var t,r;const{colDef:n,open:a,columnMenuId:o,columnMenuButtonId:s,iconButtonRef:l}=e,i=$e(),u=ke(),c=k({},e,{classes:u.classes}),d=bp(c),f=x.useCallback(p=>{p.preventDefault(),p.stopPropagation(),i.current.toggleColumnMenu(n.field)},[i,n.field]);return I.jsx("div",{className:d.root,children:I.jsx(u.slots.baseTooltip,k({title:i.current.getLocaleText("columnMenuLabel"),enterDelay:1e3},(t=u.slotProps)==null?void 0:t.baseTooltip,{children:I.jsx(u.slots.baseIconButton,k({ref:l,tabIndex:-1,className:d.button,"aria-label":i.current.getLocaleText("columnMenuLabel"),size:"small",onClick:f,"aria-haspopup":"menu","aria-expanded":a,"aria-controls":a?o:void 0,id:s},(r=u.slotProps)==null?void 0:r.baseIconButton,{children:I.jsx(u.slots.columnMenuIcon,{fontSize:"small"})}))}))})});function kp({columnMenuId:e,columnMenuButtonId:t,ContentComponent:r,contentComponentProps:n,field:a,open:o,target:s,onExited:l}){const i=$e(),u=i.current.getColumn(a),c=Er(d=>{d&&(d.stopPropagation(),s!=null&&s.contains(d.target))||i.current.hideColumnMenu()});return!s||!u?null:I.jsx(ws,{placement:`bottom-${u.align==="right"?"start":"end"}`,open:o,target:s,onClose:c,onExited:l,children:I.jsx(r,k({colDef:u,hideMenu:c,open:o,id:e,labelledby:t},n))})}const Ep=["className"],Tp=e=>{const{classes:t}=e;return Le({root:["columnHeaderTitle"]},We,t)},yp=Ft("div",{name:"MuiDataGrid",slot:"ColumnHeaderTitle",overridesResolver:(e,t)=>t.columnHeaderTitle})({textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontWeight:"var(--unstable_DataGrid-headWeight)"}),_p=x.forwardRef(function(t,r){const{className:n}=t,a=me(t,Ep),o=ke(),s=Tp(o);return I.jsx(yp,k({ref:r,className:Ue(s.root,n),ownerState:o},a))});function Fp(e){var t;const{label:r,description:n}=e,a=ke(),o=x.useRef(null),[s,l]=x.useState(""),i=x.useCallback(()=>{if(!n&&o!=null&&o.current){const u=t1(o.current);l(u?r:"")}},[n,r]);return I.jsx(a.slots.baseTooltip,k({title:n||s},(t=a.slotProps)==null?void 0:t.baseTooltip,{children:I.jsx(_p,{onMouseOver:i,ref:o,children:r})}))}const Ip=["resizable","resizing","height","side"];var t0=function(e){return e.Left="left",e.Right="right",e}(t0||{});const Pp=e=>{const{resizable:t,resizing:r,classes:n,side:a}=e,o={root:["columnSeparator",t&&"columnSeparator--resizable",r&&"columnSeparator--resizing",a&&`columnSeparator--side${et(a)}`],icon:["iconSeparator"]};return Le(o,We,n)};function Ap(e){const{height:t,side:r=t0.Right}=e,n=me(e,Ip),a=ke(),o=k({},e,{side:r,classes:a.classes}),s=Pp(o),l=x.useCallback(i=>{i.preventDefault(),i.stopPropagation()},[]);return I.jsx("div",k({className:s.root,style:{minHeight:t,opacity:a.showColumnVerticalBorder?0:1}},n,{onClick:l,children:I.jsx(a.slots.columnResizeIcon,{className:s.icon})}))}const Mp=x.memo(Ap),Dp=["classes","columnMenuOpen","colIndex","height","isResizing","sortDirection","hasFocus","tabIndex","separatorSide","isDraggable","headerComponent","description","elementId","width","columnMenuIconButton","columnMenu","columnTitleIconButtons","headerClassName","label","resizable","draggableContainerProps","columnHeaderSeparatorProps"],r0=x.forwardRef(function(t,r){const{classes:n,columnMenuOpen:a,colIndex:o,height:s,isResizing:l,sortDirection:i,hasFocus:u,tabIndex:c,separatorSide:d,isDraggable:f,headerComponent:p,description:h,width:g,columnMenuIconButton:m=null,columnMenu:w=null,columnTitleIconButtons:v=null,headerClassName:C,label:E,resizable:R,draggableContainerProps:S,columnHeaderSeparatorProps:b}=t,T=me(t,Dp),A=vn(),N=ke(),y=x.useRef(null),[D,L]=x.useState(a),M=qr(y,r);let F="none";return i!=null&&(F=i==="asc"?"ascending":"descending"),x.useEffect(()=>{D||L(a)},[D,a]),x.useLayoutEffect(()=>{const B=A.current.state.columnMenu;if(u&&!B.open){const G=y.current.querySelector('[tabindex="0"]')||y.current;G==null||G.focus(),A.current.columnHeadersContainerElementRef.current.scrollLeft=0}},[A,u]),I.jsxs("div",k({ref:M,className:Ue(n.root,C),style:{height:s,width:g,minWidth:g,maxWidth:g},role:"columnheader",tabIndex:c,"aria-colindex":o+1,"aria-sort":F,"aria-label":p==null?E:void 0},T,{children:[I.jsxs("div",k({className:n.draggableContainer,draggable:f,role:"presentation"},S,{children:[I.jsxs("div",{className:n.titleContainer,role:"presentation",children:[I.jsx("div",{className:n.titleContainerContent,children:p!==void 0?p:I.jsx(Fp,{label:E,description:h,columnWidth:g})}),v]}),m]})),I.jsx(Mp,k({resizable:!N.disableColumnResize&&!!R,resizing:l,height:s,side:d},b)),w]}))}),Op=e=>{const{colDef:t,classes:r,isDragging:n,sortDirection:a,showRightBorder:o,filterItemsCounter:s}=e,l=a!=null,i=s!=null&&s>0,u=t.type==="number",c={root:["columnHeader",t.headerAlign==="left"&&"columnHeader--alignLeft",t.headerAlign==="center"&&"columnHeader--alignCenter",t.headerAlign==="right"&&"columnHeader--alignRight",t.sortable&&"columnHeader--sortable",n&&"columnHeader--moving",l&&"columnHeader--sorted",i&&"columnHeader--filtered",u&&"columnHeader--numeric","withBorderColor",o&&"columnHeader--withRightBorder"],draggableContainer:["columnHeaderDraggableContainer"],titleContainer:["columnHeaderTitleContainer"],titleContainerContent:["columnHeaderTitleContainerContent"]};return Le(c,We,r)};function Rp(e){var t,r,n,a;const{colDef:o,columnMenuOpen:s,colIndex:l,headerHeight:i,isResizing:u,sortDirection:c,sortIndex:d,filterItemsCounter:f,hasFocus:p,tabIndex:h,disableReorder:g,separatorSide:m}=e,w=vn(),v=ke(),C=x.useRef(null),E=tt(),R=tt(),S=x.useRef(null),[b,T]=x.useState(s),A=x.useMemo(()=>!v.disableColumnReorder&&!g&&!o.disableReorder,[v.disableColumnReorder,g,o.disableReorder]);let N;o.renderHeader&&(N=o.renderHeader(w.current.getColumnHeaderParams(o.field)));const y=k({},e,{classes:v.classes,showRightBorder:v.showColumnVerticalBorder}),D=Op(y),L=x.useCallback(K=>X=>{ao(X)||w.current.publishEvent(K,w.current.getColumnHeaderParams(o.field),X)},[w,o.field]),M=x.useMemo(()=>({onClick:L("columnHeaderClick"),onDoubleClick:L("columnHeaderDoubleClick"),onMouseOver:L("columnHeaderOver"),onMouseOut:L("columnHeaderOut"),onMouseEnter:L("columnHeaderEnter"),onMouseLeave:L("columnHeaderLeave"),onKeyDown:L("columnHeaderKeyDown"),onFocus:L("columnHeaderFocus"),onBlur:L("columnHeaderBlur")}),[L]),F=x.useMemo(()=>A?{onDragStart:L("columnHeaderDragStart"),onDragEnter:L("columnHeaderDragEnter"),onDragOver:L("columnHeaderDragOver"),onDragEnd:L("columnHeaderDragEnd")}:{},[A,L]),B=x.useMemo(()=>({onMouseDown:L("columnSeparatorMouseDown"),onDoubleClick:L("columnSeparatorDoubleClick")}),[L]);x.useEffect(()=>{b||T(s)},[b,s]);const H=x.useCallback(()=>{T(!1)},[]),G=!v.disableColumnMenu&&!o.disableColumnMenu&&I.jsx(Sp,{colDef:o,columnMenuId:E,columnMenuButtonId:R,open:b,iconButtonRef:S}),_=I.jsx(kp,{columnMenuId:E,columnMenuButtonId:R,field:o.field,open:s,target:S.current,ContentComponent:v.slots.columnMenu,contentComponentProps:(t=v.slotProps)==null?void 0:t.columnMenu,onExited:H}),Z=(r=o.sortingOrder)!=null?r:v.sortingOrder,ee=I.jsxs(x.Fragment,{children:[!v.disableColumnFilter&&I.jsx(v.slots.columnHeaderFilterIconButton,k({field:o.field,counter:f},(n=v.slotProps)==null?void 0:n.columnHeaderFilterIconButton)),o.sortable&&!o.hideSortIcons&&I.jsx(Cp,{direction:c,index:d,sortingOrder:Z})]});x.useLayoutEffect(()=>{const K=w.current.state.columnMenu;if(p&&!K.open){const te=C.current.querySelector('[tabindex="0"]')||C.current;te==null||te.focus(),w.current.columnHeadersContainerElementRef.current.scrollLeft=0}},[w,p]);const P=typeof o.headerClassName=="function"?o.headerClassName({field:o.field,colDef:o}):o.headerClassName,q=(a=o.headerName)!=null?a:o.field;return I.jsx(r0,k({ref:C,classes:D,columnMenuOpen:s,colIndex:l,height:i,isResizing:u,sortDirection:c,hasFocus:p,tabIndex:h,separatorSide:m,isDraggable:A,headerComponent:N,description:o.description,elementId:o.field,width:o.computedWidth,columnMenuIconButton:G,columnTitleIconButtons:ee,headerClassName:P,label:q,resizable:!v.disableColumnResize&&!!o.resizable,"data-field":o.field,columnMenu:_,draggableContainerProps:F,columnHeaderSeparatorProps:B},M))}const ja=()=>({items:[],logicOperator:rr.And,quickFilterValues:[],quickFilterLogicOperator:rr.And}),Hi=1e3;class Lp{constructor(t=Hi){this.timeouts=new Map,this.cleanupTimeout=Hi,this.cleanupTimeout=t}register(t,r,n){this.timeouts||(this.timeouts=new Map);const a=setTimeout(()=>{typeof r=="function"&&r(),this.timeouts.delete(n.cleanupToken)},this.cleanupTimeout);this.timeouts.set(n.cleanupToken,a)}unregister(t){const r=this.timeouts.get(t.cleanupToken);r&&(this.timeouts.delete(t.cleanupToken),clearTimeout(r))}reset(){this.timeouts&&(this.timeouts.forEach((t,r)=>{this.unregister({cleanupToken:r})}),this.timeouts=void 0)}}class Np{constructor(){this.registry=new FinalizationRegistry(t=>{typeof t=="function"&&t()})}register(t,r,n){this.registry.register(t,r,n)}unregister(t){this.registry.unregister(t)}reset(){}}var Or=function(e){return e.DataGrid="DataGrid",e.DataGridPro="DataGridPro",e}(Or||{});class Bp{}function Hp(e){let t=0;return function(n,a,o,s){e.registry===null&&(e.registry=typeof FinalizationRegistry<"u"?new Np:new Lp);const[l]=x.useState(new Bp),i=x.useRef(null),u=x.useRef();u.current=o;const c=x.useRef(null);if(!i.current&&u.current){const d=(f,p,h)=>{if(!p.defaultMuiPrevented){var g;(g=u.current)==null||g.call(u,f,p,h)}};i.current=n.current.subscribeEvent(a,d,s),t+=1,c.current={cleanupToken:t},e.registry.register(l,()=>{var f;(f=i.current)==null||f.call(i),i.current=null,c.current=null},c.current)}else!u.current&&i.current&&(i.current(),i.current=null,c.current&&(e.registry.unregister(c.current),c.current=null));x.useEffect(()=>{if(!i.current&&u.current){const d=(f,p,h)=>{if(!p.defaultMuiPrevented){var g;(g=u.current)==null||g.call(u,f,p,h)}};i.current=n.current.subscribeEvent(a,d,s)}return c.current&&e.registry&&(e.registry.unregister(c.current),c.current=null),()=>{var d;(d=i.current)==null||d.call(i),i.current=null}},[n,a,s])}}const $p={registry:null},Fe=Hp($p),Vp={isFirst:!0};function it(e,t,r){Fe(e,t,r,Vp)}function Ut(e,t){const r=x.useRef(null);if(r.current)return r.current;const n=e.current.getLogger(t);return r.current=n,n}function Gp(e){return typeof e=="number"&&!Number.isNaN(e)}function n0(e){return typeof e=="function"}function Bl(e){return typeof e=="object"&&e!==null}function Up(){try{const e="__some_random_key_you_are_not_going_to_use__";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch{return!1}}function Do(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}const fa=(e,t,r)=>Math.max(t,Math.min(r,e));function jr(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)){const a=e.length;if(a!==t.length)return!1;for(let o=0;o<a;o+=1)if(!jr(e[o],t[o]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;const a=Array.from(e.entries());for(let o=0;o<a.length;o+=1)if(!t.has(a[o][0]))return!1;for(let o=0;o<a.length;o+=1){const s=a[o];if(!jr(s[1],t.get(s[0])))return!1}return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;const a=Array.from(e.entries());for(let o=0;o<a.length;o+=1)if(!t.has(a[o][0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){const a=e.length;if(a!==t.length)return!1;for(let o=0;o<a;o+=1)if(e[o]!==t[o])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const r=Object.keys(e),n=r.length;if(n!==Object.keys(t).length)return!1;for(let a=0;a<n;a+=1)if(!Object.prototype.hasOwnProperty.call(t,r[a]))return!1;for(let a=0;a<n;a+=1){const o=r[a];if(!jr(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function zp(e){return()=>{let t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}function jp(e,t,r){const n=zp(e);return()=>t+(r-t)*n()}function a0(e){return typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}const Wp=(e,t,r,n,a)=>{const o=Ut(e,"useNativeEventListener"),[s,l]=x.useState(!1),i=x.useRef(n),u=x.useCallback(c=>i.current&&i.current(c),[]);x.useEffect(()=>{i.current=n},[n]),x.useEffect(()=>{let c;if(n0(t)?c=t():c=t&&t.current?t.current:null,c&&r&&!s){o.debug(`Binding native ${r} event`),c.addEventListener(r,u,a);const d=c;l(!0);const f=()=>{o.debug(`Clearing native ${r} event`),d.removeEventListener(r,u,a)};e.current.subscribeEvent("unmount",f)}},[t,u,r,s,o,a,e])},oo=e=>{const t=x.useRef(!0);t.current&&(t.current=!1,e())},Kp=100,Xp=e=>e?0:100,o0=(e,t)=>t>0&&e>0?Math.ceil(e/t):0;Nr(["MUI: the 'rowCount' prop is undefined while using paginationMode='server'","For more detail, see http://mui.com/components/data-grid/pagination/#basic-implementation"],"error");const s0=e=>({page:0,pageSize:e?0:100}),Yp=(e,t=0)=>t===0?e:Math.max(Math.min(e,t-1),0),l0=(e,t)=>{if(t===Or.DataGrid&&e>Kp)throw new Error(["MUI: `pageSize` cannot exceed 100 in the MIT version of the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`))},i0=e=>e.pagination,fr=Ve(i0,e=>e.paginationModel),qp=Ve(fr,e=>e.page),Zp=Ve(fr,e=>e.pageSize);Ve(fr,gs,(e,t)=>o0(t,e.pageSize));const Hl=ct(fr,vr,hs,wn,Hu,(e,t,r,n,a)=>{const o=a.length,s=Math.min(e.pageSize*e.page,o-1),l=Math.min(s+e.pageSize-1,o-1);if(s===-1||l===-1)return null;if(r<2)return{firstRowIndex:s,lastRowIndex:l};const i=a[s],u=l-s+1,c=n.findIndex(h=>h.id===i.id);let d=c,f=0;for(;d<n.length&&f<=u;){var p;const h=n[d],g=(p=t[h.id])==null?void 0:p.depth;g===void 0?d+=1:((f<u||g>0)&&(d+=1),g===0&&(f+=1))}return{firstRowIndex:c,lastRowIndex:d-1}}),Qp=ct(wn,Hl,(e,t)=>t?e.slice(t.firstRowIndex,t.lastRowIndex+1):[]),c0=ct(Da,Hl,(e,t)=>t?e.slice(t.firstRowIndex,t.lastRowIndex+1):[]),An=e=>e.preferencePanel;var _r=function(e){return e.filters="filters",e.columns="columns",e}(_r||{});const Wa=e=>e.rowsMeta,dr=e=>e.rowSelection,Jp=Ve(dr,e=>e.length),ex=ct(dr,cn,(e,t)=>new Map(e.map(r=>[r,t[r]]))),jo=ct(dr,e=>e.reduce((t,r)=>(t[r]=r,t),{})),tx=Nr(["MUI: The `sortModel` can only contain a single item when the `disableMultipleColumnsSorting` prop is set to `true`.","If you are using the community version of the `DataGrid`, this prop is always `true`."],"error"),u0=(e,t)=>t&&e.length>1?(tx(),[e[0]]):e,$i=(e,t)=>r=>k({},r,{sorting:k({},r.sorting,{sortModel:u0(e,t)})}),rx=e=>e==="desc",nx=(e,t)=>{const r=t.current.getColumn(e.field);if(!r)return null;const n=rx(e.sort)?(...o)=>-1*r.sortComparator(...o):r.sortComparator;return{getSortCellParams:o=>({id:o,field:r.field,rowNode:t.current.getRowNode(o),value:t.current.getCellValue(o,r.field),api:t.current}),comparator:n}},ax=(e,t,r)=>e.reduce((n,a,o)=>{if(n!==0)return n;const s=t.params[o],l=r.params[o];return n=a.comparator(s.value,l.value,s,l),n},0),ox=(e,t)=>{const r=e.map(n=>nx(n,t)).filter(n=>!!n);return r.length===0?null:n=>n.map(a=>({node:a,params:r.map(o=>o.getSortCellParams(a.id))})).sort((a,o)=>ax(r,a,o)).map(a=>a.node.id)},Vi=(e,t)=>{const r=e.indexOf(t);return!t||r===-1||r+1===e.length?e[0]:e[r+1]},$l=(e,t)=>e==null&&t!=null?-1:t==null&&e!=null?1:e==null&&t==null?0:null,sx=new Intl.Collator,lx=(e,t)=>{const r=$l(e,t);return r!==null?r:typeof e=="string"?sx.compare(e.toString(),t.toString()):e-t},d0=(e,t)=>{const r=$l(e,t);return r!==null?r:Number(e)-Number(t)},f0=(e,t)=>{const r=$l(e,t);return r!==null?r:e>t?1:e<t?-1:0},h0=e=>e.headerFiltering,ix=Ve(h0,e=>e.editing),cx=Ve(h0,e=>e.menuOpen),ux=(e,t)=>{const r={enabled:!t.disableVirtualization,enabledForColumns:!0};return k({},e,{virtualization:r})};function dx(e,t){const r=o=>{e.current.setState(s=>k({},s,{virtualization:k({},s.virtualization,{enabled:o})}))};ze(e,{unstable_setVirtualization:r,unstable_setColumnVirtualization:o=>{e.current.setState(s=>k({},s,{virtualization:k({},s.virtualization,{enabledForColumns:o})}))}},"public"),x.useEffect(()=>{r(!t.disableVirtualization)},[t.disableVirtualization])}const g0=e=>e.virtualization,fx=Ve(g0,e=>e.enabled),p0=Ve(g0,e=>e.enabledForColumns),hx=e=>{const{classes:t}=e;return Le({icon:["filterIcon"]},We,t)};function gx(e){var t,r;const{counter:n,field:a,onClick:o}=e,s=$e(),l=ke(),i=k({},e,{classes:l.classes}),u=hx(i),c=Ce(s,An),d=tt(),f=tt(),p=x.useCallback(m=>{m.preventDefault(),m.stopPropagation();const{open:w,openedPanelValue:v}=An(s.current.state);w&&v===_r.filters?s.current.hideFilterPanel():s.current.showFilterPanel(void 0,f,d),o&&o(s.current.getColumnHeaderParams(a),m)},[s,a,o,f,d]);if(!n)return null;const h=c.open&&c.labelId===d,g=I.jsx(l.slots.baseIconButton,k({id:d,onClick:p,color:"default","aria-label":s.current.getLocaleText("columnHeaderFiltersLabel"),size:"small",tabIndex:-1,"aria-haspopup":"menu","aria-expanded":h,"aria-controls":h?f:void 0},(t=l.slotProps)==null?void 0:t.baseIconButton,{children:I.jsx(l.slots.columnFilteredIcon,{className:u.icon,fontSize:"small"})}));return I.jsx(l.slots.baseTooltip,k({title:s.current.getLocaleText("columnHeaderFiltersTooltipActive")(n),enterDelay:1e3},(r=l.slotProps)==null?void 0:r.baseTooltip,{children:I.jsxs(e0,{children:[n>1&&I.jsx(El,{badgeContent:n,color:"default",children:g}),n===1&&g]})}))}const px=["field","id","value","formattedValue","row","rowNode","colDef","isEditable","cellMode","hasFocus","tabIndex","api"],xx=e=>{const{classes:t}=e;return Le({root:["checkboxInput"]},We,t)},mx=x.forwardRef(function(t,r){var n;const{field:a,id:o,value:s,rowNode:l,hasFocus:i,tabIndex:u}=t,c=me(t,px),d=$e(),f=ke(),p={classes:f.classes},h=xx(p),g=x.useRef(null),m=x.useRef(null),w=qr(g,r),v=d.current.getCellElement(o,a),C=b=>{const T={value:b.target.checked,id:o};d.current.publishEvent("rowSelectionCheckboxChange",T,b)};x.useLayoutEffect(()=>{u===0&&v&&(v.tabIndex=-1)},[v,u]),x.useEffect(()=>{if(i){var b;const T=(b=g.current)==null?void 0:b.querySelector("input");T==null||T.focus({preventScroll:!0})}else m.current&&m.current.stop({})},[i]);const E=x.useCallback(b=>{Zu(b.key)&&b.stopPropagation()},[]);if(l.type==="footer"||l.type==="pinnedRow")return null;const R=d.current.isRowSelectable(o),S=d.current.getLocaleText(s?"checkboxSelectionUnselectRow":"checkboxSelectionSelectRow");return I.jsx(f.slots.baseCheckbox,k({ref:w,tabIndex:u,checked:s,onChange:C,className:h.root,inputProps:{"aria-label":S},onKeyDown:E,disabled:!R,touchRippleRef:m},(n=f.slotProps)==null?void 0:n.baseCheckbox,c))}),vx=mx,wx=["field","colDef"],Cx=e=>{const{classes:t}=e;return Le({root:["checkboxInput"]},We,t)},bx=x.forwardRef(function(t,r){var n;const a=me(t,wx),[,o]=x.useState(!1),s=$e(),l=ke(),i={classes:l.classes},u=Cx(i),c=Ce(s,Gu),d=Ce(s,dr),f=Ce(s,Da),p=Ce(s,c0),h=x.useMemo(()=>typeof l.isRowSelectable!="function"?d:d.filter(T=>s.current.getRow(T)?l.isRowSelectable(s.current.getRowParams(T)):!1),[s,l.isRowSelectable,d]),g=x.useMemo(()=>(!l.pagination||!l.checkboxSelectionVisibleOnly?f:p).reduce((A,N)=>(A[N]=!0,A),{}),[l.pagination,l.checkboxSelectionVisibleOnly,p,f]),m=x.useMemo(()=>h.filter(T=>g[T]).length,[h,g]),w=m>0&&m<Object.keys(g).length,v=m>0,C=T=>{const A={value:T.target.checked};s.current.publishEvent("headerSelectionCheckboxChange",A)},E=c!==null&&c.field===t.field?0:-1;x.useLayoutEffect(()=>{const T=s.current.getColumnHeaderElement(t.field);E===0&&T&&(T.tabIndex=-1)},[E,s,t.field]);const R=x.useCallback(T=>{T.key===" "&&s.current.publishEvent("headerSelectionCheckboxChange",{value:!v})},[s,v]),S=x.useCallback(()=>{o(T=>!T)},[]);x.useEffect(()=>s.current.subscribeEvent("rowSelectionChange",S),[s,S]);const b=s.current.getLocaleText(v?"checkboxSelectionUnselectAllRows":"checkboxSelectionSelectAllRows");return I.jsx(l.slots.baseCheckbox,k({ref:r,indeterminate:w,checked:v,onChange:C,className:u.root,inputProps:{"aria-label":b},tabIndex:E,onKeyDown:R},(n=l.slotProps)==null?void 0:n.baseCheckbox,a))}),Gi=Qe(I.jsx("path",{d:"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"}),"ArrowUpward"),Ui=Qe(I.jsx("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),zi=Qe(I.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRight"),ji=Qe(I.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),Sx=Qe(I.jsx("path",{d:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"}),"FilterList"),Wi=Qe(I.jsx("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAlt"),kx=Qe(I.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");Qe(I.jsx("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu");Qe(I.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");const Ex=Qe(I.jsx("path",{d:"M6 5H3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm14 0h-3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm-7 0h-3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1z"}),"ColumnIcon"),Tx=Qe(I.jsx("path",{d:"M11 19V5h2v14z"}),"Separator"),yx=Qe(I.jsx("path",{d:"M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"}),"ViewHeadline"),_x=Qe(I.jsx("path",{d:"M21,8H3V4h18V8z M21,10H3v4h18V10z M21,16H3v4h18V16z"}),"TableRows"),Fx=Qe(I.jsx("path",{d:"M4 18h17v-6H4v6zM4 5v6h17V5H4z"}),"ViewStream"),Ix=Qe(I.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"TripleDotsVertical"),Rs=Qe(I.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Ki=Qe(I.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),Px=Qe(I.jsx("path",{d:"M19 13H5v-2h14v2z"}),"Remove"),Ax=Qe(I.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}),"Load"),Xi=Qe(I.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"Drag"),Mx=Qe(I.jsx("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"}),"SaveAlt"),Dx=Qe(I.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),Ox=Qe(I.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert"),Rx=Qe(I.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff"),Lx=Qe(I.jsx("g",{children:I.jsx("path",{d:"M14.67,5v14H9.33V5H14.67z M15.67,19H21V5h-5.33V19z M8.33,19V5H3v14H8.33z"})}),"ViewColumn"),Nx=Qe(I.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");Qe(I.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");const Bx=Qe(I.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),Hx=["hideMenu","colDef","id","labelledby","className","children","open"],$x=je(is)(()=>({minWidth:248})),Vx=x.forwardRef(function(t,r){const{hideMenu:n,id:a,labelledby:o,className:s,children:l,open:i}=t,u=me(t,Hx),c=x.useCallback(d=>{vs(d.key)&&d.preventDefault(),Ll(d.key)&&n(d)},[n]);return I.jsx($x,k({id:a,ref:r,className:Ue(Q.menuList,s),"aria-labelledby":o,onKeyDown:c,autoFocus:i},u,{children:l}))}),Gx=["displayOrder"],Ux=e=>{const t=vn(),{defaultSlots:r,defaultSlotProps:n,slots:a={},slotProps:o={},hideMenu:s,colDef:l,addDividers:i=!0}=e,u=x.useMemo(()=>k({},r,a),[r,a]),c=x.useMemo(()=>{if(!o||Object.keys(o).length===0)return n;const p=k({},o);return Object.entries(n).forEach(([h,g])=>{p[h]=k({},g,o[h]||{})}),p},[n,o]),d=t.current.unstable_applyPipeProcessors("columnMenu",[],e.colDef),f=x.useMemo(()=>{const p=Object.keys(r);return Object.keys(a).filter(h=>!p.includes(h))},[a,r]);return x.useMemo(()=>{const g=Array.from(new Set([...d,...f])).filter(m=>u[m]!=null).sort((m,w)=>{const v=c[m],C=c[w],E=Number.isFinite(v==null?void 0:v.displayOrder)?v.displayOrder:100,R=Number.isFinite(C==null?void 0:C.displayOrder)?C.displayOrder:100;return E-R});return g.reduce((m,w,v)=>{let C={colDef:l,onClick:s};const E=c[w];if(E){const R=me(E,Gx);C=k({},C,R)}return i&&v!==g.length-1?[...m,[u[w],C],[Eu,{}]]:[...m,[u[w],C]]},[])},[i,l,d,s,u,c,f])};function zx(e){const{colDef:t,onClick:r}=e,n=$e(),a=ke(),l=At(n).filter(u=>u.disableColumnMenu!==!0).length===1,i=x.useCallback(u=>{l||(n.current.setColumnVisibility(t.field,!1),r(u))},[n,t.field,r,l]);return a.disableColumnSelector||t.hideable===!1?null:I.jsxs(kr,{onClick:i,disabled:l,children:[I.jsx(Tn,{children:I.jsx(a.slots.columnMenuHideIcon,{fontSize:"small"})}),I.jsx(oa,{children:n.current.getLocaleText("columnMenuHideColumn")})]})}function jx(e){const{onClick:t}=e,r=$e(),n=ke(),a=x.useCallback(o=>{t(o),r.current.showPreferences(_r.columns)},[r,t]);return n.disableColumnSelector?null:I.jsxs(kr,{onClick:a,children:[I.jsx(Tn,{children:I.jsx(n.slots.columnMenuManageColumnsIcon,{fontSize:"small"})}),I.jsx(oa,{children:r.current.getLocaleText("columnMenuManageColumns")})]})}function Wx(e){return I.jsxs(x.Fragment,{children:[I.jsx(zx,k({},e)),I.jsx(jx,k({},e))]})}function Kx(e){const{colDef:t,onClick:r}=e,n=$e(),a=ke(),o=x.useCallback(s=>{r(s),n.current.showFilterPanel(t.field)},[n,t.field,r]);return a.disableColumnFilter||!t.filterable?null:I.jsxs(kr,{onClick:o,children:[I.jsx(Tn,{children:I.jsx(a.slots.columnMenuFilterIcon,{fontSize:"small"})}),I.jsx(oa,{children:n.current.getLocaleText("columnMenuFilter")})]})}function Xx(e){var t;const{colDef:r,onClick:n}=e,a=$e(),o=Ce(a,ur),s=ke(),l=x.useMemo(()=>{if(!r)return null;const d=o.find(f=>f.field===r.field);return d==null?void 0:d.sort},[r,o]),i=(t=r.sortingOrder)!=null?t:s.sortingOrder,u=x.useCallback(d=>{n(d);const f=d.currentTarget.getAttribute("data-value")||null;a.current.sortColumn(r,f===l?null:f)},[a,r,n,l]);if(!r||!r.sortable||!i.some(d=>!!d))return null;const c=d=>{const f=a.current.getLocaleText(d);return typeof f=="function"?f(r):f};return I.jsxs(x.Fragment,{children:[i.includes("asc")&&l!=="asc"?I.jsxs(kr,{onClick:u,"data-value":"asc",children:[I.jsx(Tn,{children:I.jsx(s.slots.columnMenuSortAscendingIcon,{fontSize:"small"})}),I.jsx(oa,{children:c("columnMenuSortAsc")})]}):null,i.includes("desc")&&l!=="desc"?I.jsxs(kr,{onClick:u,"data-value":"desc",children:[I.jsx(Tn,{children:I.jsx(s.slots.columnMenuSortDescendingIcon,{fontSize:"small"})}),I.jsx(oa,{children:c("columnMenuSortDesc")})]}):null,i.includes(null)&&l!=null?I.jsxs(kr,{onClick:u,children:[I.jsx(Tn,{}),I.jsx(oa,{children:a.current.getLocaleText("columnMenuUnsort")})]}):null]})}const Yx=["defaultSlots","defaultSlotProps","slots","slotProps"],qx={columnMenuSortItem:Xx,columnMenuFilterItem:Kx,columnMenuColumnsItem:Wx},Zx={columnMenuSortItem:{displayOrder:10},columnMenuFilterItem:{displayOrder:20},columnMenuColumnsItem:{displayOrder:30}},Qx=x.forwardRef(function(t,r){const{defaultSlots:n,defaultSlotProps:a,slots:o,slotProps:s}=t,l=me(t,Yx),i=Ux(k({},l,{defaultSlots:n,defaultSlotProps:a,slots:o,slotProps:s}));return I.jsx(Vx,k({ref:r},l,{children:i.map(([u,c],d)=>I.jsx(u,k({},c),d))}))}),Jx=x.forwardRef(function(t,r){return I.jsx(Qx,k({},t,{ref:r,defaultSlots:qx,defaultSlotProps:Zx}))}),em=["className"],tm=e=>{const{classes:t}=e;return Le({root:["panelContent"]},We,t)},rm=Ft("div",{name:"MuiDataGrid",slot:"PanelContent",overridesResolver:(e,t)=>t.panelContent})({display:"flex",flexDirection:"column",overflow:"auto",flex:"1 1",maxHeight:400});function x0(e){const{className:t}=e,r=me(e,em),n=ke(),a=tm(n);return I.jsx(rm,k({className:Ue(t,a.root),ownerState:n},r))}const nm=["className"],am=e=>{const{classes:t}=e;return Le({root:["panelFooter"]},We,t)},om=Ft("div",{name:"MuiDataGrid",slot:"PanelFooter",overridesResolver:(e,t)=>t.panelFooter})(({theme:e})=>({padding:e.spacing(.5),display:"flex",justifyContent:"space-between"}));function m0(e){const{className:t}=e,r=me(e,nm),n=ke(),a=am(n);return I.jsx(om,k({className:Ue(t,a.root),ownerState:n},r))}const sm=["className"],lm=e=>{const{classes:t}=e;return Le({root:["panelHeader"]},We,t)},im=Ft("div",{name:"MuiDataGrid",slot:"PanelHeader",overridesResolver:(e,t)=>t.panelHeader})(({theme:e})=>({padding:e.spacing(1)}));function cm(e){const{className:t}=e,r=me(e,sm),n=ke(),a=lm(n);return I.jsx(im,k({className:Ue(t,a.root),ownerState:n},r))}const um=["className","slotProps"],dm=e=>{const{classes:t}=e;return Le({root:["panelWrapper"]},We,t)},fm=je("div",{name:"MuiDataGrid",slot:"PanelWrapper",overridesResolver:(e,t)=>t.panelWrapper})({display:"flex",flexDirection:"column",flex:1,"&:focus":{outline:0}}),hm=()=>!0,v0=x.forwardRef(function(t,r){const{className:n,slotProps:a={}}=t,o=me(t,um),s=ke(),l=dm(s);return I.jsx(_f,k({open:!0,disableEnforceFocus:!0,isEnabled:hm},a.TrapFocus,{children:I.jsx(fm,k({ref:r,tabIndex:-1,className:Ue(n,l.root),ownerState:s},o))}))}),gm=!1,pm=["sort","searchPredicate","autoFocusSearchField","disableHideAllButton","disableShowAllButton","getTogglableColumns"],xm=e=>{const{classes:t}=e;return Le({root:["columnsPanel"],columnsPanelRow:["columnsPanelRow"]},We,t)},mm=je("div",{name:"MuiDataGrid",slot:"ColumnsPanel",overridesResolver:(e,t)=>t.columnsPanel})({padding:"8px 0px 8px 8px"}),vm=je("div",{name:"MuiDataGrid",slot:"ColumnsPanelRow",overridesResolver:(e,t)=>t.columnsPanelRow})(({theme:e})=>({display:"flex",justifyContent:"space-between",padding:"1px 8px 1px 7px",[`& .${Nt.root}`]:{marginRight:e.spacing(.5)}})),wm=je(ln)({justifyContent:"flex-end"}),Yi=new Intl.Collator,Cm=(e,t)=>(e.headerName||e.field).toLowerCase().indexOf(t)>-1;function bm(e){var t,r,n;const a=$e(),o=x.useRef(null),s=Ce(a,Dr),l=Ce(a,Cr),i=ke(),[u,c]=x.useState(""),d=xm(i),{sort:f,searchPredicate:p=Cm,autoFocusSearchField:h=!0,disableHideAllButton:g=!1,disableShowAllButton:m=!1,getTogglableColumns:w}=e,v=me(e,pm),C=x.useMemo(()=>{switch(f){case"asc":return[...s].sort((y,D)=>Yi.compare(y.headerName||y.field,D.headerName||D.field));case"desc":return[...s].sort((y,D)=>-Yi.compare(y.headerName||y.field,D.headerName||D.field));default:return s}},[s,f]),E=y=>{const{name:D}=y.target;a.current.setColumnVisibility(D,l[D]===!1)},R=x.useCallback(y=>{const D=Cr(a),L=k({},D),M=w?w(s):null;return s.forEach(F=>{F.hideable&&(M==null||M.includes(F.field))&&(y?delete L[F.field]:L[F.field]=!1)}),a.current.setColumnVisibilityModel(L)},[a,s,w]),S=x.useCallback(y=>{c(y.target.value)},[]),b=x.useMemo(()=>{const y=w?w(C):null,D=y?C.filter(({field:L})=>y.includes(L)):C;return u?D.filter(L=>p(L,u.toLowerCase())):D},[C,u,p,w]),T=x.useRef(null);x.useEffect(()=>{h?o.current.focus():T.current&&typeof T.current.focus=="function"&&T.current.focus()},[h]);let A=!1;const N=y=>A===!1&&y.hideable!==!1?(A=!0,!0):!1;return I.jsxs(v0,k({},v,{children:[I.jsx(cm,{children:I.jsx(i.slots.baseTextField,k({label:a.current.getLocaleText("columnsPanelTextFieldLabel"),placeholder:a.current.getLocaleText("columnsPanelTextFieldPlaceholder"),inputRef:o,value:u,onChange:S,variant:"standard",fullWidth:!0},(t=i.slotProps)==null?void 0:t.baseTextField))}),I.jsx(x0,{children:I.jsx(mm,{className:d.root,ownerState:i,children:b.map(y=>{var D;return I.jsxs(vm,{className:d.columnsPanelRow,ownerState:i,children:[I.jsx($f,{control:I.jsx(i.slots.baseSwitch,k({disabled:y.hideable===!1,checked:l[y.field]!==!1,onClick:E,name:y.field,size:"small",inputRef:N(y)?T:void 0},(D=i.slotProps)==null?void 0:D.baseSwitch)),label:y.headerName||y.field}),!i.disableColumnReorder&&gm&&I.jsx(wm,{draggable:!0,"aria-label":a.current.getLocaleText("columnsPanelDragIconLabel"),title:a.current.getLocaleText("columnsPanelDragIconLabel"),size:"small",disabled:!0,children:I.jsx(i.slots.columnReorderIcon,{})})]},y.field)})})}),m&&g?null:I.jsxs(m0,{children:[g?I.jsx("span",{}):I.jsx(i.slots.baseButton,k({onClick:()=>R(!1)},(r=i.slotProps)==null?void 0:r.baseButton,{disabled:g,children:a.current.getLocaleText("columnsPanelHideAllButton")})),m?null:I.jsx(i.slots.baseButton,k({onClick:()=>R(!0)},(n=i.slotProps)==null?void 0:n.baseButton,{disabled:m,children:a.current.getLocaleText("columnsPanelShowAllButton")}))]})]}))}const Sm=["children","className","classes"],km=mn("MuiDataGrid",["panel","paper"]),Em=je(bl,{name:"MuiDataGrid",slot:"Panel",overridesResolver:(e,t)=>t.panel})(({theme:e})=>({zIndex:e.zIndex.modal})),Tm=je(ku,{name:"MuiDataGrid",slot:"Paper",overridesResolver:(e,t)=>t.paper})(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,minWidth:300,maxHeight:450,display:"flex"})),ym=x.forwardRef((e,t)=>{const{children:r,className:n}=e,a=me(e,Sm),o=$e(),s=ke(),l=km,[i,u]=x.useState(!1),c=x.useCallback(()=>{o.current.hidePreferences()},[o]),d=x.useCallback(g=>{Uo(g.key)&&o.current.hidePreferences()},[o]),f=x.useMemo(()=>[{name:"flip",enabled:!1},{name:"isPlaced",enabled:!0,phase:"main",fn:()=>{u(!0)},effect:()=>()=>{u(!1)}}],[]),[p,h]=x.useState(null);return x.useEffect(()=>{var g;const m=(g=o.current.rootElementRef)==null||(g=g.current)==null?void 0:g.querySelector(`.${Q.columnHeaders}`);m&&h(m)},[o]),p?I.jsx(Em,k({ref:t,placement:"bottom-start",className:Ue(n,l.panel),ownerState:s,anchorEl:p,modifiers:f},a,{children:I.jsx(Su,{mouseEvent:"onMouseUp",onClickAway:c,children:I.jsx(Tm,{className:l.paper,ownerState:s,elevation:8,onKeyDown:d,children:i&&r})})})):null}),_m=x.forwardRef(function(t,r){var n,a,o;const s=$e(),l=Ce(s,Dr),i=ke(),u=Ce(s,An),c=s.current.unstable_applyPipeProcessors("preferencePanel",null,(n=u.openedPanelValue)!=null?n:_r.filters);return I.jsx(i.slots.panel,k({ref:r,as:i.slots.basePopper,open:l.length>0&&u.open,id:u.panelId,"aria-labelledby":u.labelId},(a=i.slotProps)==null?void 0:a.panel,t,(o=i.slotProps)==null?void 0:o.basePopper,{children:c}))}),Fm=["item","hasMultipleFilters","deleteFilter","applyFilterChanges","multiFilterOperator","showMultiFilterOperators","disableMultiFilterOperator","applyMultiFilterOperatorChanges","focusElementRef","logicOperators","columnsSort","filterColumns","deleteIconProps","logicOperatorInputProps","operatorInputProps","columnInputProps","valueInputProps","children"],Im=["InputComponentProps"],Pm=e=>{const{classes:t}=e;return Le({root:["filterForm"],deleteIcon:["filterFormDeleteIcon"],logicOperatorInput:["filterFormLogicOperatorInput"],columnInput:["filterFormColumnInput"],operatorInput:["filterFormOperatorInput"],valueInput:["filterFormValueInput"]},We,t)},Am=je("div",{name:"MuiDataGrid",slot:"FilterForm",overridesResolver:(e,t)=>t.filterForm})(({theme:e})=>({display:"flex",padding:e.spacing(1)})),Mm=je("div",{name:"MuiDataGrid",slot:"FilterFormDeleteIcon",overridesResolver:(e,t)=>t.filterFormDeleteIcon})(({theme:e})=>({flexShrink:0,justifyContent:"flex-end",marginRight:e.spacing(.5),marginBottom:e.spacing(.2)})),Dm=je("div",{name:"MuiDataGrid",slot:"FilterFormLogicOperatorInput",overridesResolver:(e,t)=>t.filterFormLogicOperatorInput})({minWidth:55,marginRight:5,justifyContent:"end"}),Om=je("div",{name:"MuiDataGrid",slot:"FilterFormColumnInput",overridesResolver:(e,t)=>t.filterFormColumnInput})({width:150}),Rm=je("div",{name:"MuiDataGrid",slot:"FilterFormOperatorInput",overridesResolver:(e,t)=>t.filterFormOperatorInput})({width:120}),Lm=je("div",{name:"MuiDataGrid",slot:"FilterFormValueInput",overridesResolver:(e,t)=>t.filterFormValueInput})({width:190}),Nm=e=>{switch(e){case rr.And:return"filterPanelOperatorAnd";case rr.Or:return"filterPanelOperatorOr";default:throw new Error("MUI: Invalid `logicOperator` property in the `GridFilterPanel`.")}},Ta=e=>e.headerName||e.field,qi=new Intl.Collator,Bm=x.forwardRef(function(t,r){var n,a,o,s,l,i,u,c,d,f;const{item:p,hasMultipleFilters:h,deleteFilter:g,applyFilterChanges:m,multiFilterOperator:w,showMultiFilterOperators:v,disableMultiFilterOperator:C,applyMultiFilterOperatorChanges:E,focusElementRef:R,logicOperators:S=[rr.And,rr.Or],columnsSort:b,filterColumns:T,deleteIconProps:A={},logicOperatorInputProps:N={},operatorInputProps:y={},columnInputProps:D={},valueInputProps:L={}}=t,M=me(t,Fm),F=$e(),B=Ce(F,Ou),H=Ce(F,It),G=tt(),_=tt(),Z=tt(),ee=tt(),P=ke(),q=Pm(P),K=x.useRef(null),X=x.useRef(null),te=h&&S.length>0,le=((n=P.slotProps)==null?void 0:n.baseFormControl)||{},de=(o=(((a=P.slotProps)==null?void 0:a.baseSelect)||{}).native)!=null?o:!0,ie=((s=P.slotProps)==null?void 0:s.baseInputLabel)||{},xe=((l=P.slotProps)==null?void 0:l.baseSelectOption)||{},{InputComponentProps:z}=L,Pe=me(L,Im),_e=x.useMemo(()=>{if(T===void 0||typeof T!="function")return B;const ye=T({field:p.field,columns:B,currentFilters:(H==null?void 0:H.items)||[]});return B.filter(he=>ye.includes(he.field))},[T,H==null?void 0:H.items,B,p.field]),Ie=x.useMemo(()=>{switch(b){case"asc":return _e.sort((ye,he)=>qi.compare(Ta(ye),Ta(he)));case"desc":return _e.sort((ye,he)=>-qi.compare(Ta(ye),Ta(he)));default:return _e}},[_e,b]),ce=p.field?F.current.getColumn(p.field):null,ne=x.useMemo(()=>{var ye;return!p.operator||!ce?null:(ye=ce.filterOperators)==null?void 0:ye.find(he=>he.value===p.operator)},[p,ce]),be=x.useCallback(ye=>{const he=ye.target.value,ve=F.current.getColumn(he);if(ve.field===ce.field)return;const Ee=ve.filterOperators.find(Je=>Je.value===p.operator)||ve.filterOperators[0],Ne=!Ee.InputComponent||Ee.InputComponent!==(ne==null?void 0:ne.InputComponent)||ve.type!==ce.type;m(k({},p,{field:he,operator:Ee.value,value:Ne?void 0:p.value}))},[F,m,p,ce,ne]),Ae=x.useCallback(ye=>{const he=ye.target.value,ve=ce==null?void 0:ce.filterOperators.find(Ne=>Ne.value===he),Ee=!(ve!=null&&ve.InputComponent)||(ve==null?void 0:ve.InputComponent)!==(ne==null?void 0:ne.InputComponent);m(k({},p,{operator:he,value:Ee?void 0:p.value}))},[m,p,ce,ne]),Me=x.useCallback(ye=>{const he=ye.target.value===rr.And.toString()?rr.And:rr.Or;E(he)},[E]),Oe=()=>{P.disableMultipleColumnsFiltering?p.value===void 0?g(p):m(k({},p,{value:void 0})):g(p)};return x.useImperativeHandle(R,()=>({focus:()=>{if(ne!=null&&ne.InputComponent){var ye;K==null||(ye=K.current)==null||ye.focus()}else X.current.focus()}}),[ne]),I.jsxs(Am,k({ref:r,className:q.root,"data-id":p.id,ownerState:P},M,{children:[I.jsx(Mm,k({variant:"standard",as:P.slots.baseFormControl},le,A,{className:Ue(q.deleteIcon,le.className,A.className),ownerState:P,children:I.jsx(P.slots.baseIconButton,k({"aria-label":F.current.getLocaleText("filterPanelDeleteIconLabel"),title:F.current.getLocaleText("filterPanelDeleteIconLabel"),onClick:Oe,size:"small"},(i=P.slotProps)==null?void 0:i.baseIconButton,{children:I.jsx(P.slots.filterPanelDeleteIcon,{fontSize:"small"})}))})),I.jsx(Dm,k({variant:"standard",as:P.slots.baseFormControl},le,N,{sx:k({display:te?"flex":"none",visibility:v?"visible":"hidden"},le.sx||{},N.sx||{}),className:Ue(q.logicOperatorInput,le.className,N.className),ownerState:P,children:I.jsx(P.slots.baseSelect,k({inputProps:{"aria-label":F.current.getLocaleText("filterPanelLogicOperator")},value:w,onChange:Me,disabled:!!C||S.length===1,native:de},(u=P.slotProps)==null?void 0:u.baseSelect,{children:S.map(ye=>x.createElement(P.slots.baseSelectOption,k({},xe,{native:de,key:ye.toString(),value:ye.toString()}),F.current.getLocaleText(Nm(ye))))}))})),I.jsxs(Om,k({variant:"standard",as:P.slots.baseFormControl},le,D,{className:Ue(q.columnInput,le.className,D.className),ownerState:P,children:[I.jsx(P.slots.baseInputLabel,k({},ie,{htmlFor:G,id:_,children:F.current.getLocaleText("filterPanelColumns")})),I.jsx(P.slots.baseSelect,k({labelId:_,id:G,label:F.current.getLocaleText("filterPanelColumns"),value:p.field||"",onChange:be,native:de},(c=P.slotProps)==null?void 0:c.baseSelect,{children:Ie.map(ye=>x.createElement(P.slots.baseSelectOption,k({},xe,{native:de,key:ye.field,value:ye.field}),Ta(ye)))}))]})),I.jsxs(Rm,k({variant:"standard",as:P.slots.baseFormControl},le,y,{className:Ue(q.operatorInput,le.className,y.className),ownerState:P,children:[I.jsx(P.slots.baseInputLabel,k({},ie,{htmlFor:Z,id:ee,children:F.current.getLocaleText("filterPanelOperator")})),I.jsx(P.slots.baseSelect,k({labelId:ee,label:F.current.getLocaleText("filterPanelOperator"),id:Z,value:p.operator,onChange:Ae,native:de,inputRef:X},(d=P.slotProps)==null?void 0:d.baseSelect,{children:ce==null||(f=ce.filterOperators)==null?void 0:f.map(ye=>x.createElement(P.slots.baseSelectOption,k({},xe,{native:de,key:ye.value,value:ye.value}),ye.label||F.current.getLocaleText(`filterOperator${et(ye.value)}`)))}))]})),I.jsx(Lm,k({variant:"standard",as:P.slots.baseFormControl},le,Pe,{className:Ue(q.valueInput,le.className,Pe.className),ownerState:P,children:ne!=null&&ne.InputComponent?I.jsx(ne.InputComponent,k({apiRef:F,item:p,applyValue:m,focusElementRef:K},ne.InputComponentProps,z)):null}))]}))});class Vl{constructor(){this.currentId=0,this.clear=()=>{this.currentId!==0&&(clearTimeout(this.currentId),this.currentId=0)},this.disposeEffect=()=>this.clear}static create(){return new Vl}start(t,r){this.clear(),this.currentId=setTimeout(r,t)}}function Gl(){const e=_l(Vl.create).current;return Mu(e.disposeEffect),e}const Hm=["item","applyValue","type","apiRef","focusElementRef","tabIndex","disabled","isFilterActive","clearButton","InputProps"];function Mr(e){var t,r;const{item:n,applyValue:a,type:o,apiRef:s,focusElementRef:l,tabIndex:i,disabled:u,clearButton:c,InputProps:d}=e,f=me(e,Hm),p=Gl(),[h,g]=x.useState((t=n.value)!=null?t:""),[m,w]=x.useState(!1),v=tt(),C=ke(),E=x.useCallback(R=>{const{value:S}=R.target;g(String(S)),w(!0),p.start(C.filterDebounceMs,()=>{const b=k({},n,{value:S,fromInput:v});a(b),w(!1)})},[v,a,n,C.filterDebounceMs,p]);return x.useEffect(()=>{if(n.fromInput!==v||n.value===void 0){var S;g(String((S=n.value)!=null?S:""))}},[v,n]),I.jsx(C.slots.baseTextField,k({id:v,label:s.current.getLocaleText("filterPanelInputLabel"),placeholder:s.current.getLocaleText("filterPanelInputPlaceholder"),value:h,onChange:E,variant:"standard",type:o||"text",InputProps:k({},m||c?{endAdornment:m?I.jsx(C.slots.loadIcon,{fontSize:"small",color:"action"}):c}:{},{disabled:u},d,{inputProps:k({tabIndex:i},d==null?void 0:d.inputProps)}),InputLabelProps:{shrink:!0},inputRef:l},f,(r=C.slotProps)==null?void 0:r.baseTextField))}const $m=["item","applyValue","type","apiRef","focusElementRef","InputProps","isFilterActive","clearButton","tabIndex","disabled"];function Yn(e){var t,r;const{item:n,applyValue:a,type:o,apiRef:s,focusElementRef:l,InputProps:i,clearButton:u,tabIndex:c,disabled:d}=e,f=me(e,$m),p=Gl(),[h,g]=x.useState((t=n.value)!=null?t:""),[m,w]=x.useState(!1),v=tt(),C=ke(),E=x.useCallback(R=>{const S=R.target.value;g(String(S)),w(!0),p.start(C.filterDebounceMs,()=>{a(k({},n,{value:S})),w(!1)})},[a,n,C.filterDebounceMs,p]);return x.useEffect(()=>{var R;const S=(R=n.value)!=null?R:"";g(String(S))},[n.value]),I.jsx(C.slots.baseTextField,k({fullWidth:!0,id:v,label:s.current.getLocaleText("filterPanelInputLabel"),placeholder:s.current.getLocaleText("filterPanelInputPlaceholder"),value:h,onChange:E,variant:"standard",type:o||"text",InputLabelProps:{shrink:!0},inputRef:l,InputProps:k({},m||u?{endAdornment:m?I.jsx(C.slots.loadIcon,{fontSize:"small",color:"action"}):u}:{},{disabled:d},i,{inputProps:k({max:o==="datetime-local"?"9999-12-31T23:59":"9999-12-31",tabIndex:c},i==null?void 0:i.inputProps)})},f,(r=C.slotProps)==null?void 0:r.baseTextField))}const Vm=["item","applyValue","type","apiRef","focusElementRef","getOptionLabel","getOptionValue","placeholder","tabIndex","label","isFilterActive","clearButton","InputLabelProps"],Gm=({column:{valueOptions:e,field:t},OptionComponent:r,getOptionLabel:n,getOptionValue:a,isSelectNative:o,baseSelectOptionProps:s})=>(typeof e=="function"?["",...e({field:t})]:["",...e||[]]).map(i=>{const u=a(i),c=n(i);return x.createElement(r,k({},s,{native:o,key:u,value:u}),c)}),Um=je("div")({display:"flex",alignItems:"flex-end",width:"100%","& button":{margin:"auto 0px 5px 5px"}});function Zi(e){var t,r,n,a,o,s,l,i;const{item:u,applyValue:c,type:d,apiRef:f,focusElementRef:p,getOptionLabel:h,getOptionValue:g,placeholder:m,tabIndex:w,label:v,clearButton:C}=e,E=me(e,Vm),[R,S]=x.useState((t=u.value)!=null?t:""),b=tt(),T=tt(),A=ke(),N=(r=(n=A.slotProps)==null||(n=n.baseSelect)==null?void 0:n.native)!=null?r:!0;let y=null;if(u.field){const H=f.current.getColumn(u.field);Fn(H)&&(y=H)}const D=g||((a=y)==null?void 0:a.getOptionValue),L=h||((o=y)==null?void 0:o.getOptionLabel),M=x.useMemo(()=>{if(y)return typeof y.valueOptions=="function"?y.valueOptions({field:y.field}):y.valueOptions},[y]),F=x.useCallback(H=>{let G=H.target.value;G=Zs(G,M,D),S(String(G)),c(k({},u,{value:G}))},[M,D,c,u]);if(x.useEffect(()=>{var H;let G;if(M!==void 0){if(G=Zs(u.value,M,D),G!==u.value){c(k({},u,{value:G}));return}}else G=u.value;G=(H=G)!=null?H:"",S(String(G))},[u,M,c,D]),!Fn(y)||!Fn(y))return null;const B=v??f.current.getLocaleText("filterPanelInputLabel");return I.jsxs(Um,{children:[I.jsxs(A.slots.baseFormControl,{children:[I.jsx(A.slots.baseInputLabel,k({},(s=A.slotProps)==null?void 0:s.baseInputLabel,{id:T,htmlFor:b,shrink:!0,variant:"standard",children:B})),I.jsx(A.slots.baseSelect,k({id:b,label:B,labelId:T,value:R,onChange:F,variant:"standard",type:d||"text",inputProps:{tabIndex:w,ref:p,placeholder:m??f.current.getLocaleText("filterPanelInputPlaceholder")},native:N},E,(l=A.slotProps)==null?void 0:l.baseSelect,{children:Gm({column:y,OptionComponent:A.slots.baseSelectOption,getOptionLabel:L,getOptionValue:D,isSelectNative:N,baseSelectOptionProps:(i=A.slotProps)==null?void 0:i.baseSelectOption})}))]}),C]})}const zm=["item","applyValue","apiRef","focusElementRef","isFilterActive","clearButton","tabIndex","label","InputLabelProps"],jm=je("div")({display:"flex",alignItems:"center",width:"100%","& button":{margin:"auto 0px 5px 5px"}});function Wm(e){var t,r,n,a;const{item:o,applyValue:s,apiRef:l,focusElementRef:i,clearButton:u,tabIndex:c,label:d}=e,f=me(e,zm),[p,h]=x.useState(o.value||""),g=ke(),m=tt(),w=tt(),v=((t=g.slotProps)==null?void 0:t.baseSelect)||{},C=(r=v.native)!=null?r:!0,E=((n=g.slotProps)==null?void 0:n.baseSelectOption)||{},R=x.useCallback(b=>{const T=b.target.value;h(T),s(k({},o,{value:T}))},[s,o]);x.useEffect(()=>{h(o.value||"")},[o.value]);const S=d??l.current.getLocaleText("filterPanelInputLabel");return I.jsxs(jm,{children:[I.jsxs(g.slots.baseFormControl,{fullWidth:!0,children:[I.jsx(g.slots.baseInputLabel,k({},(a=g.slotProps)==null?void 0:a.baseInputLabel,{id:m,shrink:!0,variant:"standard",children:S})),I.jsxs(g.slots.baseSelect,k({labelId:m,id:w,label:S,value:p,onChange:R,variant:"standard",native:C,displayEmpty:!0,inputProps:{ref:i,tabIndex:c}},f,v,{children:[I.jsx(g.slots.baseSelectOption,k({},E,{native:C,value:"",children:l.current.getLocaleText("filterValueAny")})),I.jsx(g.slots.baseSelectOption,k({},E,{native:C,value:"true",children:l.current.getLocaleText("filterValueTrue")})),I.jsx(g.slots.baseSelectOption,k({},E,{native:C,value:"false",children:l.current.getLocaleText("filterValueFalse")}))]}))]}),u]})}const Km=["logicOperators","columnsSort","filterFormProps","getColumnForNewFilter","children","disableAddFilterButton","disableRemoveAllButton"],Qi=e=>({field:e.field,operator:e.filterOperators[0].value,id:Math.round(Math.random()*1e5)}),Xm=x.forwardRef(function(t,r){var n,a;const o=$e(),s=ke(),l=Ce(o,It),i=Ce(o,Ou),u=x.useRef(null),c=x.useRef(null),{logicOperators:d=[rr.And,rr.Or],columnsSort:f,filterFormProps:p,getColumnForNewFilter:h,disableAddFilterButton:g=!1,disableRemoveAllButton:m=!1}=t,w=me(t,Km),v=o.current.upsertFilterItem,C=x.useCallback(y=>{o.current.setFilterLogicOperator(y)},[o]),E=x.useCallback(()=>{let y;if(h&&typeof h=="function"){const D=h({currentFilters:(l==null?void 0:l.items)||[],columns:i});if(D===null)return null;y=i.find(({field:L})=>L===D)}else y=i.find(D=>{var L;return(L=D.filterOperators)==null?void 0:L.length});return y?Qi(y):null},[l==null?void 0:l.items,i,h]),R=x.useCallback(()=>{if(h===void 0||typeof h!="function")return E();const y=l.items.length?l.items:[E()].filter(Boolean),D=h({currentFilters:y,columns:i});if(D===null)return null;const L=i.find(({field:M})=>M===D);return L?Qi(L):null},[l.items,i,h,E]),S=x.useMemo(()=>l.items.length?l.items:(c.current||(c.current=E()),c.current?[c.current]:[]),[l.items,E]),b=S.length>1,T=()=>{const y=R();y&&o.current.upsertFilterItems([...S,y])},A=x.useCallback(y=>{const D=S.length===1;o.current.deleteFilterItem(y),D&&o.current.hideFilterPanel()},[o,S.length]),N=()=>{S.length===1&&S[0].value===void 0&&(o.current.deleteFilterItem(S[0]),o.current.hideFilterPanel()),o.current.setFilterModel(k({},l,{items:[]}))};return x.useEffect(()=>{d.length>0&&l.logicOperator&&!d.includes(l.logicOperator)&&C(d[0])},[d,C,l.logicOperator]),x.useEffect(()=>{S.length>0&&u.current.focus()},[S.length]),I.jsxs(v0,k({ref:r},w,{children:[I.jsx(x0,{children:S.map((y,D)=>I.jsx(Bm,k({item:y,applyFilterChanges:v,deleteFilter:A,hasMultipleFilters:b,showMultiFilterOperators:D>0,multiFilterOperator:l.logicOperator,disableMultiFilterOperator:D!==1,applyMultiFilterOperatorChanges:C,focusElementRef:D===S.length-1?u:null,logicOperators:d,columnsSort:f},p),y.id==null?D:y.id))}),!s.disableMultipleColumnsFiltering&&!(g&&m)?I.jsxs(m0,{children:[g?I.jsx("span",{}):I.jsx(s.slots.baseButton,k({onClick:T,startIcon:I.jsx(s.slots.filterPanelAddIcon,{})},(n=s.slotProps)==null?void 0:n.baseButton,{children:o.current.getLocaleText("filterPanelAddFilter")})),m?null:I.jsx(s.slots.baseButton,k({onClick:N,startIcon:I.jsx(s.slots.filterPanelRemoveAllIcon,{})},(a=s.slotProps)==null?void 0:a.baseButton,{children:o.current.getLocaleText("filterPanelRemoveAll")}))]}):null]}))}),Ym=["item","applyValue","type","apiRef","focusElementRef","color","error","helperText","size","variant"];function w0(e){const{item:t,applyValue:r,type:n,apiRef:a,focusElementRef:o,color:s,error:l,helperText:i,size:u,variant:c}=e,d=me(e,Ym),f={color:s,error:l,helperText:i,size:u,variant:c},[p,h]=x.useState(t.value||[]),g=tt(),m=ke();x.useEffect(()=>{var v;const C=(v=t.value)!=null?v:[];h(C.map(String))},[t.value]);const w=x.useCallback((v,C)=>{h(C.map(String)),r(k({},t,{value:[...C]}))},[r,t]);return I.jsx(Tu,k({multiple:!0,freeSolo:!0,options:[],filterOptions:(v,C)=>{const{inputValue:E}=C;return E==null||E===""?[]:[E]},id:g,value:p,onChange:w,renderTags:(v,C)=>v.map((E,R)=>I.jsx(m.slots.baseChip,k({variant:"outlined",size:"small",label:E},C({index:R})))),renderInput:v=>{var C;return I.jsx(m.slots.baseTextField,k({},v,{label:a.current.getLocaleText("filterPanelInputLabel"),placeholder:a.current.getLocaleText("filterPanelInputPlaceholder"),InputLabelProps:k({},v.InputLabelProps,{shrink:!0}),inputRef:o,type:n||"text"},f,(C=m.slotProps)==null?void 0:C.baseTextField))}},d))}const qm=["item","applyValue","type","apiRef","focusElementRef","color","error","helperText","size","variant","getOptionLabel","getOptionValue"],Zm=Ff();function Qm(e){var t,r;const{item:n,applyValue:a,apiRef:o,focusElementRef:s,color:l,error:i,helperText:u,size:c,variant:d="standard",getOptionLabel:f,getOptionValue:p}=e,h=me(e,qm),g={color:l,error:i,helperText:u,size:c,variant:d},m=tt(),w=ke();let v=null;if(n.field){const N=o.current.getColumn(n.field);Fn(N)&&(v=N)}const C=p||((t=v)==null?void 0:t.getOptionValue),E=f||((r=v)==null?void 0:r.getOptionLabel),R=x.useCallback((N,y)=>C(N)===C(y),[C]),S=x.useMemo(()=>{var N;return(N=v)!=null&&N.valueOptions?typeof v.valueOptions=="function"?v.valueOptions({field:v.field}):v.valueOptions:[]},[v]),b=x.useMemo(()=>S==null?void 0:S.map(C),[S,C]),T=x.useMemo(()=>Array.isArray(n.value)?S!==void 0?n.value.map(y=>b==null?void 0:b.findIndex(D=>D===y)).filter(y=>y>=0).map(y=>S[y]):n.value:[],[n.value,S,b]);x.useEffect(()=>{(!Array.isArray(n.value)||T.length!==n.value.length)&&a(k({},n,{value:T.map(C)}))},[n,T,a,C]);const A=x.useCallback((N,y)=>{a(k({},n,{value:y.map(C)}))},[a,n,C]);return I.jsx(Tu,k({multiple:!0,options:S,isOptionEqualToValue:R,filterOptions:Zm,id:m,value:T,onChange:A,getOptionLabel:E,renderTags:(N,y)=>N.map((D,L)=>I.jsx(w.slots.baseChip,k({variant:"outlined",size:"small",label:E(D)},y({index:L})))),renderInput:N=>{var y;return I.jsx(w.slots.baseTextField,k({},N,{label:o.current.getLocaleText("filterPanelInputLabel"),placeholder:o.current.getLocaleText("filterPanelInputPlaceholder"),InputLabelProps:k({},N.InputLabelProps,{shrink:!0}),inputRef:s,type:"singleSelect"},g,(y=w.slotProps)==null?void 0:y.baseTextField))}},h))}const Jm=["onClick"],ev=x.forwardRef(function(t,r){var n;const{onClick:a}=t,o=me(t,Jm),s=tt(),l=tt(),i=$e(),u=ke(),c=Ce(i,An),d=p=>{c.open&&c.openedPanelValue===_r.columns?i.current.hidePreferences():i.current.showPreferences(_r.columns,l,s),a==null||a(p)};if(u.disableColumnSelector)return null;const f=c.open&&c.panelId===l;return I.jsx(u.slots.baseButton,k({ref:r,id:s,size:"small","aria-label":i.current.getLocaleText("toolbarColumnsLabel"),"aria-haspopup":"menu","aria-expanded":f,"aria-controls":f?l:void 0,startIcon:I.jsx(u.slots.columnSelectorIcon,{})},o,{onClick:d},(n=u.slotProps)==null?void 0:n.baseButton,{children:i.current.getLocaleText("toolbarColumns")}))}),tv=["onClick"],rv=x.forwardRef(function(t,r){var n;const{onClick:a}=t,o=me(t,tv),s=$e(),l=ke(),i=Ce(s,Uu),u=tt(),c=tt(),[d,f]=x.useState(!1),p=x.useRef(null),h=qr(r,p),g=[{icon:I.jsx(l.slots.densityCompactIcon,{}),label:s.current.getLocaleText("toolbarDensityCompact"),value:"compact"},{icon:I.jsx(l.slots.densityStandardIcon,{}),label:s.current.getLocaleText("toolbarDensityStandard"),value:"standard"},{icon:I.jsx(l.slots.densityComfortableIcon,{}),label:s.current.getLocaleText("toolbarDensityComfortable"),value:"comfortable"}],m=x.useMemo(()=>{switch(i){case"compact":return I.jsx(l.slots.densityCompactIcon,{});case"comfortable":return I.jsx(l.slots.densityComfortableIcon,{});default:return I.jsx(l.slots.densityStandardIcon,{})}},[i,l]),w=S=>{f(b=>!b),a==null||a(S)},v=()=>{f(!1)},C=S=>{s.current.setDensity(S),f(!1)},E=S=>{vs(S.key)&&S.preventDefault(),Ll(S.key)&&f(!1)};if(l.disableDensitySelector)return null;const R=g.map((S,b)=>I.jsxs(kr,{onClick:()=>C(S.value),selected:S.value===i,children:[I.jsx(Tn,{children:S.icon}),S.label]},b));return I.jsxs(x.Fragment,{children:[I.jsx(l.slots.baseButton,k({ref:h,size:"small",startIcon:m,"aria-label":s.current.getLocaleText("toolbarDensityLabel"),"aria-haspopup":"menu","aria-expanded":d,"aria-controls":d?c:void 0,id:u},o,{onClick:w},(n=l.slotProps)==null?void 0:n.baseButton,{children:s.current.getLocaleText("toolbarDensity")})),I.jsx(ws,{open:d,target:p.current,onClose:v,position:"bottom-start",children:I.jsx(is,{id:c,className:Q.menuList,"aria-labelledby":u,onKeyDown:E,autoFocusItem:d,children:R})})]})}),nv=["componentsProps"],av=e=>{const{classes:t}=e;return Le({root:["toolbarFilterList"]},We,t)},ov=je("ul",{name:"MuiDataGrid",slot:"ToolbarFilterList",overridesResolver:(e,t)=>t.toolbarFilterList})(({theme:e})=>({margin:e.spacing(1,1,.5),padding:e.spacing(0,1)})),sv=x.forwardRef(function(t,r){var n,a;const{componentsProps:o={}}=t,s=me(t,nv),l=o.button||{},i=$e(),u=ke(),c=Ce(i,Vu),d=Ce(i,Bn),f=Ce(i,An),p=av(u),h=tt(),g=tt(),m=x.useMemo(()=>{if(f.open)return i.current.getLocaleText("toolbarFiltersTooltipHide");if(c.length===0)return i.current.getLocaleText("toolbarFiltersTooltipShow");const C=R=>d[R.field].filterOperators.find(S=>S.value===R.operator).label||i.current.getLocaleText(`filterOperator${et(R.operator)}`).toString(),E=R=>{const{getValueAsString:S}=d[R.field].filterOperators.find(b=>b.value===R.operator);return S?S(R.value):R.value};return I.jsxs("div",{children:[i.current.getLocaleText("toolbarFiltersTooltipActive")(c.length),I.jsx(ov,{className:p.root,ownerState:u,children:c.map((R,S)=>k({},d[R.field]&&I.jsx("li",{children:`${d[R.field].headerName||R.field}
                  ${C(R)}
                  ${R.value!=null?E(R):""}`},S)))})]})},[i,u,f.open,c,d,p]),w=C=>{var E;const{open:R,openedPanelValue:S}=f;R&&S===_r.filters?i.current.hidePreferences():i.current.showPreferences(_r.filters,g,h),(E=l.onClick)==null||E.call(l,C)};if(u.disableColumnFilter)return null;const v=f.open&&f.panelId===g;return I.jsx(u.slots.baseTooltip,k({title:m,enterDelay:1e3},s,(n=u.slotProps)==null?void 0:n.baseTooltip,{children:I.jsx(u.slots.baseButton,k({ref:r,id:h,size:"small","aria-label":i.current.getLocaleText("toolbarFiltersLabel"),"aria-controls":v?g:void 0,"aria-expanded":v,"aria-haspopup":!0,startIcon:I.jsx(El,{badgeContent:c.length,color:"primary",children:I.jsx(u.slots.openFilterButtonIcon,{})})},l,{onClick:w},(a=u.slotProps)==null?void 0:a.baseButton,{children:i.current.getLocaleText("toolbarFilters")}))}))}),lv=["children","onClick"],iv=x.forwardRef(function(t,r){var n;const{children:a,onClick:o}=t,s=me(t,lv),l=$e(),i=ke(),u=tt(),c=tt(),[d,f]=x.useState(!1),p=x.useRef(null),h=qr(r,p),g=v=>{f(C=>!C),o==null||o(v)},m=()=>f(!1),w=v=>{vs(v.key)&&v.preventDefault(),Ll(v.key)&&m()};return a==null?null:I.jsxs(x.Fragment,{children:[I.jsx(i.slots.baseButton,k({ref:h,size:"small",startIcon:I.jsx(i.slots.exportIcon,{}),"aria-expanded":d,"aria-label":l.current.getLocaleText("toolbarExportLabel"),"aria-haspopup":"menu","aria-controls":d?c:void 0,id:u},s,{onClick:g},(n=i.slotProps)==null?void 0:n.baseButton,{children:l.current.getLocaleText("toolbarExport")})),I.jsx(ws,{open:d,target:p.current,onClose:m,position:"bottom-start",children:I.jsx(is,{id:c,className:Q.menuList,"aria-labelledby":u,onKeyDown:w,autoFocusItem:d,children:x.Children.map(a,v=>x.isValidElement(v)?x.cloneElement(v,{hideMenu:m}):v)})})]})}),cv=["hideMenu","options"],uv=["hideMenu","options"],dv=["csvOptions","printOptions","excelOptions"];function fv(e){const t=$e(),{hideMenu:r,options:n}=e,a=me(e,cv);return I.jsx(kr,k({onClick:()=>{t.current.exportDataAsCsv(n),r==null||r()}},a,{children:t.current.getLocaleText("toolbarExportCSV")}))}function hv(e){const t=$e(),{hideMenu:r,options:n}=e,a=me(e,uv);return I.jsx(kr,k({onClick:()=>{t.current.exportDataAsPrint(n),r==null||r()}},a,{children:t.current.getLocaleText("toolbarExportPrint")}))}const gv=x.forwardRef(function(t,r){const{csvOptions:n={},printOptions:a={},excelOptions:o}=t,s=me(t,dv),i=$e().current.unstable_applyPipeProcessors("exportMenu",[],{excelOptions:o,csvOptions:n,printOptions:a}).sort((u,c)=>u.componentName>c.componentName?1:-1);return i.length===0?null:I.jsx(iv,k({},s,{ref:r,children:i.map((u,c)=>x.cloneElement(u.component,{key:c}))}))}),pv=["quickFilterParser","quickFilterFormatter","debounceMs"],xv=je(Sl,{name:"MuiDataGrid",slot:"ToolbarQuickFilter",overridesResolver:(e,t)=>t.toolbarQuickFilter})(({theme:e})=>({width:"auto",paddingBottom:e.spacing(.5),"& input":{marginLeft:e.spacing(.5)},"& .MuiInput-underline:before":{borderBottom:`1px solid ${(e.vars||e).palette.divider}`},"& input[type=search]::-ms-clear,\n& input[type=search]::-ms-reveal":{display:"none",width:0,height:0},'& input[type="search"]::-webkit-search-decoration,\n  & input[type="search"]::-webkit-search-cancel-button,\n  & input[type="search"]::-webkit-search-results-button,\n  & input[type="search"]::-webkit-search-results-decoration':{display:"none"}})),mv=e=>e.split(" ").filter(t=>t!==""),vv=e=>e.join(" ");function wv(e){var t,r;const n=$e(),a=ke(),o=Ce(n,Ng),{quickFilterParser:s=mv,quickFilterFormatter:l=vv,debounceMs:i=a.filterDebounceMs}=e,u=me(e,pv),[c,d]=x.useState(()=>l(o??[])),f=x.useRef(o);x.useEffect(()=>{jr(f.current,o)||(f.current=o,d(w=>jr(s(w),o)?w:l(o??[])))},[o,l,s]);const p=x.useCallback(w=>{const v=s(w);f.current=v,n.current.setQuickFilterValues(v)},[n,s]),h=x.useMemo(()=>kl(p,i),[p,i]),g=x.useCallback(w=>{const v=w.target.value;d(v),h(v)},[h]),m=x.useCallback(()=>{d(""),p("")},[p]);return I.jsx(xv,k({as:a.slots.baseTextField,ownerState:a,variant:"standard",value:c,onChange:g,placeholder:n.current.getLocaleText("toolbarQuickFilterPlaceholder"),"aria-label":n.current.getLocaleText("toolbarQuickFilterLabel"),type:"search"},u,{InputProps:k({startAdornment:I.jsx(a.slots.quickFilterIcon,{fontSize:"small"}),endAdornment:I.jsx(a.slots.baseIconButton,k({"aria-label":n.current.getLocaleText("toolbarQuickFilterDeleteIconLabel"),size:"small",sx:{visibility:c?"visible":"hidden"},onClick:m},(t=a.slotProps)==null?void 0:t.baseIconButton,{children:I.jsx(a.slots.quickFilterClearIcon,{fontSize:"small"})}))},u.InputProps)},(r=a.slotProps)==null?void 0:r.baseTextField))}const Cv=["className","csvOptions","printOptions","excelOptions","showQuickFilter","quickFilterProps"],bv=x.forwardRef(function(t,r){const{csvOptions:n,printOptions:a,excelOptions:o,showQuickFilter:s=!1,quickFilterProps:l={}}=t,i=me(t,Cv),u=ke();return u.disableColumnFilter&&u.disableColumnSelector&&u.disableDensitySelector&&!s?null:I.jsxs(Ju,k({ref:r},i,{children:[I.jsx(ev,{}),I.jsx(sv,{}),I.jsx(rv,{}),I.jsx(gv,{csvOptions:n,printOptions:a,excelOptions:o}),I.jsx(gn,{sx:{flex:1}}),s&&I.jsx(wv,k({},l))]}))}),Sv=["className","selectedRowCount"],kv=e=>{const{classes:t}=e;return Le({root:["selectedRowCount"]},We,t)},Ev=Ft("div",{name:"MuiDataGrid",slot:"SelectedRowCount",overridesResolver:(e,t)=>t.selectedRowCount})(({theme:e})=>({alignItems:"center",display:"flex",margin:e.spacing(0,2),visibility:"hidden",width:0,height:0,[e.breakpoints.up("sm")]:{visibility:"visible",width:"auto",height:"auto"}})),Tv=x.forwardRef(function(t,r){const{className:n,selectedRowCount:a}=t,o=me(t,Sv),s=$e(),l=ke(),i=kv(l),u=s.current.getLocaleText("footerRowSelected")(a);return I.jsx(Ev,k({ref:r,className:Ue(i.root,n),ownerState:l},o,{children:u}))}),yv=x.forwardRef(function(t,r){var n,a;const o=$e(),s=ke(),l=Ce(o,Ig),i=Ce(o,Jp),u=Ce(o,gs),c=!s.hideFooterSelectedRowCount&&i>0?I.jsx(Tv,{selectedRowCount:i}):I.jsx("div",{}),d=!s.hideFooterRowCount&&!s.pagination?I.jsx(s.slots.footerRowCount,k({},(n=s.slotProps)==null?void 0:n.footerRowCount,{rowCount:l,visibleRowCount:u})):null,f=s.pagination&&!s.hideFooterPagination&&s.slots.pagination&&I.jsx(s.slots.pagination,k({},(a=s.slotProps)==null?void 0:a.pagination));return I.jsxs(lp,k({ref:r},t,{children:[c,d,f]}))});function _v(){var e,t;const r=ke();return I.jsxs(x.Fragment,{children:[I.jsx(r.slots.preferencesPanel,k({},(e=r.slotProps)==null?void 0:e.preferencesPanel)),r.slots.toolbar&&I.jsx(r.slots.toolbar,k({},(t=r.slotProps)==null?void 0:t.toolbar))]})}const Fv=x.forwardRef(function(t,r){return I.jsx(Nl,k({ref:r},t,{children:I.jsx(Gf,{})}))}),Iv=x.forwardRef(function(t,r){const a=$e().current.getLocaleText("noRowsLabel");return I.jsx(Nl,k({ref:r},t,{children:a}))}),Pv=je(ng)(({theme:e})=>({[`& .${yn.selectLabel}`]:{display:"none",[e.breakpoints.up("sm")]:{display:"block"}},[`& .${yn.input}`]:{display:"none",[e.breakpoints.up("sm")]:{display:"inline-flex"}}})),Av=x.forwardRef(function(t,r){const n=$e(),a=ke(),o=Ce(n,fr),s=Ce(n,gs),l=x.useMemo(()=>{var p,h;return(p=(h=a.rowCount)!=null?h:s)!=null?p:0},[a.rowCount,s]),i=x.useMemo(()=>Math.floor(l/(o.pageSize||1)),[l,o.pageSize]),u=x.useCallback(p=>{const h=Number(p.target.value);n.current.setPageSize(h)},[n]),c=x.useCallback((p,h)=>{n.current.setPage(h)},[n]),f=(p=>{for(let h=0;h<a.pageSizeOptions.length;h+=1){const g=a.pageSizeOptions[h];if(typeof g=="number"){if(g===p)return!0}else if(g.value===p)return!0}return!1})(o.pageSize)?a.pageSizeOptions:[];return I.jsx(Pv,k({ref:r,component:"div",count:l,page:o.page<=i?o.page:i,rowsPerPageOptions:f,rowsPerPage:o.pageSize,onPageChange:c,onRowsPerPageChange:u},n.current.getLocaleText("MuiTablePagination"),t))}),Mv=["className","rowCount","visibleRowCount"],Dv=e=>{const{classes:t}=e;return Le({root:["rowCount"]},We,t)},Ov=Ft("div",{name:"MuiDataGrid",slot:"RowCount",overridesResolver:(e,t)=>t.rowCount})(({theme:e})=>({alignItems:"center",display:"flex",margin:e.spacing(0,2)})),Rv=x.forwardRef(function(t,r){const{className:n,rowCount:a,visibleRowCount:o}=t,s=me(t,Mv),l=$e(),i=ke(),u=Dv(i);if(a===0)return null;const c=o<a?l.current.getLocaleText("footerTotalVisibleRows")(o,a):a.toLocaleString();return I.jsxs(Ov,k({ref:r,className:Ue(u.root,n),ownerState:i},s,{children:[l.current.getLocaleText("footerTotalRows")," ",c]}))}),Wo=(e,t)=>{let r,n;return t.pagination&&t.paginationMode==="client"?(n=Hl(e),r=Qp(e)):(r=wn(e),r.length===0?n=null:n={firstRowIndex:0,lastRowIndex:r.length-1}),{rows:r,range:n}},Hn=(e,t)=>{const r=Wo(e,t);return x.useMemo(()=>({rows:r.rows,range:r.range}),[r.rows,r.range])},Qs={current:null};function so(e){return e.isInternal=!0,e}function Ko(e){return e!==void 0&&e.isInternal===!0}function Lv(e){return so((t,r)=>{const n=e(t,r);return n&&(a=>n(a.value,a.row,r,Qs.current))})}function lo(e){return e.map(t=>k({},t,{getApplyFilterFn:Lv(t.getApplyFilterFnV7),getApplyFilterFnV7:so(t.getApplyFilterFnV7)}))}function C0(e){return so((t,r,n)=>{const a=e(t,r,n);return a&&(o=>a(o.value,o.row,r,n))})}function b0(e){return{current:e.current.getPublicApi()}}const Nv=typeof window>"u"?globalThis:window,S0=Nv[atob("ZXZhbA==")];let ya;const Bv=()=>{if(ya!==void 0)return ya;try{ya=S0("true")}catch{ya=!1}return ya},Js=(e,t)=>{const r=k({},e);if(r.id==null&&(r.id=Math.round(Math.random()*1e5)),r.operator==null){const n=Bn(t)[r.field];r.operator=n&&n.filterOperators[0].value}return r},Hv=Nr(["MUI: The `filterModel` can only contain a single item when the `disableMultipleColumnsFiltering` prop is set to `true`.","If you are using the community version of the `DataGrid`, this prop is always `true`."],"error"),$v=Nr("MUI: The `id` field is required on `filterModel.items` when you use multiple filters.","error"),Vv=Nr("MUI: The `operator` field is required on `filterModel.items`, one or more of your filtering item has no `operator` provided.","error"),k0=(e,t,r)=>{const n=e.items.length>1;let a;n&&t?(Hv(),a=[e.items[0]]):a=e.items;const o=n&&a.some(l=>l.id==null),s=a.some(l=>l.operator==null);return o&&$v(),s&&Vv(),s||o?k({},e,{items:a.map(l=>Js(l,r))}):e.items!==a?k({},e,{items:a}):e},Ji=(e,t,r)=>n=>k({},n,{filterModel:k0(e,t,r)}),un=e=>typeof e=="string"?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e,E0=(e,t)=>{if(!e.field||!e.operator)return null;const r=t.current.getColumn(e.field);if(!r)return null;let n;if(r.valueParser){var a;const p=r.valueParser;n=Array.isArray(e.value)?(a=e.value)==null?void 0:a.map(h=>p(h)):p(e.value)}else n=e.value;const{ignoreDiacritics:o}=t.current.rootProps;o&&(n=un(n));const s=k({},e,{value:n}),l=r.filterOperators;if(!(l!=null&&l.length))throw new Error(`MUI: No filter operators found for column '${r.field}'.`);const i=l.find(p=>p.value===s.operator);if(!i)throw new Error(`MUI: No filter operator found for column '${r.field}' and operator value '${s.operator}'.`);const u=!Ko(i.getApplyFilterFn),c=!Ko(i.getApplyFilterFnV7),d=b0(t);if(i.getApplyFilterFnV7&&!(u&&!c)){const p=i.getApplyFilterFnV7(s,r);return typeof p!="function"?null:{v7:!0,item:s,fn:h=>{let g=t.current.getRowValue(h,r);return o&&(g=un(g)),p(g,h,r,d)}}}const f=i.getApplyFilterFn(s,r);return typeof f!="function"?null:{v7:!1,item:s,fn:p=>{const h=t.current.getCellParams(p,s.field);Qs.current=d,o&&(h.value=un(h.value));const g=f(h);return Qs.current=null,g}}};let ec=1;const Gv=(e,t,r)=>{const{items:n}=e,a=n.map(i=>E0(i,t)).filter(i=>!!i);if(a.length===0)return null;if(r||!Bv())return(i,u)=>{const c={};for(let d=0;d<a.length;d+=1){const f=a[d];(!u||u(f.item.field))&&(c[f.item.id]=f.v7?f.fn(i):f.fn(t.current.getRowId(i)))}return c};const o=`(function filterItem$$(getRowId, appliers, row, shouldApplyFilter) {
      ${a.map((i,u)=>`const shouldApply${u} = !shouldApplyFilter || shouldApplyFilter(${JSON.stringify(i.item.field)});`).join(`
`)}

      const result$$ = {
      ${a.map((i,u)=>`${JSON.stringify(String(i.item.id))}:
          !shouldApply${u} ?
            false :
            ${i.v7?`appliers[${u}].fn(row)`:`appliers[${u}].fn(getRowId(row))`},
      `).join(`
`)}};

      return result$$;
    })`,s=S0(o.replaceAll("$$",String(ec))),l=(i,u)=>s(t.current.getRowId,a,i,u);return ec+=1,l},Uv=(e,t)=>{var r,n,a;const o=(r=(n=e.quickFilterValues)==null?void 0:n.filter(Boolean))!=null?r:[];if(o.length===0)return null;const l=((a=e.quickFilterExcludeHiddenColumns)!=null?a:!1)?us(t):zr(t),i=[],{ignoreDiacritics:u}=t.current.rootProps,c=b0(t);return l.forEach(d=>{const f=t.current.getColumn(d),p=f==null?void 0:f.getApplyQuickFilterFn,h=f==null?void 0:f.getApplyQuickFilterFnV7,g=!Ko(p),m=!Ko(h);h&&!(g&&!m)?i.push({column:f,appliers:o.map(w=>{const v=u?un(w):w;return{v7:!0,fn:h(v,f,c)}})}):p&&i.push({column:f,appliers:o.map(w=>{const v=u?un(w):w;return{v7:!1,fn:p(v,f,c)}})})}),function(f,p){const h={},g={};e:for(let w=0;w<o.length;w+=1){const v=o[w];for(let C=0;C<i.length;C+=1){const{column:E,appliers:R}=i[C],{field:S}=E;if(p&&!p(S))continue;const b=R[w];let T=t.current.getRowValue(f,E);if(b.fn!==null)if(b.v7){if(u&&(T=un(T)),b.fn(T,f,E,c)){h[v]=!0;continue e}}else{var m;const A=(m=g[S])!=null?m:t.current.getCellParams(t.current.getRowId(f),S);if(u&&(A.value=un(A.value)),g[S]=A,b.fn(A)){h[v]=!0;continue e}}}h[v]=!1}return h}},zv=(e,t,r)=>{const n=Gv(e,t,r),a=Uv(e,t);return function(s,l,i){var u,c;i.passingFilterItems=(u=n==null?void 0:n(s,l))!=null?u:null,i.passingQuickFilterValues=(c=a==null?void 0:a(s,l))!=null?c:null}},tc=e=>e!=null,jv=(e,t,r)=>(e.cleanedFilterItems||(e.cleanedFilterItems=r.filter(n=>E0(n,t)!==null)),e.cleanedFilterItems),Wv=(e,t,r,n,a)=>{const o=jv(a,n,r.items),s=e.filter(tc),l=t.filter(tc);if(s.length>0){var i;const c=f=>s.some(p=>p[f.id]);if(((i=r.logicOperator)!=null?i:ja().logicOperator)===rr.And){if(!o.every(c))return!1}else if(!o.some(c))return!1}if(l.length>0&&r.quickFilterValues!=null){var u;const c=f=>l.some(p=>p[f]);if(((u=r.quickFilterLogicOperator)!=null?u:ja().quickFilterLogicOperator)===rr.And){if(!r.quickFilterValues.every(c))return!1}else if(!r.quickFilterValues.some(c))return!1}return!0},rc=so(e=>{if(!e)return null;const t=new RegExp(Do(e),"i");return(r,n,a,o)=>{let s=o.current.getRowFormattedValue(n,a);return o.current.ignoreDiacritics&&(s=un(s)),s!=null?t.test(s.toString()):!1}}),Kv=(e=!1)=>lo([{value:"contains",getApplyFilterFnV7:t=>{if(!t.value)return null;const r=e?t.value:t.value.trim(),n=new RegExp(Do(r),"i");return a=>a!=null?n.test(String(a)):!1},InputComponent:Mr},{value:"equals",getApplyFilterFnV7:t=>{if(!t.value)return null;const r=e?t.value:t.value.trim(),n=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"});return a=>a!=null?n.compare(r,a.toString())===0:!1},InputComponent:Mr},{value:"startsWith",getApplyFilterFnV7:t=>{if(!t.value)return null;const r=e?t.value:t.value.trim(),n=new RegExp(`^${Do(r)}.*$`,"i");return a=>a!=null?n.test(a.toString()):!1},InputComponent:Mr},{value:"endsWith",getApplyFilterFnV7:t=>{if(!t.value)return null;const r=e?t.value:t.value.trim(),n=new RegExp(`.*${Do(r)}$`,"i");return a=>a!=null?n.test(a.toString()):!1},InputComponent:Mr},{value:"isEmpty",getApplyFilterFnV7:()=>t=>t===""||t==null,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFnV7:()=>t=>t!==""&&t!=null,requiresFilterValue:!1},{value:"isAnyOf",getApplyFilterFnV7:t=>{if(!Array.isArray(t.value)||t.value.length===0)return null;const r=e?t.value:t.value.map(a=>a.trim()),n=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"});return a=>a!=null?r.some(o=>n.compare(o,a.toString()||"")===0):!1},InputComponent:w0}]),Tr={width:100,minWidth:50,maxWidth:1/0,hideable:!0,sortable:!0,resizable:!0,filterable:!0,groupable:!0,pinnable:!0,aggregable:!0,editable:!1,sortComparator:lx,type:"string",align:"left",filterOperators:Kv(),renderEditCell:A1,getApplyQuickFilterFn:C0(rc),getApplyQuickFilterFnV7:rc},Xv=()=>lo([{value:"is",getApplyFilterFnV7:e=>{if(!e.value)return null;const t=e.value==="true";return r=>!!r===t},InputComponent:Wm}]);function Yv({value:e,api:t}){return e?t.getLocaleText("booleanCellTrueLabel"):t.getLocaleText("booleanCellFalseLabel")}const qv=e=>{switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"null":case"undefined":return!1;default:return}},T0=k({},Tr,{type:"boolean",align:"center",headerAlign:"center",renderCell:v1,renderEditCell:S1,sortComparator:d0,valueFormatter:Yv,filterOperators:Xv(),getApplyQuickFilterFn:void 0,getApplyQuickFilterFnV7:void 0,aggregable:!1,pastedValueParser:e=>qv(e)}),rn="__check__",ma=k({},T0,{field:rn,type:"checkboxSelection",width:50,resizable:!1,sortable:!1,filterable:!1,aggregable:!1,disableColumnMenu:!0,disableReorder:!0,disableExport:!0,getApplyQuickFilterFn:void 0,getApplyQuickFilterFnV7:void 0,valueGetter:e=>jo(e.api.state,e.api.instanceId)[e.id]!==void 0,renderHeader:e=>I.jsx(bx,k({},e)),renderCell:e=>I.jsx(vx,k({},e))}),Cs="actions",Zv=k({},Tr,{sortable:!1,filterable:!1,aggregable:!1,width:100,align:"center",headerAlign:"center",headerName:"",disableColumnMenu:!0,disableExport:!0,renderCell:Y1,getApplyQuickFilterFn:void 0,getApplyQuickFilterFnV7:void 0}),Ul="__detail_panel_toggle__",Xt=e=>e.editRows,Qv=["selected","hovered","rowId","row","index","style","position","rowHeight","className","visibleColumns","renderedColumns","containerWidth","firstColumnToRender","lastColumnToRender","isLastVisible","focusedCellColumnIndexNotInRange","isNotVisible","focusedCell","tabbableCell","onClick","onDoubleClick","onMouseEnter","onMouseLeave","onMouseOut","onMouseOver"],Jv=e=>{const{editable:t,editing:r,selected:n,isLastVisible:a,rowHeight:o,classes:s}=e;return Le({root:["row",n&&"selected",t&&"row--editable",r&&"row--editing",a&&"row--lastVisible",o==="auto"&&"row--dynamicHeight"]},We,s)};function ew({width:e}){if(!e)return null;const t={width:e};return I.jsx("div",{className:`${Q.cell} ${Q.withBorderColor}`,style:t})}const tw=x.forwardRef(function(t,r){const{selected:n,hovered:a,rowId:o,row:s,index:l,style:i,position:u,rowHeight:c,className:d,visibleColumns:f,renderedColumns:p,containerWidth:h,firstColumnToRender:g,isLastVisible:m=!1,focusedCellColumnIndexNotInRange:w,isNotVisible:v,focusedCell:C,onClick:E,onDoubleClick:R,onMouseEnter:S,onMouseLeave:b,onMouseOut:T,onMouseOver:A}=t,N=me(t,Qv),y=$e(),D=x.useRef(null),L=ke(),M=Hn(y,L),F=Ce(y,Il),B=Ce(y,ur),H=Ce(y,hs),G=Ce(y,no),_=Ce(y,Xt),Z=qr(D,r),ee=l+G+2,P={selected:n,hovered:a,isLastVisible:m,classes:L.classes,editing:y.current.getRowMode(o)===ot.Edit,editable:L.editMode===Rr.Row,rowHeight:c},q=Jv(P);x.useLayoutEffect(()=>{c==="auto"&&D.current&&typeof ResizeObserver>"u"&&y.current.unstable_storeRowHeightMeasurement(o,D.current.clientHeight,u)},[y,c,o,u]),x.useLayoutEffect(()=>{if(M.range){const Ne=y.current.getRowIndexRelativeToVisibleRows(o);Ne!=null&&y.current.unstable_setLastMeasuredRowIndex(Ne)}const he=D.current;if(!he||c!=="auto"||typeof ResizeObserver>"u")return;const Ee=new ResizeObserver(Ne=>{const[Je]=Ne,rt=Je.borderBoxSize&&Je.borderBoxSize.length>0?Je.borderBoxSize[0].blockSize:Je.contentRect.height;y.current.unstable_storeRowHeightMeasurement(o,rt,u)});return Ee.observe(he),()=>Ee.disconnect()},[y,M.range,l,c,o,u]);const K=x.useCallback((he,ve)=>Ee=>{ao(Ee)||y.current.getRow(o)&&(y.current.publishEvent(he,y.current.getRowParams(o),Ee),ve&&ve(Ee))},[y,o]),X=x.useCallback(he=>{const ve=r1(he.target,Q.cell),Ee=ve==null?void 0:ve.getAttribute("data-field");if(Ee){if(Ee===ma.field||Ee===Ul||Ee==="__reorder__"||y.current.getCellMode(o,Ee)===at.Edit)return;const Ne=y.current.getColumn(Ee);if((Ne==null?void 0:Ne.type)===Cs)return}K("rowClick",E)(he)},[y,E,K,o]),{slots:te,slotProps:le,disableColumnReorder:fe}=L,de=te.cell===qs?qs:f1,ie=L.rowReordering,xe=(he,ve)=>{var Ee,Ne;const Je=fe&&he.disableReorder||!ie&&!!B.length&&H>1&&Object.keys(_).length>0,rt=(Ee=(Ne=_[o])==null?void 0:Ne[he.field])!=null?Ee:null;let ut=!1;return w!==void 0&&f[w].field===he.field&&(ut=!0),I.jsx(de,k({column:he,width:ve.width,rowId:o,height:c,showRightBorder:ve.showRightBorder,align:he.align||"left",colIndex:ve.indexRelativeToAllColumns,colSpan:ve.colSpan,disableDragEvents:Je,editCellState:rt,isNotVisible:ut},le==null?void 0:le.cell),he.field)},z=Ce(y,()=>k({},y.current.unstable_getRowInternalSizes(o)),Fl);let Pe=c;if(Pe==="auto"&&z){let he=0;const ve=Object.entries(z).reduce((Ee,[Ne,Je])=>/^base[A-Z]/.test(Ne)?(he+=1,Je>Ee?Je:Ee):Ee,0);ve>0&&he>1&&(Pe=ve)}const _e=x.useMemo(()=>{if(v)return{opacity:0,width:0,height:0};const he=k({},i,{maxHeight:c==="auto"?"none":c,minHeight:Pe});if(z!=null&&z.spacingTop){const ve=L.rowSpacingType==="border"?"borderTopWidth":"marginTop";he[ve]=z.spacingTop}if(z!=null&&z.spacingBottom){const ve=L.rowSpacingType==="border"?"borderBottomWidth":"marginBottom";let Ee=he[ve];typeof Ee!="number"&&(Ee=parseInt(Ee||"0",10)),Ee+=z.spacingBottom,he[ve]=Ee}return he},[v,c,i,Pe,z,L.rowSpacingType]),Ie=y.current.unstable_applyPipeProcessors("rowClassName",[],o);if(typeof L.getRowClassName=="function"){var ce;const he=l-(((ce=M.range)==null?void 0:ce.firstRowIndex)||0),ve=k({},y.current.getRowParams(o),{isFirstVisible:he===0,isLastVisible:he===M.rows.length-1,indexRelativeToCurrentPage:he});Ie.push(L.getRowClassName(ve))}const ne=jp(1e4,20,80),be=y.current.getRowNode(o);if(!be)return null;const Ae=be.type,Me=[];for(let he=0;he<p.length;he+=1){const ve=p[he];let Ee=g+he;w!==void 0&&C&&(f[w].field===ve.field?Ee=w:Ee-=1);const Ne=y.current.unstable_getCellColSpanInfo(o,Ee);if(Ne&&!Ne.spannedByColSpan)if(Ae!=="skeletonRow"){const{colSpan:Je,width:rt}=Ne.cellProps,ut={width:rt,colSpan:Je,showRightBorder:L.showCellVerticalBorder,indexRelativeToAllColumns:Ee};Me.push(xe(ve,ut))}else{const{width:Je}=Ne.cellProps,rt=Math.round(ne());Me.push(I.jsx(te.skeletonCell,{width:Je,contentWidth:rt,field:ve.field,align:ve.align},ve.field))}}const Oe=h-F,ye=s?{onClick:X,onDoubleClick:K("rowDoubleClick",R),onMouseEnter:K("rowMouseEnter",S),onMouseLeave:K("rowMouseLeave",b),onMouseOut:K("rowMouseOut",T),onMouseOver:K("rowMouseOver",A)}:null;return I.jsxs("div",k({ref:Z,"data-id":o,"data-rowindex":l,role:"row",className:Ue(...Ie,q.root,d,a&&"Mui-hovered"),"aria-rowindex":ee,"aria-selected":n,style:_e},ye,N,{children:[Me,Oe>0&&I.jsx(ew,{width:Oe})]}))}),rw=ms(tw);function nw({privateApiRef:e,props:t,children:r}){const n=x.useRef(e.current.getPublicApi());return I.jsx(Pu.Provider,{value:t,children:I.jsx(Au.Provider,{value:e,children:I.jsx(Iu.Provider,{value:n,children:r})})})}const aw=Up()&&window.localStorage.getItem("DEBUG")!=null,_a=()=>{},ow={debug:_a,info:_a,warn:_a,error:_a},nc=["debug","info","warn","error"];function ac(e,t,r=console){const n=nc.indexOf(t);if(n===-1)throw new Error(`MUI: Log level ${t} not recognized.`);return nc.reduce((o,s,l)=>(l>=n?o[s]=(...i)=>{const[u,...c]=i;r[s](`MUI: ${e} - ${u}`,...c)}:o[s]=_a,o),{})}const sw=(e,t)=>{const r=x.useCallback(n=>aw?ac(n,"debug",t.logger):t.logLevel?ac(n,t.logLevel.toString(),t.logger):ow,[t.logLevel,t.logger]);ze(e,{getLogger:r},"private")};class zl{static create(t){return new zl(t)}constructor(t){this.value=void 0,this.listeners=void 0,this.subscribe=r=>(this.listeners.add(r),()=>{this.listeners.delete(r)}),this.getSnapshot=()=>this.value,this.update=r=>{this.value=r,this.listeners.forEach(n=>n(r))},this.value=t,this.listeners=new Set}}class lw{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(t,r,n={}){let a=this.events[t];a||(a={highPriority:new Map,regular:new Map},this.events[t]=a),n.isFirst?a.highPriority.set(r,!0):a.regular.set(r,!0)}removeListener(t,r){this.events[t]&&(this.events[t].regular.delete(r),this.events[t].highPriority.delete(r))}removeAllListeners(){this.events={}}emit(t,...r){const n=this.events[t];if(!n)return;const a=Array.from(n.highPriority.keys()),o=Array.from(n.regular.keys());for(let s=a.length-1;s>=0;s-=1){const l=a[s];n.highPriority.has(l)&&l.apply(this,r)}for(let s=0;s<o.length;s+=1){const l=o[s];n.regular.has(l)&&l.apply(this,r)}}once(t,r){const n=this;this.on(t,function a(...o){n.removeListener(t,a),r.apply(n,o)})}}const y0=Symbol("mui.api_private"),iw=e=>e.isPropagationStopped!==void 0;let oc=0;function cw(e){var t;const r=(t=e.current)==null?void 0:t[y0];if(r)return r;const n={},a={state:n,store:zl.create(n),instanceId:{id:oc}};return oc+=1,a.getPublicApi=()=>e.current,a.register=(o,s)=>{Object.keys(s).forEach(l=>{const i=s[l],u=a[l];if((u==null?void 0:u.spying)===!0?u.target=i:a[l]=i,o==="public"){const c=e.current,d=c[l];(d==null?void 0:d.spying)===!0?d.target=i:c[l]=i}})},a.register("private",{caches:{},eventManager:new lw}),a}function uw(e){return{get state(){return e.current.state},get store(){return e.current.store},get instanceId(){return e.current.instanceId},[y0]:e.current}}function dw(e,t){const r=x.useRef(),n=x.useRef();n.current||(n.current=cw(r)),r.current||(r.current=uw(n));const a=x.useCallback((...s)=>{const[l,i,u={}]=s;if(u.defaultMuiPrevented=!1,iw(u)&&u.isPropagationStopped())return;const c=t.signature===Or.DataGridPro?{api:n.current.getPublicApi()}:{};n.current.eventManager.emit(l,i,u,c)},[n,t.signature]),o=x.useCallback((s,l,i)=>{n.current.eventManager.on(s,l,i);const u=n.current;return()=>{u.eventManager.removeListener(s,l)}},[n]);return ze(n,{subscribeEvent:o,publishEvent:a},"public"),x.useImperativeHandle(e,()=>r.current,[r]),x.useEffect(()=>{const s=n.current;return()=>{s.publishEvent("unmount")}},[n]),n}const fw=(e,t)=>{const r=x.useCallback(n=>{if(t.localeText[n]==null)throw new Error(`Missing translation for key ${n}.`);return t.localeText[n]},[t.localeText]);e.current.register("public",{getLocaleText:r})},hw=e=>{const t=x.useRef({}),r=x.useRef(!1),n=x.useCallback(c=>{r.current||!c||(r.current=!0,Object.values(c.appliers).forEach(d=>{d()}),r.current=!1)},[]),a=x.useCallback((c,d,f)=>{t.current[c]||(t.current[c]={processors:new Map,appliers:{}});const p=t.current[c];return p.processors.get(d)!==f&&(p.processors.set(d,f),n(p)),()=>{t.current[c].processors.set(d,null)}},[n]),o=x.useCallback((c,d,f)=>(t.current[c]||(t.current[c]={processors:new Map,appliers:{}}),t.current[c].appliers[d]=f,()=>{const p=t.current[c].appliers,h=me(p,[d].map(Ua));t.current[c].appliers=h}),[]),s=x.useCallback(c=>{const d=t.current[c];n(d)},[n]),l=x.useCallback((...c)=>{const[d,f,p]=c;return t.current[d]?Array.from(t.current[d].processors.values()).reduce((g,m)=>m?m(g,p):g,f):f},[]),i={registerPipeProcessor:a,registerPipeApplier:o,requestPipeProcessorsApplication:s},u={unstable_applyPipeProcessors:l};ze(e,i,"private"),ze(e,u,"public")},kt=(e,t,r)=>{const n=x.useRef(),a=x.useRef(`mui-${Math.round(Math.random()*1e9)}`),o=x.useCallback(()=>{n.current=e.current.registerPipeProcessor(t,a.current,r)},[e,r,t]);oo(()=>{o()});const s=x.useRef(!0);x.useEffect(()=>(s.current?s.current=!1:o(),()=>{n.current&&(n.current(),n.current=null)}),[o])},jl=(e,t,r)=>{const n=x.useRef(),a=x.useRef(`mui-${Math.round(Math.random()*1e9)}`),o=x.useCallback(()=>{n.current=e.current.registerPipeApplier(t,a.current,r)},[e,r,t]);oo(()=>{o()});const s=x.useRef(!0);x.useEffect(()=>(s.current?s.current=!1:o(),()=>{n.current&&(n.current(),n.current=null)}),[o])},Xo=(e,t,r,n)=>{const a=x.useCallback(()=>{e.current.registerStrategyProcessor(t,r,n)},[e,n,r,t]);oo(()=>{a()});const o=x.useRef(!0);x.useEffect(()=>{o.current?o.current=!1:a()},[a])},Mn="none",sc={rowTreeCreation:"rowTree",filtering:"rowTree",sorting:"rowTree",visibleRowsLookupCreation:"rowTree"},gw=e=>{const t=x.useRef(new Map),r=x.useRef({}),n=x.useCallback((i,u,c)=>{const d=()=>{const h=r.current[u],g=me(h,[i].map(Ua));r.current[u]=g};r.current[u]||(r.current[u]={});const f=r.current[u],p=f[i];return f[i]=c,!p||p===c||i===e.current.getActiveStrategy(sc[u])&&e.current.publishEvent("activeStrategyProcessorChange",u),d},[e]),a=x.useCallback((i,u)=>{const c=e.current.getActiveStrategy(sc[i]);if(c==null)throw new Error("Can't apply a strategy processor before defining an active strategy");const d=r.current[i];if(!d||!d[c])throw new Error(`No processor found for processor "${i}" on strategy "${c}"`);const f=d[c];return f(u)},[e]),o=x.useCallback(i=>{var u;const d=Array.from(t.current.entries()).find(([,f])=>f.group!==i?!1:f.isAvailable());return(u=d==null?void 0:d[0])!=null?u:Mn},[]),s=x.useCallback((i,u,c)=>{t.current.set(u,{group:i,isAvailable:c}),e.current.publishEvent("strategyAvailabilityChange")},[e]);ze(e,{registerStrategyProcessor:n,applyStrategyProcessor:a,getActiveStrategy:o,setStrategyAvailability:s},"private")},pw=(e,t)=>{const r=x.useRef({}),[,n]=x.useState(),a=x.useCallback(c=>{r.current[c.stateId]=c},[]),o=x.useCallback((c,d)=>{let f;if(n0(c)?f=c(e.current.state):f=c,e.current.state===f)return!1;let p=!1;const h=[];if(Object.keys(r.current).forEach(g=>{const m=r.current[g],w=m.stateSelector(e.current.state,e.current.instanceId),v=m.stateSelector(f,e.current.instanceId);v!==w&&(h.push({stateId:m.stateId,hasPropChanged:v!==m.propModel}),m.propModel!==void 0&&v!==m.propModel&&(p=!0))}),h.length>1)throw new Error(`You're not allowed to update several sub-state in one transaction. You already updated ${h[0].stateId}, therefore, you're not allowed to update ${h.map(g=>g.stateId).join(", ")} in the same transaction.`);if(p||(e.current.state=f,e.current.publishEvent&&e.current.publishEvent("stateChange",f),e.current.store.update(f)),h.length===1){const{stateId:g,hasPropChanged:m}=h[0],w=r.current[g],v=w.stateSelector(f,e.current.instanceId);if(w.propOnChange&&m){const C=t.signature===Or.DataGridPro?{api:e.current,reason:d}:{reason:d};w.propOnChange(v,C)}p||e.current.publishEvent(w.changeEvent,v,{reason:d})}return!p},[e,t.signature]),s=x.useCallback((c,d,f)=>e.current.setState(p=>k({},p,{[c]:d(p[c])}),f),[e]),l=x.useCallback(()=>n(()=>e.current.state),[e]),i={setState:o,forceUpdate:l},u={updateControlState:s,registerControlState:a};ze(e,i,"public"),ze(e,u,"private")},xw=(e,t)=>{const r=dw(e,t);return sw(r,t),pw(r,t),hw(r),gw(r),fw(r,t),r.current.register("private",{rootProps:t}),r},er=(e,t,r)=>{const n=x.useRef(!1);n.current||(t.current.state=e(t.current.state,r,t),n.current=!0)},mw=/(\d+)-(\d+)-(\d+)/,vw=/(\d+)-(\d+)-(\d+)T(\d+):(\d+)/;function qn(e,t,r,n){if(!e.value)return null;const[a,o,s,l,i]=e.value.match(r?vw:mw).slice(1).map(Number),u=new Date(a,o-1,s,l||0,i||0).getTime();return c=>{if(!c)return!1;if(n)return t(c.getTime(),u);const f=new Date(c).setHours(r?c.getHours():0,r?c.getMinutes():0,0,0);return t(f,u)}}const _0=e=>lo([{value:"is",getApplyFilterFnV7:t=>qn(t,(r,n)=>r===n,e),InputComponent:Yn,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"not",getApplyFilterFnV7:t=>qn(t,(r,n)=>r!==n,e),InputComponent:Yn,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"after",getApplyFilterFnV7:t=>qn(t,(r,n)=>r>n,e),InputComponent:Yn,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"onOrAfter",getApplyFilterFnV7:t=>qn(t,(r,n)=>r>=n,e),InputComponent:Yn,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"before",getApplyFilterFnV7:t=>qn(t,(r,n)=>r<n,e,!e),InputComponent:Yn,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"onOrBefore",getApplyFilterFnV7:t=>qn(t,(r,n)=>r<=n,e),InputComponent:Yn,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"isEmpty",getApplyFilterFnV7:()=>t=>t==null,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFnV7:()=>t=>t!=null,requiresFilterValue:!1}]);function F0({value:e,columnType:t,rowId:r,field:n}){if(!(e instanceof Date))throw new Error([`MUI: \`${t}\` column type only accepts \`Date\` objects as values.`,"Use `valueGetter` to transform the value into a `Date` object.",`Row ID: ${r}, field: "${n}".`].join(`
`))}function ww({value:e,field:t,id:r}){return e?(F0({value:e,columnType:"date",rowId:r,field:t}),e.toLocaleDateString()):""}function Cw({value:e,field:t,id:r}){return e?(F0({value:e,columnType:"dateTime",rowId:r,field:t}),e.toLocaleString()):""}const bw=k({},Tr,{type:"date",sortComparator:f0,valueFormatter:ww,filterOperators:_0(),renderEditCell:qu,pastedValueParser:e=>new Date(e)}),Sw=k({},Tr,{type:"dateTime",sortComparator:f0,valueFormatter:Cw,filterOperators:_0(!0),renderEditCell:qu,pastedValueParser:e=>new Date(e)}),nn=e=>e==null?null:Number(e),lc=so(e=>e==null||Number.isNaN(e)||e===""?null:t=>nn(t)===nn(e)),kw=()=>lo([{value:"=",getApplyFilterFnV7:e=>e.value==null||Number.isNaN(e.value)?null:t=>nn(t)===e.value,InputComponent:Mr,InputComponentProps:{type:"number"}},{value:"!=",getApplyFilterFnV7:e=>e.value==null||Number.isNaN(e.value)?null:t=>nn(t)!==e.value,InputComponent:Mr,InputComponentProps:{type:"number"}},{value:">",getApplyFilterFnV7:e=>e.value==null||Number.isNaN(e.value)?null:t=>t==null?!1:nn(t)>e.value,InputComponent:Mr,InputComponentProps:{type:"number"}},{value:">=",getApplyFilterFnV7:e=>e.value==null||Number.isNaN(e.value)?null:t=>t==null?!1:nn(t)>=e.value,InputComponent:Mr,InputComponentProps:{type:"number"}},{value:"<",getApplyFilterFnV7:e=>e.value==null||Number.isNaN(e.value)?null:t=>t==null?!1:nn(t)<e.value,InputComponent:Mr,InputComponentProps:{type:"number"}},{value:"<=",getApplyFilterFnV7:e=>e.value==null||Number.isNaN(e.value)?null:t=>t==null?!1:nn(t)<=e.value,InputComponent:Mr,InputComponentProps:{type:"number"}},{value:"isEmpty",getApplyFilterFnV7:()=>e=>e==null,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFnV7:()=>e=>e!=null,requiresFilterValue:!1},{value:"isAnyOf",getApplyFilterFnV7:e=>!Array.isArray(e.value)||e.value.length===0?null:t=>t!=null&&e.value.includes(Number(t)),InputComponent:w0,InputComponentProps:{type:"number"}}]),Ew=k({},Tr,{type:"number",align:"right",headerAlign:"right",sortComparator:d0,valueParser:e=>e===""?null:Number(e),valueFormatter:({value:e})=>Gp(e)?e.toLocaleString():e||"",filterOperators:kw(),getApplyQuickFilterFn:C0(lc),getApplyQuickFilterFnV7:lc}),Zn=e=>e==null||!Bl(e)?e:e.value,Tw=()=>lo([{value:"is",getApplyFilterFnV7:e=>e.value==null||e.value===""?null:t=>Zn(t)===Zn(e.value),InputComponent:Zi},{value:"not",getApplyFilterFnV7:e=>e.value==null||e.value===""?null:t=>Zn(t)!==Zn(e.value),InputComponent:Zi},{value:"isAnyOf",getApplyFilterFnV7:e=>{if(!Array.isArray(e.value)||e.value.length===0)return null;const t=e.value.map(Zn);return r=>t.includes(Zn(r))},InputComponent:Qm}]),yw=e=>typeof e[0]=="object",_w=e=>Bl(e)?e.value:e,Fw=e=>Bl(e)?e.label:String(e),Iw=k({},Tr,{type:"singleSelect",getOptionLabel:Fw,getOptionValue:_w,valueFormatter(e){const{id:t,field:r,value:n,api:a}=e,o=e.api.getColumn(r);if(!Fn(o))return"";let s;if(typeof o.valueOptions=="function"?s=o.valueOptions({id:t,row:t?a.getRow(t):null,field:r}):s=o.valueOptions,n==null)return"";if(!s)return n;if(!yw(s))return o.getOptionLabel(n);const l=s.find(i=>o.getOptionValue(i)===n);return l?o.getOptionLabel(l):""},renderEditCell:V1,filterOperators:Tw(),pastedValueParser:(e,t)=>{const r=t.colDef,n=r.valueOptions,a=typeof n=="function"?n({field:r.field}):n||[],o=r.getOptionValue;if(a.find(l=>o(l)===e))return e}}),I0="__default__",Pw=()=>({string:Tr,number:Ew,date:bw,dateTime:Sw,boolean:T0,singleSelect:Iw,[Cs]:Zv,[I0]:Tr});function el(e,t){return typeof e=="string"&&[t,`
`,"\r",'"'].some(r=>e.includes(r))?`"${e.replace(/"/g,'""')}"`:e}const P0=(e,t)=>{const{delimiterCharacter:r,ignoreValueFormatter:n}=t;let a;if(n){var o;const l=e.colDef.type;if(l==="number")a=String(e.value);else if(l==="date"||l==="dateTime"){var s;a=(s=e.value)==null?void 0:s.toISOString()}else typeof((o=e.value)==null?void 0:o.toString)=="function"?a=e.value.toString():a=e.value}else a=e.formattedValue;return el(a,r)};Nr(["MUI: When the value of a field is an object or a `renderCell` is provided, the CSV export might not display the value correctly.","You can provide a `valueFormatter` with a string representation to be used."]);class tl{constructor(t){this.options=void 0,this.rowString="",this.isEmpty=!0,this.options=t}addValue(t){this.isEmpty||(this.rowString+=this.options.delimiterCharacter),t==null?this.rowString+="":typeof this.options.sanitizeCellValue=="function"?this.rowString+=this.options.sanitizeCellValue(t,this.options.delimiterCharacter):this.rowString+=t,this.isEmpty=!1}getRowString(){return this.rowString}}const Aw=({id:e,columns:t,getCellParams:r,delimiterCharacter:n,ignoreValueFormatter:a})=>{const o=new tl({delimiterCharacter:n});return t.forEach(s=>{const l=r(e,s.field);o.addValue(P0(l,{delimiterCharacter:n,ignoreValueFormatter:a}))}),o.getRowString()};function Mw(e){const{columns:t,rowIds:r,delimiterCharacter:n,includeHeaders:a,includeColumnGroupsHeaders:o,ignoreValueFormatter:s,apiRef:l}=e,i=r.reduce((p,h)=>`${p}${Aw({id:h,columns:t,getCellParams:l.current.getCellParams,delimiterCharacter:n,ignoreValueFormatter:s})}\r
`,"").trim();if(!a)return i;const u=t.filter(p=>p.field!==ma.field),c=[];if(o){const p=l.current.unstable_getAllGroupDetails();let h=0;const g=u.reduce((m,w)=>{const v=l.current.unstable_getColumnGroupPath(w.field);return m[w.field]=v,h=Math.max(h,v.length),m},{});for(let m=0;m<h;m+=1){const w=new tl({delimiterCharacter:n,sanitizeCellValue:el});c.push(w),u.forEach(v=>{const C=(g[v.field]||[])[m],E=p[C];w.addValue(E?E.headerName||E.groupId:"")})}}const d=new tl({delimiterCharacter:n,sanitizeCellValue:el});return u.forEach(p=>{d.addValue(p.headerName||p.field)}),c.push(d),`${`${c.map(p=>p.getRowString()).join(`\r
`)}\r
`}${i}`.trim()}function ic(e){const t=document.createElement("span");t.style.whiteSpace="pre",t.style.userSelect="all",t.style.opacity="0px",t.textContent=e,document.body.appendChild(t);const r=document.createRange();r.selectNode(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(r);try{document.execCommand("copy")}finally{document.body.removeChild(t)}}function Dw(e){navigator.clipboard?navigator.clipboard.writeText(e).catch(()=>{ic(e)}):ic(e)}function Ow(e){var t;return!!((t=window.getSelection())!=null&&t.toString()||e&&(e.selectionEnd||0)-(e.selectionStart||0)>0)}const Rw=(e,t)=>{const r=t.unstable_ignoreValueFormatterDuringExport,n=(typeof r=="object"?r==null?void 0:r.clipboardExport:r)||!1,a=t.clipboardCopyCellDelimiter,o=x.useCallback(s=>{if(!((s.ctrlKey||s.metaKey)&&s.key==="c")||Ow(s.target))return;let l="";if(e.current.getSelectedRows().size>0)l=e.current.getDataAsCsv({includeHeaders:!1,delimiter:a});else{const u=nr(e);if(u){const c=e.current.getCellParams(u.id,u.field);l=P0(c,{delimiterCharacter:a,ignoreValueFormatter:n})}}l=e.current.unstable_applyPipeProcessors("clipboardCopy",l),l&&(Dw(l),e.current.publishEvent("clipboardCopy",l))},[e,n,a]);Wp(e,e.current.rootElementRef,"keydown",o),it(e,"clipboardCopy",t.onClipboardCopy)},Lw=e=>k({},e,{columnMenu:{open:!1}}),Nw=e=>{const t=Ut(e,"useGridColumnMenu"),r=x.useCallback(s=>{e.current.setState(i=>i.columnMenu.open&&i.columnMenu.field===s?i:(t.debug("Opening Column Menu"),k({},i,{columnMenu:{open:!0,field:s}})))&&(e.current.hidePreferences(),e.current.forceUpdate())},[e,t]),n=x.useCallback(()=>{const s=Ys(e.current.state);if(s.field){const i=Bn(e),u=Cr(e),c=zr(e);let d=s.field;if(i[d]||(d=c[0]),u[d]===!1){const f=c.filter(h=>h===d?!0:u[h]!==!1),p=f.indexOf(d);d=f[p+1]||f[p-1]}e.current.setColumnHeaderFocus(d)}e.current.setState(i=>!i.columnMenu.open&&i.columnMenu.field===void 0?i:(t.debug("Hiding Column Menu"),k({},i,{columnMenu:k({},i.columnMenu,{open:!1,field:void 0})})))&&e.current.forceUpdate()},[e,t]),a=x.useCallback(s=>{t.debug("Toggle Column Menu");const l=Ys(e.current.state);!l.open||l.field!==s?r(s):n()},[e,t,r,n]);ze(e,{showColumnMenu:r,hideColumnMenu:n,toggleColumnMenu:a},"public"),Fe(e,"columnResizeStart",n),Fe(e,"virtualScrollerWheel",e.current.hideColumnMenu),Fe(e,"virtualScrollerTouchMove",e.current.hideColumnMenu)},A0=["maxWidth","minWidth","width","flex"];function Bw({initialFreeSpace:e,totalFlexUnits:t,flexColumns:r}){const n=new Set(r.map(s=>s.field)),a={all:{},frozenFields:[],freeze:s=>{const l=a.all[s];l&&l.frozen!==!0&&(a.all[s].frozen=!0,a.frozenFields.push(s))}};function o(){if(a.frozenFields.length===n.size)return;const s={min:{},max:{}};let l=e,i=t,u=0;a.frozenFields.forEach(c=>{l-=a.all[c].computedWidth,i-=a.all[c].flex});for(let c=0;c<r.length;c+=1){const d=r[c];if(a.all[d.field]&&a.all[d.field].frozen===!0)continue;let p=l/i*d.flex;p<d.minWidth?(u+=d.minWidth-p,p=d.minWidth,s.min[d.field]=!0):p>d.maxWidth&&(u+=d.maxWidth-p,p=d.maxWidth,s.max[d.field]=!0),a.all[d.field]={frozen:!1,computedWidth:p,flex:d.flex}}u<0?Object.keys(s.max).forEach(c=>{a.freeze(c)}):u>0?Object.keys(s.min).forEach(c=>{a.freeze(c)}):r.forEach(({field:c})=>{a.freeze(c)}),o()}return o(),a.all}const rl=(e,t)=>{const r={};let n=0,a=0;const o=[];e.orderedFields.forEach(l=>{const i=k({},e.lookup[l]);if(e.columnVisibilityModel[l]===!1)i.computedWidth=0;else{let u;i.flex&&i.flex>0?(n+=i.flex,u=0,o.push(i)):u=fa(i.width||Tr.width,i.minWidth||Tr.minWidth,i.maxWidth||Tr.maxWidth),a+=u,i.computedWidth=u}r[l]=i});const s=Math.max(t-a,0);if(n>0&&t>0){const l=Bw({initialFreeSpace:s,totalFlexUnits:n,flexColumns:o});Object.keys(l).forEach(i=>{r[i].computedWidth=l[i].computedWidth})}return k({},e,{lookup:r})},Hw=(e,t)=>{if(!t)return e;const{orderedFields:r=[],dimensions:n={}}=t,a=Object.keys(n);if(a.length===0&&r.length===0)return e;const o={},s=[];for(let c=0;c<r.length;c+=1){const d=r[c];e.lookup[d]&&(o[d]=!0,s.push(d))}const l=s.length===0?e.orderedFields:[...s,...e.orderedFields.filter(c=>!o[c])],i=k({},e.lookup);for(let c=0;c<a.length;c+=1){const d=a[c],f=k({},i[d],{hasBeenResized:!0});Object.entries(n[d]).forEach(([p,h])=>{f[p]=h===-1?1/0:h}),i[d]=f}return k({},e,{orderedFields:l,lookup:i})};function cc(e,t){let r=e[I0];return t&&e[t]&&(r=e[t]),r}const ta=({apiRef:e,columnsToUpsert:t,initialState:r,columnTypes:n,columnVisibilityModel:a=Cr(e),keepOnlyColumnsToUpsert:o=!1})=>{var s,l,i;const u=!e.current.state.columns;let c;if(u)c={orderedFields:[],lookup:{},columnVisibilityModel:a};else{const h=_n(e.current.state);c={orderedFields:o?[]:[...h.orderedFields],lookup:k({},h.lookup),columnVisibilityModel:a}}let d={};o&&!u&&(d=Object.keys(c.lookup).reduce((h,g)=>k({},h,{[g]:!1}),{})),t.forEach(h=>{const{field:g}=h;d[g]=!0;let m=c.lookup[g];m==null?(m=k({},cc(n,h.type),{field:g,hasBeenResized:!1}),c.orderedFields.push(g)):o&&c.orderedFields.push(g),m&&m.type!==h.type&&(m=k({},cc(n,h.type),{field:g}));let w=m.hasBeenResized;A0.forEach(v=>{h[v]!==void 0&&(w=!0,h[v]===-1&&(h[v]=1/0))}),c.lookup[g]=k({},m,h,{hasBeenResized:w})}),o&&!u&&Object.keys(c.lookup).forEach(h=>{d[h]||delete c.lookup[h]});const f=e.current.unstable_applyPipeProcessors("hydrateColumns",c),p=Hw(f,r);return rl(p,(s=(l=(i=e.current).getRootDimensions)==null||(l=l.call(i))==null?void 0:l.viewportInnerSize.width)!=null?s:0)},uc=e=>t=>k({},t,{columns:e});function nl({firstColumnToRender:e,apiRef:t,firstRowToRender:r,lastRowToRender:n,visibleRows:a}){let o=e;for(let s=r;s<n;s+=1)if(a[s]){const i=a[s].id,u=t.current.unstable_getCellColSpanInfo(i,e);u&&u.spannedByColSpan&&(o=u.leftVisibleCellIndex)}return o}function $w({firstColumnIndex:e,minColumnIndex:t,columnBuffer:r,firstRowToRender:n,lastRowToRender:a,apiRef:o,visibleRows:s}){const l=Math.max(e-r,t);return nl({firstColumnToRender:l,apiRef:o,firstRowToRender:n,lastRowToRender:a,visibleRows:s})}function Wl(e,t){const r=xa(e),n=no(e);return Math.floor(t*r)*((n??0)+1)}const M0=Pw(),Vw=(e,t,r)=>{var n,a,o,s;const l=ta({apiRef:r,columnTypes:M0,columnsToUpsert:t.columns,initialState:(n=t.initialState)==null?void 0:n.columns,columnVisibilityModel:(a=(o=t.columnVisibilityModel)!=null?o:(s=t.initialState)==null||(s=s.columns)==null?void 0:s.columnVisibilityModel)!=null?a:{},keepOnlyColumnsToUpsert:!0});return k({},e,{columns:l})};function Gw(e,t){var r,n;const a=Ut(e,"useGridColumns"),o=M0,s=x.useRef(t.columns),l=x.useRef(o);e.current.registerControlState({stateId:"visibleColumns",propModel:t.columnVisibilityModel,propOnChange:t.onColumnVisibilityModelChange,stateSelector:Cr,changeEvent:"columnVisibilityModelChange"});const i=x.useCallback(M=>{a.debug("Updating columns state."),e.current.setState(uc(M)),e.current.forceUpdate(),e.current.publishEvent("columnsChange",M.orderedFields)},[a,e]),u=x.useCallback(M=>Bn(e)[M],[e]),c=x.useCallback(()=>Dr(e),[e]),d=x.useCallback(()=>At(e),[e]),f=x.useCallback((M,F=!0)=>(F?At(e):Dr(e)).findIndex(H=>H.field===M),[e]),p=x.useCallback(M=>{const F=f(M);return da(e)[F]},[e,f]),h=x.useCallback(M=>{Cr(e)!==M&&(e.current.setState(B=>k({},B,{columns:ta({apiRef:e,columnTypes:o,columnsToUpsert:[],initialState:void 0,columnVisibilityModel:M,keepOnlyColumnsToUpsert:!1})})),e.current.forceUpdate())},[e,o]),g=x.useCallback(M=>{const F=ta({apiRef:e,columnTypes:o,columnsToUpsert:M,initialState:void 0,keepOnlyColumnsToUpsert:!1});i(F)},[e,i,o]),m=x.useCallback((M,F)=>{var B;const H=Cr(e),G=(B=H[M])!=null?B:!0;if(F!==G){const _=k({},H,{[M]:F});e.current.setColumnVisibilityModel(_)}},[e]),w=x.useCallback(M=>zr(e).findIndex(B=>B===M),[e]),v=x.useCallback((M,F)=>{const B=zr(e),H=w(M);if(H===F)return;a.debug(`Moving column ${M} to index ${F}`);const G=[...B],_=G.splice(H,1)[0];G.splice(F,0,_),i(k({},_n(e.current.state),{orderedFields:G}));const Z={column:e.current.getColumn(M),targetIndex:e.current.getColumnIndexRelativeToVisibleColumns(M),oldIndex:H};e.current.publishEvent("columnIndexChange",Z)},[e,a,i,w]),C=x.useCallback((M,F)=>{var B,H;a.debug(`Updating column ${M} width to ${F}`);const G=_n(e.current.state),_=G.lookup[M],Z=k({},_,{width:F,hasBeenResized:!0});i(rl(k({},G,{lookup:k({},G.lookup,{[M]:Z})}),(B=(H=e.current.getRootDimensions())==null?void 0:H.viewportInnerSize.width)!=null?B:0)),e.current.publishEvent("columnWidthChange",{element:e.current.getColumnHeaderElement(M),colDef:Z,width:F})},[e,a,i]),E={getColumn:u,getAllColumns:c,getColumnIndex:f,getColumnPosition:p,getVisibleColumns:d,getColumnIndexRelativeToVisibleColumns:w,updateColumns:g,setColumnVisibilityModel:h,setColumnVisibility:m,setColumnWidth:C},R={setColumnIndex:v};ze(e,E,"public"),ze(e,R,t.signature===Or.DataGrid?"private":"public");const S=x.useCallback((M,F)=>{var B,H;const G={},_=Cr(e);(!F.exportOnlyDirtyModels||t.columnVisibilityModel!=null||Object.keys((B=(H=t.initialState)==null||(H=H.columns)==null?void 0:H.columnVisibilityModel)!=null?B:{}).length>0||Object.keys(_).length>0)&&(G.columnVisibilityModel=_),G.orderedFields=zr(e);const ee=Dr(e),P={};return ee.forEach(q=>{if(q.hasBeenResized){const K={};A0.forEach(X=>{let te=q[X];te===1/0&&(te=-1),K[X]=te}),P[q.field]=K}}),Object.keys(P).length>0&&(G.dimensions=P),k({},M,{columns:G})},[e,t.columnVisibilityModel,(r=t.initialState)==null?void 0:r.columns]),b=x.useCallback((M,F)=>{var B;const H=(B=F.stateToRestore.columns)==null?void 0:B.columnVisibilityModel,G=F.stateToRestore.columns;if(H==null&&G==null)return M;const _=ta({apiRef:e,columnTypes:o,columnsToUpsert:[],initialState:G,columnVisibilityModel:H,keepOnlyColumnsToUpsert:!1});return e.current.setState(uc(_)),G!=null&&e.current.publishEvent("columnsChange",_.orderedFields),M},[e,o]),T=x.useCallback((M,F)=>{if(F===_r.columns){var B;const H=t.slots.columnsPanel;return I.jsx(H,k({},(B=t.slotProps)==null?void 0:B.columnsPanel))}return M},[t.slots.columnsPanel,(n=t.slotProps)==null?void 0:n.columnsPanel]),A=x.useCallback(M=>t.disableColumnSelector?M:[...M,"columnMenuColumnsItem"],[t.disableColumnSelector]);kt(e,"columnMenu",A),kt(e,"exportState",S),kt(e,"restoreState",b),kt(e,"preferencePanel",T);const N=x.useRef(null);Fe(e,"viewportInnerSizeChange",M=>{N.current!==M.width&&(N.current=M.width,i(rl(_n(e.current.state),M.width)))});const D=x.useCallback(()=>{a.info("Columns pipe processing have changed, regenerating the columns");const M=ta({apiRef:e,columnTypes:o,columnsToUpsert:[],initialState:void 0,keepOnlyColumnsToUpsert:!1});i(M)},[e,a,i,o]);jl(e,"hydrateColumns",D);const L=x.useRef(!0);x.useEffect(()=>{if(L.current){L.current=!1;return}if(a.info(`GridColumns have changed, new length ${t.columns.length}`),s.current===t.columns&&l.current===o)return;const M=ta({apiRef:e,columnTypes:o,initialState:void 0,columnsToUpsert:t.columns,keepOnlyColumnsToUpsert:!0});s.current=t.columns,l.current=o,i(M)},[a,e,i,t.columns,o]),x.useEffect(()=>{t.columnVisibilityModel!==void 0&&e.current.setColumnVisibilityModel(t.columnVisibilityModel)},[e,a,t.columnVisibilityModel])}const Uw=.7,zw=1.3,D0={compact:Uw,comfortable:zw,standard:1},jw=(e,t)=>k({},e,{density:{value:t.density,factor:D0[t.density]}}),Ww=(e,t)=>{const r=Ut(e,"useDensity"),n=x.useCallback(o=>{r.debug(`Set grid density to ${o}`),e.current.setState(s=>{const l=Dl(s),i={value:o,factor:D0[o]};return jr(l,i)?s:k({},s,{density:i})}),e.current.forceUpdate()},[r,e]);x.useEffect(()=>{e.current.setDensity(t.density)},[e,t.density]),ze(e,{setDensity:n},"public")};function Kw(e,t="csv",r=document.title||"untitled"){const n=`${r}.${t}`;if("download"in HTMLAnchorElement.prototype){const a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=n,o.click(),setTimeout(()=>{URL.revokeObjectURL(a)});return}throw new Error("MUI: exportAs not supported")}const O0=({apiRef:e,options:t})=>{const r=Dr(e);return t.fields?t.fields.reduce((a,o)=>{const s=r.find(l=>l.field===o);return s&&a.push(s),a},[]):(t.allColumns?r:At(e)).filter(a=>!a.disableExport)},Xw=({apiRef:e})=>{var t,r;const n=$g(e),a=vr(e),o=e.current.getSelectedRows(),s=n.filter(c=>a[c].type!=="footer"),l=pa(e),i=(l==null||(t=l.top)==null?void 0:t.map(c=>c.id))||[],u=(l==null||(r=l.bottom)==null?void 0:r.map(c=>c.id))||[];return s.unshift(...i),s.push(...u),o.size>0?s.filter(c=>o.has(c)):s},Yw=(e,t)=>{const r=Ut(e,"useGridCsvExport"),n=t.unstable_ignoreValueFormatterDuringExport,a=(typeof n=="object"?n==null?void 0:n.csvExport:n)||!1,o=x.useCallback((u={})=>{var c,d,f;r.debug("Get data as CSV");const p=O0({apiRef:e,options:u}),g=((c=u.getRowsToExport)!=null?c:Xw)({apiRef:e});return Mw({columns:p,rowIds:g,delimiterCharacter:u.delimiter||",",includeHeaders:(d=u.includeHeaders)!=null?d:!0,includeColumnGroupsHeaders:(f=u.includeColumnGroupsHeaders)!=null?f:!0,ignoreValueFormatter:a,apiRef:e})},[r,e,a]),s=x.useCallback(u=>{r.debug("Export data as CSV");const c=o(u),d=new Blob([u!=null&&u.utf8WithBom?new Uint8Array([239,187,191]):"",c],{type:"text/csv"});Kw(d,"csv",u==null?void 0:u.fileName)},[r,o]);ze(e,{getDataAsCsv:o,exportDataAsCsv:s},"public");const i=x.useCallback((u,c)=>{var d;return(d=c.csvOptions)!=null&&d.disableToolbarButton?u:[...u,{component:I.jsx(fv,{options:c.csvOptions}),componentName:"csvExport"}]},[]);kt(e,"exportMenu",i)},qw=(e,t)=>{var r,n;const a=k({},s0(t.autoPageSize),(r=t.paginationModel)!=null?r:(n=t.initialState)==null||(n=n.pagination)==null?void 0:n.paginationModel);return l0(a.pageSize,t.signature),k({},e,{pagination:{paginationModel:a}})},Oo=(e,t,r)=>n=>{var a;let o=n.paginationModel;const s=(a=r==null?void 0:r.pageSize)!=null?a:o.pageSize,l=o0(e,s);r&&((r==null?void 0:r.page)!==o.page||(r==null?void 0:r.pageSize)!==o.pageSize)&&(o=r);const i=Yp(o.page,l);return i!==o.page&&(o=k({},o,{page:i})),l0(o.pageSize,t),{paginationModel:o}},Zw=(e,t)=>{var r;const n=Ut(e,"useGridPagination"),a=Ce(e,gs),o=Ce(e,xa),s=Math.floor(t.rowHeight*o);e.current.registerControlState({stateId:"pagination",propModel:t.paginationModel,propOnChange:t.onPaginationModelChange,stateSelector:fr,changeEvent:"paginationModelChange"});const l=x.useCallback(g=>{const m=fr(e);g!==m.page&&(n.debug(`Setting page to ${g}`),e.current.setPaginationModel({page:g,pageSize:m.pageSize}))},[e,n]),i=x.useCallback(g=>{const m=fr(e);g!==m.pageSize&&(n.debug(`Setting page size to ${g}`),e.current.setPaginationModel({pageSize:g,page:m.page}))},[e,n]),u=x.useCallback(g=>{var m;const w=fr(e);g!==w&&(n.debug("Setting 'paginationModel' to",g),e.current.updateControlState("pagination",Oo((m=t.rowCount)!=null?m:a,t.signature,g),"setPaginationModel"),e.current.forceUpdate())},[e,n,t.rowCount,t.signature,a]);ze(e,{setPage:l,setPageSize:i,setPaginationModel:u},"public");const d=x.useCallback((g,m)=>{var w;const v=fr(e);return!m.exportOnlyDirtyModels||t.paginationModel!=null||((w=t.initialState)==null||(w=w.pagination)==null?void 0:w.paginationModel)!=null||v.page!==0&&v.pageSize!==Xp(t.autoPageSize)?k({},g,{pagination:k({},g.pagination,{paginationModel:v})}):g},[e,t.paginationModel,(r=t.initialState)==null||(r=r.pagination)==null?void 0:r.paginationModel,t.autoPageSize]),f=x.useCallback((g,m)=>{var w,v,C;const E=(w=m.stateToRestore.pagination)!=null&&w.paginationModel?k({},s0(t.autoPageSize),(v=m.stateToRestore.pagination)==null?void 0:v.paginationModel):fr(e);return e.current.updateControlState("pagination",Oo((C=t.rowCount)!=null?C:a,t.signature,E),"stateRestorePreProcessing"),g},[e,t.autoPageSize,t.rowCount,t.signature,a]);kt(e,"exportState",d),kt(e,"restoreState",f);const p=()=>{var g;const m=fr(e);(g=e.current.virtualScrollerRef)!=null&&g.current&&e.current.scrollToIndexes({rowIndex:m.page*m.pageSize}),e.current.forceUpdate()},h=x.useCallback(()=>{const g=e.current.getRootDimensions();if(!t.autoPageSize||!g)return;const m=Wu(e),w=Math.floor((g.viewportInnerSize.height-m.top-m.bottom)/s);e.current.setPageSize(w)},[e,t.autoPageSize,s]);Fe(e,"viewportInnerSizeChange",h),Fe(e,"paginationModelChange",p),x.useEffect(()=>{},[t.rowCount,t.paginationMode]),x.useEffect(()=>{var g;e.current.updateControlState("pagination",Oo((g=t.rowCount)!=null?g:a,t.signature,t.paginationModel))},[e,t.paginationModel,t.rowCount,t.paginationMode,a,t.signature]),x.useEffect(()=>{h()},[h])};function Qw(){return new Promise(e=>{requestAnimationFrame(()=>{e()})})}function Jw(e){const t=document.createElement("iframe");return t.style.position="absolute",t.style.width="0px",t.style.height="0px",t.title=e||document.title,t}const eC=(e,t)=>{const r=Ut(e,"useGridPrintExport"),n=x.useRef(null),a=x.useRef(null),o=x.useRef({}),s=x.useRef([]);x.useEffect(()=>{n.current=ls(e.current.rootElementRef.current)},[e]);const l=x.useCallback((h,g,m)=>new Promise(w=>{const v=O0({apiRef:e,options:{fields:h,allColumns:g}}).map(R=>R.field),C=Dr(e),E={};C.forEach(R=>{E[R.field]=v.includes(R.field)}),m&&(E[ma.field]=!0),e.current.setColumnVisibilityModel(E),w()}),[e]),i=x.useCallback(h=>{const m=h({apiRef:e}).map(w=>e.current.getRow(w));e.current.setRows(m)},[e]),u=x.useCallback((h,g)=>{var m,w;const v=k({copyStyles:!0,hideToolbar:!1,hideFooter:!1,includeCheckboxes:!1},g),C=h.contentDocument;if(!C)return;const E=Wa(e.current.state),R=e.current.rootElementRef.current,S=R.cloneNode(!0),b=S.querySelector(`.${Q.main}`);b.style.overflow="visible",S.style.contain="size";const A=S.querySelector(`.${Q.columnHeaders}`).querySelector(`.${Q.columnHeadersInner}`);A.style.width="100%";let N=((m=R.querySelector(`.${Q.toolbarContainer}`))==null?void 0:m.offsetHeight)||0,y=((w=R.querySelector(`.${Q.footerContainer}`))==null?void 0:w.offsetHeight)||0;if(v.hideToolbar){var D;(D=S.querySelector(`.${Q.toolbarContainer}`))==null||D.remove(),N=0}if(v.hideFooter){var L;(L=S.querySelector(`.${Q.footerContainer}`))==null||L.remove(),y=0}const M=E.currentPageTotalHeight+Wl(e,t.columnHeaderHeight)+N+y;if(S.style.height=`${M}px`,S.style.boxSizing="content-box",g!=null&&g.getRowsToExport){const G=S.querySelector(`.${Q.footerContainer}`);G.style.position="absolute",G.style.width="100%",G.style.top=`${M-y}px`}const F=document.createElement("div");F.appendChild(S),C.body.innerHTML=F.innerHTML;const B=typeof v.pageStyle=="function"?v.pageStyle():v.pageStyle;if(typeof B=="string"){const G=C.createElement("style");G.appendChild(C.createTextNode(B)),C.head.appendChild(G)}v.bodyClassName&&C.body.classList.add(...v.bodyClassName.split(" "));const H=[];if(v.copyStyles){const G=R.getRootNode(),Z=(G.constructor.name==="ShadowRoot"?G:n.current).querySelectorAll("style, link[rel='stylesheet']");for(let ee=0;ee<Z.length;ee+=1){const P=Z[ee];if(P.tagName==="STYLE"){const q=C.createElement(P.tagName),K=P.sheet;if(K){let X="";for(let te=0;te<K.cssRules.length;te+=1)typeof K.cssRules[te].cssText=="string"&&(X+=`${K.cssRules[te].cssText}\r
`);q.appendChild(C.createTextNode(X)),C.head.appendChild(q)}}else if(P.getAttribute("href")){const q=C.createElement(P.tagName);for(let K=0;K<P.attributes.length;K+=1){const X=P.attributes[K];X&&q.setAttribute(X.nodeName,X.nodeValue||"")}H.push(new Promise(K=>{q.addEventListener("load",()=>K())})),C.head.appendChild(q)}}}Promise.all(H).then(()=>{h.contentWindow.print()})},[e,n,t.columnHeaderHeight]),c=x.useCallback(h=>{var g;n.current.body.removeChild(h),e.current.restoreState(a.current||{}),(g=a.current)!=null&&(g=g.columns)!=null&&g.columnVisibilityModel||e.current.setColumnVisibilityModel(o.current),e.current.unstable_setVirtualization(!0),e.current.setRows(s.current),a.current=null,o.current={},s.current=[]},[e]),f={exportDataAsPrint:x.useCallback(async h=>{if(r.debug("Export data as Print"),!e.current.rootElementRef.current)throw new Error("MUI: No grid root element available.");if(a.current=e.current.exportState(),o.current=Cr(e),s.current=e.current.getSortedRows(),t.pagination){const m=$u(e),w={page:0,pageSize:m};e.current.updateControlState("pagination",Oo(m,"DataGridPro",w)),e.current.forceUpdate()}await l(h==null?void 0:h.fields,h==null?void 0:h.allColumns,h==null?void 0:h.includeCheckboxes),h!=null&&h.getRowsToExport&&i(h.getRowsToExport),e.current.unstable_setVirtualization(!1),await Qw();const g=Jw(h==null?void 0:h.fileName);g.onload=()=>{u(g,h),g.contentWindow.matchMedia("print").addEventListener("change",w=>{w.matches===!1&&c(g)})},n.current.body.appendChild(g)},[t,r,e,u,c,l,i])};ze(e,f,"public");const p=x.useCallback((h,g)=>{var m;return(m=g.printOptions)!=null&&m.disableToolbarButton?h:[...h,{component:I.jsx(hv,{options:g.printOptions}),componentName:"printExport"}]},[]);kt(e,"exportMenu",p)},tC=(e,t,r)=>{var n,a,o;const s=(n=(a=t.filterModel)!=null?a:(o=t.initialState)==null||(o=o.filter)==null?void 0:o.filterModel)!=null?n:ja();return k({},e,{filter:{filterModel:k0(s,t.disableMultipleColumnsFiltering,r),filteredRowsLookup:{},filteredDescendantCountLookup:{}},visibleRowsLookup:{}})},rC=e=>e.filteredRowsLookup;function dc(e,t){return e.current.applyStrategyProcessor("visibleRowsLookupCreation",{tree:t.rows.tree,filteredRowsLookup:t.filter.filteredRowsLookup})}function nC(){return cs(Object.values)}const aC=(e,t)=>{var r,n;const a=Ut(e,"useGridFilter");e.current.registerControlState({stateId:"filter",propModel:t.filterModel,propOnChange:t.onFilterModelChange,stateSelector:It,changeEvent:"filterModelChange"});const o=x.useCallback(()=>{e.current.setState(N=>{const y=It(N,e.current.instanceId),D=t.filterMode==="client"?zv(y,e,t.disableEval):null,L=e.current.applyStrategyProcessor("filtering",{isRowMatchingFilters:D,filterModel:y??ja()}),M=k({},N,{filter:k({},N.filter,L)}),F=dc(e,M);return k({},M,{visibleRowsLookup:F})}),e.current.publishEvent("filteredRowsSet")},[e,t.filterMode,t.disableEval]),s=x.useCallback((N,y)=>y==null||y.filterable===!1||t.disableColumnFilter?N:[...N,"columnMenuFilterItem"],[t.disableColumnFilter]),l=x.useCallback(()=>{o(),e.current.forceUpdate()},[e,o]),i=x.useCallback(N=>{const y=It(e),D=[...y.items],L=D.findIndex(M=>M.id===N.id);L===-1?D.push(N):D[L]=N,e.current.setFilterModel(k({},y,{items:D}),"upsertFilterItem")},[e]),u=x.useCallback(N=>{const y=It(e),D=[...y.items];N.forEach(L=>{const M=N.findIndex(F=>F.id===L.id);M===-1?D.push(L):D[M]=L}),e.current.setFilterModel(k({},y,{items:N}),"upsertFilterItems")},[e]),c=x.useCallback(N=>{const y=It(e),D=y.items.filter(L=>L.id!==N.id);D.length!==y.items.length&&e.current.setFilterModel(k({},y,{items:D}),"deleteFilterItem")},[e]),d=x.useCallback((N,y,D)=>{if(a.debug("Displaying filter panel"),N){const L=It(e),M=L.items.filter(G=>{var _;if(G.value!==void 0)return!(Array.isArray(G.value)&&G.value.length===0);const ee=(_=e.current.getColumn(G.field).filterOperators)==null?void 0:_.find(q=>q.value===G.operator);return!(typeof(ee==null?void 0:ee.requiresFilterValue)>"u"?!0:ee==null?void 0:ee.requiresFilterValue)});let F;const B=M.find(G=>G.field===N),H=e.current.getColumn(N);B?F=M:t.disableMultipleColumnsFiltering?F=[Js({field:N,operator:H.filterOperators[0].value},e)]:F=[...M,Js({field:N,operator:H.filterOperators[0].value},e)],e.current.setFilterModel(k({},L,{items:F}))}e.current.showPreferences(_r.filters,y,D)},[e,a,t.disableMultipleColumnsFiltering]),f=x.useCallback(()=>{a.debug("Hiding filter panel"),e.current.hidePreferences()},[e,a]),p=x.useCallback(N=>{const y=It(e);y.logicOperator!==N&&e.current.setFilterModel(k({},y,{logicOperator:N}),"changeLogicOperator")},[e]),h=x.useCallback(N=>{const y=It(e);jr(y.quickFilterValues,N)||e.current.setFilterModel(k({},y,{quickFilterValues:[...N]}))},[e]),g=x.useCallback((N,y)=>{It(e)!==N&&(a.debug("Setting filter model"),e.current.updateControlState("filter",Ji(N,t.disableMultipleColumnsFiltering,e),y),e.current.unstable_applyFilters())},[e,a,t.disableMultipleColumnsFiltering]),m={setFilterLogicOperator:p,unstable_applyFilters:l,deleteFilterItem:c,upsertFilterItem:i,upsertFilterItems:u,setFilterModel:g,showFilterPanel:d,hideFilterPanel:f,setQuickFilterValues:h,ignoreDiacritics:t.ignoreDiacritics};ze(e,m,"public");const w=x.useCallback((N,y)=>{var D;const L=It(e);return!y.exportOnlyDirtyModels||t.filterModel!=null||((D=t.initialState)==null||(D=D.filter)==null?void 0:D.filterModel)!=null||!jr(L,ja())?k({},N,{filter:{filterModel:L}}):N},[e,t.filterModel,(r=t.initialState)==null||(r=r.filter)==null?void 0:r.filterModel]),v=x.useCallback((N,y)=>{var D;const L=(D=y.stateToRestore.filter)==null?void 0:D.filterModel;return L==null?N:(e.current.updateControlState("filter",Ji(L,t.disableMultipleColumnsFiltering,e),"restoreState"),k({},N,{callbacks:[...N.callbacks,e.current.unstable_applyFilters]}))},[e,t.disableMultipleColumnsFiltering]),C=x.useCallback((N,y)=>{if(y===_r.filters){var D;const L=t.slots.filterPanel;return I.jsx(L,k({},(D=t.slotProps)==null?void 0:D.filterPanel))}return N},[t.slots.filterPanel,(n=t.slotProps)==null?void 0:n.filterPanel]),{getRowId:E}=t,R=_l(nC),S=x.useCallback(N=>{if(t.filterMode!=="client"||!N.isRowMatchingFilters)return{filteredRowsLookup:{},filteredDescendantCountLookup:{}};const y=cn(e),D={},{isRowMatchingFilters:L}=N,M={},F={passingFilterItems:null,passingQuickFilterValues:null},B=R.current(e.current.state.rows.dataRowIdToModelLookup);for(let _=0;_<B.length;_+=1){const Z=B[_],ee=E?E(Z):Z.id;L(Z,void 0,F);const P=Wv([F.passingFilterItems],[F.passingQuickFilterValues],N.filterModel,e,M);D[ee]=P}const H="auto-generated-group-footer-root";return y[H]&&(D[H]=!0),{filteredRowsLookup:D,filteredDescendantCountLookup:{}}},[e,t.filterMode,E,R]);kt(e,"columnMenu",s),kt(e,"exportState",w),kt(e,"restoreState",v),kt(e,"preferencePanel",C),Xo(e,Mn,"filtering",S),Xo(e,Mn,"visibleRowsLookupCreation",rC);const b=x.useCallback(()=>{a.debug("onColUpdated - GridColumns changed, applying filters");const N=It(e),y=Tg(e),D=N.items.filter(L=>L.field&&y[L.field]);D.length<N.items.length&&e.current.setFilterModel(k({},N,{items:D}))},[e,a]),T=x.useCallback(N=>{N==="filtering"&&e.current.unstable_applyFilters()},[e]),A=x.useCallback(()=>{e.current.setState(N=>k({},N,{visibleRowsLookup:dc(e,N)})),e.current.forceUpdate()},[e]);Fe(e,"rowsSet",o),Fe(e,"columnsChange",b),Fe(e,"activeStrategyProcessorChange",T),Fe(e,"rowExpansionChange",A),Fe(e,"columnVisibilityModelChange",()=>{const N=It(e);N.quickFilterValues&&N.quickFilterExcludeHiddenColumns&&e.current.unstable_applyFilters()}),oo(()=>{e.current.unstable_applyFilters()}),Mt(()=>{t.filterModel!==void 0&&e.current.setFilterModel(t.filterModel)},[e,a,t.filterModel])},oC=e=>k({},e,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null},tabIndex:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}),sC=(e,t)=>{const r=Ut(e,"useGridFocus"),n=x.useRef(null),a=x.useCallback((b,T)=>{b&&e.current.getRow(b.id)&&e.current.publishEvent("cellFocusOut",e.current.getCellParams(b.id,b.field),T)},[e]),o=x.useCallback((b,T)=>{const A=nr(e);(A==null?void 0:A.id)===b&&(A==null?void 0:A.field)===T||(e.current.setState(N=>(r.debug(`Focusing on cell with id=${b} and field=${T}`),k({},N,{tabIndex:{cell:{id:b,field:T},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null},focus:{cell:{id:b,field:T},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}))),e.current.forceUpdate(),e.current.getRow(b)&&(A&&a(A,{}),e.current.publishEvent("cellFocusIn",e.current.getCellParams(b,T))))},[e,r,a]),s=x.useCallback((b,T={})=>{const A=nr(e);a(A,T),e.current.setState(N=>(r.debug(`Focusing on column header with colIndex=${b}`),k({},N,{tabIndex:{columnHeader:{field:b},columnHeaderFilter:null,cell:null,columnGroupHeader:null},focus:{columnHeader:{field:b},columnHeaderFilter:null,cell:null,columnGroupHeader:null}}))),e.current.forceUpdate()},[e,r,a]),l=x.useCallback((b,T={})=>{const A=nr(e);a(A,T),e.current.setState(N=>(r.debug(`Focusing on column header filter with colIndex=${b}`),k({},N,{tabIndex:{columnHeader:null,columnHeaderFilter:{field:b},cell:null,columnGroupHeader:null},focus:{columnHeader:null,columnHeaderFilter:{field:b},cell:null,columnGroupHeader:null}}))),e.current.forceUpdate()},[e,r,a]),i=x.useCallback((b,T,A={})=>{const N=nr(e);N&&e.current.publishEvent("cellFocusOut",e.current.getCellParams(N.id,N.field),A),e.current.setState(y=>k({},y,{tabIndex:{columnGroupHeader:{field:b,depth:T},columnHeader:null,columnHeaderFilter:null,cell:null},focus:{columnGroupHeader:{field:b,depth:T},columnHeader:null,columnHeaderFilter:null,cell:null}})),e.current.forceUpdate()},[e]),u=x.useCallback(()=>Ho(e),[e]),c=x.useCallback((b,T,A)=>{let N=e.current.getColumnIndex(T);const y=At(e),D=Wo(e,{pagination:t.pagination,paginationMode:t.paginationMode}),L=pa(e),M=[].concat(L.top||[],D.rows,L.bottom||[]);let F=M.findIndex(_=>_.id===b);A==="right"?N+=1:A==="left"?N-=1:F+=1,N>=y.length?(F+=1,F<M.length&&(N=0)):N<0&&(F-=1,F>=0&&(N=y.length-1)),F=fa(F,0,M.length-1);const B=M[F];if(!B)return;const H=e.current.unstable_getCellColSpanInfo(B.id,N);H&&H.spannedByColSpan&&(A==="left"||A==="below"?N=H.leftVisibleCellIndex:A==="right"&&(N=H.rightVisibleCellIndex)),N=fa(N,0,y.length-1);const G=y[N];e.current.setCellFocus(B.id,G.field)},[e,t.pagination,t.paginationMode]),d=x.useCallback(({id:b,field:T})=>{e.current.setCellFocus(b,T)},[e]),f=x.useCallback((b,T)=>{T.key==="Enter"||T.key==="Tab"||T.key==="Shift"||zo(T.key)||e.current.setCellFocus(b.id,b.field)},[e]),p=x.useCallback(({field:b},T)=>{T.target===T.currentTarget&&e.current.setColumnHeaderFocus(b,T)},[e]),h=x.useCallback(({fields:b,depth:T},A)=>{if(A.target!==A.currentTarget)return;const N=Ho(e);N!==null&&N.depth===T&&b.includes(N.field)||e.current.setColumnGroupHeaderFocus(b[0],T,A)},[e]),g=x.useCallback((b,T)=>{var A;(A=T.relatedTarget)!=null&&A.className.includes(Q.columnHeader)||(r.debug("Clearing focus"),e.current.setState(N=>k({},N,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}})))},[r,e]),m=x.useCallback(b=>{n.current=b},[]),w=x.useCallback(b=>{const T=n.current;n.current=null;const A=nr(e);if(!e.current.unstable_applyPipeProcessors("canUpdateFocus",!0,{event:b,cell:T}))return;if(!A){T&&e.current.setCellFocus(T.id,T.field);return}if((T==null?void 0:T.id)===A.id&&(T==null?void 0:T.field)===A.field)return;const y=e.current.getCellElement(A.id,A.field);y!=null&&y.contains(b.target)||(T?e.current.setCellFocus(T.id,T.field):(e.current.setState(D=>k({},D,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}})),e.current.forceUpdate(),a(A,b)))},[e,a]),v=x.useCallback(b=>{if(b.cellMode==="view")return;const T=nr(e);((T==null?void 0:T.id)!==b.id||(T==null?void 0:T.field)!==b.field)&&e.current.setCellFocus(b.id,b.field)},[e]),C=x.useCallback(()=>{const b=nr(e);b&&!e.current.getRow(b.id)&&e.current.setState(T=>k({},T,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}))},[e]),E=Er(()=>{const b=nr(e);if(!b)return;const T=Wo(e,{pagination:t.pagination,paginationMode:t.paginationMode});if(T.rows.find(y=>y.id===b.id))return;const N=At(e);e.current.setState(y=>k({},y,{tabIndex:{cell:{id:T.rows[0].id,field:N[0].field},columnGroupHeader:null,columnHeader:null,columnHeaderFilter:null}}))}),R={setCellFocus:o,setColumnHeaderFocus:s,setColumnHeaderFilterFocus:l},S={moveFocusToRelativeCell:c,setColumnGroupHeaderFocus:i,getColumnGroupHeaderFocus:u};ze(e,R,"public"),ze(e,S,"private"),x.useEffect(()=>{const b=ls(e.current.rootElementRef.current);return b.addEventListener("mouseup",w),()=>{b.removeEventListener("mouseup",w)}},[e,w]),Fe(e,"columnHeaderBlur",g),Fe(e,"cellDoubleClick",d),Fe(e,"cellMouseDown",m),Fe(e,"cellKeyDown",f),Fe(e,"cellModeChange",v),Fe(e,"columnHeaderFocus",p),Fe(e,"columnGroupHeaderFocus",h),Fe(e,"rowsSet",C),Fe(e,"paginationModelChange",E)};function lC(e,t){const r=pa(e)||{};return[...r.top||[],...t,...r.bottom||[]]}const Ls=({currentColIndex:e,firstColIndex:t,lastColIndex:r,direction:n})=>{if(n==="rtl"){if(e<r)return e+1}else if(n==="ltr"&&e>t)return e-1;return null},Ns=({currentColIndex:e,firstColIndex:t,lastColIndex:r,direction:n})=>{if(n==="rtl"){if(e>t)return e-1}else if(n==="ltr"&&e<r)return e+1;return null},iC=(e,t)=>{const r=Ut(e,"useGridKeyboardNavigation"),n=Hn(e,t).rows,a=Yr(),o=x.useMemo(()=>lC(e,n),[e,n]),s=t.signature!=="DataGrid"&&t.unstable_headerFilters,l=x.useCallback((w,v,C="left")=>{const E=wn(e),R=e.current.unstable_getCellColSpanInfo(v,w);R&&R.spannedByColSpan&&(C==="left"?w=R.leftVisibleCellIndex:C==="right"&&(w=R.rightVisibleCellIndex));const S=E.findIndex(T=>T.id===v);r.debug(`Navigating to cell row ${S}, col ${w}`),e.current.scrollToIndexes({colIndex:w,rowIndex:S});const b=e.current.getVisibleColumns()[w].field;e.current.setCellFocus(v,b)},[e,r]),i=x.useCallback((w,v)=>{r.debug(`Navigating to header col ${w}`),e.current.scrollToIndexes({colIndex:w});const C=e.current.getVisibleColumns()[w].field;e.current.setColumnHeaderFocus(C,v)},[e,r]),u=x.useCallback((w,v)=>{r.debug(`Navigating to header filter col ${w}`),e.current.scrollToIndexes({colIndex:w});const C=e.current.getVisibleColumns()[w].field;e.current.setColumnHeaderFilterFocus(C,v)},[e,r]),c=x.useCallback((w,v,C)=>{r.debug(`Navigating to header col ${w}`),e.current.scrollToIndexes({colIndex:w});const{field:E}=e.current.getVisibleColumns()[w];e.current.setColumnGroupHeaderFocus(E,v,C)},[e,r]),d=x.useCallback(w=>{var v;return(v=o[w])==null?void 0:v.id},[o]),f=x.useCallback((w,v)=>{const C=v.currentTarget.querySelector(`.${Q.columnHeaderTitleContainerContent}`);if(!!C&&C.contains(v.target)&&w.field!==ma.field||!e.current.getRootDimensions())return;const S=e.current.getViewportPageSize(),b=w.field?e.current.getColumnIndex(w.field):0,T=o.length>0?0:null,A=o.length-1,N=0,y=At(e).length-1,D=no(e);let L=!0;switch(v.key){case"ArrowDown":{T!==null&&(s?u(b,v):l(b,d(T)));break}case"ArrowRight":{const M=Ns({currentColIndex:b,firstColIndex:N,lastColIndex:y,direction:a.direction});M!==null&&i(M,v);break}case"ArrowLeft":{const M=Ls({currentColIndex:b,firstColIndex:N,lastColIndex:y,direction:a.direction});M!==null&&i(M,v);break}case"ArrowUp":{D>0&&c(b,D-1,v);break}case"PageDown":{T!==null&&A!==null&&l(b,d(Math.min(T+S,A)));break}case"Home":{i(N,v);break}case"End":{i(y,v);break}case"Enter":{(v.ctrlKey||v.metaKey)&&e.current.toggleColumnMenu(w.field);break}case" ":break;default:L=!1}L&&v.preventDefault()},[e,o.length,s,u,l,d,a.direction,i,c]),p=x.useCallback((w,v)=>{if(!e.current.getRootDimensions())return;const E=ix(e)===w.field,R=cx(e)===w.field;if(E||R||!zo(v.key))return;const S=e.current.getViewportPageSize(),b=w.field?e.current.getColumnIndex(w.field):0,T=0,A=o.length-1,N=0,y=At(e).length-1;let D=!0;switch(v.key){case"ArrowDown":{const L=d(T);L!=null&&l(b,L);break}case"ArrowRight":{const L=Ns({currentColIndex:b,firstColIndex:N,lastColIndex:y,direction:a.direction});L!==null&&u(L,v);break}case"ArrowLeft":{const L=Ls({currentColIndex:b,firstColIndex:N,lastColIndex:y,direction:a.direction});L!==null?u(L,v):e.current.setColumnHeaderFilterFocus(w.field,v);break}case"ArrowUp":{i(b,v);break}case"PageDown":{A!==null&&l(b,d(Math.min(T+S,A)));break}case"Home":{u(N,v);break}case"End":{u(y,v);break}case" ":break;default:D=!1}D&&v.preventDefault()},[e,o.length,u,a.direction,i,l,d]),h=x.useCallback((w,v)=>{if(!e.current.getRootDimensions())return;const E=Ho(e);if(E===null)return;const{field:R,depth:S}=E,{fields:b,depth:T,maxDepth:A}=w,N=e.current.getViewportPageSize(),y=e.current.getColumnIndex(R),D=R?e.current.getColumnIndex(R):0,L=0,M=o.length-1,F=0,B=At(e).length-1;let H=!0;switch(v.key){case"ArrowDown":{T===A-1?i(y,v):c(y,S+1,v);break}case"ArrowUp":{T>0&&c(y,S-1,v);break}case"ArrowRight":{const G=b.length-b.indexOf(R)-1;y+G+1<=B&&c(y+G+1,S,v);break}case"ArrowLeft":{const G=b.indexOf(R);y-G-1>=F&&c(y-G-1,S,v);break}case"PageDown":{M!==null&&l(D,d(Math.min(L+N,M)));break}case"Home":{c(F,S,v);break}case"End":{c(B,S,v);break}case" ":break;default:H=!1}H&&v.preventDefault()},[e,o.length,i,c,l,d]),g=x.useCallback((w,v)=>{if(ao(v))return;const C=e.current.getCellParams(w.id,w.field);if(C.cellMode===at.Edit||!zo(v.key)||!e.current.unstable_applyPipeProcessors("canUpdateFocus",!0,{event:v,cell:C}))return;const R=e.current.getRootDimensions();if(o.length===0||!R)return;const S=a.direction,b=e.current.getViewportPageSize(),T=w.field?e.current.getColumnIndex(w.field):0,A=o.findIndex(F=>F.id===w.id),N=0,y=o.length-1,D=0,L=At(e).length-1;let M=!0;switch(v.key){case"ArrowDown":{A<y&&l(T,d(A+1));break}case"ArrowUp":{A>N?l(T,d(A-1)):s?u(T,v):i(T,v);break}case"ArrowRight":{const F=Ns({currentColIndex:T,firstColIndex:D,lastColIndex:L,direction:S});F!==null&&l(F,d(A),S==="rtl"?"left":"right");break}case"ArrowLeft":{const F=Ls({currentColIndex:T,firstColIndex:D,lastColIndex:L,direction:S});F!==null&&l(F,d(A),S==="rtl"?"right":"left");break}case"Tab":{v.shiftKey&&T>D?l(T-1,d(A),"left"):!v.shiftKey&&T<L&&l(T+1,d(A),"right");break}case" ":{if(w.field===Ul)break;const B=w.colDef;if(B&&B.type==="treeDataGroup")break;!v.shiftKey&&A<y&&l(T,d(Math.min(A+b,y)));break}case"PageDown":{A<y&&l(T,d(Math.min(A+b,y)));break}case"PageUp":{const F=Math.max(A-b,N);F!==A&&F>=N?l(T,d(F)):i(T,v);break}case"Home":{v.ctrlKey||v.metaKey||v.shiftKey?l(D,d(N)):l(D,d(A));break}case"End":{v.ctrlKey||v.metaKey||v.shiftKey?l(L,d(y)):l(L,d(A));break}default:M=!1}M&&v.preventDefault()},[e,o,a.direction,l,d,s,u,i]),m=x.useCallback((w,{event:v})=>v.key===" "?!1:w,[]);kt(e,"canStartEditing",m),Fe(e,"columnHeaderKeyDown",f),Fe(e,"headerFilterKeyDown",p),Fe(e,"columnGroupHeaderKeyDown",h),Fe(e,"cellKeyDown",g)},cC=(e,t)=>{var r,n;return k({},e,{preferencePanel:(r=(n=t.initialState)==null?void 0:n.preferencePanel)!=null?r:{open:!1}})},uC=(e,t)=>{var r;const n=Ut(e,"useGridPreferencesPanel"),a=x.useRef(),o=x.useRef(),s=x.useCallback(()=>{n.debug("Hiding Preferences Panel");const f=An(e.current.state);f.openedPanelValue&&e.current.publishEvent("preferencePanelClose",{openedPanelValue:f.openedPanelValue}),e.current.setState(p=>k({},p,{preferencePanel:{open:!1}})),e.current.forceUpdate()},[e,n]),l=x.useCallback(()=>{o.current=setTimeout(()=>clearTimeout(a.current),0)},[]),i=x.useCallback(()=>{a.current=setTimeout(s,100)},[s]),u=x.useCallback((f,p,h)=>{n.debug("Opening Preferences Panel"),l(),e.current.setState(g=>k({},g,{preferencePanel:k({},g.preferencePanel,{open:!0,openedPanelValue:f,panelId:p,labelId:h})})),e.current.publishEvent("preferencePanelOpen",{openedPanelValue:f}),e.current.forceUpdate()},[n,l,e]);ze(e,{showPreferences:u,hidePreferences:i},"public");const c=x.useCallback((f,p)=>{var h;const g=An(e.current.state);return!p.exportOnlyDirtyModels||((h=t.initialState)==null?void 0:h.preferencePanel)!=null||g.open?k({},f,{preferencePanel:g}):f},[e,(r=t.initialState)==null?void 0:r.preferencePanel]),d=x.useCallback((f,p)=>{const h=p.stateToRestore.preferencePanel;return h!=null&&e.current.setState(g=>k({},g,{preferencePanel:h})),f},[e]);kt(e,"exportState",c),kt(e,"restoreState",d),x.useEffect(()=>()=>{clearTimeout(a.current),clearTimeout(o.current)},[])},dC=["id","field"],fC=["id","field"],hC=Nr(["MUI: A call to `processRowUpdate` threw an error which was not handled because `onProcessRowUpdateError` is missing.","To handle the error pass a callback to the `onProcessRowUpdateError` prop, e.g. `<DataGrid onProcessRowUpdateError={(error) => ...} />`.","For more detail, see http://mui.com/components/data-grid/editing/#server-side-persistence."],"error"),gC=(e,t)=>{const[r,n]=x.useState({}),a=x.useRef(r),o=x.useRef({}),{processRowUpdate:s,onProcessRowUpdateError:l,cellModesModel:i,onCellModesModelChange:u}=t,c=M=>(...F)=>{t.editMode===Rr.Cell&&M(...F)},d=x.useCallback((M,F)=>{const B=e.current.getCellParams(M,F);if(!e.current.isCellEditable(B))throw new Error(`MUI: The cell with id=${M} and field=${F} is not editable.`)},[e]),f=x.useCallback((M,F,B)=>{if(e.current.getCellMode(M,F)!==B)throw new Error(`MUI: The cell with id=${M} and field=${F} is not in ${B} mode.`)},[e]),p=x.useCallback((M,F)=>{if(!M.isEditable||M.cellMode===at.Edit)return;const B=k({},M,{reason:Vr.cellDoubleClick});e.current.publishEvent("cellEditStart",B,F)},[e]),h=x.useCallback((M,F)=>{if(M.cellMode===at.View||e.current.getCellMode(M.id,M.field)===at.View)return;const B=k({},M,{reason:mr.cellFocusOut});e.current.publishEvent("cellEditStop",B,F)},[e]),g=x.useCallback((M,F)=>{if(M.cellMode===at.Edit){if(F.which===229)return;let B;if(F.key==="Escape"?B=mr.escapeKeyDown:F.key==="Enter"?B=mr.enterKeyDown:F.key==="Tab"&&(B=F.shiftKey?mr.shiftTabKeyDown:mr.tabKeyDown,F.preventDefault()),B){const H=k({},M,{reason:B});e.current.publishEvent("cellEditStop",H,F)}}else if(M.isEditable){let B;if(!e.current.unstable_applyPipeProcessors("canStartEditing",!0,{event:F,cellParams:M,editMode:"cell"}))return;if(Qu(F)?B=Vr.printableKeyDown:(F.ctrlKey||F.metaKey)&&F.key==="v"?B=Vr.pasteKeyDown:F.key==="Enter"?B=Vr.enterKeyDown:(F.key==="Delete"||F.key==="Backspace")&&(B=Vr.deleteKeyDown),B){const G=k({},M,{reason:B,key:F.key});e.current.publishEvent("cellEditStart",G,F)}}},[e]),m=x.useCallback(M=>{const{id:F,field:B,reason:H}=M,G={id:F,field:B};(H===Vr.printableKeyDown||H===Vr.deleteKeyDown||H===Vr.pasteKeyDown)&&(G.deleteValue=!0),e.current.startCellEditMode(G)},[e]),w=x.useCallback(M=>{const{id:F,field:B,reason:H}=M;e.current.runPendingEditCellValueMutation(F,B);let G;H===mr.enterKeyDown?G="below":H===mr.tabKeyDown?G="right":H===mr.shiftTabKeyDown&&(G="left");const _=H==="escapeKeyDown";e.current.stopCellEditMode({id:F,field:B,ignoreModifications:_,cellToFocusAfter:G})},[e]);Fe(e,"cellDoubleClick",c(p)),Fe(e,"cellFocusOut",c(h)),Fe(e,"cellKeyDown",c(g)),Fe(e,"cellEditStart",c(m)),Fe(e,"cellEditStop",c(w)),it(e,"cellEditStart",t.onCellEditStart),it(e,"cellEditStop",t.onCellEditStop);const v=x.useCallback((M,F)=>{const B=Xt(e.current.state);return B[M]&&B[M][F]?at.Edit:at.View},[e]),C=Er(M=>{const F=M!==t.cellModesModel;u&&F&&u(M,{}),!(t.cellModesModel&&F)&&(n(M),a.current=M,e.current.publishEvent("cellModesModelChange",M))}),E=x.useCallback((M,F,B)=>{const H=k({},a.current);if(B!==null)H[M]=k({},H[M],{[F]:k({},B)});else{const G=H[M],_=me(G,[F].map(Ua));H[M]=_,Object.keys(H[M]).length===0&&delete H[M]}C(H)},[C]),R=x.useCallback((M,F,B)=>{e.current.setState(H=>{const G=k({},H.editRows);return B!==null?G[M]=k({},G[M],{[F]:k({},B)}):(delete G[M][F],Object.keys(G[M]).length===0&&delete G[M]),k({},H,{editRows:G})}),e.current.forceUpdate()},[e]),S=x.useCallback(M=>{const{id:F,field:B}=M,H=me(M,dC);d(F,B),f(F,B,at.View),E(F,B,k({mode:at.Edit},H))},[d,f,E]),b=Er(M=>{const{id:F,field:B,deleteValue:H,initialValue:G}=M;let _=e.current.getCellValue(F,B);(H||G)&&(_=H?"":G),R(F,B,{value:_,error:!1,isProcessingProps:!1}),e.current.setCellFocus(F,B)}),T=x.useCallback(M=>{const{id:F,field:B}=M,H=me(M,fC);f(F,B,at.Edit),E(F,B,k({mode:at.View},H))},[f,E]),A=Er(async M=>{const{id:F,field:B,ignoreModifications:H,cellToFocusAfter:G="none"}=M;f(F,B,at.Edit),e.current.runPendingEditCellValueMutation(F,B);const _=()=>{R(F,B,null),E(F,B,null),G!=="none"&&e.current.moveFocusToRelativeCell(F,B,G)};if(H){_();return}const Z=Xt(e.current.state),{error:ee,isProcessingProps:P}=Z[F][B];if(ee||P){o.current[F][B].mode=at.Edit,E(F,B,{mode:at.Edit});return}const q=e.current.getRowWithUpdatedValuesFromCellEditing(F,B);if(s){const K=X=>{o.current[F][B].mode=at.Edit,E(F,B,{mode:at.Edit}),l?l(X):hC()};try{const X=e.current.getRow(F);Promise.resolve(s(q,X)).then(te=>{e.current.updateRows([te]),_()}).catch(K)}catch(X){K(X)}}else e.current.updateRows([q]),_()}),N=x.useCallback(async M=>{var F;const{id:B,field:H,value:G,debounceMs:_,unstable_skipValueParser:Z}=M;d(B,H),f(B,H,at.Edit);const ee=e.current.getColumn(H),P=e.current.getRow(B);let q=G;ee.valueParser&&!Z&&(q=ee.valueParser(G,e.current.getCellParams(B,H)));let K=Xt(e.current.state),X=k({},K[B][H],{value:q,changeReason:_?"debouncedSetEditCellValue":"setEditCellValue"});if(ee.preProcessEditCellProps){const te=G!==K[B][H].value;X=k({},X,{isProcessingProps:!0}),R(B,H,X),X=await Promise.resolve(ee.preProcessEditCellProps({id:B,row:P,props:X,hasChanged:te}))}return e.current.getCellMode(B,H)===at.View?!1:(K=Xt(e.current.state),X=k({},X,{isProcessingProps:!1}),X.value=ee.preProcessEditCellProps?K[B][H].value:q,R(B,H,X),K=Xt(e.current.state),!((F=K[B])!=null&&(F=F[H])!=null&&F.error))},[e,d,f,R]),y=x.useCallback((M,F)=>{const B=e.current.getColumn(F),H=Xt(e.current.state),G=e.current.getRow(M);if(!H[M]||!H[M][F])return e.current.getRow(M);const{value:_}=H[M][F];return B.valueSetter?B.valueSetter({value:_,row:G}):k({},G,{[F]:_})},[e]),D={getCellMode:v,startCellEditMode:S,stopCellEditMode:T},L={setCellEditingEditCellValue:N,getRowWithUpdatedValuesFromCellEditing:y};ze(e,D,"public"),ze(e,L,"private"),x.useEffect(()=>{i&&C(i)},[i,C]),Mt(()=>{const M=Bo(e),F=o.current;o.current=a0(r),Object.entries(r).forEach(([B,H])=>{Object.entries(H).forEach(([G,_])=>{var Z,ee;const P=((Z=F[B])==null||(Z=Z[G])==null?void 0:Z.mode)||at.View,q=(ee=M[B])!=null?ee:B;_.mode===at.Edit&&P===at.View?b(k({id:q,field:G},_)):_.mode===at.View&&P===at.Edit&&A(k({id:q,field:G},_))})})},[e,r,b,A])},pC=["id"],xC=["id"],mC=Nr(["MUI: A call to `processRowUpdate` threw an error which was not handled because `onProcessRowUpdateError` is missing.","To handle the error pass a callback to the `onProcessRowUpdateError` prop, e.g. `<DataGrid onProcessRowUpdateError={(error) => ...} />`.","For more detail, see http://mui.com/components/data-grid/editing/#server-side-persistence."],"error"),vC=(e,t)=>{const[r,n]=x.useState({}),a=x.useRef(r),o=x.useRef({}),s=x.useRef(null),l=x.useRef(null),{processRowUpdate:i,onProcessRowUpdateError:u,rowModesModel:c,onRowModesModelChange:d}=t,f=G=>(..._)=>{t.editMode===Rr.Row&&G(..._)},p=x.useCallback((G,_)=>{const Z=e.current.getCellParams(G,_);if(!e.current.isCellEditable(Z))throw new Error(`MUI: The cell with id=${G} and field=${_} is not editable.`)},[e]),h=x.useCallback((G,_)=>{if(e.current.getRowMode(G)!==_)throw new Error(`MUI: The row with id=${G} is not in ${_} mode.`)},[e]),g=x.useCallback((G,_)=>{if(!G.isEditable||e.current.getRowMode(G.id)===ot.Edit)return;const Z=e.current.getRowParams(G.id),ee=k({},Z,{field:G.field,reason:tn.cellDoubleClick});e.current.publishEvent("rowEditStart",ee,_)},[e]),m=x.useCallback(G=>{l.current=G},[]),w=x.useCallback((G,_)=>{G.isEditable&&e.current.getRowMode(G.id)!==ot.View&&(l.current=null,s.current=setTimeout(()=>{var Z;if(s.current=null,((Z=l.current)==null?void 0:Z.id)!==G.id){if(!e.current.getRow(G.id)||e.current.getRowMode(G.id)===ot.View)return;const ee=e.current.getRowParams(G.id),P=k({},ee,{field:G.field,reason:Gr.rowFocusOut});e.current.publishEvent("rowEditStop",P,_)}}))},[e]);x.useEffect(()=>()=>{clearTimeout(s.current)},[]);const v=x.useCallback((G,_)=>{if(G.cellMode===ot.Edit){if(_.which===229)return;let Z;if(_.key==="Escape")Z=Gr.escapeKeyDown;else if(_.key==="Enter")Z=Gr.enterKeyDown;else if(_.key==="Tab"){const ee=us(e).filter(P=>e.current.getColumn(P).type===Cs?!0:e.current.isCellEditable(e.current.getCellParams(G.id,P)));if(_.shiftKey?G.field===ee[0]&&(Z=Gr.shiftTabKeyDown):G.field===ee[ee.length-1]&&(Z=Gr.tabKeyDown),_.preventDefault(),!Z){const P=ee.findIndex(K=>K===G.field),q=ee[_.shiftKey?P-1:P+1];e.current.setCellFocus(G.id,q)}}if(Z){const ee=k({},e.current.getRowParams(G.id),{reason:Z,field:G.field});e.current.publishEvent("rowEditStop",ee,_)}}else if(G.isEditable){let Z;if(!e.current.unstable_applyPipeProcessors("canStartEditing",!0,{event:_,cellParams:G,editMode:"row"}))return;if(Qu(_)||(_.ctrlKey||_.metaKey)&&_.key==="v"?Z=tn.printableKeyDown:_.key==="Enter"?Z=tn.enterKeyDown:(_.key==="Delete"||_.key==="Backspace")&&(Z=tn.deleteKeyDown),Z){const P=e.current.getRowParams(G.id),q=k({},P,{field:G.field,reason:Z});e.current.publishEvent("rowEditStart",q,_)}}},[e]),C=x.useCallback(G=>{const{id:_,field:Z,reason:ee}=G,P={id:_,fieldToFocus:Z};(ee===tn.printableKeyDown||ee===tn.deleteKeyDown)&&(P.deleteValue=!!Z),e.current.startRowEditMode(P)},[e]),E=x.useCallback(G=>{const{id:_,reason:Z,field:ee}=G;e.current.runPendingEditCellValueMutation(_);let P;Z===Gr.enterKeyDown?P="below":Z===Gr.tabKeyDown?P="right":Z===Gr.shiftTabKeyDown&&(P="left");const q=Z==="escapeKeyDown";e.current.stopRowEditMode({id:_,ignoreModifications:q,field:ee,cellToFocusAfter:P})},[e]);Fe(e,"cellDoubleClick",f(g)),Fe(e,"cellFocusIn",f(m)),Fe(e,"cellFocusOut",f(w)),Fe(e,"cellKeyDown",f(v)),Fe(e,"rowEditStart",f(C)),Fe(e,"rowEditStop",f(E)),it(e,"rowEditStart",t.onRowEditStart),it(e,"rowEditStop",t.onRowEditStop);const R=x.useCallback(G=>{if(t.editMode===Rr.Cell)return ot.View;const _=Xt(e.current.state);return _[G]&&Object.keys(_[G]).length>0?ot.Edit:ot.View},[e,t.editMode]),S=Er(G=>{const _=G!==t.rowModesModel;d&&_&&d(G,{}),!(t.rowModesModel&&_)&&(n(G),a.current=G,e.current.publishEvent("rowModesModelChange",G))}),b=x.useCallback((G,_)=>{const Z=k({},a.current);_!==null?Z[G]=k({},_):delete Z[G],S(Z)},[S]),T=x.useCallback((G,_)=>{e.current.setState(Z=>{const ee=k({},Z.editRows);return _!==null?ee[G]=_:delete ee[G],k({},Z,{editRows:ee})}),e.current.forceUpdate()},[e]),A=x.useCallback((G,_,Z)=>{e.current.setState(ee=>{const P=k({},ee.editRows);return Z!==null?P[G]=k({},P[G],{[_]:k({},Z)}):(delete P[G][_],Object.keys(P[G]).length===0&&delete P[G]),k({},ee,{editRows:P})}),e.current.forceUpdate()},[e]),N=x.useCallback(G=>{const{id:_}=G,Z=me(G,pC);h(_,ot.View),b(_,k({mode:ot.Edit},Z))},[h,b]),y=Er(G=>{const{id:_,fieldToFocus:Z,deleteValue:ee,initialValue:P}=G,K=zr(e).reduce((X,te)=>{if(!e.current.getCellParams(_,te).isEditable)return X;let fe=e.current.getCellValue(_,te);return Z===te&&(ee||P)&&(fe=ee?"":P),X[te]={value:fe,error:!1,isProcessingProps:!1},X},{});T(_,K),Z&&e.current.setCellFocus(_,Z)}),D=x.useCallback(G=>{const{id:_}=G,Z=me(G,xC);h(_,ot.Edit),b(_,k({mode:ot.View},Z))},[h,b]),L=Er(G=>{const{id:_,ignoreModifications:Z,field:ee,cellToFocusAfter:P="none"}=G;e.current.runPendingEditCellValueMutation(_);const q=()=>{P!=="none"&&ee&&e.current.moveFocusToRelativeCell(_,ee,P),T(_,null),b(_,null)};if(Z){q();return}const K=Xt(e.current.state),X=e.current.getRow(_);if(Object.values(K[_]).some(de=>de.isProcessingProps)){o.current[_].mode=ot.Edit;return}if(Object.values(K[_]).some(de=>de.error)){o.current[_].mode=ot.Edit,b(_,{mode:ot.Edit});return}const fe=e.current.getRowWithUpdatedValuesFromRowEditing(_);if(i){const de=ie=>{o.current[_].mode=ot.Edit,b(_,{mode:ot.Edit}),u?u(ie):mC()};try{Promise.resolve(i(fe,X)).then(ie=>{e.current.updateRows([ie]),q()}).catch(de)}catch(ie){de(ie)}}else e.current.updateRows([fe]),q()}),M=x.useCallback(G=>{const{id:_,field:Z,value:ee,debounceMs:P,unstable_skipValueParser:q}=G;p(_,Z);const K=e.current.getColumn(Z),X=e.current.getRow(_);let te=ee;K.valueParser&&!q&&(te=K.valueParser(ee,e.current.getCellParams(_,Z)));let le=Xt(e.current.state),fe=k({},le[_][Z],{value:te,changeReason:P?"debouncedSetEditCellValue":"setEditCellValue"});return K.preProcessEditCellProps||A(_,Z,fe),new Promise(de=>{const ie=[];if(K.preProcessEditCellProps){const xe=fe.value!==le[_][Z].value;fe=k({},fe,{isProcessingProps:!0}),A(_,Z,fe);const z=le[_],Pe=me(z,[Z].map(Ua)),_e=Promise.resolve(K.preProcessEditCellProps({id:_,row:X,props:fe,hasChanged:xe,otherFieldsProps:Pe})).then(Ie=>{if(e.current.getRowMode(_)===ot.View){de(!1);return}le=Xt(e.current.state),Ie=k({},Ie,{isProcessingProps:!1}),Ie.value=K.preProcessEditCellProps?le[_][Z].value:te,A(_,Z,Ie)});ie.push(_e)}Object.entries(le[_]).forEach(([xe,z])=>{if(xe===Z)return;const Pe=e.current.getColumn(xe);if(!Pe.preProcessEditCellProps)return;z=k({},z,{isProcessingProps:!0}),A(_,xe,z),le=Xt(e.current.state);const _e=le[_],Ie=me(_e,[xe].map(Ua)),ce=Promise.resolve(Pe.preProcessEditCellProps({id:_,row:X,props:z,hasChanged:!1,otherFieldsProps:Ie})).then(ne=>{if(e.current.getRowMode(_)===ot.View){de(!1);return}ne=k({},ne,{isProcessingProps:!1}),A(_,xe,ne)});ie.push(ce)}),Promise.all(ie).then(()=>{e.current.getRowMode(_)===ot.Edit?(le=Xt(e.current.state),de(!le[_][Z].error)):de(!1)})})},[e,p,A]),F=x.useCallback(G=>{const _=Xt(e.current.state),Z=e.current.getRow(G);if(!_[G])return e.current.getRow(G);let ee=k({},Z);return Object.entries(_[G]).forEach(([P,q])=>{const K=e.current.getColumn(P);K.valueSetter?ee=K.valueSetter({value:q.value,row:ee}):ee[P]=q.value}),ee},[e]),B={getRowMode:R,startRowEditMode:N,stopRowEditMode:D},H={setRowEditingEditCellValue:M,getRowWithUpdatedValuesFromRowEditing:F};ze(e,B,"public"),ze(e,H,"private"),x.useEffect(()=>{c&&S(c)},[c,S]),Mt(()=>{const G=Bo(e),_=o.current;o.current=a0(r),Object.entries(r).forEach(([Z,ee])=>{var P,q;const K=((P=_[Z])==null?void 0:P.mode)||ot.View,X=(q=G[Z])!=null?q:Z;ee.mode===ot.Edit&&K===ot.View?y(k({id:X},ee)):ee.mode===ot.View&&K===ot.Edit&&L(k({id:X},ee))})},[e,r,y,L])},wC=e=>k({},e,{editRows:{}}),CC=(e,t)=>{gC(e,t),vC(e,t);const r=x.useRef({}),{isCellEditable:n}=t,a=x.useCallback(f=>za(f.rowNode)||!f.colDef.editable||!f.colDef.renderEditCell?!1:n?n(f):!0,[n]),o=(f,p,h,g)=>{if(!h){g();return}if(r.current[f]||(r.current[f]={}),r.current[f][p]){const[v]=r.current[f][p];clearTimeout(v)}const m=()=>{const[v]=r.current[f][p];clearTimeout(v),g(),delete r.current[f][p]},w=setTimeout(()=>{g(),delete r.current[f][p]},h);r.current[f][p]=[w,m]};x.useEffect(()=>{const f=r.current;return()=>{Object.entries(f).forEach(([p,h])=>{Object.keys(h).forEach(g=>{const[m]=f[p][g];clearTimeout(m),delete f[p][g]})})}},[]);const s=x.useCallback((f,p)=>{if(r.current[f]){if(!p)Object.keys(r.current[f]).forEach(h=>{const[,g]=r.current[f][h];g()});else if(r.current[f][p]){const[,h]=r.current[f][p];h()}}},[]),l=x.useCallback(f=>{const{id:p,field:h,debounceMs:g}=f;return new Promise(m=>{o(p,h,g,async()=>{const w=t.editMode===Rr.Row?e.current.setRowEditingEditCellValue:e.current.setCellEditingEditCellValue;if(e.current.getCellMode(p,h)===at.Edit){const v=await w(f);m(v)}})})},[e,t.editMode]),i=x.useCallback((f,p)=>t.editMode===Rr.Cell?e.current.getRowWithUpdatedValuesFromCellEditing(f,p):e.current.getRowWithUpdatedValuesFromRowEditing(f),[e,t.editMode]),u=x.useCallback((f,p)=>{var h,g;return(h=(g=Xt(e.current.state)[f])==null?void 0:g[p])!=null?h:null},[e]),c={isCellEditable:a,setEditCellValue:l,getRowWithUpdatedValues:i,unstable_getEditCellMeta:u},d={runPendingEditCellValueMutation:s};ze(e,c,"public"),ze(e,d,"private")},bC=(e,t,r)=>(r.current.caches.rows=Mo({rows:t.rows,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),k({},e,{rows:ju({apiRef:r,rowCountProp:t.rowCount,loadingProp:t.loading,previousTree:null,previousTreeDepths:null})})),SC=(e,t)=>{const r=Ut(e,"useGridRows"),n=Hn(e,t),a=x.useRef(Date.now()),o=Gl(),s=x.useCallback(L=>{const M=cn(e)[L];if(M)return M;const F=e.current.getRowNode(L);return F&&za(F)?{[sa]:L}:null},[e]),l=t.getRowId,i=x.useCallback(L=>sa in L?L[sa]:l?l(L):L.id,[l]),u=x.useMemo(()=>n.rows.reduce((L,{id:M},F)=>(L[M]=F,L),{}),[n.rows]),c=x.useCallback(({cache:L,throttle:M})=>{const F=()=>{a.current=Date.now(),e.current.setState(H=>k({},H,{rows:ju({apiRef:e,rowCountProp:t.rowCount,loadingProp:t.loading,previousTree:vr(e),previousTreeDepths:Li(e)})})),e.current.publishEvent("rowsSet"),e.current.forceUpdate()};if(o.clear(),e.current.caches.rows=L,!M){F();return}const B=t.throttleRowsMs-(Date.now()-a.current);if(B>0){o.start(B,F);return}F()},[t.throttleRowsMs,t.rowCount,t.loading,e,o]),d=x.useCallback(L=>{r.debug(`Updating all rows, new length ${L.length}`);const M=Mo({rows:L,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),F=e.current.caches.rows;M.rowsBeforePartialUpdates=F.rowsBeforePartialUpdates,c({cache:M,throttle:!0})},[r,t.getRowId,t.loading,t.rowCount,c,e]),f=x.useCallback(L=>{if(t.signature===Or.DataGrid&&L.length>1)throw new Error(["MUI: You can't update several rows at once in `apiRef.current.updateRows` on the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`));const M=[];L.forEach(B=>{const H=Vo(B,t.getRowId,"A row was provided without id when calling updateRows():"),G=e.current.getRowNode(H);if((G==null?void 0:G.type)==="pinnedRow"){const _=e.current.caches.pinnedRows,Z=_.idLookup[H];Z&&(_.idLookup[H]=k({},Z,B))}else M.push(B)});const F=Xg({updates:M,getRowId:t.getRowId,previousCache:e.current.caches.rows});c({cache:F,throttle:!0})},[t.signature,t.getRowId,c,e]),p=x.useCallback(()=>{const L=So(e),M=cn(e);return new Map(L.map(F=>{var B;return[F,(B=M[F])!=null?B:{}]}))},[e]),h=x.useCallback(()=>fs(e),[e]),g=x.useCallback(()=>So(e),[e]),m=x.useCallback(L=>u[L],[u]),w=x.useCallback((L,M)=>{const F=e.current.getRowNode(L);if(!F)throw new Error(`MUI: No row with id #${L} found`);if(F.type!=="group")throw new Error("MUI: Only group nodes can be expanded or collapsed");const B=k({},F,{childrenExpanded:M});e.current.setState(H=>k({},H,{rows:k({},H.rows,{tree:k({},H.rows.tree,{[L]:B})})})),e.current.forceUpdate(),e.current.publishEvent("rowExpansionChange",B)},[e]),v=x.useCallback(L=>{var M;return(M=vr(e)[L])!=null?M:null},[e]),C=x.useCallback(({skipAutoGeneratedRows:L=!0,groupId:M,applySorting:F,applyFiltering:B})=>{const H=vr(e);let G;if(F){const _=H[M];if(!_)return[];const Z=Pl(e);G=[];const ee=Z.findIndex(P=>P===M)+1;for(let P=ee;P<Z.length&&H[Z[P]].depth>_.depth;P+=1){const q=Z[P];(!L||!za(H[q]))&&G.push(q)}}else G=Ol(H,M,L);if(B){const _=Bu(e);G=G.filter(Z=>_[Z]!==!1)}return G},[e]),E=x.useCallback((L,M)=>{const F=e.current.getRowNode(L);if(!F)throw new Error(`MUI: No row with id #${L} found`);if(F.parent!==Yt)throw new Error("MUI: The row reordering do not support reordering of grouped rows yet");if(F.type!=="leaf")throw new Error("MUI: The row reordering do not support reordering of footer or grouping rows");e.current.setState(B=>{const H=vr(B,e.current.instanceId)[Yt],G=H.children,_=G.findIndex(ee=>ee===L);if(_===-1||_===M)return B;r.debug(`Moving row ${L} to index ${M}`);const Z=[...G];return Z.splice(M,0,Z.splice(_,1)[0]),k({},B,{rows:k({},B.rows,{tree:k({},B.rows.tree,{[Yt]:k({},H,{children:Z})})})})}),e.current.publishEvent("rowsSet")},[e,r]),R=x.useCallback((L,M)=>{if(t.signature===Or.DataGrid&&M.length>1)throw new Error(["MUI: You can't replace rows using `apiRef.current.unstable_replaceRows` on the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`));if(M.length===0)return;if(hs(e)>1)throw new Error("`apiRef.current.unstable_replaceRows` is not compatible with tree data and row grouping");const B=k({},vr(e)),H=k({},cn(e)),G=k({},Bo(e)),_=B[Yt],Z=[..._.children];for(let P=0;P<M.length;P+=1){const q=M[P],K=Vo(q,t.getRowId,"A row was provided without id when calling replaceRows()."),[X]=Z.splice(L+P,1,K);delete H[X],delete G[X],delete B[X];const te={id:K,depth:0,parent:Yt,type:"leaf",groupingKey:null};H[K]=q,G[K]=K,B[K]=te}B[Yt]=k({},_,{children:Z});const ee=Z.filter(P=>B[P].type==="leaf");e.current.caches.rows.dataRowIdToModelLookup=H,e.current.caches.rows.dataRowIdToIdLookup=G,e.current.setState(P=>k({},P,{rows:k({},P.rows,{dataRowIdToModelLookup:H,dataRowIdToIdLookup:G,dataRowIds:ee,tree:B})})),e.current.publishEvent("rowsSet")},[e,t.signature,t.getRowId]),S={getRow:s,getRowId:i,getRowModels:p,getRowsCount:h,getAllRowIds:g,setRows:d,updateRows:f,getRowNode:v,getRowIndexRelativeToVisibleRows:m,unstable_replaceRows:R},b={setRowIndex:E,setRowChildrenExpansion:w,getRowGroupChildren:C},T=x.useCallback(()=>{r.info("Row grouping pre-processing have changed, regenerating the row tree");let L;e.current.caches.rows.rowsBeforePartialUpdates===t.rows?L=k({},e.current.caches.rows,{updates:{type:"full",rows:So(e)}}):L=Mo({rows:t.rows,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),c({cache:L,throttle:!1})},[r,e,t.rows,t.getRowId,t.loading,t.rowCount,c]),A=x.useCallback(L=>{L==="rowTreeCreation"&&T()},[T]),N=x.useCallback(()=>{e.current.getActiveStrategy("rowTree")!==Pg(e)&&T()},[e,T]);Fe(e,"activeStrategyProcessorChange",A),Fe(e,"strategyAvailabilityChange",N);const y=x.useCallback(()=>{e.current.setState(L=>{const M=e.current.unstable_applyPipeProcessors("hydrateRows",{tree:vr(L,e.current.instanceId),treeDepths:Li(L,e.current.instanceId),dataRowIds:So(L,e.current.instanceId),dataRowIdToModelLookup:cn(L,e.current.instanceId),dataRowIdToIdLookup:Bo(L,e.current.instanceId)});return k({},L,{rows:k({},L.rows,M,{totalTopLevelRowCount:zu({tree:M.tree,rowCountProp:t.rowCount})})})}),e.current.publishEvent("rowsSet"),e.current.forceUpdate()},[e,t.rowCount]);jl(e,"hydrateRows",y),ze(e,S,"public"),ze(e,b,t.signature===Or.DataGrid?"private":"public");const D=x.useRef(!0);x.useEffect(()=>{if(D.current){D.current=!1;return}const L=e.current.caches.rows.rowsBeforePartialUpdates===t.rows,M=e.current.caches.rows.loadingPropBeforePartialUpdates===t.loading,F=e.current.caches.rows.rowCountPropBeforePartialUpdates===t.rowCount;if(L){M||(e.current.setState(B=>k({},B,{rows:k({},B.rows,{loading:t.loading})})),e.current.caches.rows.loadingPropBeforePartialUpdates=t.loading,e.current.forceUpdate()),F||(e.current.setState(B=>k({},B,{rows:k({},B.rows,{totalRowCount:Math.max(t.rowCount||0,B.rows.totalRowCount),totalTopLevelRowCount:Math.max(t.rowCount||0,B.rows.totalTopLevelRowCount)})})),e.current.caches.rows.rowCountPropBeforePartialUpdates=t.rowCount,e.current.forceUpdate());return}r.debug(`Updating all rows, new length ${t.rows.length}`),c({cache:Mo({rows:t.rows,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),throttle:!1})},[t.rows,t.rowCount,t.getRowId,t.loading,r,c,e])},kC=e=>{const t={[Yt]:k({},Wg(),{children:e})};for(let r=0;r<e.length;r+=1){const n=e[r];t[n]={id:n,depth:0,parent:Yt,type:"leaf",groupingKey:null}}return{groupingName:Mn,tree:t,treeDepths:{0:e.length},dataRowIds:e}},EC=({previousTree:e,actions:t})=>{const r=k({},e),n={};for(let s=0;s<t.remove.length;s+=1){const l=t.remove[s];n[l]=!0,delete r[l]}for(let s=0;s<t.insert.length;s+=1){const l=t.insert[s];r[l]={id:l,depth:0,parent:Yt,type:"leaf",groupingKey:null}}const a=r[Yt];let o=[...a.children,...t.insert];return Object.values(n).length&&(o=o.filter(s=>!n[s])),r[Yt]=k({},a,{children:o}),{groupingName:Mn,tree:r,treeDepths:{0:o.length},dataRowIds:o}},TC=e=>e.updates.type==="full"?kC(e.updates.rows):EC({previousTree:e.previousTree,actions:e.updates.actions}),yC=e=>{Xo(e,Mn,"rowTreeCreation",TC)},R0=(e,t)=>e==null||Array.isArray(e)?e:t&&t[0]===e?t:[e],_C=(e,t)=>{var r;return k({},e,{rowSelection:t.rowSelection?(r=R0(t.rowSelectionModel))!=null?r:[]:[]})},FC=(e,t)=>{const r=Ut(e,"useGridSelection"),n=M=>(...F)=>{t.rowSelection&&M(...F)},a=x.useMemo(()=>R0(t.rowSelectionModel,dr(e.current.state)),[e,t.rowSelectionModel]),o=x.useRef(null);e.current.registerControlState({stateId:"rowSelection",propModel:a,propOnChange:t.onRowSelectionModelChange,stateSelector:dr,changeEvent:"rowSelectionChange"});const{checkboxSelection:s,disableMultipleRowSelection:l,disableRowSelectionOnClick:i,isRowSelectable:u}=t,c=!l||s,d=Hn(e,t),f=x.useCallback(M=>{var F;let B=M;const H=(F=o.current)!=null?F:M,G=e.current.isRowSelected(M);if(G){const _=Da(e),Z=_.findIndex(P=>P===H),ee=_.findIndex(P=>P===B);if(Z===ee)return;Z>ee?B=_[ee+1]:B=_[ee-1]}o.current=M,e.current.selectRowRange({startId:H,endId:B},!G)},[e]),p=x.useCallback(M=>{if(t.signature===Or.DataGrid&&!t.checkboxSelection&&Array.isArray(M)&&M.length>1)throw new Error(["MUI: `rowSelectionModel` can only contain 1 item in DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock multiple selection."].join(`
`));dr(e.current.state)!==M&&(r.debug("Setting selection model"),e.current.setState(B=>k({},B,{rowSelection:t.rowSelection?M:[]})),e.current.forceUpdate())},[e,r,t.rowSelection,t.signature,t.checkboxSelection]),h=x.useCallback(M=>dr(e.current.state).includes(M),[e]),g=x.useCallback(M=>{if(u&&!u(e.current.getRowParams(M)))return!1;const F=e.current.getRowNode(M);return!((F==null?void 0:F.type)==="footer"||(F==null?void 0:F.type)==="pinnedRow")},[e,u]),m=x.useCallback(()=>ex(e),[e]),w=x.useCallback((M,F=!0,B=!1)=>{if(e.current.isRowSelectable(M))if(o.current=M,B)r.debug(`Setting selection for row ${M}`),e.current.setRowSelectionModel(F?[M]:[]);else{r.debug(`Toggling selection for row ${M}`);const G=dr(e.current.state).filter(Z=>Z!==M);F&&G.push(M),(G.length<2||c)&&e.current.setRowSelectionModel(G)}},[e,r,c]),v=x.useCallback((M,F=!0,B=!1)=>{r.debug("Setting selection for several rows");const H=M.filter(Z=>e.current.isRowSelectable(Z));let G;if(B)G=F?H:[];else{const Z=k({},jo(e));H.forEach(ee=>{F?Z[ee]=ee:delete Z[ee]}),G=Object.values(Z)}(G.length<2||c)&&e.current.setRowSelectionModel(G)},[e,r,c]),C=x.useCallback(({startId:M,endId:F},B=!0,H=!1)=>{if(!e.current.getRow(M)||!e.current.getRow(F))return;r.debug(`Expanding selection from row ${M} to row ${F}`);const G=Da(e),_=G.indexOf(M),Z=G.indexOf(F),[ee,P]=_>Z?[Z,_]:[_,Z],q=G.slice(ee,P+1);e.current.selectRows(q,B,H)},[e,r]),E={selectRow:w,setRowSelectionModel:p,getSelectedRows:m,isRowSelected:h,isRowSelectable:g},R={selectRows:v,selectRowRange:C};ze(e,E,"public"),ze(e,R,t.signature===Or.DataGrid?"private":"public");const S=x.useCallback(()=>{if(t.keepNonExistentRowsSelected)return;const M=dr(e.current.state),F=cn(e),B=k({},jo(e));let H=!1;M.forEach(G=>{F[G]||(delete B[G],H=!0)}),H&&e.current.setRowSelectionModel(Object.values(B))},[e,t.keepNonExistentRowsSelected]),b=x.useCallback((M,F)=>{const B=F.metaKey||F.ctrlKey,H=!s&&!B&&!L1(F),G=!c||H,_=e.current.isRowSelected(M);G?e.current.selectRow(M,H?!0:!_,!0):e.current.selectRow(M,!_,!1)},[e,c,s]),T=x.useCallback((M,F)=>{var B;if(i)return;const H=(B=F.target.closest(`.${Q.cell}`))==null?void 0:B.getAttribute("data-field");if(H===ma.field||H===Ul)return;if(H){const _=e.current.getColumn(H);if((_==null?void 0:_.type)===Cs)return}e.current.getRowNode(M.id).type!=="pinnedRow"&&(F.shiftKey&&(c||s)?f(M.id):b(M.id,F))},[i,c,s,e,f,b]),A=x.useCallback((M,F)=>{if(c&&F.shiftKey){var B;(B=window.getSelection())==null||B.removeAllRanges()}},[c]),N=x.useCallback((M,F)=>{F.nativeEvent.shiftKey?f(M.id):e.current.selectRow(M.id,M.value)},[e,f]),y=x.useCallback(M=>{const B=t.checkboxSelectionVisibleOnly&&t.pagination?c0(e):Da(e);e.current.selectRows(B,M.value)},[e,t.checkboxSelectionVisibleOnly,t.pagination]),D=x.useCallback((M,F)=>{if(e.current.getCellMode(M.id,M.field)!==at.Edit&&!ao(F)){if(zo(F.key)&&F.shiftKey){const B=nr(e);if(B&&B.id!==M.id){F.preventDefault();const H=e.current.isRowSelected(B.id);if(!c){e.current.selectRow(B.id,!H,!0);return}const G=e.current.getRowIndexRelativeToVisibleRows(B.id),_=e.current.getRowIndexRelativeToVisibleRows(M.id);let Z,ee;G>_?H?(Z=_,ee=G-1):(Z=_,ee=G):H?(Z=G+1,ee=_):(Z=G,ee=_);const P=d.rows.slice(Z,ee+1).map(q=>q.id);e.current.selectRows(P,!H);return}}if(F.key===" "&&F.shiftKey){F.preventDefault(),b(M.id,F);return}F.key==="a"&&(F.ctrlKey||F.metaKey)&&(F.preventDefault(),v(e.current.getAllRowIds(),!0))}},[e,b,v,d.rows,c]);Fe(e,"sortedRowsSet",n(S)),Fe(e,"rowClick",n(T)),Fe(e,"rowSelectionCheckboxChange",n(N)),Fe(e,"headerSelectionCheckboxChange",y),Fe(e,"cellMouseDown",n(A)),Fe(e,"cellKeyDown",n(D)),x.useEffect(()=>{a!==void 0&&e.current.setRowSelectionModel(a)},[e,a,t.rowSelection]),x.useEffect(()=>{t.rowSelection||e.current.setRowSelectionModel([])},[e,t.rowSelection]);const L=a!=null;x.useEffect(()=>{if(L||!t.rowSelection)return;const M=dr(e.current.state);if(g){const F=M.filter(B=>g(B));F.length<M.length&&e.current.setRowSelectionModel(F)}},[e,g,L,t.rowSelection]),x.useEffect(()=>{if(!t.rowSelection||L)return;const M=dr(e.current.state);!c&&M.length>1&&e.current.setRowSelectionModel([])},[e,c,s,L,t.rowSelection])},IC={noRowsLabel:"No rows",noResultsOverlayLabel:"No results found.",toolbarDensity:"Density",toolbarDensityLabel:"Density",toolbarDensityCompact:"Compact",toolbarDensityStandard:"Standard",toolbarDensityComfortable:"Comfortable",toolbarColumns:"Columns",toolbarColumnsLabel:"Select columns",toolbarFilters:"Filters",toolbarFiltersLabel:"Show filters",toolbarFiltersTooltipHide:"Hide filters",toolbarFiltersTooltipShow:"Show filters",toolbarFiltersTooltipActive:e=>e!==1?`${e} active filters`:`${e} active filter`,toolbarQuickFilterPlaceholder:"Searchâ€¦",toolbarQuickFilterLabel:"Search",toolbarQuickFilterDeleteIconLabel:"Clear",toolbarExport:"Export",toolbarExportLabel:"Export",toolbarExportCSV:"Download as CSV",toolbarExportPrint:"Print",toolbarExportExcel:"Download as Excel",columnsPanelTextFieldLabel:"Find column",columnsPanelTextFieldPlaceholder:"Column title",columnsPanelDragIconLabel:"Reorder column",columnsPanelShowAllButton:"Show all",columnsPanelHideAllButton:"Hide all",filterPanelAddFilter:"Add filter",filterPanelRemoveAll:"Remove all",filterPanelDeleteIconLabel:"Delete",filterPanelLogicOperator:"Logic operator",filterPanelOperator:"Operator",filterPanelOperatorAnd:"And",filterPanelOperatorOr:"Or",filterPanelColumns:"Columns",filterPanelInputLabel:"Value",filterPanelInputPlaceholder:"Filter value",filterOperatorContains:"contains",filterOperatorEquals:"equals",filterOperatorStartsWith:"starts with",filterOperatorEndsWith:"ends with",filterOperatorIs:"is",filterOperatorNot:"is not",filterOperatorAfter:"is after",filterOperatorOnOrAfter:"is on or after",filterOperatorBefore:"is before",filterOperatorOnOrBefore:"is on or before",filterOperatorIsEmpty:"is empty",filterOperatorIsNotEmpty:"is not empty",filterOperatorIsAnyOf:"is any of","filterOperator=":"=","filterOperator!=":"!=","filterOperator>":">","filterOperator>=":">=","filterOperator<":"<","filterOperator<=":"<=",headerFilterOperatorContains:"Contains",headerFilterOperatorEquals:"Equals",headerFilterOperatorStartsWith:"Starts with",headerFilterOperatorEndsWith:"Ends with",headerFilterOperatorIs:"Is",headerFilterOperatorNot:"Is not",headerFilterOperatorAfter:"Is after",headerFilterOperatorOnOrAfter:"Is on or after",headerFilterOperatorBefore:"Is before",headerFilterOperatorOnOrBefore:"Is on or before",headerFilterOperatorIsEmpty:"Is empty",headerFilterOperatorIsNotEmpty:"Is not empty",headerFilterOperatorIsAnyOf:"Is any of","headerFilterOperator=":"Equals","headerFilterOperator!=":"Not equals","headerFilterOperator>":"Greater than","headerFilterOperator>=":"Greater than or equal to","headerFilterOperator<":"Less than","headerFilterOperator<=":"Less than or equal to",filterValueAny:"any",filterValueTrue:"true",filterValueFalse:"false",columnMenuLabel:"Menu",columnMenuShowColumns:"Show columns",columnMenuManageColumns:"Manage columns",columnMenuFilter:"Filter",columnMenuHideColumn:"Hide column",columnMenuUnsort:"Unsort",columnMenuSortAsc:"Sort by ASC",columnMenuSortDesc:"Sort by DESC",columnHeaderFiltersTooltipActive:e=>e!==1?`${e} active filters`:`${e} active filter`,columnHeaderFiltersLabel:"Show filters",columnHeaderSortIconLabel:"Sort",footerRowSelected:e=>e!==1?`${e.toLocaleString()} rows selected`:`${e.toLocaleString()} row selected`,footerTotalRows:"Total Rows:",footerTotalVisibleRows:(e,t)=>`${e.toLocaleString()} of ${t.toLocaleString()}`,checkboxSelectionHeaderName:"Checkbox selection",checkboxSelectionSelectAllRows:"Select all rows",checkboxSelectionUnselectAllRows:"Unselect all rows",checkboxSelectionSelectRow:"Select row",checkboxSelectionUnselectRow:"Unselect row",booleanCellTrueLabel:"yes",booleanCellFalseLabel:"no",actionsCellMore:"more",pinToLeft:"Pin to left",pinToRight:"Pin to right",unpin:"Unpin",treeDataGroupingHeaderName:"Group",treeDataExpand:"see children",treeDataCollapse:"hide children",groupingColumnHeaderName:"Group",groupColumn:e=>`Group by ${e}`,unGroupColumn:e=>`Stop grouping by ${e}`,detailPanelToggle:"Detail panel toggle",expandDetailPanel:"Expand",collapseDetailPanel:"Collapse",MuiTablePagination:{},rowReorderingHeaderName:"Row reordering",aggregationMenuItemHeader:"Aggregation",aggregationFunctionLabelSum:"sum",aggregationFunctionLabelAvg:"avg",aggregationFunctionLabelMin:"min",aggregationFunctionLabelMax:"max",aggregationFunctionLabelSize:"size"},PC=e=>{const{classes:t}=e;return x.useMemo(()=>Le({cellCheckbox:["cellCheckbox"],columnHeaderCheckbox:["columnHeaderCheckbox"]},We,t),[t])},AC=(e,t)=>{const r={classes:t.classes},n=PC(r),a=x.useCallback(o=>{const s=k({},ma,{cellClassName:n.cellCheckbox,headerClassName:n.columnHeaderCheckbox,headerName:e.current.getLocaleText("checkboxSelectionHeaderName")}),l=t.checkboxSelection,i=o.lookup[rn]!=null;return l&&!i?(o.lookup[rn]=s,o.orderedFields=[rn,...o.orderedFields]):!l&&i?(delete o.lookup[rn],o.orderedFields=o.orderedFields.filter(u=>u!==rn)):l&&i&&(o.lookup[rn]=k({},s,o.lookup[rn])),o},[e,n,t.checkboxSelection]);kt(e,"hydrateColumns",a)},MC=(e,t)=>{var r,n,a;const o=(r=(n=t.sortModel)!=null?n:(a=t.initialState)==null||(a=a.sorting)==null?void 0:a.sortModel)!=null?r:[];return k({},e,{sorting:{sortModel:u0(o,t.disableMultipleColumnsSorting),sortedRows:[]}})},DC=(e,t)=>{var r;const n=Ut(e,"useGridSorting");e.current.registerControlState({stateId:"sortModel",propModel:t.sortModel,propOnChange:t.onSortModelChange,stateSelector:ur,changeEvent:"sortModelChange"});const a=x.useCallback((S,b)=>{const T=ur(e),A=T.findIndex(y=>y.field===S);let N=[...T];return A>-1?b?N.splice(A,1,b):N.splice(A,1):N=[...T,b],N},[e]),o=x.useCallback((S,b)=>{var T;const N=ur(e).find(D=>D.field===S.field);if(N){var y;const D=b===void 0?Vi((y=S.sortingOrder)!=null?y:t.sortingOrder,N.sort):b;return D==null?void 0:k({},N,{sort:D})}return{field:S.field,sort:b===void 0?Vi((T=S.sortingOrder)!=null?T:t.sortingOrder):b}},[e,t.sortingOrder]),s=x.useCallback((S,b)=>b==null||b.sortable===!1?S:(b.sortingOrder||t.sortingOrder).some(A=>!!A)?[...S,"columnMenuSortItem"]:S,[t.sortingOrder]),l=x.useCallback(()=>{e.current.setState(S=>{if(t.sortingMode==="server")return n.debug("Skipping sorting rows as sortingMode = server"),k({},S,{sorting:k({},S.sorting,{sortedRows:Ol(vr(e),Yt,!1)})});const b=ur(S,e.current.instanceId),T=ox(b,e),A=e.current.applyStrategyProcessor("sorting",{sortRowList:T});return k({},S,{sorting:k({},S.sorting,{sortedRows:A})})}),e.current.publishEvent("sortedRowsSet"),e.current.forceUpdate()},[e,n,t.sortingMode]),i=x.useCallback(S=>{ur(e)!==S&&(n.debug("Setting sort model"),e.current.setState($i(S,t.disableMultipleColumnsSorting)),e.current.forceUpdate(),e.current.applySorting())},[e,n,t.disableMultipleColumnsSorting]),u=x.useCallback((S,b,T)=>{if(!S.sortable)return;const A=o(S,b);let N;!T||t.disableMultipleColumnsSorting?N=A?[A]:[]:N=a(S.field,A),e.current.setSortModel(N)},[e,a,o,t.disableMultipleColumnsSorting]),c=x.useCallback(()=>ur(e),[e]),d=x.useCallback(()=>Al(e).map(b=>b.model),[e]),f=x.useCallback(()=>Pl(e),[e]),p=x.useCallback(S=>e.current.getSortedRowIds()[S],[e]);ze(e,{getSortModel:c,getSortedRows:d,getSortedRowIds:f,getRowIdFromRowIndex:p,setSortModel:i,sortColumn:u,applySorting:l},"public");const g=x.useCallback((S,b)=>{var T;const A=ur(e);return!b.exportOnlyDirtyModels||t.sortModel!=null||((T=t.initialState)==null||(T=T.sorting)==null?void 0:T.sortModel)!=null||A.length>0?k({},S,{sorting:{sortModel:A}}):S},[e,t.sortModel,(r=t.initialState)==null||(r=r.sorting)==null?void 0:r.sortModel]),m=x.useCallback((S,b)=>{var T;const A=(T=b.stateToRestore.sorting)==null?void 0:T.sortModel;return A==null?S:(e.current.setState($i(A,t.disableMultipleColumnsSorting)),k({},S,{callbacks:[...S.callbacks,e.current.applySorting]}))},[e,t.disableMultipleColumnsSorting]),w=x.useCallback(S=>{const b=vr(e),T=b[Yt],A=S.sortRowList?S.sortRowList(T.children.map(N=>b[N])):[...T.children];return T.footerId!=null&&A.push(T.footerId),A},[e]);kt(e,"exportState",g),kt(e,"restoreState",m),Xo(e,Mn,"sorting",w);const v=x.useCallback(({colDef:S},b)=>{const T=b.shiftKey||b.metaKey||b.ctrlKey;u(S,void 0,T)},[u]),C=x.useCallback(({colDef:S},b)=>{M1(b.key)&&!b.ctrlKey&&!b.metaKey&&u(S,void 0,b.shiftKey)},[u]),E=x.useCallback(()=>{const S=ur(e),b=Bn(e);if(S.length>0){const T=S.filter(A=>b[A.field]);T.length<S.length&&e.current.setSortModel(T)}},[e]),R=x.useCallback(S=>{S==="sorting"&&e.current.applySorting()},[e]);kt(e,"columnMenu",s),Fe(e,"columnHeaderClick",v),Fe(e,"columnHeaderKeyDown",C),Fe(e,"rowsSet",e.current.applySorting),Fe(e,"columnsChange",E),Fe(e,"activeStrategyProcessorChange",R),oo(()=>{e.current.applySorting()}),Mt(()=>{t.sortModel!==void 0&&e.current.setSortModel(t.sortModel)},[e,t.sortModel])};function fc(e){const{clientHeight:t,scrollTop:r,offsetHeight:n,offsetTop:a}=e,o=a+n;if(n>t)return a;if(o-t>r)return o-t;if(a<r)return a}const OC=(e,t)=>{const r=Yr(),n=Ut(e,"useGridScroll"),a=e.current.columnHeadersElementRef,o=e.current.virtualScrollerRef,s=Ce(e,wn),l=x.useCallback(d=>{const f=fs(e),p=At(e);if(!(d.rowIndex==null)&&f===0||p.length===0)return!1;n.debug(`Scrolling to cell at row ${d.rowIndex}, col: ${d.colIndex} `);let g={};if(d.colIndex!=null){const C=da(e);let E;if(typeof d.rowIndex<"u"){var m;const R=(m=s[d.rowIndex])==null?void 0:m.id,S=e.current.unstable_getCellColSpanInfo(R,d.colIndex);S&&!S.spannedByColSpan&&(E=S.cellProps.width)}typeof E>"u"&&(E=p[d.colIndex].computedWidth),g.left=fc({clientHeight:o.current.clientWidth,scrollTop:Math.abs(o.current.scrollLeft),offsetHeight:E,offsetTop:C[d.colIndex]})}if(d.rowIndex!=null){var w,v;const C=Wa(e.current.state),E=qp(e),R=Zp(e),S=t.pagination?d.rowIndex-E*R:d.rowIndex,b=C.positions[S+1]?C.positions[S+1]-C.positions[S]:C.currentPageTotalHeight-C.positions[S],T=((w=o.current.querySelector(`.${Q["pinnedRows--top"]}`))==null?void 0:w.clientHeight)||0,A=((v=o.current.querySelector(`.${Q["pinnedRows--bottom"]}`))==null?void 0:v.clientHeight)||0;g.top=fc({clientHeight:o.current.clientHeight-T-A,scrollTop:o.current.scrollTop,offsetHeight:b,offsetTop:C.positions[S]})}return g=e.current.unstable_applyPipeProcessors("scrollToIndexes",g,d),typeof g.left!==void 0||typeof g.top!==void 0?(e.current.scroll(g),!0):!1},[n,e,o,t.pagination,s]),i=x.useCallback(d=>{if(o.current&&d.left!=null&&a.current){const f=r.direction==="rtl"?-1:1;a.current.scrollLeft=d.left,o.current.scrollLeft=f*d.left,n.debug(`Scrolling left: ${d.left}`)}o.current&&d.top!=null&&(o.current.scrollTop=d.top,n.debug(`Scrolling top: ${d.top}`)),n.debug("Scrolling, updating container, and viewport")},[o,r.direction,a,n]),u=x.useCallback(()=>o!=null&&o.current?{top:o.current.scrollTop,left:o.current.scrollLeft}:{top:0,left:0},[o]);ze(e,{scroll:i,scrollToIndexes:l,getScrollPosition:u},"public")};function RC(e,t){it(e,"columnHeaderClick",t.onColumnHeaderClick),it(e,"columnHeaderDoubleClick",t.onColumnHeaderDoubleClick),it(e,"columnHeaderOver",t.onColumnHeaderOver),it(e,"columnHeaderOut",t.onColumnHeaderOut),it(e,"columnHeaderEnter",t.onColumnHeaderEnter),it(e,"columnHeaderLeave",t.onColumnHeaderLeave),it(e,"cellClick",t.onCellClick),it(e,"cellDoubleClick",t.onCellDoubleClick),it(e,"cellKeyDown",t.onCellKeyDown),it(e,"preferencePanelClose",t.onPreferencePanelClose),it(e,"preferencePanelOpen",t.onPreferencePanelOpen),it(e,"menuOpen",t.onMenuOpen),it(e,"menuClose",t.onMenuClose),it(e,"rowDoubleClick",t.onRowDoubleClick),it(e,"rowClick",t.onRowClick),it(e,"stateChange",t.onStateChange)}const LC=({content:e,container:t,scrollBarSize:r})=>{const n=e.width>t.width,a=e.height>t.height;let o=!1,s=!1;return(n||a)&&(o=n,s=e.height+(o?r:0)>t.height,s&&(o=e.width+r>t.width)),{hasScrollX:o,hasScrollY:s}};function NC(e,t){const r=Ut(e,"useResizeContainer"),n=x.useRef(!1),a=x.useRef(null),o=x.useRef(null),s=Ce(e,Wa),l=Ce(e,xa),i=Math.floor(t.rowHeight*l),u=Wl(e,t.columnHeaderHeight),c=x.useCallback(()=>{var b;const T=(b=e.current.rootElementRef)==null?void 0:b.current,A=Il(e),N=Wu(e);if(!a.current)return;let y;if(t.scrollbarSize!=null)y=t.scrollbarSize;else if(!A||!T)y=0;else{const _=ls(T).createElement("div");_.style.width="99px",_.style.height="99px",_.style.position="absolute",_.style.overflow="scroll",_.className="scrollDiv",T.appendChild(_),y=_.offsetWidth-_.clientWidth,T.removeChild(_)}let D,L,M;if(t.autoHeight)M=!1,L=Math.round(A)>Math.round(a.current.width),D={width:a.current.width,height:s.currentPageTotalHeight+(L?y:0)};else{D={width:a.current.width,height:Math.max(a.current.height-u,0)};const G=LC({content:{width:Math.round(A),height:s.currentPageTotalHeight},container:{width:Math.round(D.width),height:D.height-N.top-N.bottom},scrollBarSize:y});M=G.hasScrollY,L=G.hasScrollX}const F={width:D.width-(M?y:0),height:D.height-(L?y:0)},B={viewportOuterSize:D,viewportInnerSize:F,hasScrollX:L,hasScrollY:M,scrollBarSize:y},H=o.current;o.current=B,(B.viewportInnerSize.width!==(H==null?void 0:H.viewportInnerSize.width)||B.viewportInnerSize.height!==(H==null?void 0:H.viewportInnerSize.height))&&e.current.publishEvent("viewportInnerSizeChange",B.viewportInnerSize)},[e,t.scrollbarSize,t.autoHeight,s.currentPageTotalHeight,u]),[d,f]=x.useState(),p=x.useMemo(()=>kl(f,60),[]),h=x.useRef();Mt(()=>{d&&(c(),e.current.publishEvent("debouncedResize",a.current))},[e,d,c]);const g=x.useCallback(()=>{e.current.computeSizeAndPublishResizeEvent()},[e]),m=x.useCallback(()=>o.current,[]),w=x.useCallback(()=>{const b=e.current.getRootDimensions();if(!b)return 0;const T=Wo(e,{pagination:t.pagination,paginationMode:t.paginationMode});if(t.getRowHeight){const N=e.current.getRenderContext(),y=N.lastRowIndex-N.firstRowIndex;return Math.min(y-1,T.rows.length)}const A=Math.floor(b.viewportInnerSize.height/i);return Math.min(A,T.rows.length)},[e,t.pagination,t.paginationMode,t.getRowHeight,i]),v=x.useCallback(()=>{var b,T,A;const N=(b=e.current.mainElementRef)==null?void 0:b.current;if(!N)return;const D=If(N).getComputedStyle(N),L=parseFloat(D.height)||0,M=parseFloat(D.width)||0,F=L!==((T=h.current)==null?void 0:T.height),B=M!==((A=h.current)==null?void 0:A.width);if(!h.current||F||B){const H={width:M,height:L};e.current.publishEvent("resize",H),h.current=H}},[e]),C={resize:g,getRootDimensions:m},E={getViewportPageSize:w,updateGridDimensionsRef:c,computeSizeAndPublishResizeEvent:v};ze(e,C,"public"),ze(e,E,"private");const R=x.useRef(!0),S=x.useCallback(b=>{a.current=b;const T=/jsdom/.test(window.navigator.userAgent);if(b.height===0&&!n.current&&!t.autoHeight&&!T&&(r.error(["The parent DOM element of the data grid has an empty height.","Please make sure that this element has an intrinsic height.","The grid displays with a height of 0px.","","More details: https://mui.com/r/x-data-grid-no-dimensions."].join(`
`)),n.current=!0),b.width===0&&!n.current&&!T&&(r.error(["The parent DOM element of the data grid has an empty width.","Please make sure that this element has an intrinsic width.","The grid displays with a width of 0px.","","More details: https://mui.com/r/x-data-grid-no-dimensions."].join(`
`)),n.current=!0),R.current){f(b),R.current=!1;return}p(b)},[t.autoHeight,p,r]);Mt(()=>c(),[c]),it(e,"sortedRowsSet",c),it(e,"paginationModelChange",c),it(e,"columnsChange",c),Fe(e,"resize",S),it(e,"debouncedResize",t.onResize)}const BC=["style"],HC=["style"];function la(e,t,r=0,n=t.length){if(t.length<=0)return-1;if(r>=n)return r;const a=r+Math.floor((n-r)/2),o=t[a];return e<=o?la(e,t,r,a):la(e,t,a+1,n)}function $C(e,t,r){let n=1;for(;r<t.length&&Math.abs(t[r])<e;)r+=n,n*=2;return la(e,t,Math.floor(r/2),Math.min(r,t.length))}const an=({firstIndex:e,lastIndex:t,buffer:r,minFirstIndex:n,maxLastIndex:a})=>[fa(e-r,n,a),fa(t+r,n,a)],L0=(e,t)=>e===t?!0:e.firstRowIndex===t.firstRowIndex&&e.lastRowIndex===t.lastRowIndex&&e.firstColumnIndex===t.firstColumnIndex&&e.lastColumnIndex===t.lastColumnIndex,VC={maxSize:3},GC=e=>{var t,r;const n=vn(),a=ke(),o=Ce(n,At),s=Ce(n,fx),l=Ce(n,p0),{ref:i,onRenderZonePositioning:u,renderZoneMinColumnIndex:c=0,renderZoneMaxColumnIndex:d=o.length,getRowProps:f}=e,p=Yr(),h=Ce(n,da),g=Ce(n,Il),m=Ce(n,nr),w=Ce(n,$o),v=Ce(n,Wa),C=Ce(n,jo),E=Hn(n,a),R=x.useRef(null),S=x.useRef(null),b=qr(i,S),[T,A]=x.useState(null),N=x.useRef(T),y=x.useRef({top:0,left:0}),[D,L]=x.useState({width:null,height:null}),M=x.useRef(g),[F,B]=x.useState(null),H=x.useRef(Object.create(null)),G=x.useRef(),_=x.useRef(),Z=x.useRef(cs((ce,ne,be,Ae,Me,Oe)=>{let ye;const he=ce.slice(ne,be);return Oe>-1&&(ne>Oe&&Oe>=Ae||be<Oe&&Oe<Me)&&(ye=Oe),{focusedCellColumnIndexNotInRange:ye,renderedColumns:he}},VC)),ee=x.useMemo(()=>m!==null?o.findIndex(ce=>ce.field===m.field):-1,[m,o]),P=x.useCallback(ce=>{var ne,be;const Ae=n.current.getLastMeasuredRowIndex();let Me=Ae===1/0;(ne=E.range)!=null&&ne.lastRowIndex&&!Me&&(Me=Ae>=E.range.lastRowIndex);const Oe=fa(Ae-(((be=E.range)==null?void 0:be.firstRowIndex)||0),0,v.positions.length);return Me||v.positions[Oe]>=ce?la(ce,v.positions):$C(ce,v.positions,Oe)},[n,(t=E.range)==null?void 0:t.firstRowIndex,(r=E.range)==null?void 0:r.lastRowIndex,v.positions]),q=x.useCallback(()=>{if(!s)return{firstRowIndex:0,lastRowIndex:E.rows.length,firstColumnIndex:0,lastColumnIndex:o.length};const{top:ce,left:ne}=y.current,be=Math.min(P(ce),v.positions.length-1),Ae=a.autoHeight?be+E.rows.length:P(ce+D.height);let Me=0,Oe=h.length;if(l){let ye=!1;const[he,ve]=an({firstIndex:be,lastIndex:Ae,minFirstIndex:0,maxLastIndex:E.rows.length,buffer:a.rowBuffer});for(let Ee=he;Ee<ve&&!ye;Ee+=1){const Ne=E.rows[Ee];ye=n.current.rowHasAutoHeight(Ne.id)}ye||(Me=la(Math.abs(ne),h),Oe=la(Math.abs(ne)+D.width,h))}return{firstRowIndex:be,lastRowIndex:Ae,firstColumnIndex:Me,lastColumnIndex:Oe}},[s,l,P,v.positions.length,a.autoHeight,a.rowBuffer,E.rows,h,o.length,n,D]);Mt(()=>{s?(S.current.scrollLeft=0,S.current.scrollTop=0):R.current.style.transform="translate3d(0px, 0px, 0px)"},[s]),Mt(()=>{L({width:S.current.clientWidth,height:S.current.clientHeight})},[v.currentPageTotalHeight]);const K=x.useCallback(()=>{S.current&&L({width:S.current.clientWidth,height:S.current.clientHeight})},[]);Fe(n,"debouncedResize",K);const X=x.useCallback(ce=>{const[ne,be]=an({firstIndex:ce.firstRowIndex,lastIndex:ce.lastRowIndex,minFirstIndex:0,maxLastIndex:E.rows.length,buffer:a.rowBuffer}),[Ae]=an({firstIndex:ce.firstColumnIndex,lastIndex:ce.lastColumnIndex,minFirstIndex:c,maxLastIndex:d,buffer:a.columnBuffer}),Me=nl({firstColumnToRender:Ae,apiRef:n,firstRowToRender:ne,lastRowToRender:be,visibleRows:E.rows}),Oe=p.direction==="ltr"?1:-1,ye=Wa(n.current.state).positions[ne],he=Oe*da(n)[Me];R.current.style.transform=`translate3d(${he}px, ${ye}px, 0px)`,typeof u=="function"&&u({top:ye,left:he})},[n,E.rows,u,c,d,a.columnBuffer,a.rowBuffer,p.direction]),te=x.useCallback(()=>N.current,[]),le=x.useCallback(ce=>{if(N.current&&L0(ce,N.current)){X(ce);return}A(ce),X(ce);const[ne,be]=an({firstIndex:ce.firstRowIndex,lastIndex:ce.lastRowIndex,minFirstIndex:0,maxLastIndex:E.rows.length,buffer:a.rowBuffer});n.current.publishEvent("renderedRowsIntervalChange",{firstRowToRender:ne,lastRowToRender:be}),N.current=ce},[n,A,N,E.rows.length,a.rowBuffer,X]);Mt(()=>{if(D.width==null)return;const ce=q();le(ce);const{top:ne,left:be}=y.current,Ae={top:ne,left:be,renderContext:ce};n.current.publishEvent("scrollPositionChange",Ae)},[n,q,D.width,le]);const fe=Er(ce=>{const{scrollTop:ne,scrollLeft:be}=ce.currentTarget;if(y.current.top=ne,y.current.left=be,!N.current||ne<0||p.direction==="ltr"&&be<0||p.direction==="rtl"&&be>0)return;const Ae=s?q():N.current,Me=Math.abs(Ae.firstRowIndex-N.current.firstRowIndex),Oe=Math.abs(Ae.lastRowIndex-N.current.lastRowIndex),ye=Math.abs(Ae.firstColumnIndex-N.current.firstColumnIndex),he=Math.abs(Ae.lastColumnIndex-N.current.lastColumnIndex),ve=Me>=a.rowThreshold||Oe>=a.rowThreshold||ye>=a.columnThreshold||he>=a.columnThreshold||M.current!==g;n.current.publishEvent("scrollPositionChange",{top:ne,left:be,renderContext:ve?Ae:N.current},ce),ve&&(yu.flushSync(()=>{le(Ae)}),M.current=g)}),de=Er(ce=>{n.current.publishEvent("virtualScrollerWheel",{},ce)}),ie=Er(ce=>{n.current.publishEvent("virtualScrollerTouchMove",{},ce)}),xe=x.useMemo(()=>m!==null?E.rows.findIndex(ce=>ce.id===m.id):-1,[m,E.rows]);Fe(n,"rowMouseOver",(ce,ne)=>{var be;ne.currentTarget.contains(ne.relatedTarget)||B((be=ce.id)!=null?be:null)}),Fe(n,"rowMouseOut",(ce,ne)=>{ne.currentTarget.contains(ne.relatedTarget)||B(null)});const z=(ce={renderContext:T})=>{var ne;const{onRowRender:be,renderContext:Ae,minFirstColumn:Me=c,maxLastColumn:Oe=d,availableSpace:ye=D.width,rowIndexOffset:he=0,position:ve="center"}=ce;if(!Ae||ye==null)return null;const Ee=s?a.rowBuffer:0,Ne=s?a.columnBuffer:0,[Je,rt]=an({firstIndex:Ae.firstRowIndex,lastIndex:Ae.lastRowIndex,minFirstIndex:0,maxLastIndex:E.rows.length,buffer:Ee}),ut=[];if(ce.rows)ce.rows.forEach(bt=>{ut.push(bt),n.current.calculateColSpan({rowId:bt.id,minFirstColumn:Me,maxLastColumn:Oe,columns:o})});else{if(!E.range)return null;for(let bt=Je;bt<rt;bt+=1){const gt=E.rows[bt];ut.push(gt),n.current.calculateColSpan({rowId:gt.id,minFirstColumn:Me,maxLastColumn:Oe,columns:o})}}let Re=!1;if(xe>-1){const bt=E.rows[xe];(Je>xe||rt<xe)&&(Re=!0,xe>Je?ut.push(bt):ut.unshift(bt),n.current.calculateColSpan({rowId:bt.id,minFirstColumn:Me,maxLastColumn:Oe,columns:o}))}const[lt,nt]=an({firstIndex:Ae.firstColumnIndex,lastIndex:Ae.lastColumnIndex,minFirstIndex:Me,maxLastIndex:Oe,buffer:Ne}),Ke=nl({firstColumnToRender:lt,apiRef:n,firstRowToRender:Je,lastRowToRender:rt,visibleRows:E.rows});let jt=!1;(Ke>ee||nt<ee)&&(jt=!0);const{focusedCellColumnIndexNotInRange:Ir,renderedColumns:Wn}=Z.current(o,Ke,nt,Me,Oe,jt?ee:-1),Kn=((ne=a.slotProps)==null?void 0:ne.row)||{},{style:Qr}=Kn,po=me(Kn,BC);(G.current!==f||_.current!==Qr)&&(H.current=Object.create(null));const xo=[];let mo=!1;for(let bt=0;bt<ut.length;bt+=1){var bn;const{id:gt,model:vo}=ut[bt],_s=Re&&m.id===gt,Fs=Re?Je+bt===E.rows.length:Je+bt===E.rows.length-1,Is=n.current.rowHasAutoHeight(gt)?"auto":n.current.unstable_getRowHeight(gt);let ba;C[gt]==null?ba=!1:ba=n.current.isRowSelectable(gt),be&&be(gt);const wo=m!==null&&m.id===gt?m.field:null,Xn=Ir!==void 0&&o[Ir],Ps=Xn&&wo?[Xn,...Wn]:Wn;let Co=null;w!==null&&w.id===gt&&(Co=n.current.getCellParams(gt,w.field).cellMode==="view"?w.field:null);const bo=typeof f=="function"&&f(gt,vo)||{},{style:O}=bo,j=me(bo,HC);if(!H.current[gt]){const U=k({},O,Qr);H.current[gt]=U}let V=he+((E==null||(bn=E.range)==null?void 0:bn.firstRowIndex)||0)+Je+bt;Re&&(m==null?void 0:m.id)===gt?(V=xe,mo=!0):mo&&(V-=1),xo.push(I.jsx(a.slots.row,k({row:vo,rowId:gt,focusedCellColumnIndexNotInRange:Ir,isNotVisible:_s,rowHeight:Is,focusedCell:wo,tabbableCell:Co,renderedColumns:Ps,visibleColumns:o,firstColumnToRender:Ke,lastColumnToRender:nt,selected:ba,index:V,containerWidth:ye,isLastVisible:Fs,position:ve},j,po,{hovered:F===gt,style:H.current[gt]}),gt))}return G.current=f,_.current=Qr,xo},Pe=D.width&&g>=D.width,_e=x.useMemo(()=>{const ce=Math.max(v.currentPageTotalHeight,1);let ne=!1;S!=null&&S.current&&ce<=(S==null?void 0:S.current.clientHeight)&&(ne=!0);const be={width:Pe?g:"auto",height:ce,minHeight:ne?"100%":"auto"};return a.autoHeight&&E.rows.length===0&&(be.height=Ku(n,a.rowHeight)),be},[n,S,g,v.currentPageTotalHeight,Pe,a.autoHeight,a.rowHeight,E.rows.length]);x.useEffect(()=>{n.current.publishEvent("virtualScrollerContentSizeChange")},[n,_e]);const Ie=x.useMemo(()=>{const ce={};return Pe||(ce.overflowX="hidden"),a.autoHeight&&(ce.overflowY="hidden"),ce},[Pe,a.autoHeight]);return n.current.register("private",{getRenderContext:te}),{renderContext:T,updateRenderZonePosition:X,getRows:z,getRootProps:(ce={})=>k({ref:b,onScroll:fe,onWheel:de,onTouchMove:ie},ce,{style:ce.style?k({},ce.style,Ie):Ie,role:"presentation"}),getContentProps:({style:ce}={})=>({style:ce?k({},ce,_e):_e,role:"presentation"}),getRenderZoneProps:()=>({ref:R,role:"rowgroup"})}},UC=e=>{const{classes:t,headerAlign:r,isDragging:n,showColumnBorder:a,groupId:o}=e;return Le({root:["columnHeader",r==="left"&&"columnHeader--alignLeft",r==="center"&&"columnHeader--alignCenter",r==="right"&&"columnHeader--alignRight",n&&"columnHeader--moving",a&&"columnHeader--showColumnBorder",a&&"columnHeader--withRightBorder","withBorderColor",o===null?"columnHeader--emptyGroup":"columnHeader--filledGroup"],draggableContainer:["columnHeaderDraggableContainer"],titleContainer:["columnHeaderTitleContainer","withBorderColor"],titleContainerContent:["columnHeaderTitleContainerContent"]},We,t)};function zC(e){var t;const{groupId:r,width:n,depth:a,maxDepth:o,fields:s,height:l,colIndex:i,hasFocus:u,tabIndex:c,isLastColumn:d}=e,f=ke(),p=x.useRef(null),h=$e(),g=Ce(h,Ru),m=r?g[r]:{},{headerName:w=r??"",description:v="",headerAlign:C=void 0}=m;let E;const R=r&&((t=g[r])==null?void 0:t.renderHeaderGroup),S=x.useMemo(()=>({groupId:r,headerName:w,description:v,depth:a,maxDepth:o,fields:s,colIndex:i,isLastColumn:d}),[r,w,v,a,o,s,i,d]);r&&R&&(E=R(S));const b=f.showColumnVerticalBorder,T=k({},e,{classes:f.classes,showColumnBorder:b,headerAlign:C,depth:a,isDragging:!1}),A=w??r,N=tt(),y=r===null?`empty-group-cell-${N}`:r,D=UC(T);x.useLayoutEffect(()=>{if(u){const H=p.current.querySelector('[tabindex="0"]')||p.current;H==null||H.focus()}},[h,u]);const L=x.useCallback(B=>H=>{ao(H)||h.current.publishEvent(B,S,H)},[h,S]),M=x.useMemo(()=>({onKeyDown:L("columnGroupHeaderKeyDown"),onFocus:L("columnGroupHeaderFocus"),onBlur:L("columnGroupHeaderBlur")}),[L]),F=typeof m.headerClassName=="function"?m.headerClassName(S):m.headerClassName;return I.jsx(r0,k({ref:p,classes:D,columnMenuOpen:!1,colIndex:i,height:l,isResizing:!1,sortDirection:null,hasFocus:!1,tabIndex:c,isDraggable:!1,headerComponent:E,headerClassName:F,description:v,elementId:y,width:n,columnMenuIconButton:null,columnTitleIconButtons:null,resizable:!1,label:A,"aria-colspan":s.length,"data-fields":`|-${s.join("-|-")}-|`},M))}const hc=je("div",{name:"MuiDataGrid",slot:"ColumnHeaderRow",overridesResolver:(e,t)=>t.columnHeaderRow})(()=>({display:"flex"}));function jC(e){return!!e.target}const WC=e=>{const{innerRef:t,minColumnIndex:r=0,visibleColumns:n,sortColumnLookup:a,filterColumnLookup:o,columnPositions:s,columnHeaderTabIndexState:l,columnGroupHeaderTabIndexState:i,columnHeaderFocus:u,columnGroupHeaderFocus:c,densityFactor:d,headerGroupingMaxDepth:f,columnMenuState:p,columnVisibility:h,columnGroupsHeaderStructure:g,hasOtherElementInTabSequence:m}=e,w=Yr(),[v,C]=x.useState(""),[E,R]=x.useState(""),S=vn(),b=Ce(S,p0),T=ke(),A=x.useRef(null),N=qr(t,A),[y,D]=x.useState(null),L=x.useRef(y),M=x.useRef(0),F=Hn(S,T),B=Wl(S,T.columnHeaderHeight),H=Math.floor(T.columnHeaderHeight*d),G=x.useCallback(ie=>{y&&ie&&L0(y,ie)||D(ie)},[y]);x.useEffect(()=>{S.current.columnHeadersContainerElementRef.current.scrollLeft=0},[S]);const _=x.useRef(cs($w,{equalityCheck:(ie,xe)=>["firstColumnIndex","minColumnIndex","columnBuffer"].every(z=>ie[z]===xe[z])})),Z=x.useCallback(ie=>{const[xe,z]=an({firstIndex:ie.firstRowIndex,lastIndex:ie.lastRowIndex,minFirstIndex:0,maxLastIndex:F.rows.length,buffer:T.rowBuffer}),Pe=_.current({firstColumnIndex:ie.firstColumnIndex,minColumnIndex:r,columnBuffer:T.columnBuffer,firstRowToRender:xe,lastRowToRender:z,apiRef:S,visibleRows:F.rows}),_e=w.direction==="ltr"?1:-1,Ie=Pe>0?M.current-_e*s[Pe]:M.current;A.current.style.transform=`translate3d(${-Ie}px, 0px, 0px)`},[s,r,T.columnBuffer,S,F.rows,T.rowBuffer,w.direction]);x.useLayoutEffect(()=>{y&&Z(y)},[y,Z]);const ee=x.useCallback(({left:ie,renderContext:xe=null},z)=>{var Pe,_e;if(!A.current||M.current===ie&&((Pe=L.current)==null?void 0:Pe.firstColumnIndex)===(xe==null?void 0:xe.firstColumnIndex)&&((_e=L.current)==null?void 0:_e.lastColumnIndex)===(xe==null?void 0:xe.lastColumnIndex))return;M.current=ie;let Ie=!1;xe!==L.current||!L.current?(jC(z)?(yu.flushSync(()=>{G(xe)}),Ie=!0):G(xe),L.current=xe):Ie=!0,xe&&Ie&&Z(xe)},[Z,G]),P=x.useCallback(ie=>R(ie.field),[]),q=x.useCallback(()=>R(""),[]),K=x.useCallback(ie=>C(ie.field),[]),X=x.useCallback(()=>C(""),[]);Fe(S,"columnResizeStart",P),Fe(S,"columnResizeStop",q),Fe(S,"columnHeaderDragStart",K),Fe(S,"columnHeaderDragEnd",X),Fe(S,"scrollPositionChange",ee);const te=ie=>{const{renderContext:xe=y,minFirstColumn:z=r,maxLastColumn:Pe=n.length}=ie||{};if(!xe)return null;const[_e,Ie]=an({firstIndex:xe.firstRowIndex,lastIndex:xe.lastRowIndex,minFirstIndex:0,maxLastIndex:F.rows.length,buffer:T.rowBuffer}),ce=b?_.current({firstColumnIndex:xe.firstColumnIndex,minColumnIndex:z,columnBuffer:T.columnBuffer,apiRef:S,firstRowToRender:_e,lastRowToRender:Ie,visibleRows:F.rows}):0,ne=b?Math.min(xe.lastColumnIndex+T.columnBuffer,Pe):Pe;return{renderedColumns:n.slice(ce,ne),firstColumnToRender:ce,lastColumnToRender:ne,minFirstColumn:z,maxLastColumn:Pe}},le=(ie,xe={})=>{const z=te(ie);if(z==null)return null;const{renderedColumns:Pe,firstColumnToRender:_e}=z,Ie=[];for(let ce=0;ce<Pe.length;ce+=1){const ne=Pe[ce],be=_e+ce,Ae=be===0,Me=l!==null&&l.field===ne.field||Ae&&!m?0:-1,Oe=u!==null&&u.field===ne.field,ye=p.open&&p.field===ne.field;Ie.push(I.jsx(Rp,k({},a[ne.field],{columnMenuOpen:ye,filterItemsCounter:o[ne.field]&&o[ne.field].length,headerHeight:H,isDragging:ne.field===v,colDef:ne,colIndex:be,isResizing:E===ne.field,hasFocus:Oe,tabIndex:Me},xe),ne.field))}return I.jsx(hc,{role:"row","aria-rowindex":f+1,ownerState:T,children:Ie})},fe=ie=>{if(f===0)return null;const xe=te(ie);if(xe==null||xe.renderedColumns.length===0)return null;const{firstColumnToRender:z,lastColumnToRender:Pe}=xe,_e=[],Ie=[];for(let be=0;be<f;be+=1){var ce,ne;const Ae=g[be],Me=n[z].field,Oe=(ce=S.current.unstable_getColumnGroupPath(Me)[be])!=null?ce:null,ye=Ae.findIndex(({groupId:nt,columnFields:Ke})=>nt===Oe&&Ke.includes(Me)),he=n[Pe-1].field,ve=(ne=S.current.unstable_getColumnGroupPath(he)[be])!=null?ne:null,Ee=Ae.findIndex(({groupId:nt,columnFields:Ke})=>nt===ve&&Ke.includes(he)),Ne=Ae.slice(ye,Ee+1).map(nt=>k({},nt,{columnFields:nt.columnFields.filter(Ke=>h[Ke]!==!1)})).filter(nt=>nt.columnFields.length>0),Je=Ne[0].columnFields.indexOf(Me),ut=Ne[0].columnFields.slice(0,Je).reduce((nt,Ke)=>{var jt;const Ir=S.current.getColumn(Ke);return nt+((jt=Ir.computedWidth)!=null?jt:0)},0);let Re=z;const lt=Ne.map(({groupId:nt,columnFields:Ke})=>{const jt=c!==null&&c.depth===be&&Ke.includes(c.field),Ir=i!==null&&i.depth===be&&Ke.includes(i.field)?0:-1,Wn={groupId:nt,width:Ke.reduce((Kn,Qr)=>Kn+S.current.getColumn(Qr).computedWidth,0),fields:Ke,colIndex:Re,hasFocus:jt,tabIndex:Ir};return Re+=Ke.length,Wn});Ie.push({leftOverflow:ut,elements:lt})}return Ie.forEach((be,Ae)=>{_e.push(I.jsx(hc,{style:{height:`${H}px`,transform:`translateX(-${be.leftOverflow}px)`},role:"row","aria-rowindex":Ae+1,ownerState:T,children:be.elements.map(({groupId:Me,width:Oe,fields:ye,colIndex:he,hasFocus:ve,tabIndex:Ee},Ne)=>I.jsx(zC,{groupId:Me,width:Oe,fields:ye,colIndex:he,depth:Ae,isLastColumn:he===n.length-ye.length,maxDepth:Ie.length,height:H,hasFocus:ve,tabIndex:Ee},Ne))},Ae))}),_e},de={minHeight:B,maxHeight:B,lineHeight:`${H}px`};return{renderContext:y,getColumnHeaders:le,getColumnsToRender:te,getColumnGroupHeaders:fe,isDragging:!!v,getRootProps:(ie={})=>k({style:de},ie),getInnerProps:()=>({ref:N,role:"rowgroup"}),headerHeight:H}},KC=["className"],XC=e=>{const{classes:t}=e;return Le({root:["columnHeaders","withBorderColor"]},We,t)},YC=Ft("div",{name:"MuiDataGrid",slot:"ColumnHeaders",overridesResolver:(e,t)=>t.columnHeaders})({position:"relative",overflow:"hidden",display:"flex",alignItems:"center",boxSizing:"border-box",borderBottom:"1px solid",borderTopLeftRadius:"var(--unstable_DataGrid-radius)",borderTopRightRadius:"var(--unstable_DataGrid-radius)"}),qC=x.forwardRef(function(t,r){const{className:n}=t,a=me(t,KC),o=ke(),s=XC(o);return I.jsx(YC,k({ref:r,className:Ue(n,s.root),ownerState:o},a,{role:"presentation"}))}),ZC=["isDragging","className"],QC=e=>{const{isDragging:t,hasScrollX:r,classes:n}=e;return Le({root:["columnHeadersInner",t&&"columnHeaderDropZone",r&&"columnHeadersInner--scrollable"]},We,n)},JC=Ft("div",{name:"MuiDataGrid",slot:"columnHeadersInner",overridesResolver:(e,t)=>[{[`&.${Q.columnHeaderDropZone}`]:t.columnHeaderDropZone},t.columnHeadersInner]})(()=>({display:"flex",alignItems:"flex-start",flexDirection:"column",[`&.${Q.columnHeaderDropZone} .${Q.columnHeaderDraggableContainer}`]:{cursor:"move"},[`&.${Q["columnHeadersInner--scrollable"]} .${Q.columnHeader}:last-child`]:{borderRight:"none"}})),e2=x.forwardRef(function(t,r){var n,a;const{isDragging:o,className:s}=t,l=me(t,ZC),i=$e(),u=ke(),c=k({},u,{isDragging:o,hasScrollX:(n=(a=i.current.getRootDimensions())==null?void 0:a.hasScrollX)!=null?n:!1}),d=QC(c);return I.jsx(JC,k({ref:r,className:Ue(s,d.root),ownerState:c},l))}),t2=["innerRef","className","visibleColumns","sortColumnLookup","filterColumnLookup","columnPositions","columnHeaderTabIndexState","columnGroupHeaderTabIndexState","columnHeaderFocus","columnGroupHeaderFocus","densityFactor","headerGroupingMaxDepth","columnMenuState","columnVisibility","columnGroupsHeaderStructure","hasOtherElementInTabSequence"],r2=x.forwardRef(function(t,r){const{innerRef:n,visibleColumns:a,sortColumnLookup:o,filterColumnLookup:s,columnPositions:l,columnHeaderTabIndexState:i,columnGroupHeaderTabIndexState:u,columnHeaderFocus:c,columnGroupHeaderFocus:d,densityFactor:f,headerGroupingMaxDepth:p,columnMenuState:h,columnVisibility:g,columnGroupsHeaderStructure:m,hasOtherElementInTabSequence:w}=t,v=me(t,t2),{isDragging:C,getRootProps:E,getInnerProps:R,getColumnHeaders:S,getColumnGroupHeaders:b}=WC({innerRef:n,visibleColumns:a,sortColumnLookup:o,filterColumnLookup:s,columnPositions:l,columnHeaderTabIndexState:i,columnGroupHeaderTabIndexState:u,columnHeaderFocus:c,columnGroupHeaderFocus:d,densityFactor:f,headerGroupingMaxDepth:p,columnMenuState:h,columnVisibility:g,columnGroupsHeaderStructure:m,hasOtherElementInTabSequence:w});return I.jsx(qC,k({ref:r},E(v),{children:I.jsxs(e2,k({isDragging:C},R(),{children:[b(),S()]}))}))}),n2=ms(r2),a2=x.forwardRef(function(t,r){const a=$e().current.getLocaleText("noResultsOverlayLabel");return I.jsx(Nl,k({ref:r},t,{children:a}))}),o2=["sortingOrder"],s2=x.memo(function(t){const{sortingOrder:r}=t,n=me(t,o2),a=ke(),[o]=r,s=o==="asc"?a.slots.columnSortedAscendingIcon:a.slots.columnSortedDescendingIcon;return s?I.jsx(s,k({},n)):null}),l2=["native"];function i2(e){let{native:t}=e,r=me(e,l2);return t?I.jsx("option",k({},r)):I.jsx(kr,k({},r))}const c2={BooleanCellTrueIcon:Dx,BooleanCellFalseIcon:Rs,ColumnMenuIcon:Ix,OpenFilterButtonIcon:Sx,FilterPanelDeleteIcon:Rs,ColumnFilteredIcon:Wi,ColumnSelectorIcon:Ex,ColumnUnsortedIcon:s2,ColumnSortedAscendingIcon:Gi,ColumnSortedDescendingIcon:Ui,ColumnResizeIcon:Tx,DensityCompactIcon:yx,DensityStandardIcon:_x,DensityComfortableIcon:Fx,ExportIcon:Mx,MoreActionsIcon:Ox,TreeDataCollapseIcon:ji,TreeDataExpandIcon:zi,GroupingCriteriaCollapseIcon:ji,GroupingCriteriaExpandIcon:zi,DetailPanelExpandIcon:Ki,DetailPanelCollapseIcon:Px,RowReorderIcon:Xi,QuickFilterIcon:kx,QuickFilterClearIcon:Rs,ColumnMenuHideIcon:Rx,ColumnMenuSortAscendingIcon:Gi,ColumnMenuSortDescendingIcon:Ui,ColumnMenuFilterIcon:Wi,ColumnMenuManageColumnsIcon:Lx,ColumnMenuClearIcon:Nx,LoadIcon:Ax,FilterPanelAddIcon:Ki,FilterPanelRemoveAllIcon:Bx,ColumnReorderIcon:Xi},u2=k({},c2,{BaseCheckbox:Vf,BaseTextField:Sl,BaseFormControl:Pf,BaseSelect:bu,BaseSwitch:Ch,BaseButton:Ro,BaseIconButton:ln,BaseInputAdornment:Af,BaseTooltip:Mf,BasePopper:bl,BaseInputLabel:Df,BaseSelectOption:i2,BaseChip:Of}),d2=u2,f2=k({},d2,{Cell:qs,SkeletonCell:Q1,ColumnHeaderFilterIconButton:gx,ColumnMenu:Jx,ColumnHeaders:n2,Footer:yv,FooterRowCount:Rv,Toolbar:null,PreferencesPanel:_m,LoadingOverlay:Fv,NoResultsOverlay:a2,NoRowsOverlay:Iv,Pagination:Av,FilterPanel:Xm,ColumnsPanel:bm,Panel:ym,Row:rw}),N0=e=>{if(e!==void 0)return Object.keys(e).reduce((t,r)=>k({},t,{[`${r.charAt(0).toLowerCase()}${r.slice(1)}`]:e[r]}),{})};function h2({defaultSlots:e,slots:t,components:r}){const n=t??(r?N0(r):null);if(!n||Object.keys(n).length===0)return e;const a=k({},e);return Object.keys(n).forEach(o=>{const s=o;n[s]!==void 0&&(a[s]=n[s])}),a}const g2=["components","componentsProps"];function p2(e){var t;const r=Object.keys(e);if(!r.some(o=>o.startsWith("aria-")||o.startsWith("data-")))return e;const n={},a=(t=e.forwardedProps)!=null?t:{};for(let o=0;o<r.length;o+=1){const s=r[o];s.startsWith("aria-")||s.startsWith("data-")?a[s]=e[s]:n[s]=e[s]}return n.forwardedProps=a,n}function x2(e){return x.useMemo(()=>{const{components:t,componentsProps:r}=e,n=me(e,g2);return[t,r,p2(n)]},[e])}const m2={disableMultipleColumnsFiltering:!0,disableMultipleColumnsSorting:!0,disableMultipleRowSelection:!0,throttleRowsMs:void 0,hideFooterRowCount:!1,pagination:!0,checkboxSelectionVisibleOnly:!1,disableColumnReorder:!0,disableColumnResize:!0,keepColumnPositionIfDraggedOutside:!1,signature:"DataGrid"},bs={autoHeight:!1,autoPageSize:!1,checkboxSelection:!1,checkboxSelectionVisibleOnly:!1,columnBuffer:3,rowBuffer:3,columnThreshold:3,rowThreshold:3,rowSelection:!0,density:"standard",disableColumnFilter:!1,disableColumnMenu:!1,disableColumnSelector:!1,disableDensitySelector:!1,disableEval:!1,disableMultipleColumnsFiltering:!1,disableMultipleRowSelection:!1,disableMultipleColumnsSorting:!1,disableRowSelectionOnClick:!1,disableVirtualization:!1,editMode:Rr.Cell,filterMode:"client",filterDebounceMs:150,columnHeaderHeight:56,hideFooter:!1,hideFooterPagination:!1,hideFooterRowCount:!1,hideFooterSelectedRowCount:!1,ignoreDiacritics:!1,logger:console,logLevel:"error",pagination:!1,paginationMode:"client",rowHeight:52,pageSizeOptions:[25,50,100],rowSpacingType:"margin",showCellVerticalBorder:!1,showColumnVerticalBorder:!1,sortingOrder:["asc","desc",null],sortingMode:"client",throttleRowsMs:0,disableColumnReorder:!1,disableColumnResize:!1,keepNonExistentRowsSelected:!1,keepColumnPositionIfDraggedOutside:!1,unstable_ignoreValueFormatterDuringExport:!1,clipboardCopyCellDelimiter:"	",rowPositionsDebounceMs:166},v2=N0(f2),w2=e=>{const[t,r,n]=x2(Ln({props:e,name:"MuiDataGrid"})),a=x.useMemo(()=>k({},IC,n.localeText),[n.localeText]),o=x.useMemo(()=>h2({defaultSlots:v2,slots:n.slots,components:t}),[t,n.slots]);return x.useMemo(()=>{var s;return k({},bs,n,{localeText:a,slots:o,slotProps:(s=n.slotProps)!=null?s:r},m2)},[n,a,o,r])},C2=e=>k({},e,{rowsMeta:{currentPageTotalHeight:0,positions:[]}}),gc=(e,t,r)=>typeof e=="number"&&e>0?e:t,b2=(e,t)=>{const{getRowHeight:r,getRowSpacing:n,getEstimatedRowHeight:a}=t,o=x.useRef(Object.create(null)),s=x.useRef(-1),l=x.useRef(!1),i=Ce(e,xa),u=Ce(e,It),c=Ce(e,i0),d=Ce(e,ur),f=Hn(e,t),p=Ce(e,pa),h=gc(t.rowHeight,bs.rowHeight),g=Math.floor(h*i),m=x.useCallback(()=>{var D,L;l.current=!1;const M=H=>{o.current[H.id]||(o.current[H.id]={sizes:{baseCenter:g},isResized:!1,autoHeight:!1,needsFirstMeasurement:!0});const{isResized:G,needsFirstMeasurement:_,sizes:Z}=o.current[H.id];let ee=typeof g=="number"&&g>0?g:52;const P=Z.baseCenter;if(G)ee=P;else if(r){const le=r(k({},H,{densityFactor:i}));if(le==="auto"){if(_){const fe=a?a(k({},H,{densityFactor:i})):g;ee=fe??g}else ee=P;l.current=!0,o.current[H.id].autoHeight=!0}else ee=gc(le,g),o.current[H.id].needsFirstMeasurement=!1,o.current[H.id].autoHeight=!1}else o.current[H.id].needsFirstMeasurement=!1;const q={};for(const le in Z)/^base[A-Z]/.test(le)&&(q[le]=Z[le]);if(q.baseCenter=ee,n){var K,X;const le=e.current.getRowIndexRelativeToVisibleRows(H.id),fe=n(k({},H,{isFirstVisible:le===0,isLastVisible:le===f.rows.length-1,indexRelativeToCurrentPage:le}));q.spacingTop=(K=fe.top)!=null?K:0,q.spacingBottom=(X=fe.bottom)!=null?X:0}const te=e.current.unstable_applyPipeProcessors("rowHeight",q,H);return o.current[H.id].sizes=te,te},F=[],B=f.rows.reduce((H,G)=>{F.push(H);let _=0,Z=0;const ee=M(G);for(const P in ee){const q=ee[P];/^base[A-Z]/.test(P)?_=q>_?q:_:Z+=q}return H+_+Z},0);p==null||(D=p.top)==null||D.forEach(H=>{M(H)}),p==null||(L=p.bottom)==null||L.forEach(H=>{M(H)}),e.current.setState(H=>k({},H,{rowsMeta:{currentPageTotalHeight:B,positions:F}})),l.current||(s.current=1/0),e.current.forceUpdate()},[e,f.rows,g,r,n,a,p,i]),w=x.useCallback(D=>{const L=o.current[D];return L?L.sizes.baseCenter:g},[g]),v=D=>{var L;return(L=o.current[D])==null?void 0:L.sizes},C=x.useCallback((D,L)=>{o.current[D].sizes.baseCenter=L,o.current[D].isResized=!0,o.current[D].needsFirstMeasurement=!1,m()},[m]),E=x.useMemo(()=>kl(m,t.rowPositionsDebounceMs),[m,t.rowPositionsDebounceMs]),R=x.useCallback((D,L,M)=>{if(!o.current[D]||!o.current[D].autoHeight)return;const F=o.current[D].sizes[`base${et(M)}`]!==L;o.current[D].needsFirstMeasurement=!1,o.current[D].sizes[`base${et(M)}`]=L,F&&E()},[E]),S=x.useCallback(D=>{var L;return((L=o.current[D])==null?void 0:L.autoHeight)||!1},[]),b=x.useCallback(()=>s.current,[]),T=x.useCallback(D=>{l.current&&D>s.current&&(s.current=D)},[]),A=x.useCallback(()=>{o.current={},m()},[m]);x.useEffect(()=>{m()},[g,u,c,d,m]),jl(e,"rowHeight",m);const N={unstable_setLastMeasuredRowIndex:T,unstable_getRowHeight:w,unstable_getRowInternalSizes:v,unstable_setRowHeight:C,unstable_storeRowHeightMeasurement:R,resetRowHeights:A},y={getLastMeasuredRowIndex:b,rowHasAutoHeight:S};ze(e,N,"public"),ze(e,y,"private")},S2=e=>{const t=x.useCallback((a={})=>e.current.unstable_applyPipeProcessors("exportState",{},a),[e]),r=x.useCallback(a=>{e.current.unstable_applyPipeProcessors("restoreState",{callbacks:[]},{stateToRestore:a}).callbacks.forEach(s=>{s()}),e.current.forceUpdate()},[e]);ze(e,{exportState:t,restoreState:r},"public")},k2=e=>{const t=x.useRef({}),r=x.useCallback((u,c,d)=>{const f=t.current;f[u]||(f[u]={}),f[u][c]=d},[]),n=x.useCallback((u,c)=>{var d;return(d=t.current[u])==null?void 0:d[c]},[]),a=x.useCallback(u=>{const{columnIndex:c,rowId:d,minFirstColumnIndex:f,maxLastColumnIndex:p,columns:h}=u,g=h.length,m=h[c],w=typeof m.colSpan=="function"?m.colSpan(e.current.getCellParams(d,m.field)):m.colSpan;if(!w||w===1)return r(d,c,{spannedByColSpan:!1,cellProps:{colSpan:1,width:m.computedWidth}}),{colSpan:1};let v=m.computedWidth;for(let C=1;C<w;C+=1){const E=c+C;if(E>=f&&E<p){const R=h[E];v+=R.computedWidth,r(d,c+C,{spannedByColSpan:!0,rightVisibleCellIndex:Math.min(c+w,g-1),leftVisibleCellIndex:c})}r(d,c,{spannedByColSpan:!1,cellProps:{colSpan:w,width:v}})}return{colSpan:w}},[e,r]),o=x.useCallback(({rowId:u,minFirstColumn:c,maxLastColumn:d,columns:f})=>{for(let p=c;p<d;p+=1){const h=a({columnIndex:p,rowId:u,minFirstColumnIndex:c,maxLastColumnIndex:d,columns:f});h.colSpan>1&&(p+=h.colSpan-1)}},[a]),s={unstable_getCellColSpanInfo:n},l={calculateColSpan:o};ze(e,s,"public"),ze(e,l,"private");const i=x.useCallback(()=>{t.current={}},[]);Fe(e,"columnOrderChange",i)},B0=(e,t,r)=>{if(Xu(e)){if(r[e.field]!==void 0)throw new Error(["MUI: columnGroupingModel contains duplicated field",`column field ${e.field} occurs two times in the grouping model:`,`- ${r[e.field].join(" > ")}`,`- ${t.join(" > ")}`].join(`
`));r[e.field]=t;return}const{groupId:n,children:a}=e;a.forEach(o=>{B0(o,[...t,n],r)})},al=e=>{if(!e)return{};const t={};return e.forEach(r=>{B0(r,[],t)}),t},ol=(e,t,r)=>{const n=i=>{var u;return(u=t[i])!=null?u:[]},a=[],o=Math.max(...e.map(i=>n(i).length)),s=(i,u,c)=>jr(n(i).slice(0,c+1),n(u).slice(0,c+1)),l=(i,u)=>!!(r!=null&&r.left&&r.left.includes(i)&&!r.left.includes(u)||r!=null&&r.right&&!r.right.includes(i)&&r.right.includes(u));for(let i=0;i<o;i+=1){const u=e.reduce((c,d)=>{var f;const p=(f=n(d)[i])!=null?f:null;if(c.length===0)return[{columnFields:[d],groupId:p}];const h=c[c.length-1],g=h.columnFields[h.columnFields.length-1];return h.groupId!==p||!s(g,d,i)||l(g,d)?[...c,{columnFields:[d],groupId:p}]:[...c.slice(0,c.length-1),{columnFields:[...h.columnFields,d],groupId:p}]},[]);a.push(u)}return a},E2=["groupId","children"],Kl=e=>{let t={};return e.forEach(r=>{if(Xu(r))return;const{groupId:n,children:a}=r,o=me(r,E2);if(!n)throw new Error("MUI: An element of the columnGroupingModel does not have either `field` or `groupId`.");a||console.warn(`MUI: group groupId=${n} has no children.`);const s=k({},o,{groupId:n}),l=Kl(a);if(l[n]!==void 0||t[n]!==void 0)throw new Error(`MUI: The groupId ${n} is used multiple times in the columnGroupingModel.`);t=k({},t,l,{[n]:s})}),k({},t)},T2=(e,t,r)=>{var n,a,o,s;if(!((n=t.experimentalFeatures)!=null&&n.columnGrouping))return e;const l=zr(r),i=us(r),u=Kl((a=t.columnGroupingModel)!=null?a:[]),c=al((o=t.columnGroupingModel)!=null?o:[]),d=ol(l,c,(s=r.current.state.pinnedColumns)!=null?s:{}),f=i.length===0?0:Math.max(...i.map(p=>{var h,g;return(h=(g=c[p])==null?void 0:g.length)!=null?h:0}));return k({},e,{columnGrouping:{lookup:u,unwrappedGroupingModel:c,headerStructure:d,maxDepth:f}})},y2=(e,t)=>{var r;const n=x.useCallback(i=>{var u;return(u=yg(e)[i])!=null?u:[]},[e]),a=x.useCallback(()=>Ru(e),[e]);ze(e,{unstable_getColumnGroupPath:n,unstable_getAllGroupDetails:a},"public");const s=x.useCallback(()=>{var i;const u=al((i=t.columnGroupingModel)!=null?i:[]);e.current.setState(c=>{var d,f,p;const h=(d=(f=c.columns)==null?void 0:f.orderedFields)!=null?d:[],g=(p=c.pinnedColumns)!=null?p:{},m=ol(h,u,g);return k({},c,{columnGrouping:k({},c.columnGrouping,{headerStructure:m})})})},[e,t.columnGroupingModel]),l=x.useCallback(i=>{var u,c,d,f;if(!((u=t.experimentalFeatures)!=null&&u.columnGrouping))return;const p=(c=(d=(f=e.current).getPinnedColumns)==null?void 0:d.call(f))!=null?c:{},h=zr(e),g=us(e),m=Kl(i??[]),w=al(i??[]),v=ol(h,w,p),C=g.length===0?0:Math.max(...g.map(E=>{var R,S;return(R=(S=w[E])==null?void 0:S.length)!=null?R:0}));e.current.setState(E=>k({},E,{columnGrouping:{lookup:m,unwrappedGroupingModel:w,headerStructure:v,maxDepth:C}}))},[e,(r=t.experimentalFeatures)==null?void 0:r.columnGrouping]);Fe(e,"columnIndexChange",s),Fe(e,"columnsChange",()=>{l(t.columnGroupingModel)}),Fe(e,"columnVisibilityModelChange",()=>{l(t.columnGroupingModel)}),x.useEffect(()=>{l(t.columnGroupingModel)},[l,t.columnGroupingModel])},_2=(e,t)=>{const r=xw(e,t);return AC(r,t),yC(r),er(_C,r,t),er(Vw,r,t),er(bC,r,t),er(wC,r,t),er(oC,r,t),er(MC,r,t),er(cC,r,t),er(tC,r,t),er(jw,r,t),er(qw,r,t),er(C2,r,t),er(Lw,r,t),er(T2,r,t),er(ux,r,t),iC(r,t),FC(r,t),Gw(r,t),SC(r,t),s1(r,t),k2(r),y2(r,t),CC(r,t),sC(r,t),uC(r,t),aC(r,t),DC(r,t),Ww(r,t),Zw(r,t),b2(r,t),OC(r,t),Nw(r),Yw(r,t),eC(r,t),Rw(r,t),NC(r,t),RC(r,t),S2(r),dx(r,t),r},F2=e=>{const{classes:t}=e;return Le({root:["virtualScroller"]},We,t)},I2=Ft("div",{name:"MuiDataGrid",slot:"VirtualScroller",overridesResolver:(e,t)=>t.virtualScroller})({overflow:"auto",height:"100%",position:"relative","@media print":{overflow:"hidden"},zIndex:0}),P2=x.forwardRef(function(t,r){const n=ke(),a=F2(n);return I.jsx(I2,k({ref:r},t,{className:Ue(a.root,t.className),ownerState:n}))}),A2=(e,t)=>{const{classes:r}=e;return Le({root:["virtualScrollerContent",t&&"virtualScrollerContent--overflowed"]},We,r)},M2=Ft("div",{name:"MuiDataGrid",slot:"VirtualScrollerContent",overridesResolver:(e,t)=>t.virtualScrollerContent})({}),D2=x.forwardRef(function(t,r){var n;const a=ke(),o=!a.autoHeight&&((n=t.style)==null?void 0:n.minHeight)==="auto",s=A2(a,o);return I.jsx(M2,k({ref:r},t,{ownerState:a,className:Ue(s.root,t.className)}))}),O2=["className"],R2=e=>{const{classes:t}=e;return Le({root:["virtualScrollerRenderZone"]},We,t)},L2=Ft("div",{name:"MuiDataGrid",slot:"VirtualScrollerRenderZone",overridesResolver:(e,t)=>t.virtualScrollerRenderZone})({position:"absolute",display:"flex",flexDirection:"column"}),N2=x.forwardRef(function(t,r){const{className:n}=t,a=me(t,O2),o=ke(),s=R2(o);return I.jsx(L2,k({ref:r,className:Ue(s.root,n),ownerState:o},a))}),B2=["className"],H2=x.forwardRef(function(t,r){const{className:n}=t,a=me(t,B2),{getRootProps:o,getContentProps:s,getRenderZoneProps:l,getRows:i}=GC({ref:r});return I.jsxs(P2,k({className:n},o(a),{children:[I.jsx(Jg,{}),I.jsx(D2,k({},s(),{children:I.jsx(N2,k({},l(),{children:i()}))}))]}))}),H0=x.forwardRef(function(t,r){const n=w2(t),a=_2(n.apiRef,n);return I.jsx(nw,{privateApiRef:a,props:n,children:I.jsxs(np,k({className:n.className,style:n.style,sx:n.sx,ref:r},n.forwardedProps,{children:[I.jsx(_v,{}),I.jsx(zg,{VirtualScrollerComponent:H2}),I.jsx(jg,{})]}))})}),$2=x.memo(H0);bs.filterDebounceMs;bs.filterDebounceMs;H0.propTypes={apiRef:J.shape({current:J.object.isRequired}),"aria-label":J.string,"aria-labelledby":J.string,autoHeight:J.bool,autoPageSize:J.bool,cellModesModel:J.object,checkboxSelection:J.bool,classes:J.object,clipboardCopyCellDelimiter:J.string,columnBuffer:J.number,columnGroupingModel:J.arrayOf(J.object),columnHeaderHeight:J.number,columns:Uf(J.array.isRequired),columnThreshold:J.number,columnVisibilityModel:J.object,components:J.object,componentsProps:J.object,density:J.oneOf(["comfortable","compact","standard"]),disableColumnFilter:J.bool,disableColumnMenu:J.bool,disableColumnSelector:J.bool,disableDensitySelector:J.bool,disableEval:J.bool,disableRowSelectionOnClick:J.bool,disableVirtualization:J.bool,editMode:J.oneOf(["cell","row"]),experimentalFeatures:J.shape({ariaV7:J.bool,columnGrouping:J.bool,warnIfFocusStateIsNotSynced:J.bool}),filterDebounceMs:J.number,filterMode:J.oneOf(["client","server"]),filterModel:J.shape({items:J.arrayOf(J.shape({field:J.string.isRequired,id:J.oneOfType([J.number,J.string]),operator:J.string.isRequired,value:J.any})).isRequired,logicOperator:J.oneOf(["and","or"]),quickFilterExcludeHiddenColumns:J.bool,quickFilterLogicOperator:J.oneOf(["and","or"]),quickFilterValues:J.array}),forwardedProps:J.object,getCellClassName:J.func,getDetailPanelContent:J.func,getEstimatedRowHeight:J.func,getRowClassName:J.func,getRowHeight:J.func,getRowId:J.func,getRowSpacing:J.func,hideFooter:J.bool,hideFooterPagination:J.bool,hideFooterSelectedRowCount:J.bool,ignoreDiacritics:J.bool,initialState:J.object,isCellEditable:J.func,isRowSelectable:J.func,keepNonExistentRowsSelected:J.bool,loading:J.bool,localeText:J.object,logger:J.shape({debug:J.func.isRequired,error:J.func.isRequired,info:J.func.isRequired,warn:J.func.isRequired}),logLevel:J.oneOf(["debug","error","info","warn",!1]),nonce:J.string,onCellClick:J.func,onCellDoubleClick:J.func,onCellEditStart:J.func,onCellEditStop:J.func,onCellKeyDown:J.func,onCellModesModelChange:J.func,onClipboardCopy:J.func,onColumnHeaderClick:J.func,onColumnHeaderDoubleClick:J.func,onColumnHeaderEnter:J.func,onColumnHeaderLeave:J.func,onColumnHeaderOut:J.func,onColumnHeaderOver:J.func,onColumnOrderChange:J.func,onColumnVisibilityModelChange:J.func,onFilterModelChange:J.func,onMenuClose:J.func,onMenuOpen:J.func,onPaginationModelChange:J.func,onPreferencePanelClose:J.func,onPreferencePanelOpen:J.func,onProcessRowUpdateError:J.func,onResize:J.func,onRowClick:J.func,onRowDoubleClick:J.func,onRowEditCommit:J.func,onRowEditStart:J.func,onRowEditStop:J.func,onRowModesModelChange:J.func,onRowSelectionModelChange:J.func,onSortModelChange:J.func,onStateChange:J.func,pageSizeOptions:J.arrayOf(J.oneOfType([J.number,J.shape({label:J.string.isRequired,value:J.number.isRequired})]).isRequired),pagination:e=>e.pagination===!1?new Error(["MUI: `<DataGrid pagination={false} />` is not a valid prop.","Infinite scrolling is not available in the MIT version.","","You need to upgrade to DataGridPro or DataGridPremium component to disable the pagination."].join(`
`)):null,paginationMode:J.oneOf(["client","server"]),paginationModel:J.shape({page:J.number.isRequired,pageSize:J.number.isRequired}),processRowUpdate:J.func,rowBuffer:J.number,rowCount:J.number,rowHeight:J.number,rowModesModel:J.object,rowPositionsDebounceMs:J.number,rows:J.arrayOf(J.object).isRequired,rowSelection:J.bool,rowSelectionModel:J.oneOfType([J.arrayOf(J.oneOfType([J.number,J.string]).isRequired),J.number,J.string]),rowSpacingType:J.oneOf(["border","margin"]),rowThreshold:J.number,scrollbarSize:J.number,showCellVerticalBorder:J.bool,showColumnVerticalBorder:J.bool,slotProps:J.object,slots:J.object,sortingMode:J.oneOf(["client","server"]),sortingOrder:J.arrayOf(J.oneOf(["asc","desc"])),sortModel:J.arrayOf(J.shape({field:J.string.isRequired,sort:J.oneOf(["asc","desc"])})),sx:J.oneOfType([J.arrayOf(J.oneOfType([J.func,J.object,J.bool])),J.func,J.object]),unstable_ignoreValueFormatterDuringExport:J.oneOfType([J.shape({clipboardExport:J.bool,csvExport:J.bool}),J.bool])};var Xl={},V2=ro;Object.defineProperty(Xl,"__esModule",{value:!0});var $0=Xl.default=void 0,G2=V2(to()),pc=I;$0=Xl.default=(0,G2.default)([(0,pc.jsx)("path",{d:"M17 19.22H5V7h7V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-7h-2z"},"0"),(0,pc.jsx)("path",{d:"M19 2h-2v3h-3c.01.01 0 2 0 2h3v2.99c.01.01 2 0 2 0V7h3V5h-3zM7 9h8v2H7zm0 3v2h8v-2h-3zm0 3h8v2H7z"},"1")],"PostAdd");/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var V0=1252,U2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Yl={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ql=function(e){U2.indexOf(e)!=-1&&(V0=Yl[0]=e)};function z2(){ql(1252)}var br=function(e){ql(e)};function G0(){br(1200),z2()}function xc(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function j2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function U0(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Fa=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?j2(e.slice(2)):t==254&&r==255?U0(e.slice(2)):t==65279?e.slice(1):e},ko=function(t){return String.fromCharCode(t)},mc=function(t){return String.fromCharCode(t)},on,dn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function vc(e){for(var t="",r=0,n=0,a=0,o=0,s=0,l=0,i=0,u=0;u<e.length;)r=e.charCodeAt(u++),o=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),l=(n&15)<<2|a>>6,i=a&63,isNaN(n)?l=i=64:isNaN(a)&&(i=64),t+=dn.charAt(o)+dn.charAt(s)+dn.charAt(l)+dn.charAt(i);return t}function sr(e){var t="",r=0,n=0,a=0,o=0,s=0,l=0,i=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)o=dn.indexOf(e.charAt(u++)),s=dn.indexOf(e.charAt(u++)),r=o<<2|s>>4,t+=String.fromCharCode(r),l=dn.indexOf(e.charAt(u++)),n=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),i=dn.indexOf(e.charAt(u++)),a=(l&3)<<6|i,i!==64&&(t+=String.fromCharCode(a));return t}var Xe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$n=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function pn(e){return Xe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function wc(e){return Xe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wr=function(t){return Xe?$n(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Vn(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Zl(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Zl(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var sn=Xe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:$n(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function W2(e){for(var t=[],r=0,n=e.length+250,a=pn(e.length+255),o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++o)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|l>>6&15|(s&3)<<4,a[r++]=128|l&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=pn(65535),n=65530)}return t.push(a.slice(0,r)),sn(t)}var Qt=/\u0000/g,Ia=/[\u0001-\u0006]/g;function ia(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Sr(e,t){var r=""+e;return r.length>=t?r:pt("0",t-r.length)+r}function Ql(e,t){var r=""+e;return r.length>=t?r:pt(" ",t-r.length)+r}function Yo(e,t){var r=""+e;return r.length>=t?r:r+pt(" ",t-r.length)}function K2(e,t){var r=""+Math.round(e);return r.length>=t?r:pt("0",t-r.length)+r}function X2(e,t){var r=""+e;return r.length>=t?r:pt("0",t-r.length)+r}var Cc=Math.pow(2,32);function Qn(e,t){if(e>Cc||e<-Cc)return K2(e,t);var r=Math.round(e);return X2(r,t)}function qo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var bc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Bs=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Y2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var Ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},Sc={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},q2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zo(e,t,r){for(var n=e<0?-1:1,a=e*n,o=0,s=1,l=0,i=1,u=0,c=0,d=Math.floor(a);u<t&&(d=Math.floor(a),l=d*s+o,c=d*u+i,!(a-d<5e-8));)a=1/(a-d),o=s,s=l,i=u,u=c;if(c>t&&(u>t?(c=i,l=o):(c=u,l=s)),!r)return[0,n*l,c];var f=Math.floor(n*l/c);return[f,n*l-f*c,c]}function En(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),o=0,s=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var i=new Date(1900,0,1);i.setDate(i.getDate()+n-1),s=[i.getFullYear(),i.getMonth()+1,i.getDate()],o=i.getDay(),n<60&&(o=(o+6)%7),r&&(o=rb(i,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=o,l}var z0=new Date(1899,11,31,0,0,0),Z2=z0.getTime(),Q2=new Date(1900,2,1,0,0,0);function j0(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Q2&&(r+=24*60*60*1e3),(r-(Z2+(e.getTimezoneOffset()-z0.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Jl(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function J2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function eb(e){var t=e<0?12:11,r=Jl(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function tb(e){var t=Jl(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ka(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=eb(e):t===10?r=e.toFixed(10).substr(0,12):r=tb(e),Jl(J2(r.toUpperCase()))}function Dn(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ka(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return hr(14,j0(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function rb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function nb(e,t,r,n){var a="",o=0,s=0,l=r.y,i,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,u=2;break;default:i=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:i=r.m,u=t.length;break;case 3:return Bs[r.m-1][1];case 5:return Bs[r.m-1][0];default:return Bs[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=r.d,u=t.length;break;case 3:return bc[r.q][0];default:return bc[r.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Sr(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,o=Math.round(s*(r.S+r.u)),o>=60*s&&(o=0),t==="s"?o===0?"0":""+o/s:(a=Sr(o,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":i=r.D*24+r.H;break;case"[m]":case"[mm]":i=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":i=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:i=l,u=1;break}var c=u>0?Sr(i,u):"";return c}function fn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var W0=/%/g;function ab(e,t,r){var n=t.replace(W0,""),a=t.length-n.length;return Wr(e,n,r*Math.pow(10,2*a))+pt("%",a)}function ob(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function K0(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+K0(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(t/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+o):r+="E+"+(s-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,i,u,c){return i+u+c.substr(0,(a+o)%a)+"."+c.substr(o)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var X0=/# (\?+)( ?)\/( ?)(\d+)/;function sb(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),o=Math.floor(a/n),s=a-o*n,l=n;return r+(o===0?"":""+o)+" "+(s===0?pt(" ",e[1].length+1+e[4].length):Ql(s,e[1].length)+e[2]+"/"+e[3]+Sr(l,e[4].length))}function lb(e,t,r){return r+(t===0?"":""+t)+pt(" ",e[1].length+2+e[4].length)}var Y0=/^#*0*\.([0#]+)/,q0=/\).*[0#]/,Z0=/\(###\) ###\\?-####/;function Kt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function kc(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ec(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function ib(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function cb(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ir(e,t,r){if(e.charCodeAt(0)===40&&!t.match(q0)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ir("n",n,r):"("+ir("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ob(e,t,r);if(t.indexOf("%")!==-1)return ab(e,t,r);if(t.indexOf("E")!==-1)return K0(t,r);if(t.charCodeAt(0)===36)return"$"+ir(e,t.substr(t.charAt(1)==" "?2:1),r);var a,o,s,l,i=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Qn(i,t.length);if(t.match(/^[#?]+$/))return a=Qn(r,0),a==="0"&&(a=""),a.length>t.length?a:Kt(t.substr(0,t.length-a.length))+a;if(o=t.match(X0))return sb(o,i,u);if(t.match(/^#+0+$/))return u+Qn(i,t.length-t.indexOf("0"));if(o=t.match(Y0))return a=kc(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Kt(o[1])).replace(/\.$/,"."+Kt(o[1])).replace(/\.(\d*)$/,function(h,g){return"."+g+pt("0",Kt(o[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return u+kc(i,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return u+fn(Qn(i,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ir(e,t,-r):fn(""+(Math.floor(r)+ib(r,o[1].length)))+"."+Sr(Ec(r,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return ir(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ia(ir(e,t.replace(/[\\-]/g,""),r)),s=0,ia(ia(t.replace(/\\/g,"")).replace(/[0#]/g,function(h){return s<a.length?a.charAt(s++):h==="0"?"0":""}));if(t.match(Z0))return a=ir(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=Zo(i,Math.pow(10,s)-1,!1),a=""+u,c=Wr("n",o[1],l[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+o[2]+"/"+o[3],c=Yo(l[2],s),c.length<o[4].length&&(c=Kt(o[4].substr(o[4].length-c.length))+c),a+=c,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=Zo(i,Math.pow(10,s)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ql(l[1],s)+o[2]+"/"+o[3]+Yo(l[2],s):pt(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=Qn(r,0),t.length<=a.length?a:Kt(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,f=t.length-a.length-d;return Kt(t.substr(0,d)+a+t.substr(t.length-f))}if(o=t.match(/^00,000\.([#0]*0)$/))return s=Ec(r,o[1].length),r<0?"-"+ir(e,t,-r):fn(cb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?Sr(0,3-h.length):"")+h})+"."+Sr(s,o[1].length);switch(t){case"###,##0.00":return ir(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=fn(Qn(i,0));return p!=="0"?u+p:"";case"###,###.00":return ir(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ir(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ub(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function db(e,t,r){var n=t.replace(W0,""),a=t.length-n.length;return Wr(e,n,r*Math.pow(10,2*a))+pt("%",a)}function Q0(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Q0(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(t/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+o):r+="E+"+(s-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,i,u,c){return i+u+c.substr(0,(a+o)%a)+"."+c.substr(o)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ar(e,t,r){if(e.charCodeAt(0)===40&&!t.match(q0)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ar("n",n,r):"("+Ar("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ub(e,t,r);if(t.indexOf("%")!==-1)return db(e,t,r);if(t.indexOf("E")!==-1)return Q0(t,r);if(t.charCodeAt(0)===36)return"$"+Ar(e,t.substr(t.charAt(1)==" "?2:1),r);var a,o,s,l,i=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Sr(i,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Kt(t.substr(0,t.length-a.length))+a;if(o=t.match(X0))return lb(o,i,u);if(t.match(/^#+0+$/))return u+Sr(i,t.length-t.indexOf("0"));if(o=t.match(Y0))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Kt(o[1])).replace(/\.$/,"."+Kt(o[1])),a=a.replace(/\.(\d*)$/,function(h,g){return"."+g+pt("0",Kt(o[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return u+(""+i).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return u+fn(""+i);if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ar(e,t,-r):fn(""+r)+"."+pt("0",o[1].length);if(o=t.match(/^#,#*,#0/))return Ar(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ia(Ar(e,t.replace(/[\\-]/g,""),r)),s=0,ia(ia(t.replace(/\\/g,"")).replace(/[0#]/g,function(h){return s<a.length?a.charAt(s++):h==="0"?"0":""}));if(t.match(Z0))return a=Ar(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=Zo(i,Math.pow(10,s)-1,!1),a=""+u,c=Wr("n",o[1],l[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+o[2]+"/"+o[3],c=Yo(l[2],s),c.length<o[4].length&&(c=Kt(o[4].substr(o[4].length-c.length))+c),a+=c,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=Zo(i,Math.pow(10,s)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ql(l[1],s)+o[2]+"/"+o[3]+Yo(l[2],s):pt(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Kt(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,f=t.length-a.length-d;return Kt(t.substr(0,d)+a+t.substr(t.length-f))}if(o=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ar(e,t,-r):fn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?Sr(0,3-h.length):"")+h})+"."+Sr(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=fn(""+i);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Ar(e,t.slice(0,t.lastIndexOf(".")),r)+Kt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wr(e,t,r){return(r|0)===r?Ar(e,t,r):ir(e,t,r)}function fb(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var J0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function va(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":qo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(J0))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function hb(e,t,r,n){for(var a=[],o="",s=0,l="",i="t",u,c,d,f="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!qo(e,s))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";(d=e.charCodeAt(++s))!==34&&s<e.length;)o+=String.fromCharCode(d);a[a.length]={t:"t",v:o},++s;break;case"\\":var p=e.charAt(++s),h=p==="("||p===")"?p:"t";a[a.length]={t:h,v:p},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=En(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},i=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=En(t,r),u==null))return"";for(o=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)o+=l;l==="m"&&i.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),a[a.length]={t:l,v:o},i=l;break;case"A":case"a":case"ä¸Š":var g={t:l,v:l};if(u==null&&(u=En(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",f="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,f="h"):e.substr(s,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(u!=null&&(g.v=u.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),g.t="T",s+=5,f="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,i=l;break;case"[":for(o=l;e.charAt(s++)!=="]"&&s<e.length;)o+=e.charAt(s);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(J0)){if(u==null&&(u=En(t,r),u==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},i=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",va(e)||(a[a.length]={t:"t",v:o}));break;case".":if(u!=null){for(o=l;++s<e.length&&(l=e.charAt(s))==="0";)o+=l;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)o+=l;a[a.length]={t:"n",v:o};break;case"?":for(o=l;e.charAt(++s)===l;)o+=l;a[a.length]={t:l,v:o},i=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)o+=e.charAt(s);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++s;break}var m=0,w=0,v;for(s=a.length-1,i="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=f,i="h",m<1&&(m=1);break;case"s":(v=a[s].v.match(/\.0+$/))&&(w=Math.max(w,v[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":i=a[s].t;break;case"m":i==="s"&&(a[s].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&a[s].v.match(/[Hh]/)&&(m=1),m<2&&a[s].v.match(/[Mm]/)&&(m=2),m<3&&a[s].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var C="",E;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=nb(a[s].t.charCodeAt(0),a[s].v,u,w),a[s].t="t";break;case"n":case"?":for(E=s+1;a[E]!=null&&((l=a[E].t)==="?"||l==="D"||(l===" "||l==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[s].v+=a[E].v,a[E]={v:"",t:";"},++E;C+=a[s].v,s=E-1;break;case"G":a[s].t="t",a[s].v=Dn(t,r);break}var R="",S,b;if(C.length>0){C.charCodeAt(0)==40?(S=t<0&&C.charCodeAt(0)===45?-t:t,b=Wr("n",C,S)):(S=t<0&&n>1?-t:t,b=Wr("n",C,S),S<0&&a[0]&&a[0].t=="t"&&(b=b.substr(1),a[0].v="-"+a[0].v)),E=b.length-1;var T=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){T=s;break}var A=a.length;if(T===a.length&&b.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(E>=a[s].v.length-1?(E-=a[s].v.length,a[s].v=b.substr(E+1,a[s].v.length)):E<0?a[s].v="":(a[s].v=b.substr(0,E+1),E=-1),a[s].t="t",A=s);E>=0&&A<a.length&&(a[A].v=b.substr(0,E+1)+a[A].v)}else if(T!==a.length&&b.indexOf("E")===-1){for(E=b.indexOf(".")-1,s=T;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(c=a[s].v.indexOf(".")>-1&&s===T?a[s].v.indexOf(".")-1:a[s].v.length-1,R=a[s].v.substr(c+1);c>=0;--c)E>=0&&(a[s].v.charAt(c)==="0"||a[s].v.charAt(c)==="#")&&(R=b.charAt(E--)+R);a[s].v=R,a[s].t="t",A=s}for(E>=0&&A<a.length&&(a[A].v=b.substr(0,E+1)+a[A].v),E=b.indexOf(".")+1,s=T;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==T)){for(c=a[s].v.indexOf(".")>-1&&s===T?a[s].v.indexOf(".")+1:0,R=a[s].v.substr(0,c);c<a[s].v.length;++c)E<b.length&&(R+=b.charAt(E++));a[s].v=R,a[s].t="t",A=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(S=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Wr(a[s].t,a[s].v,S),a[s].t="t");var N="";for(s=0;s!==a.length;++s)a[s]!=null&&(N+=a[s].v);return N}var Tc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yc(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function gb(e,t){var r=fb(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(Tc),l=r[1].match(Tc);return yc(t,s)?[n,r[0]]:yc(t,l)?[n,r[1]]:[n,r[s!=null&&l!=null?2:1]]}return[n,o]}function hr(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ge)[e],n==null&&(n=r.table&&r.table[Sc[e]]||Ge[Sc[e]]),n==null&&(n=q2[e]||"General");break}if(qo(n,0))return Dn(t,r);t instanceof Date&&(t=j0(t,r.date1904));var a=gb(n,t);if(qo(a[1]))return Dn(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return hb(a[1],t,r,a[0])}function In(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ge[r]==null){t<0&&(t=r);continue}if(Ge[r]==e){t=r;break}}t<0&&(t=391)}return Ge[t]=e,t}function ed(){Ge=Y2()}var pb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},td=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xb(e){var t=typeof e=="number"?Ge[e]:e;return t=t.replace(td,"(\\d+)"),new RegExp("^"+t+"$")}function mb(e,t,r){var n=-1,a=-1,o=-1,s=-1,l=-1,i=-1;(t.match(td)||[]).forEach(function(d,f){var p=parseInt(r[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":o=p;break;case"h":s=p;break;case"s":i=p;break;case"m":s>=0?l=p:a=p;break}}),i>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(i>=0?i:0)).slice(-2);return s==-1&&l==-1&&i==-1?u:n==-1&&a==-1&&o==-1?c:u+"T"+c}var vb=function(){var e={};e.version="1.2.0";function t(){for(var b=0,T=new Array(256),A=0;A!=256;++A)b=A,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,T[A]=b;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(b){var T=0,A=0,N=0,y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)y[N]=b[N];for(N=0;N!=256;++N)for(A=b[N],T=256+N;T<4096;T+=256)A=y[T]=A>>>8^b[A&255];var D=[];for(N=1;N!=16;++N)D[N-1]=typeof Int32Array<"u"?y.subarray(N*256,N*256+256):y.slice(N*256,N*256+256);return D}var a=n(r),o=a[0],s=a[1],l=a[2],i=a[3],u=a[4],c=a[5],d=a[6],f=a[7],p=a[8],h=a[9],g=a[10],m=a[11],w=a[12],v=a[13],C=a[14];function E(b,T){for(var A=T^-1,N=0,y=b.length;N<y;)A=A>>>8^r[(A^b.charCodeAt(N++))&255];return~A}function R(b,T){for(var A=T^-1,N=b.length-15,y=0;y<N;)A=C[b[y++]^A&255]^v[b[y++]^A>>8&255]^w[b[y++]^A>>16&255]^m[b[y++]^A>>>24]^g[b[y++]]^h[b[y++]]^p[b[y++]]^f[b[y++]]^d[b[y++]]^c[b[y++]]^u[b[y++]]^i[b[y++]]^l[b[y++]]^s[b[y++]]^o[b[y++]]^r[b[y++]];for(N+=15;y<N;)A=A>>>8^r[(A^b[y++])&255];return~A}function S(b,T){for(var A=T^-1,N=0,y=b.length,D=0,L=0;N<y;)D=b.charCodeAt(N++),D<128?A=A>>>8^r[(A^D)&255]:D<2048?(A=A>>>8^r[(A^(192|D>>6&31))&255],A=A>>>8^r[(A^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,L=b.charCodeAt(N++)&1023,A=A>>>8^r[(A^(240|D>>8&7))&255],A=A>>>8^r[(A^(128|D>>2&63))&255],A=A>>>8^r[(A^(128|L>>6&15|(D&3)<<4))&255],A=A>>>8^r[(A^(128|L&63))&255]):(A=A>>>8^r[(A^(224|D>>12&15))&255],A=A>>>8^r[(A^(128|D>>6&63))&255],A=A>>>8^r[(A^(128|D&63))&255]);return~A}return e.table=r,e.bstr=E,e.buf=R,e.str=S,e}(),Ye=function(){var t={};t.version="1.2.1";function r(O,j){for(var V=O.split("/"),U=j.split("/"),W=0,Y=0,ae=Math.min(V.length,U.length);W<ae;++W){if(Y=V[W].length-U[W].length)return Y;if(V[W]!=U[W])return V[W]<U[W]?-1:1}return V.length-U.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var j=O.lastIndexOf("/");return j===-1?O:O.slice(0,j+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var j=O.lastIndexOf("/");return j===-1?O:O.slice(j+1)}function o(O,j){typeof j=="string"&&(j=new Date(j));var V=j.getHours();V=V<<6|j.getMinutes(),V=V<<5|j.getSeconds()>>>1,O.write_shift(2,V);var U=j.getFullYear()-1980;U=U<<4|j.getMonth()+1,U=U<<5|j.getDate(),O.write_shift(2,U)}function s(O){var j=O.read_shift(2)&65535,V=O.read_shift(2)&65535,U=new Date,W=V&31;V>>>=5;var Y=V&15;V>>>=4,U.setMilliseconds(0),U.setFullYear(V+1980),U.setMonth(Y-1),U.setDate(W);var ae=j&31;j>>>=5;var ue=j&63;return j>>>=6,U.setHours(j),U.setMinutes(ue),U.setSeconds(ae<<1),U}function l(O){Pt(O,0);for(var j={},V=0;O.l<=O.length-4;){var U=O.read_shift(2),W=O.read_shift(2),Y=O.l+W,ae={};switch(U){case 21589:V=O.read_shift(1),V&1&&(ae.mtime=O.read_shift(4)),W>5&&(V&2&&(ae.atime=O.read_shift(4)),V&4&&(ae.ctime=O.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}O.l=Y,j[U]=ae}return j}var i;function u(){return i||(i={})}function c(O,j){if(O[0]==80&&O[1]==75)return ys(O,j);if((O[0]|32)==109&&(O[1]|32)==105)return Is(O,j);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var V=3,U=512,W=0,Y=0,ae=0,ue=0,re=0,oe=[],se=O.slice(0,512);Pt(se,0);var ge=d(se);switch(V=ge[0],V){case 3:U=512;break;case 4:U=4096;break;case 0:if(ge[1]==0)return ys(O,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}U!==512&&(se=O.slice(0,U),Pt(se,28));var we=O.slice(0,U);f(se,V);var Te=se.read_shift(4,"i");if(V===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);se.l+=4,ae=se.read_shift(4,"i"),se.l+=4,se.chk("00100000","Mini Stream Cutoff Size: "),ue=se.read_shift(4,"i"),W=se.read_shift(4,"i"),re=se.read_shift(4,"i"),Y=se.read_shift(4,"i");for(var pe=-1,Se=0;Se<109&&(pe=se.read_shift(4,"i"),!(pe<0));++Se)oe[Se]=pe;var He=p(O,U);m(re,Y,He,U,oe);var ft=v(He,ae,oe,U);ft[ae].name="!Directory",W>0&&ue!==L&&(ft[ue].name="!MiniFAT"),ft[oe[0]].name="!FAT",ft.fat_addrs=oe,ft.ssz=U;var ht={},Rt=[],Sa=[],ka=[];C(ae,ft,He,Rt,W,ht,Sa,ue),h(Sa,ka,Rt),Rt.shift();var Ea={FileIndex:Sa,FullPaths:ka};return j&&j.raw&&(Ea.raw={header:we,sectors:He}),Ea}function d(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(M,"Header Signature: "),O.l+=16;var j=O.read_shift(2,"u");return[O.read_shift(2,"u"),j]}function f(O,j){var V=9;switch(O.l+=2,V=O.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function p(O,j){for(var V=Math.ceil(O.length/j)-1,U=[],W=1;W<V;++W)U[W-1]=O.slice(W*j,(W+1)*j);return U[V-1]=O.slice(V*j),U}function h(O,j,V){for(var U=0,W=0,Y=0,ae=0,ue=0,re=V.length,oe=[],se=[];U<re;++U)oe[U]=se[U]=U,j[U]=V[U];for(;ue<se.length;++ue)U=se[ue],W=O[U].L,Y=O[U].R,ae=O[U].C,oe[U]===U&&(W!==-1&&oe[W]!==W&&(oe[U]=oe[W]),Y!==-1&&oe[Y]!==Y&&(oe[U]=oe[Y])),ae!==-1&&(oe[ae]=U),W!==-1&&U!=oe[U]&&(oe[W]=oe[U],se.lastIndexOf(W)<ue&&se.push(W)),Y!==-1&&U!=oe[U]&&(oe[Y]=oe[U],se.lastIndexOf(Y)<ue&&se.push(Y));for(U=1;U<re;++U)oe[U]===U&&(Y!==-1&&oe[Y]!==Y?oe[U]=oe[Y]:W!==-1&&oe[W]!==W&&(oe[U]=oe[W]));for(U=1;U<re;++U)if(O[U].type!==0){if(ue=U,ue!=oe[ue])do ue=oe[ue],j[U]=j[ue]+"/"+j[U];while(ue!==0&&oe[ue]!==-1&&ue!=oe[ue]);oe[U]=-1}for(j[0]+="/",U=1;U<re;++U)O[U].type!==2&&(j[U]+="/")}function g(O,j,V){for(var U=O.start,W=O.size,Y=[],ae=U;V&&W>0&&ae>=0;)Y.push(j.slice(ae*D,ae*D+D)),W-=D,ae=kn(V,ae*4);return Y.length===0?St(0):sn(Y).slice(0,O.size)}function m(O,j,V,U,W){var Y=L;if(O===L){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var ae=V[O],ue=(U>>>2)-1;if(!ae)return;for(var re=0;re<ue&&(Y=kn(ae,re*4))!==L;++re)W.push(Y);m(kn(ae,U-4),j-1,V,U,W)}}function w(O,j,V,U,W){var Y=[],ae=[];W||(W=[]);var ue=U-1,re=0,oe=0;for(re=j;re>=0;){W[re]=!0,Y[Y.length]=re,ae.push(O[re]);var se=V[Math.floor(re*4/U)];if(oe=re*4&ue,U<4+oe)throw new Error("FAT boundary crossed: "+re+" 4 "+U);if(!O[se])break;re=kn(O[se],oe)}return{nodes:Y,data:Lc([ae])}}function v(O,j,V,U){var W=O.length,Y=[],ae=[],ue=[],re=[],oe=U-1,se=0,ge=0,we=0,Te=0;for(se=0;se<W;++se)if(ue=[],we=se+j,we>=W&&(we-=W),!ae[we]){re=[];var pe=[];for(ge=we;ge>=0;){pe[ge]=!0,ae[ge]=!0,ue[ue.length]=ge,re.push(O[ge]);var Se=V[Math.floor(ge*4/U)];if(Te=ge*4&oe,U<4+Te)throw new Error("FAT boundary crossed: "+ge+" 4 "+U);if(!O[Se]||(ge=kn(O[Se],Te),pe[ge]))break}Y[we]={nodes:ue,data:Lc([re])}}return Y}function C(O,j,V,U,W,Y,ae,ue){for(var re=0,oe=U.length?2:0,se=j[O].data,ge=0,we=0,Te;ge<se.length;ge+=128){var pe=se.slice(ge,ge+128);Pt(pe,64),we=pe.read_shift(2),Te=ai(pe,0,we-oe),U.push(Te);var Se={name:Te,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},He=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);He!==0&&(Se.ct=E(pe,pe.l-8));var ft=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);ft!==0&&(Se.mt=E(pe,pe.l-8)),Se.start=pe.read_shift(4,"i"),Se.size=pe.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=L,Se.name=""),Se.type===5?(re=Se.start,W>0&&re!==L&&(j[re].name="!StreamData")):Se.size>=4096?(Se.storage="fat",j[Se.start]===void 0&&(j[Se.start]=w(V,Se.start,j.fat_addrs,j.ssz)),j[Se.start].name=Se.name,Se.content=j[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:re!==L&&Se.start!==L&&j[re]&&(Se.content=g(Se,j[re].data,(j[ue]||{}).data))),Se.content&&Pt(Se.content,0),Y[Te]=Se,ae.push(Se)}}function E(O,j){return new Date((ar(O,j+4)/1e7*Math.pow(2,32)+ar(O,j)/1e7-11644473600)*1e3)}function R(O,j){return u(),c(i.readFileSync(O),j)}function S(O,j){var V=j&&j.type;switch(V||Xe&&Buffer.isBuffer(O)&&(V="buffer"),V||"base64"){case"file":return R(O,j);case"base64":return c(wr(sr(O)),j);case"binary":return c(wr(O),j)}return c(O,j)}function b(O,j){var V=j||{},U=V.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=U+"/",O.FileIndex[0]={name:U,type:5}),V.CLSID&&(O.FileIndex[0].clsid=V.CLSID),T(O)}function T(O){var j="Sh33tJ5";if(!Ye.find(O,"/"+j)){var V=St(4);V[0]=55,V[1]=V[3]=50,V[2]=54,O.FileIndex.push({name:j,type:2,content:V,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+j),A(O)}}function A(O,j){b(O);for(var V=!1,U=!1,W=O.FullPaths.length-1;W>=0;--W){var Y=O.FileIndex[W];switch(Y.type){case 0:U?V=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(Y.R*Y.L*Y.C)&&(V=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!j)){var ae=new Date(1987,1,19),ue=0,re=Object.create?Object.create(null):{},oe=[];for(W=0;W<O.FullPaths.length;++W)re[O.FullPaths[W]]=!0,O.FileIndex[W].type!==0&&oe.push([O.FullPaths[W],O.FileIndex[W]]);for(W=0;W<oe.length;++W){var se=n(oe[W][0]);U=re[se],U||(oe.push([se,{name:a(se).replace("/",""),type:1,clsid:B,ct:ae,mt:ae,content:null}]),re[se]=!0)}for(oe.sort(function(Te,pe){return r(Te[0],pe[0])}),O.FullPaths=[],O.FileIndex=[],W=0;W<oe.length;++W)O.FullPaths[W]=oe[W][0],O.FileIndex[W]=oe[W][1];for(W=0;W<oe.length;++W){var ge=O.FileIndex[W],we=O.FullPaths[W];if(ge.name=a(we).replace("/",""),ge.L=ge.R=ge.C=-(ge.color=1),ge.size=ge.content?ge.content.length:0,ge.start=0,ge.clsid=ge.clsid||B,W===0)ge.C=oe.length>1?1:-1,ge.size=0,ge.type=5;else if(we.slice(-1)=="/"){for(ue=W+1;ue<oe.length&&n(O.FullPaths[ue])!=we;++ue);for(ge.C=ue>=oe.length?-1:ue,ue=W+1;ue<oe.length&&n(O.FullPaths[ue])!=n(we);++ue);ge.R=ue>=oe.length?-1:ue,ge.type=1}else n(O.FullPaths[W+1]||"")==n(we)&&(ge.R=W+1),ge.type=2}}}function N(O,j){var V=j||{};if(V.fileType=="mad")return ba(O,V);switch(A(O),V.fileType){case"zip":return mo(O,V)}var U=function(Te){for(var pe=0,Se=0,He=0;He<Te.FileIndex.length;++He){var ft=Te.FileIndex[He];if(ft.content){var ht=ft.content.length;ht>0&&(ht<4096?pe+=ht+63>>6:Se+=ht+511>>9)}}for(var Rt=Te.FullPaths.length+3>>2,Sa=pe+7>>3,ka=pe+127>>7,Ea=Sa+Se+Rt+ka,Sn=Ea+127>>7,As=Sn<=109?0:Math.ceil((Sn-109)/127);Ea+Sn+As+127>>7>Sn;)As=++Sn<=109?0:Math.ceil((Sn-109)/127);var $r=[1,As,Sn,ka,Rt,Se,pe,0];return Te.FileIndex[0].size=pe<<6,$r[7]=(Te.FileIndex[0].start=$r[0]+$r[1]+$r[2]+$r[3]+$r[4]+$r[5])+($r[6]+7>>3),$r}(O),W=St(U[7]<<9),Y=0,ae=0;{for(Y=0;Y<8;++Y)W.write_shift(1,F[Y]);for(Y=0;Y<8;++Y)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),Y=0;Y<3;++Y)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,U[2]),W.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:L),W.write_shift(4,U[3]),W.write_shift(-4,U[1]?U[0]-1:L),W.write_shift(4,U[1]),Y=0;Y<109;++Y)W.write_shift(-4,Y<U[2]?U[1]+Y:-1)}if(U[1])for(ae=0;ae<U[1];++ae){for(;Y<236+ae*127;++Y)W.write_shift(-4,Y<U[2]?U[1]+Y:-1);W.write_shift(-4,ae===U[1]-1?L:ae+1)}var ue=function(Te){for(ae+=Te;Y<ae-1;++Y)W.write_shift(-4,Y+1);Te&&(++Y,W.write_shift(-4,L))};for(ae=Y=0,ae+=U[1];Y<ae;++Y)W.write_shift(-4,H.DIFSECT);for(ae+=U[2];Y<ae;++Y)W.write_shift(-4,H.FATSECT);ue(U[3]),ue(U[4]);for(var re=0,oe=0,se=O.FileIndex[0];re<O.FileIndex.length;++re)se=O.FileIndex[re],se.content&&(oe=se.content.length,!(oe<4096)&&(se.start=ae,ue(oe+511>>9)));for(ue(U[6]+7>>3);W.l&511;)W.write_shift(-4,H.ENDOFCHAIN);for(ae=Y=0,re=0;re<O.FileIndex.length;++re)se=O.FileIndex[re],se.content&&(oe=se.content.length,!(!oe||oe>=4096)&&(se.start=ae,ue(oe+63>>6)));for(;W.l&511;)W.write_shift(-4,H.ENDOFCHAIN);for(Y=0;Y<U[4]<<2;++Y){var ge=O.FullPaths[Y];if(!ge||ge.length===0){for(re=0;re<17;++re)W.write_shift(4,0);for(re=0;re<3;++re)W.write_shift(4,-1);for(re=0;re<12;++re)W.write_shift(4,0);continue}se=O.FileIndex[Y],Y===0&&(se.start=se.size?se.start-1:L);var we=Y===0&&V.root||se.name;if(oe=2*(we.length+1),W.write_shift(64,we,"utf16le"),W.write_shift(2,oe),W.write_shift(1,se.type),W.write_shift(1,se.color),W.write_shift(-4,se.L),W.write_shift(-4,se.R),W.write_shift(-4,se.C),se.clsid)W.write_shift(16,se.clsid,"hex");else for(re=0;re<4;++re)W.write_shift(4,0);W.write_shift(4,se.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,se.start),W.write_shift(4,se.size),W.write_shift(4,0)}for(Y=1;Y<O.FileIndex.length;++Y)if(se=O.FileIndex[Y],se.size>=4096)if(W.l=se.start+1<<9,Xe&&Buffer.isBuffer(se.content))se.content.copy(W,W.l,0,se.size),W.l+=se.size+511&-512;else{for(re=0;re<se.size;++re)W.write_shift(1,se.content[re]);for(;re&511;++re)W.write_shift(1,0)}for(Y=1;Y<O.FileIndex.length;++Y)if(se=O.FileIndex[Y],se.size>0&&se.size<4096)if(Xe&&Buffer.isBuffer(se.content))se.content.copy(W,W.l,0,se.size),W.l+=se.size+63&-64;else{for(re=0;re<se.size;++re)W.write_shift(1,se.content[re]);for(;re&63;++re)W.write_shift(1,0)}if(Xe)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function y(O,j){var V=O.FullPaths.map(function(re){return re.toUpperCase()}),U=V.map(function(re){var oe=re.split("/");return oe[oe.length-(re.slice(-1)=="/"?2:1)]}),W=!1;j.charCodeAt(0)===47?(W=!0,j=V[0].slice(0,-1)+j):W=j.indexOf("/")!==-1;var Y=j.toUpperCase(),ae=W===!0?V.indexOf(Y):U.indexOf(Y);if(ae!==-1)return O.FileIndex[ae];var ue=!Y.match(Ia);for(Y=Y.replace(Qt,""),ue&&(Y=Y.replace(Ia,"!")),ae=0;ae<V.length;++ae)if((ue?V[ae].replace(Ia,"!"):V[ae]).replace(Qt,"")==Y||(ue?U[ae].replace(Ia,"!"):U[ae]).replace(Qt,"")==Y)return O.FileIndex[ae];return null}var D=64,L=-2,M="d0cf11e0a1b11ae1",F=[208,207,17,224,161,177,26,225],B="00000000000000000000000000000000",H={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:B,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function G(O,j,V){u();var U=N(O,V);i.writeFileSync(j,U)}function _(O){for(var j=new Array(O.length),V=0;V<O.length;++V)j[V]=String.fromCharCode(O[V]);return j.join("")}function Z(O,j){var V=N(O,j);switch(j&&j.type||"buffer"){case"file":return u(),i.writeFileSync(j.filename,V),V;case"binary":return typeof V=="string"?V:_(V);case"base64":return vc(typeof V=="string"?V:_(V));case"buffer":if(Xe)return Buffer.isBuffer(V)?V:$n(V);case"array":return typeof V=="string"?wr(V):V}return V}var ee;function P(O){try{var j=O.InflateRaw,V=new j;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)ee=O;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function q(O,j){if(!ee)return Qr(O,j);var V=ee.InflateRaw,U=new V,W=U._processChunk(O.slice(O.l),U._finishFlushFlag);return O.l+=U.bytesRead,W}function K(O){return ee?ee.deflateRawSync(O):Re(O)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(O){var j=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(j>>16|j>>8|j)&255}for(var de=typeof Uint8Array<"u",ie=de?new Uint8Array(256):[],xe=0;xe<256;++xe)ie[xe]=fe(xe);function z(O,j){var V=ie[O&255];return j<=8?V>>>8-j:(V=V<<8|ie[O>>8&255],j<=16?V>>>16-j:(V=V<<8|ie[O>>16&255],V>>>24-j))}function Pe(O,j){var V=j&7,U=j>>>3;return(O[U]|(V<=6?0:O[U+1]<<8))>>>V&3}function _e(O,j){var V=j&7,U=j>>>3;return(O[U]|(V<=5?0:O[U+1]<<8))>>>V&7}function Ie(O,j){var V=j&7,U=j>>>3;return(O[U]|(V<=4?0:O[U+1]<<8))>>>V&15}function ce(O,j){var V=j&7,U=j>>>3;return(O[U]|(V<=3?0:O[U+1]<<8))>>>V&31}function ne(O,j){var V=j&7,U=j>>>3;return(O[U]|(V<=1?0:O[U+1]<<8))>>>V&127}function be(O,j,V){var U=j&7,W=j>>>3,Y=(1<<V)-1,ae=O[W]>>>U;return V<8-U||(ae|=O[W+1]<<8-U,V<16-U)||(ae|=O[W+2]<<16-U,V<24-U)||(ae|=O[W+3]<<24-U),ae&Y}function Ae(O,j,V){var U=j&7,W=j>>>3;return U<=5?O[W]|=(V&7)<<U:(O[W]|=V<<U&255,O[W+1]=(V&7)>>8-U),j+3}function Me(O,j,V){var U=j&7,W=j>>>3;return V=(V&1)<<U,O[W]|=V,j+1}function Oe(O,j,V){var U=j&7,W=j>>>3;return V<<=U,O[W]|=V&255,V>>>=8,O[W+1]=V,j+8}function ye(O,j,V){var U=j&7,W=j>>>3;return V<<=U,O[W]|=V&255,V>>>=8,O[W+1]=V&255,O[W+2]=V>>>8,j+16}function he(O,j){var V=O.length,U=2*V>j?2*V:j+5,W=0;if(V>=j)return O;if(Xe){var Y=wc(U);if(O.copy)O.copy(Y);else for(;W<O.length;++W)Y[W]=O[W];return Y}else if(de){var ae=new Uint8Array(U);if(ae.set)ae.set(O);else for(;W<V;++W)ae[W]=O[W];return ae}return O.length=U,O}function ve(O){for(var j=new Array(O),V=0;V<O;++V)j[V]=0;return j}function Ee(O,j,V){var U=1,W=0,Y=0,ae=0,ue=0,re=O.length,oe=de?new Uint16Array(32):ve(32);for(Y=0;Y<32;++Y)oe[Y]=0;for(Y=re;Y<V;++Y)O[Y]=0;re=O.length;var se=de?new Uint16Array(re):ve(re);for(Y=0;Y<re;++Y)oe[W=O[Y]]++,U<W&&(U=W),se[Y]=0;for(oe[0]=0,Y=1;Y<=U;++Y)oe[Y+16]=ue=ue+oe[Y-1]<<1;for(Y=0;Y<re;++Y)ue=O[Y],ue!=0&&(se[Y]=oe[ue+16]++);var ge=0;for(Y=0;Y<re;++Y)if(ge=O[Y],ge!=0)for(ue=z(se[Y],U)>>U-ge,ae=(1<<U+4-ge)-1;ae>=0;--ae)j[ue|ae<<ge]=ge&15|Y<<4;return U}var Ne=de?new Uint16Array(512):ve(512),Je=de?new Uint16Array(32):ve(32);if(!de){for(var rt=0;rt<512;++rt)Ne[rt]=0;for(rt=0;rt<32;++rt)Je[rt]=0}(function(){for(var O=[],j=0;j<32;j++)O.push(5);Ee(O,Je,32);var V=[];for(j=0;j<=143;j++)V.push(8);for(;j<=255;j++)V.push(9);for(;j<=279;j++)V.push(7);for(;j<=287;j++)V.push(8);Ee(V,Ne,288)})();var ut=function(){for(var j=de?new Uint8Array(32768):[],V=0,U=0;V<le.length-1;++V)for(;U<le[V+1];++U)j[U]=V;for(;U<32768;++U)j[U]=29;var W=de?new Uint8Array(259):[];for(V=0,U=0;V<te.length-1;++V)for(;U<te[V+1];++U)W[U]=V;function Y(ue,re){for(var oe=0;oe<ue.length;){var se=Math.min(65535,ue.length-oe),ge=oe+se==ue.length;for(re.write_shift(1,+ge),re.write_shift(2,se),re.write_shift(2,~se&65535);se-- >0;)re[re.l++]=ue[oe++]}return re.l}function ae(ue,re){for(var oe=0,se=0,ge=de?new Uint16Array(32768):[];se<ue.length;){var we=Math.min(65535,ue.length-se);if(we<10){for(oe=Ae(re,oe,+(se+we==ue.length)),oe&7&&(oe+=8-(oe&7)),re.l=oe/8|0,re.write_shift(2,we),re.write_shift(2,~we&65535);we-- >0;)re[re.l++]=ue[se++];oe=re.l*8;continue}oe=Ae(re,oe,+(se+we==ue.length)+2);for(var Te=0;we-- >0;){var pe=ue[se];Te=(Te<<5^pe)&32767;var Se=-1,He=0;if((Se=ge[Te])&&(Se|=se&-32768,Se>se&&(Se-=32768),Se<se))for(;ue[Se+He]==ue[se+He]&&He<250;)++He;if(He>2){pe=W[He],pe<=22?oe=Oe(re,oe,ie[pe+1]>>1)-1:(Oe(re,oe,3),oe+=5,Oe(re,oe,ie[pe-23]>>5),oe+=3);var ft=pe<8?0:pe-4>>2;ft>0&&(ye(re,oe,He-te[pe]),oe+=ft),pe=j[se-Se],oe=Oe(re,oe,ie[pe]>>3),oe-=3;var ht=pe<4?0:pe-2>>1;ht>0&&(ye(re,oe,se-Se-le[pe]),oe+=ht);for(var Rt=0;Rt<He;++Rt)ge[Te]=se&32767,Te=(Te<<5^ue[se])&32767,++se;we-=He-1}else pe<=143?pe=pe+48:oe=Me(re,oe,1),oe=Oe(re,oe,ie[pe]),ge[Te]=se&32767,++se}oe=Oe(re,oe,0)-1}return re.l=(oe+7)/8|0,re.l}return function(re,oe){return re.length<8?Y(re,oe):ae(re,oe)}}();function Re(O){var j=St(50+Math.floor(O.length*1.1)),V=ut(O,j);return j.slice(0,V)}var lt=de?new Uint16Array(32768):ve(32768),nt=de?new Uint16Array(32768):ve(32768),Ke=de?new Uint16Array(128):ve(128),jt=1,Ir=1;function Wn(O,j){var V=ce(O,j)+257;j+=5;var U=ce(O,j)+1;j+=5;var W=Ie(O,j)+4;j+=4;for(var Y=0,ae=de?new Uint8Array(19):ve(19),ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,oe=de?new Uint8Array(8):ve(8),se=de?new Uint8Array(8):ve(8),ge=ae.length,we=0;we<W;++we)ae[X[we]]=Y=_e(O,j),re<Y&&(re=Y),oe[Y]++,j+=3;var Te=0;for(oe[0]=0,we=1;we<=re;++we)se[we]=Te=Te+oe[we-1]<<1;for(we=0;we<ge;++we)(Te=ae[we])!=0&&(ue[we]=se[Te]++);var pe=0;for(we=0;we<ge;++we)if(pe=ae[we],pe!=0){Te=ie[ue[we]]>>8-pe;for(var Se=(1<<7-pe)-1;Se>=0;--Se)Ke[Te|Se<<pe]=pe&7|we<<3}var He=[];for(re=1;He.length<V+U;)switch(Te=Ke[ne(O,j)],j+=Te&7,Te>>>=3){case 16:for(Y=3+Pe(O,j),j+=2,Te=He[He.length-1];Y-- >0;)He.push(Te);break;case 17:for(Y=3+_e(O,j),j+=3;Y-- >0;)He.push(0);break;case 18:for(Y=11+ne(O,j),j+=7;Y-- >0;)He.push(0);break;default:He.push(Te),re<Te&&(re=Te);break}var ft=He.slice(0,V),ht=He.slice(V);for(we=V;we<286;++we)ft[we]=0;for(we=U;we<30;++we)ht[we]=0;return jt=Ee(ft,lt,286),Ir=Ee(ht,nt,30),j}function Kn(O,j){if(O[0]==3&&!(O[1]&3))return[pn(j),2];for(var V=0,U=0,W=wc(j||1<<18),Y=0,ae=W.length>>>0,ue=0,re=0;!(U&1);){if(U=_e(O,V),V+=3,U>>>1)U>>1==1?(ue=9,re=5):(V=Wn(O,V),ue=jt,re=Ir);else{V&7&&(V+=8-(V&7));var oe=O[V>>>3]|O[(V>>>3)+1]<<8;if(V+=32,oe>0)for(!j&&ae<Y+oe&&(W=he(W,Y+oe),ae=W.length);oe-- >0;)W[Y++]=O[V>>>3],V+=8;continue}for(;;){!j&&ae<Y+32767&&(W=he(W,Y+32767),ae=W.length);var se=be(O,V,ue),ge=U>>>1==1?Ne[se]:lt[se];if(V+=ge&15,ge>>>=4,!(ge>>>8&255))W[Y++]=ge;else{if(ge==256)break;ge-=257;var we=ge<8?0:ge-4>>2;we>5&&(we=0);var Te=Y+te[ge];we>0&&(Te+=be(O,V,we),V+=we),se=be(O,V,re),ge=U>>>1==1?Je[se]:nt[se],V+=ge&15,ge>>>=4;var pe=ge<4?0:ge-2>>1,Se=le[ge];for(pe>0&&(Se+=be(O,V,pe),V+=pe),!j&&ae<Te&&(W=he(W,Te+100),ae=W.length);Y<Te;)W[Y]=W[Y-Se],++Y}}}return j?[W,V+7>>>3]:[W.slice(0,Y),V+7>>>3]}function Qr(O,j){var V=O.slice(O.l||0),U=Kn(V,j);return O.l+=U[1],U[0]}function po(O,j){if(O)typeof console<"u"&&console.error(j);else throw new Error(j)}function ys(O,j){var V=O;Pt(V,0);var U=[],W=[],Y={FileIndex:U,FullPaths:W};b(Y,{root:j.root});for(var ae=V.length-4;(V[ae]!=80||V[ae+1]!=75||V[ae+2]!=5||V[ae+3]!=6)&&ae>=0;)--ae;V.l=ae+4,V.l+=4;var ue=V.read_shift(2);V.l+=6;var re=V.read_shift(4);for(V.l=re,ae=0;ae<ue;++ae){V.l+=20;var oe=V.read_shift(4),se=V.read_shift(4),ge=V.read_shift(2),we=V.read_shift(2),Te=V.read_shift(2);V.l+=8;var pe=V.read_shift(4),Se=l(V.slice(V.l+ge,V.l+ge+we));V.l+=ge+we+Te;var He=V.l;V.l=pe+4,xo(V,oe,se,Y,Se),V.l=He}return Y}function xo(O,j,V,U,W){O.l+=2;var Y=O.read_shift(2),ae=O.read_shift(2),ue=s(O);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var re=O.read_shift(4),oe=O.read_shift(4),se=O.read_shift(4),ge=O.read_shift(2),we=O.read_shift(2),Te="",pe=0;pe<ge;++pe)Te+=String.fromCharCode(O[O.l++]);if(we){var Se=l(O.slice(O.l,O.l+we));(Se[21589]||{}).mt&&(ue=Se[21589].mt),((W||{})[21589]||{}).mt&&(ue=W[21589].mt)}O.l+=we;var He=O.slice(O.l,O.l+oe);switch(ae){case 8:He=q(O,se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var ft=!1;Y&8&&(re=O.read_shift(4),re==134695760&&(re=O.read_shift(4),ft=!0),oe=O.read_shift(4),se=O.read_shift(4)),oe!=j&&po(ft,"Bad compressed size: "+j+" != "+oe),se!=V&&po(ft,"Bad uncompressed size: "+V+" != "+se),Xn(U,Te,He,{unsafe:!0,mt:ue})}function mo(O,j){var V=j||{},U=[],W=[],Y=St(1),ae=V.compression?8:0,ue=0,re=0,oe=0,se=0,ge=0,we=O.FullPaths[0],Te=we,pe=O.FileIndex[0],Se=[],He=0;for(re=1;re<O.FullPaths.length;++re)if(Te=O.FullPaths[re].slice(we.length),pe=O.FileIndex[re],!(!pe.size||!pe.content||Te=="Sh33tJ5")){var ft=se,ht=St(Te.length);for(oe=0;oe<Te.length;++oe)ht.write_shift(1,Te.charCodeAt(oe)&127);ht=ht.slice(0,ht.l),Se[ge]=vb.buf(pe.content,0);var Rt=pe.content;ae==8&&(Rt=K(Rt)),Y=St(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,ue),Y.write_shift(2,ae),pe.mt?o(Y,pe.mt):Y.write_shift(4,0),Y.write_shift(-4,Se[ge]),Y.write_shift(4,Rt.length),Y.write_shift(4,pe.content.length),Y.write_shift(2,ht.length),Y.write_shift(2,0),se+=Y.length,U.push(Y),se+=ht.length,U.push(ht),se+=Rt.length,U.push(Rt),Y=St(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,ue),Y.write_shift(2,ae),Y.write_shift(4,0),Y.write_shift(-4,Se[ge]),Y.write_shift(4,Rt.length),Y.write_shift(4,pe.content.length),Y.write_shift(2,ht.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,ft),He+=Y.l,W.push(Y),He+=ht.length,W.push(ht),++ge}return Y=St(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,ge),Y.write_shift(2,ge),Y.write_shift(4,He),Y.write_shift(4,se),Y.write_shift(2,0),sn([sn(U),sn(W),Y])}var bn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function bt(O,j){if(O.ctype)return O.ctype;var V=O.name||"",U=V.match(/\.([^\.]+)$/);return U&&bn[U[1]]||j&&(U=(V=j).match(/[\.\\]([^\.\\])+$/),U&&bn[U[1]])?bn[U[1]]:"application/octet-stream"}function gt(O){for(var j=vc(O),V=[],U=0;U<j.length;U+=76)V.push(j.slice(U,U+76));return V.join(`\r
`)+`\r
`}function vo(O){var j=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var se=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(se.length==1?"0"+se:se)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],U=j.split(`\r
`),W=0;W<U.length;++W){var Y=U[W];if(Y.length==0){V.push("");continue}for(var ae=0;ae<Y.length;){var ue=76,re=Y.slice(ae,ae+ue);re.charAt(ue-1)=="="?ue--:re.charAt(ue-2)=="="?ue-=2:re.charAt(ue-3)=="="&&(ue-=3),re=Y.slice(ae,ae+ue),ae+=ue,ae<Y.length&&(re+="="),V.push(re)}}return V.join(`\r
`)}function _s(O){for(var j=[],V=0;V<O.length;++V){for(var U=O[V];V<=O.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+O[++V];j.push(U)}for(var W=0;W<j.length;++W)j[W]=j[W].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return wr(j.join(`\r
`))}function Fs(O,j,V){for(var U="",W="",Y="",ae,ue=0;ue<10;++ue){var re=j[ue];if(!re||re.match(/^\s*$/))break;var oe=re.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":U=oe[2].trim();break;case"content-type":Y=oe[2].trim();break;case"content-transfer-encoding":W=oe[2].trim();break}}switch(++ue,W.toLowerCase()){case"base64":ae=wr(sr(j.slice(ue).join("")));break;case"quoted-printable":ae=_s(j.slice(ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var se=Xn(O,U.slice(V.length),ae,{unsafe:!0});Y&&(se.ctype=Y)}function Is(O,j){if(_(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=j&&j.root||"",U=(Xe&&Buffer.isBuffer(O)?O.toString("binary"):_(O)).split(`\r
`),W=0,Y="";for(W=0;W<U.length;++W)if(Y=U[W],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),V||(V=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),Y.slice(0,V.length)!=V););var ae=(U[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var ue="--"+(ae[1]||""),re=[],oe=[],se={FileIndex:re,FullPaths:oe};b(se);var ge,we=0;for(W=0;W<U.length;++W){var Te=U[W];Te!==ue&&Te!==ue+"--"||(we++&&Fs(se,U.slice(ge,W),V),ge=W)}return se}function ba(O,j){var V=j||{},U=V.boundary||"SheetJS";U="------="+U;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],Y=O.FullPaths[0],ae=Y,ue=O.FileIndex[0],re=1;re<O.FullPaths.length;++re)if(ae=O.FullPaths[re].slice(Y.length),ue=O.FileIndex[re],!(!ue.size||!ue.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var oe=ue.content,se=Xe&&Buffer.isBuffer(oe)?oe.toString("binary"):_(oe),ge=0,we=Math.min(1024,se.length),Te=0,pe=0;pe<=we;++pe)(Te=se.charCodeAt(pe))>=32&&Te<128&&++ge;var Se=ge>=we*4/5;W.push(U),W.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+ae),W.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),W.push("Content-Type: "+bt(ue,ae)),W.push(""),W.push(Se?vo(se):gt(se))}return W.push(U+`--\r
`),W.join(`\r
`)}function wo(O){var j={};return b(j,O),j}function Xn(O,j,V,U){var W=U&&U.unsafe;W||b(O);var Y=!W&&Ye.find(O,j);if(!Y){var ae=O.FullPaths[0];j.slice(0,ae.length)==ae?ae=j:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+j).replace("//","/")),Y={name:a(j),type:2},O.FileIndex.push(Y),O.FullPaths.push(ae),W||Ye.utils.cfb_gc(O)}return Y.content=V,Y.size=V?V.length:0,U&&(U.CLSID&&(Y.clsid=U.CLSID),U.mt&&(Y.mt=U.mt),U.ct&&(Y.ct=U.ct)),Y}function Ps(O,j){b(O);var V=Ye.find(O,j);if(V){for(var U=0;U<O.FileIndex.length;++U)if(O.FileIndex[U]==V)return O.FileIndex.splice(U,1),O.FullPaths.splice(U,1),!0}return!1}function Co(O,j,V){b(O);var U=Ye.find(O,j);if(U){for(var W=0;W<O.FileIndex.length;++W)if(O.FileIndex[W]==U)return O.FileIndex[W].name=a(V),O.FullPaths[W]=V,!0}return!1}function bo(O){A(O,!0)}return t.find=y,t.read=S,t.parse=c,t.write=Z,t.writeFile=G,t.utils={cfb_new:wo,cfb_add:Xn,cfb_del:Ps,cfb_mov:Co,cfb_gc:bo,ReadShift:Oa,CheckField:Ed,prep_blob:Pt,bconcat:sn,use_zlib:P,_deflateRaw:Re,_inflateRaw:Qr,consts:H},t}();function wb(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Lr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ei(e){for(var t=[],r=Lr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Qo=new Date(1899,11,30,0,0,0);function Jt(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Qo.getTime()+(e.getTimezoneOffset()-Qo.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var rd=new Date,Cb=Qo.getTime()+(rd.getTimezoneOffset()-Qo.getTimezoneOffset())*6e4,_c=rd.getTimezoneOffset();function Ss(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Cb),t.getTimezoneOffset()!==_c&&t.setTime(t.getTime()+(t.getTimezoneOffset()-_c)*6e4),t}function bb(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[o],10)}return t}var Fc=new Date("2017-02-19T19:06:09.000Z"),nd=isNaN(Fc.getFullYear())?new Date("2/19/17"):Fc,Sb=nd.getFullYear()==2017;function _t(e,t){var r=new Date(e);if(Sb)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(nd.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function On(e,t){if(Xe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Aa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Aa(U0(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Aa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Aa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Dt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Dt(e[r]));return t}function pt(e,t){for(var r="";r.length<t;)r+=e;return r}function yr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(t=Number(n)))?t/r:t}var kb=["january","february","march","april","may","june","july","august","september","october","november","december"];function ha(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&kb.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Eb=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var o=r.split(n),s=[o[0]],l=1;l<o.length;++l)s.push(a),s.push(o[l]);return s}}();function ad(e){return e?e.content&&e.type?On(e.content,!0):e.data?Fa(e.data):e.asNodeBuffer&&Xe?Fa(e.asNodeBuffer().toString("binary")):e.asBinary?Fa(e.asBinary()):e._data&&e._data.getContent?Fa(On(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function od(e){if(!e)return null;if(e.data)return xc(e.data);if(e.asNodeBuffer&&Xe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?xc(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Tb(e){return e&&e.name.slice(-4)===".bin"?od(e):ad(e)}function cr(e,t){for(var r=e.FullPaths||Lr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var s=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function ti(e,t){var r=cr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function wt(e,t,r){if(!r)return Tb(ti(e,t));if(!t)return null;try{return wt(e,t)}catch{return null}}function or(e,t,r){if(!r)return ad(ti(e,t));if(!t)return null;try{return or(e,t)}catch{return null}}function sd(e,t,r){if(!r)return od(ti(e,t));if(!t)return null;try{return sd(e,t)}catch{return null}}function Ic(e){for(var t=e.FullPaths||Lr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function yb(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Xe?n=$n(r):n=W2(r),Ye.utils.cfb_add(e,t,n)}Ye.utils.cfb_add(e,t,r)}else e.file(t,r)}function ld(e,t){switch(t.type){case"base64":return Ye.read(e,{type:"base64"});case"binary":return Ye.read(e,{type:"binary"});case"buffer":case"array":return Ye.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Pa(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var id=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_b=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Pc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Fb=/<[^>]*>/g,zt=id.match(Pc)?Pc:Fb,Ib=/<\w*:/,Pb=/<(\/?)\w+:/;function De(e,t,r){for(var n={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(_b),l=0,i="",u=0,c="",d="",f=1;if(s)for(u=0;u!=s.length;++u){for(d=s[u],o=0;o!=d.length&&d.charCodeAt(o)!==61;++o);for(c=d.slice(0,o).trim();d.charCodeAt(o+1)==32;)++o;for(f=(a=d.charCodeAt(o+1))==34||a==39?1:0,i=d.slice(o+1+f,d.length-f),l=0;l!=c.length&&c.charCodeAt(l)!==58;++l);if(l===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),n[c]=i,r||(n[c.toLowerCase()]=i);else{var p=(l===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(l+1);if(n[p]&&c.slice(l-3,l)=="ext")continue;n[p]=i,r||(n[p.toLowerCase()]=i)}}return n}function Br(e){return e.replace(Pb,"<$1")}var cd={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ab=ei(cd),Ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(l,i){return cd[l]||String.fromCharCode(parseInt(i,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,i){return String.fromCharCode(parseInt(i,16))});var s=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,s)+r(a.slice(s+3))}}(),Mb=/[&<>'"]/g,Db=/[\u0000-\u001f]/g;function ri(e){var t=e+"";return t.replace(Mb,function(r){return Ab[r]}).replace(/\n/g,"<br/>").replace(Db,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Ac=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function dt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Hs(e){for(var t="",r=0,n=0,a=0,o=0,s=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(o=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}s=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Mc(e){var t=pn(2*e.length),r,n,a=1,o=0,s=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[o++]=s&255,t[o++]=s>>>8,s=0),t[o++]=r%256,t[o++]=r>>>8;return t.slice(0,o).toString("ucs2")}function Dc(e){return $n(e,"binary").toString("utf8")}var Eo="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",st=Xe&&(Dc(Eo)==Hs(Eo)&&Dc||Mc(Eo)==Hs(Eo)&&Mc)||Hs,Aa=Xe?function(e){return $n(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Xa=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),ud=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Ob=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Rb=/<\/?(?:vt:)?variant>/g,Lb=/<(?:vt:)([^>]*)>([\s\S]*)</;function Oc(e,t){var r=De(e),n=e.match(Ob(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var s=o.replace(Rb,"").match(Lb);s&&a.push({v:st(s[2]),t:s[1]})}),a}var Nb=/(^\s|\s$|\n)/;function Bb(e){return Lr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Hb(e,t,r){return"<"+e+(r!=null?Bb(r):"")+(t!=null?(t.match(Nb)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ni(e){if(Xe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return st(Vn(Zl(e)));throw new Error("Bad input format: expected Buffer or string")}var Ya=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,$b={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Vb=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Gb(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,o=5;o>=0;--o)a=a*256+e[t+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Ub(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,o=0,s=n?-t:t;isFinite(s)?s==0?a=o=0:(a=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(t)?26985:0);for(var l=0;l<=5;++l,o/=256)e[r+l]=o&255;e[r+6]=(a&15)<<4|o&15,e[r+7]=a>>4|n}var Rc=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,o=e[0][n].length;a<o;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Lc=Xe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:$n(t)})):Rc(e)}:Rc,Nc=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ur(e,a)));return n.join("").replace(Qt,"")},ai=Xe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Qt,""):Nc(e,t,r)}:Nc,Bc=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},dd=Xe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Bc(e,t,r)}:Bc,Hc=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ra(e,a)));return n.join("")},io=Xe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Hc(t,r,n)}:Hc,fd=function(e,t){var r=ar(e,t);return r>0?io(e,t+4,t+4+r-1):""},hd=fd,gd=function(e,t){var r=ar(e,t);return r>0?io(e,t+4,t+4+r-1):""},pd=gd,xd=function(e,t){var r=2*ar(e,t);return r>0?io(e,t+4,t+4+r-1):""},md=xd,vd=function(t,r){var n=ar(t,r);return n>0?ai(t,r+4,r+4+n):""},wd=vd,Cd=function(e,t){var r=ar(e,t);return r>0?io(e,t+4,t+4+r):""},bd=Cd,Sd=function(e,t){return Gb(e,t)},Jo=Sd,kd=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Xe&&(hd=function(t,r){if(!Buffer.isBuffer(t))return fd(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},pd=function(t,r){if(!Buffer.isBuffer(t))return gd(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},md=function(t,r){if(!Buffer.isBuffer(t))return xd(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},wd=function(t,r){if(!Buffer.isBuffer(t))return vd(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},bd=function(t,r){if(!Buffer.isBuffer(t))return Cd(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Jo=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Sd(t,r)},kd=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ra=function(e,t){return e[t]},Ur=function(e,t){return e[t+1]*256+e[t]},zb=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ar=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},kn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},jb=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Oa(e,t){var r="",n,a,o=[],s,l,i,u;switch(t){case"dbcs":if(u=this.l,Xe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)r+=String.fromCharCode(Ur(this,u)),u+=2;e*=2;break;case"utf8":r=io(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ai(this,this.l,this.l+e);break;case"wstr":return Oa.call(this,e,"dbcs");case"lpstr-ansi":r=hd(this,this.l),e=4+ar(this,this.l);break;case"lpstr-cp":r=pd(this,this.l),e=4+ar(this,this.l);break;case"lpwstr":r=md(this,this.l),e=4+2*ar(this,this.l);break;case"lpp4":e=4+ar(this,this.l),r=wd(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ar(this,this.l),r=bd(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=ra(this,this.l+e++))!==0;)o.push(ko(s));r=o.join("");break;case"_wstr":for(e=0,r="";(s=Ur(this,this.l+e))!==0;)o.push(ko(s)),e+=2;e+=2,r=o.join("");break;case"dbcs-cont":for(r="",u=this.l,i=0;i<e;++i){if(this.lens&&this.lens.indexOf(u)!==-1)return s=ra(this,u),this.l=u+1,l=Oa.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(ko(Ur(this,u))),u+=2}r=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,i=0;i!=e;++i){if(this.lens&&this.lens.indexOf(u)!==-1)return s=ra(this,u),this.l=u+1,l=Oa.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(ko(ra(this,u))),u+=1}r=o.join("");break;default:switch(e){case 1:return n=ra(this,this.l),this.l++,n;case 2:return n=(t==="i"?zb:Ur)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?kn:jb)(this,this.l),this.l+=4,n):(a=ar(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Jo(this,this.l):a=Jo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=dd(this,this.l,e);break}}return this.l+=e,r}var Wb=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Kb=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Xb=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Yb(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)Xb(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Wb(this,t,this.l);break;case 8:if(n=8,r==="f"){Ub(this,t,this.l);break}case 16:break;case-4:n=4,Kb(this,t,this.l);break}return this.l+=n,this}function Ed(e,t){var r=dd(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Pt(e,t){e.l=t,e.read_shift=Oa,e.chk=Ed,e.write_shift=Yb}function Gt(e,t){e.l+=t}function St(e){var t=pn(e);return Pt(t,0),t}function Zr(e,t,r){if(e){var n,a,o;Pt(e,e.l||0);for(var s=e.length,l=0,i=0;e.l<s;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=os[l]||os[65535];for(n=e.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=e.read_shift(1))&127)<<7*a;i=e.l+o;var c=u.f&&u.f(e,o,r);if(e.l=i,t(c,u,l))return}}}function sl(){var e=[],t=Xe?256:2048,r=function(u){var c=St(u);return Pt(c,0),c},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},o=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),sn(e)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),o(t)};return{next:o,push:l,end:s,_bufs:e}}function Ra(e,t,r){var n=Dt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function $c(e,t,r){var n=Dt(e);return n.s=Ra(n.s,t.s,r),n.e=Ra(n.e,t.s,r),n}function La(e,t){if(e.cRel&&e.c<0)for(e=Dt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Dt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Be(e);return!e.cRel&&e.cRel!=null&&(r=Qb(r)),!e.rRel&&e.rRel!=null&&(r=qb(r)),r}function $s(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Et(e.s.c)+":"+(e.e.cRel?"":"$")+Et(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ot(e.s.r)+":"+(e.e.rRel?"":"$")+Ot(e.e.r):La(e.s,t.biff)+":"+La(e.e,t.biff)}function oi(e){return parseInt(Zb(e),10)-1}function Ot(e){return""+(e+1)}function qb(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Zb(e){return e.replace(/\$(\d+)$/,"$1")}function si(e){for(var t=Jb(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Et(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Qb(e){return e.replace(/^([A-Z])/,"$$$1")}function Jb(e){return e.replace(/^\$([A-Z])/,"$1")}function eS(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Zt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function wa(e){var t=e.indexOf(":");return t==-1?{s:Zt(e),e:Zt(e)}:{s:Zt(e.slice(0,t)),e:Zt(e.slice(t+1))}}function qe(e,t){return typeof t>"u"||typeof t=="number"?qe(e.s,e.e):(typeof e!="string"&&(e=Be(e)),typeof t!="string"&&(t=Be(t)),e==t?e:e+":"+t)}function xt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=e.length;for(r=0;n<o&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<o&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===o||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=o&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=o&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Vc(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=hr(e.z,r?Jt(t):t)}catch{}try{return e.w=hr((e.XF||{}).numFmtId||(r?14:0),r?Jt(t):t)}catch{return""+t}}function Xr(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zn[e.v]||e.v:t==null?Vc(e,e.v):Vc(e,t))}function Cn(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Td(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,o=e||(a?[]:{}),s=0,l=0;if(o&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Zt(n.origin):n.origin;s=i.r,l=i.c}o["!ref"]||(o["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var c=xt(o["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),s==-1&&(u.e.r=s=c.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[d].length;++f)if(!(typeof t[d][f]>"u")){var p={v:t[d][f]},h=s+d,g=l+f;if(u.s.r>h&&(u.s.r=h),u.s.c>g&&(u.s.c=g),u.e.r<h&&(u.e.r=h),u.e.c<g&&(u.e.c=g),t[d][f]&&typeof t[d][f]=="object"&&!Array.isArray(t[d][f])&&!(t[d][f]instanceof Date))p=t[d][f];else if(Array.isArray(p.v)&&(p.f=t[d][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Ge[14],n.cellDates?(p.t="d",p.w=hr(p.z,Jt(p.v))):(p.t="n",p.v=Jt(p.v),p.w=hr(p.z,p.v))):p.t="s";if(a)o[h]||(o[h]=[]),o[h][g]&&o[h][g].z&&(p.z=o[h][g].z),o[h][g]=p;else{var m=Be({c:g,r:h});o[m]&&o[m].z&&(p.z=o[m].z),o[m]=p}}}return u.s.c<1e7&&(o["!ref"]=qe(u)),o}function Ca(e,t){return Td(null,e,t)}function tS(e){return e.read_shift(4,"i")}function Vt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function rS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function li(e,t){var r=e.l,n=e.read_shift(1),a=Vt(e),o=[],s={t:a,h:a};if(n&1){for(var l=e.read_shift(4),i=0;i!=l;++i)o.push(rS(e));s.r=o}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var nS=li;function gr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Gn(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var aS=Vt;function ii(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var oS=Vt,ll=ii;function ci(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Jo([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):kn(t,0)>>2;return r?a/100:a}function yd(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Un=yd;function Ht(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function sS(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),i=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Pn[a];u&&(t.rgb=Za(u));break;case 2:t.rgb=Za([s,l,i]);break;case 3:t.theme=a;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function lS(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function _d(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function iS(e){return _d(e,1)}function cS(e){return _d(e,2)}var ui=2,tr=3,To=11,Gc=12,es=19,yo=64,uS=65,dS=71,fS=4108,hS=4126,yt=80,Fd=81,gS=[yt,Fd],pS={1:{n:"CodePage",t:ui},2:{n:"Category",t:yt},3:{n:"PresentationFormat",t:yt},4:{n:"ByteCount",t:tr},5:{n:"LineCount",t:tr},6:{n:"ParagraphCount",t:tr},7:{n:"SlideCount",t:tr},8:{n:"NoteCount",t:tr},9:{n:"HiddenCount",t:tr},10:{n:"MultimediaClipCount",t:tr},11:{n:"ScaleCrop",t:To},12:{n:"HeadingPairs",t:fS},13:{n:"TitlesOfParts",t:hS},14:{n:"Manager",t:yt},15:{n:"Company",t:yt},16:{n:"LinksUpToDate",t:To},17:{n:"CharacterCount",t:tr},19:{n:"SharedDoc",t:To},22:{n:"HyperlinksChanged",t:To},23:{n:"AppVersion",t:tr,p:"version"},24:{n:"DigSig",t:uS},26:{n:"ContentType",t:yt},27:{n:"ContentStatus",t:yt},28:{n:"Language",t:yt},29:{n:"Version",t:yt},255:{},2147483648:{n:"Locale",t:es},2147483651:{n:"Behavior",t:es},1919054434:{}},xS={1:{n:"CodePage",t:ui},2:{n:"Title",t:yt},3:{n:"Subject",t:yt},4:{n:"Author",t:yt},5:{n:"Keywords",t:yt},6:{n:"Comments",t:yt},7:{n:"Template",t:yt},8:{n:"LastAuthor",t:yt},9:{n:"RevNumber",t:yt},10:{n:"EditTime",t:yo},11:{n:"LastPrinted",t:yo},12:{n:"CreatedDate",t:yo},13:{n:"ModifiedDate",t:yo},14:{n:"PageCount",t:tr},15:{n:"WordCount",t:tr},16:{n:"CharCount",t:tr},17:{n:"Thumbnail",t:dS},18:{n:"Application",t:yt},19:{n:"DocSecurity",t:tr},255:{},2147483648:{n:"Locale",t:es},2147483651:{n:"Behavior",t:es},1919054434:{}},Uc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},mS=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vS(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var wS=vS([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pn=Dt(wS),zn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Id={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},zc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function CS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bS(e){var t=CS();if(!e||!e.match)return t;var r={};if((e.match(zt)||[]).forEach(function(n){var a=De(n);switch(a[0].replace(Ib,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[zc[a.ContentType]]!==void 0&&t[zc[a.ContentType]].push(a.PartName);break}}),t.xmlns!==$b.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var aa={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function il(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Na(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(zt)||[]).forEach(function(a){var o=De(a);if(o[0]==="<Relationship"){var s={};s.Type=o.Type,s.Target=o.Target,s.Id=o.Id,o.TargetMode&&(s.TargetMode=o.TargetMode);var l=o.TargetMode==="External"?o.Target:Pa(o.Target,t);r[l]=s,n[o.Id]=s}}),r["!id"]=n,r}var SS="application/vnd.oasis.opendocument.spreadsheet";function kS(e,t){for(var r=ni(e),n,a;n=Ya.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=De(n[0],!1),a.path=="/"&&a.type!==SS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Ba=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ES=function(){for(var e=new Array(Ba.length),t=0;t<Ba.length;++t){var r=Ba[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Pd(e){var t={};e=st(e);for(var r=0;r<Ba.length;++r){var n=Ba[r],a=e.match(ES[r]);a!=null&&a.length>0&&(t[n[1]]=Ze(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=_t(t[n[1]]))}return t}var TS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Ad(e,t,r,n){var a=[];if(typeof e=="string")a=Oc(e,n);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(c){return{v:c}}));var s=typeof t=="string"?Oc(t,n).map(function(c){return c.v}):t,l=0,i=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(i=+a[u+1].v,a[u].v){case"Worksheets":case"å·¥ä½œè¡¨":case"Ð›Ð¸ÑÑ‚Ñ‹":case"Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„":case"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ":case"×’×œ×™×•× ×•×ª ×¢×‘×•×“×”":case"ArbeitsblÃ¤tter":case"Ã‡alÄ±ÅŸma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":r.Worksheets=i,r.SheetNames=s.slice(l,l+i);break;case"Named Ranges":case"Rangos con nombre":case"åå‰ä»˜ãä¸€è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":r.NamedRanges=i,r.DefinedNames=s.slice(l,l+i);break;case"Charts":case"Diagramme":r.Chartsheets=i,r.ChartNames=s.slice(l,l+i);break}l+=i}}function yS(e,t,r){var n={};return t||(t={}),e=st(e),TS.forEach(function(a){var o=(e.match(Xa(a[0]))||[])[1];switch(a[2]){case"string":o&&(t[a[1]]=Ze(o));break;case"bool":t[a[1]]=o==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Ad(n.HeadingPairs,n.TitlesOfParts,t,r),t}var _S=/<[^>]+>[^<]*/g;function FS(e,t){var r={},n="",a=e.match(_S);if(a)for(var o=0;o!=a.length;++o){var s=a[o],l=De(s);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ze(l.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var i=s.split(">"),u=i[0].slice(4),c=i[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ze(c);break;case"bool":r[n]=dt(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(c,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(c);break;case"filetime":case"date":r[n]=_t(c);break;case"cy":case"error":r[n]=Ze(c);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,i)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var IS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vs;function PS(e,t,r){Vs||(Vs=ei(IS)),t=Vs[t]||t,e[t]=r}function di(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Md(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Dd(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Od(e,t,r){return t===31?Dd(e):Md(e,t,r)}function cl(e,t,r){return Od(e,t,r===!1?0:4)}function AS(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Od(e,t,0)}function MS(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Qt,""),e.l-a&2&&(e.l+=2)}return r}function DS(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Qt,"");return r}function OS(e){var t=e.l,r=ts(e,Fd);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ts(e,tr);return[r,n]}function RS(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(OS(e));return r}function jc(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var o=e.read_shift(4),s=e.read_shift(4);n[o]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Qt,"").replace(Ia,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Rd(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function LS(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ts(e,t,r){var n=e.read_shift(2),a,o=r||{};if(e.l+=2,t!==Gc&&n!==t&&gS.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Gc?n:t){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Md(e,n,4).replace(Qt,"");case 31:return Dd(e);case 64:return di(e);case 65:return Rd(e);case 71:return LS(e);case 80:return cl(e,n,!o.raw).replace(Qt,"");case 81:return AS(e,n).replace(Qt,"");case 4108:return RS(e);case 4126:case 4127:return n==4127?MS(e):DS(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Wc(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),o=[],s=0,l=0,i=-1,u={};for(s=0;s!=a;++s){var c=e.read_shift(4),d=e.read_shift(4);o[s]=[c,d+r]}o.sort(function(v,C){return v[1]-C[1]});var f={};for(s=0;s!=a;++s){if(e.l!==o[s][1]){var p=!0;if(s>0&&t)switch(t[o[s-1][0]].t){case 2:e.l+2===o[s][1]&&(e.l+=2,p=!1);break;case 80:e.l<=o[s][1]&&(e.l=o[s][1],p=!1);break;case 4108:e.l<=o[s][1]&&(e.l=o[s][1],p=!1);break}if((!t||s==0)&&e.l<=o[s][1]&&(p=!1,e.l=o[s][1]),p)throw new Error("Read Error: Expected address "+o[s][1]+" at "+e.l+" :"+s)}if(t){var h=t[o[s][0]];if(f[h.n]=ts(e,h.t,{raw:!0}),h.p==="version"&&(f[h.n]=String(f[h.n]>>16)+"."+("0000"+String(f[h.n]&65535)).slice(-4)),h.n=="CodePage")switch(f[h.n]){case 0:f[h.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:br(l=f[h.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[h.n])}}else if(o[s][0]===1){if(l=f.CodePage=ts(e,ui),br(l),i!==-1){var g=e.l;e.l=o[i][1],u=jc(e,l),e.l=g}}else if(o[s][0]===0){if(l===0){i=s,e.l=o[s+1][1];continue}u=jc(e,l)}else{var m=u[o[s][0]],w;switch(e[e.l]){case 65:e.l+=4,w=Rd(e);break;case 30:e.l+=4,w=cl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=cl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=mt(e,4);break;case 64:e.l+=4,w=_t(di(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[m]=w}}return e.l=r+n,f}function Kc(e,t,r){var n=e.content;if(!n)return{};Pt(n,0);var a,o,s,l,i=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),c=n.read_shift(16);if(c!==Ye.utils.consts.HEADER_CLSID&&c!==r)throw new Error("Bad PropertySet CLSID "+c);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(s=n.read_shift(16),i=n.read_shift(4));var d=Wc(n,t),f={SystemIdentifier:u};for(var p in d)f[p]=d[p];if(f.FMTID=o,a===1)return f;if(i-n.l==2&&(n.l+=2),n.l!==i)throw new Error("Length mismatch 2: "+n.l+" !== "+i);var h;try{h=Wc(n,null)}catch{}for(p in h)f[p]=h[p];return f.FMTID=[o,s],f}function en(e,t){return e.read_shift(t),null}function NS(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function mt(e,t){return e.read_shift(t)===1}function Ct(e){return e.read_shift(2,"u")}function Ld(e,t){return NS(e,t,Ct)}function BS(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function co(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function HS(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,o=1+(r&1),s=0,l,i={};a&&(s=e.read_shift(2)),n&&(l=e.read_shift(4));var u=o==2?"dbcs-cont":"sbcs-cont",c=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*s),n&&(e.l+=l),i.t=c,a||(i.raw="<t>"+i.t+"</t>",i.r=i.t),i}function Rn(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function uo(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Rn(e,n,r)}function jn(e,t,r){if(r.biff>5)return uo(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function $S(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function VS(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Qt,"");return n&&(e.l+=24),a}function GS(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(o>>1,"utf16le").replace(Qt,"");return r+s}function US(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return VS(e);case"0303000000000000c000000000000046":return GS(e);default:throw new Error("Unsupported Moniker "+r)}}function _o(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Qt,""):"";return r}function zS(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var o,s,l,i,u="",c,d;a&16&&(o=_o(e,r-e.l)),a&128&&(s=_o(e,r-e.l)),(a&257)===257&&(l=_o(e,r-e.l)),(a&257)===1&&(i=US(e,r-e.l)),a&8&&(u=_o(e,r-e.l)),a&32&&(c=e.read_shift(16)),a&64&&(d=di(e)),e.l=r;var f=s||l||i||"";f&&u&&(f+="#"+u),f||(f="#"+u),a&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var p={Target:f};return c&&(p.guid=c),d&&(p.time=d),o&&(p.Tooltip=o),p}function Nd(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Bd(e,t){var r=Nd(e);return r[3]=0,r}function Hr(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function jS(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function WS(e,t,r){return t===0?"":jn(e,t,r)}function KS(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),o=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,o,s]}function Hd(e){var t=e.read_shift(2),r=ci(e);return[t,r]}function XS(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=co(e,t,r),o=e.read_shift(2);if(n-=e.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return e.l+=o,a}function ks(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function $d(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var YS=$d;function Vd(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function qS(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ZS(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Lt(e){e.l+=2,e.l+=e.read_shift(2)}var QS={0:Lt,4:Lt,5:Lt,6:Lt,7:ZS,8:Lt,9:Lt,10:Lt,11:Lt,12:Lt,13:qS,14:Lt,15:Lt,16:Lt,17:Lt,18:Lt,19:Lt,20:Lt,21:Vd};function JS(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(QS[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Fo(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ek(e,t){return t===0||e.read_shift(2),1200}function tk(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=jn(e,0,r);return e.read_shift(t+n-e.l),a}function rk(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function nk(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var s=co(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:o,name:s}}function ak(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),o=[],s=0;s!=a&&e.l<r;++s)o.push(HS(e));return o.Count=n,o.Unique=a,o}function ok(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function sk(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function lk(e){var t=jS(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function ik(e){return e.read_shift(2),e.read_shift(4)}function Xc(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function ck(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),i=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:o,CurTab:s,FirstTab:l,Selected:i,TabRatio:u}}function uk(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function dk(){}function fk(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=co(e,0,r),n}function hk(e){var t=Hr(e);return t.isst=e.read_shift(4),t}function gk(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Hr(e);r.biff==2&&e.l++;var o=uo(e,n-e.l,r);return a.val=o,a}function pk(e,t,r){var n=e.read_shift(2),a=jn(e,0,r);return[n,a]}var xk=jn;function Yc(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,o=e.read_shift(a),s=e.read_shift(a),l=e.read_shift(2),i=e.read_shift(2);return e.l=n,{s:{r:o,c:l},e:{r:s,c:i}}}function mk(e){var t=e.read_shift(2),r=e.read_shift(2),n=Hd(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function vk(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),o=[];e.l<r;)o.push(Hd(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(o.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:o}}function wk(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),o=[];e.l<r;)o.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(o.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:o}}function Ck(e,t,r,n){var a={},o=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(4),i=e.read_shift(2);return a.patternType=mS[l>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=i&127,a.icvBack=i>>7&127,a.fsxButton=i>>14&1),a}function bk(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Ck(e,t,n.fStyle,r),n}function Sk(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function qc(e,t,r){var n=Hr(e);(r.biff==2||t==9)&&++e.l;var a=BS(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function kk(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Hr(e),a=Ht(e);return n.val=a,n}var Zc=WS;function Ek(e,t,r){var n=e.l+t,a=e.read_shift(2),o=e.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var s=Rn(e,o),l=[];n>e.l;)l.push(uo(e));return[o,a,s,l]}function Qc(e,t,r){var n=e.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=XS(e,t-2,r)),o.body=a||e.read_shift(t-2),typeof a=="string"&&(o.Name=a),o}var Tk=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Jc(e,t,r){var n=e.l+t,a=e.read_shift(2),o=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),i=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),i=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Rn(e,s,r);a&32&&(u=Tk[u.charCodeAt(0)]);var c=n-e.l;r&&r.biff==2&&--c;var d=n==e.l||l===0||!(c>0)?[]:s_(e,c,r,l);return{chKey:o,Name:u,itab:i,rgce:d}}function Gd(e,t,r){if(r.biff<8)return yk(e,t,r);for(var n=[],a=e.l+t,o=e.read_shift(r.biff>8?4:2);o--!==0;)n.push(KS(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function yk(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=co(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function _k(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),o=Rn(e,n,r),s=Rn(e,a,r);return[o,s]}function Fk(e,t,r){var n=$d(e);e.l++;var a=e.read_shift(1);return t-=8,[l_(e,t,r),a,n]}function eu(e,t,r){var n=YS(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,a_(e,t,r)]}function Ik(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Pk(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),l=jn(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,s,o]}}function Ak(e,t,r){return Pk(e,t,r)}function Mk(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ks(e));return r}function Dk(e,t,r){if(r&&r.biff<8)return Rk(e,t,r);var n=Vd(e),a=JS(e,t-22,n[1]);return{cmo:n,ft:a}}var Ok={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Rk(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((Ok[n]||Gt)(e,t,r)),{cmo:[a,n,o],ft:s}}function Lk(e,t,r){var n=e.l,a="";try{e.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:s=$S(e,6,r);var l=e.read_shift(2);e.read_shift(2),Ct(e,2);var i=e.read_shift(2);e.l+=i;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var c=e[e.l],d=Rn(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(c?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Nk(e,t){var r=ks(e);e.l+=16;var n=zS(e,t-24);return[r,n]}function Bk(e,t){e.read_shift(2);var r=ks(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Qt,""),[r,n]}function Hk(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Uc[r]||r,r=e.read_shift(2),t[1]=Uc[r]||r,t}function $k(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Bd(e));return r}function Vk(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Bd(e));return r}function Gk(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Ud(e,t,r){if(!r.cellStyles)return Gt(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),i=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:o,w:s,ixfe:l,flags:i};return(r.biff>=5||!r.biff)&&(u.level=i>>8&7),u}function Uk(e,t){var r={};return t<32||(e.l+=16,r.header=Ht(e),r.footer=Ht(e),e.l+=2),r}function zk(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var jk=Hr,Wk=Ld,Kk=uo;function Xk(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function Yk(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Hr(e);++e.l;var a=jn(e,t-7,r);return n.t="str",n.val=a,n}function qk(e){var t=Hr(e);++e.l;var r=Ht(e);return t.t="n",t.val=r,t}function Zk(e){var t=Hr(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Qk(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Jk(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function eE(e,t,r){var n=e.l+t,a=Hr(e),o=e.read_shift(2),s=Rn(e,o,r);return e.l=n,a.t="str",a.val=s,a}var tE=[2,3,48,49,131,139,140,245],tu=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ei({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,i){var u=[],c=pn(1);switch(i.type){case"base64":c=wr(sr(l));break;case"binary":c=wr(l);break;case"buffer":case"array":c=l;break}Pt(c,0);var d=c.read_shift(1),f=!!(d&136),p=!1,h=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:h=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,m=521;d==2&&(g=c.read_shift(2)),c.l+=3,d!=2&&(g=c.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(m=c.read_shift(2));var w=c.read_shift(2),v=i.codepage||1252;d!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(v=e[c[c.l]]),c.l+=1,c.l+=2),h&&(c.l+=36);for(var C=[],E={},R=Math.min(c.length,d==2?521:m-10-(p?264:0)),S=h?32:11;c.l<R&&c[c.l]!=13;)switch(E={},E.name=on.utils.decode(v,c.slice(c.l,c.l+S)).replace(/[\u0000\r\n].*$/g,""),c.l+=S,E.type=String.fromCharCode(c.read_shift(1)),d!=2&&!h&&(E.offset=c.read_shift(4)),E.len=c.read_shift(1),d==2&&(E.offset=c.read_shift(2)),E.dec=c.read_shift(1),E.name.length&&C.push(E),d!=2&&(c.l+=h?13:14),E.type){case"B":(!p||E.len!=8)&&i.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":i.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(c[c.l]!==13&&(c.l=m-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=m;var b=0,T=0;for(u[0]=[],T=0;T!=C.length;++T)u[0][T]=C[T].name;for(;g-- >0;){if(c[c.l]===42){c.l+=w;continue}for(++c.l,u[++b]=[],T=0,T=0;T!=C.length;++T){var A=c.slice(c.l,c.l+C[T].len);c.l+=C[T].len,Pt(A,0);var N=on.utils.decode(v,A);switch(C[T].type){case"C":N.trim().length&&(u[b][T]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[b][T]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[b][T]=N;break;case"F":u[b][T]=parseFloat(N.trim());break;case"+":case"I":u[b][T]=h?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[b][T]=!0;break;case"N":case"F":u[b][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[b][T]="##MEMO##"+(h?parseInt(N.trim(),10):A.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[b][T]=+N||0);break;case"@":u[b][T]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[b][T]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[b][T]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[b][T]=-A.read_shift(-8,"f");break;case"B":if(p&&C[T].len==8){u[b][T]=A.read_shift(8,"f");break}case"G":case"P":A.l+=C[T].len;break;case"0":if(C[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[T].type)}}}if(d!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return i&&i.sheetRows&&(u=u.slice(0,i.sheetRows)),i.DBF=C,u}function n(l,i){var u=i||{};u.dateNF||(u.dateNF="yyyymmdd");var c=Ca(r(l,u),u);return c["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,c}function a(l,i){try{return Cn(n(l,i),i)}catch(u){if(i&&i.WTF)throw u}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,i){var u=i||{};if(+u.codepage>=0&&br(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=sl(),d=xl(l,{header:1,raw:!0,cellDates:!0}),f=d[0],p=d.slice(1),h=l["!cols"]||[],g=0,m=0,w=0,v=1;for(g=0;g<f.length;++g){if(((h[g]||{}).DBF||{}).name){f[g]=h[g].DBF.name,++w;continue}if(f[g]!=null){if(++w,typeof f[g]=="number"&&(f[g]=f[g].toString(10)),typeof f[g]!="string")throw new Error("DBF Invalid column name "+f[g]+" |"+typeof f[g]+"|");if(f.indexOf(f[g])!==g){for(m=0;m<1024;++m)if(f.indexOf(f[g]+"_"+m)==-1){f[g]+="_"+m;break}}}}var C=xt(l["!ref"]),E=[],R=[],S=[];for(g=0;g<=C.e.c-C.s.c;++g){var b="",T="",A=0,N=[];for(m=0;m<p.length;++m)p[m][g]!=null&&N.push(p[m][g]);if(N.length==0||f[g]==null){E[g]="?";continue}for(m=0;m<N.length;++m){switch(typeof N[m]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=N[m]instanceof Date?"D":"C";break;default:T="C"}A=Math.max(A,String(N[m]).length),b=b&&b!=T?"C":T}A>250&&(A=250),T=((h[g]||{}).DBF||{}).type,T=="C"&&h[g].DBF.len>A&&(A=h[g].DBF.len),b=="B"&&T=="N"&&(b="N",S[g]=h[g].DBF.dec,A=h[g].DBF.len),R[g]=b=="C"||T=="N"?A:o[b]||0,v+=R[g],E[g]=b}var y=c.next(32);for(y.write_shift(4,318902576),y.write_shift(4,p.length),y.write_shift(2,296+32*w),y.write_shift(2,v),g=0;g<4;++g)y.write_shift(4,0);for(y.write_shift(4,0|(+t[V0]||3)<<8),g=0,m=0;g<f.length;++g)if(f[g]!=null){var D=c.next(32),L=(f[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,L,"sbcs"),D.write_shift(1,E[g]=="?"?"C":E[g],"sbcs"),D.write_shift(4,m),D.write_shift(1,R[g]||o[E[g]]||0),D.write_shift(1,S[g]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),m+=R[g]||o[E[g]]||0}var M=c.next(264);for(M.write_shift(4,13),g=0;g<65;++g)M.write_shift(4,0);for(g=0;g<p.length;++g){var F=c.next(v);for(F.write_shift(1,0),m=0;m<f.length;++m)if(f[m]!=null)switch(E[m]){case"L":F.write_shift(1,p[g][m]==null?63:p[g][m]?84:70);break;case"B":F.write_shift(8,p[g][m]||0,"f");break;case"N":var B="0";for(typeof p[g][m]=="number"&&(B=p[g][m].toFixed(S[m]||0)),w=0;w<R[m]-B.length;++w)F.write_shift(1,32);F.write_shift(1,B,"sbcs");break;case"D":p[g][m]?(F.write_shift(4,("0000"+p[g][m].getFullYear()).slice(-4),"sbcs"),F.write_shift(2,("00"+(p[g][m].getMonth()+1)).slice(-2),"sbcs"),F.write_shift(2,("00"+p[g][m].getDate()).slice(-2),"sbcs")):F.write_shift(8,"00000000","sbcs");break;case"C":var H=String(p[g][m]!=null?p[g][m]:"").slice(0,R[m]);for(F.write_shift(1,H,"sbcs"),w=0;w<R[m]-H.length;++w)F.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),rE=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Lr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,p){var h=e[p];return typeof h=="number"?mc(h):h},n=function(f,p,h){var g=p.charCodeAt(0)-32<<4|h.charCodeAt(0)-48;return g==59?f:mc(g)};e["|"]=254;function a(f,p){switch(p.type){case"base64":return o(sr(f),p);case"binary":return o(f,p);case"buffer":return o(Xe&&Buffer.isBuffer(f)?f.toString("binary"):Vn(f),p);case"array":return o(On(f),p)}throw new Error("Unrecognized type "+p.type)}function o(f,p){var h=f.split(/[\n\r]+/),g=-1,m=-1,w=0,v=0,C=[],E=[],R=null,S={},b=[],T=[],A=[],N=0,y;for(+p.codepage>=0&&br(+p.codepage);w!==h.length;++w){N=0;var D=h[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),L=D.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),M=L[0],F;if(D.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&E.push(D.slice(3).replace(/;;/g,";"));break;case"C":var B=!1,H=!1,G=!1,_=!1,Z=-1,ee=-1;for(v=1;v<L.length;++v)switch(L[v].charAt(0)){case"A":break;case"X":m=parseInt(L[v].slice(1))-1,H=!0;break;case"Y":for(g=parseInt(L[v].slice(1))-1,H||(m=0),y=C.length;y<=g;++y)C[y]=[];break;case"K":F=L[v].slice(1),F.charAt(0)==='"'?F=F.slice(1,F.length-1):F==="TRUE"?F=!0:F==="FALSE"?F=!1:isNaN(yr(F))?isNaN(ha(F).getDate())||(F=_t(F)):(F=yr(F),R!==null&&va(R)&&(F=Ss(F))),B=!0;break;case"E":_=!0;var P=ca(L[v].slice(1),{r:g,c:m});C[g][m]=[C[g][m],P];break;case"S":G=!0,C[g][m]=[C[g][m],"S5S"];break;case"G":break;case"R":Z=parseInt(L[v].slice(1))-1;break;case"C":ee=parseInt(L[v].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}if(B&&(C[g][m]&&C[g][m].length==2?C[g][m][0]=F:C[g][m]=F,R=null),G){if(_)throw new Error("SYLK shared formula cannot have own formula");var q=Z>-1&&C[Z][ee];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");C[g][m][1]=Jd(q[1],{r:g-Z,c:m-ee})}break;case"F":var K=0;for(v=1;v<L.length;++v)switch(L[v].charAt(0)){case"X":m=parseInt(L[v].slice(1))-1,++K;break;case"Y":for(g=parseInt(L[v].slice(1))-1,y=C.length;y<=g;++y)C[y]=[];break;case"M":N=parseInt(L[v].slice(1))/20;break;case"F":break;case"G":break;case"P":R=E[parseInt(L[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=L[v].slice(1).split(" "),y=parseInt(A[0],10);y<=parseInt(A[1],10);++y)N=parseInt(A[2],10),T[y-1]=N===0?{hidden:!0}:{wch:N},ga(T[y-1]);break;case"C":m=parseInt(L[v].slice(1))-1,T[m]||(T[m]={});break;case"R":g=parseInt(L[v].slice(1))-1,b[g]||(b[g]={}),N>0?(b[g].hpt=N,b[g].hpx=Qa(N)):N===0&&(b[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}K<1&&(R=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}}return b.length>0&&(S["!rows"]=b),T.length>0&&(S["!cols"]=T),p&&p.sheetRows&&(C=C.slice(0,p.sheetRows)),[C,S]}function s(f,p){var h=a(f,p),g=h[0],m=h[1],w=Ca(g,p);return Lr(m).forEach(function(v){w[v]=m[v]}),w}function l(f,p){return Cn(s(f,p),p)}function i(f,p,h,g){var m="C;Y"+(h+1)+";X"+(g+1)+";K";switch(f.t){case"n":m+=f.v||0,f.f&&!f.F&&(m+=";E"+GT(f.f,{r:h,c:g}));break;case"b":m+=f.v?"TRUE":"FALSE";break;case"e":m+=f.w||f.v;break;case"d":m+='"'+(f.w||f.v)+'"';break;case"s":m+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function u(f,p){p.forEach(function(h,g){var m="F;W"+(g+1)+" "+(g+1)+" ";h.hidden?m+="0":(typeof h.width=="number"&&!h.wpx&&(h.wpx=ns(h.width)),typeof h.wpx=="number"&&!h.wch&&(h.wch=as(h.wpx)),typeof h.wch=="number"&&(m+=Math.round(h.wch))),m.charAt(m.length-1)!=" "&&f.push(m)})}function c(f,p){p.forEach(function(h,g){var m="F;";h.hidden?m+="M0;":h.hpt?m+="M"+20*h.hpt+";":h.hpx&&(m+="M"+20*qd(h.hpx)+";"),m.length>2&&f.push(m+"R"+(g+1))})}function d(f,p){var h=["ID;PWXL;N;E"],g=[],m=xt(f["!ref"]),w,v=Array.isArray(f),C=`\r
`;h.push("P;PGeneral"),h.push("F;P0;DG0G8;M255"),f["!cols"]&&u(h,f["!cols"]),f["!rows"]&&c(h,f["!rows"]),h.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var E=m.s.r;E<=m.e.r;++E)for(var R=m.s.c;R<=m.e.c;++R){var S=Be({r:E,c:R});w=v?(f[E]||[])[R]:f[S],!(!w||w.v==null&&(!w.f||w.F))&&g.push(i(w,f,E,R))}return h.join(C)+C+g.join(C)+C+"E"+C}return{to_workbook:l,to_sheet:s,from_sheet:d}}(),nE=function(){function e(o,s){switch(s.type){case"base64":return t(sr(o),s);case"binary":return t(o,s);case"buffer":return t(Xe&&Buffer.isBuffer(o)?o.toString("binary"):Vn(o),s);case"array":return t(On(o),s)}throw new Error("Unrecognized type "+s.type)}function t(o,s){for(var l=o.split(`
`),i=-1,u=-1,c=0,d=[];c!==l.length;++c){if(l[c].trim()==="BOT"){d[++i]=[],u=0;continue}if(!(i<0)){var f=l[c].trim().split(","),p=f[0],h=f[1];++c;for(var g=l[c]||"";(g.match(/["]/g)||[]).length&1&&c<l.length-1;)g+=`
`+l[++c];switch(g=g.trim(),+p){case-1:if(g==="BOT"){d[++i]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[i][u]=!0:g==="FALSE"?d[i][u]=!1:isNaN(yr(h))?isNaN(ha(h).getDate())?d[i][u]=h:d[i][u]=_t(h):d[i][u]=yr(h),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[i][u++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function r(o,s){return Ca(e(o,s),s)}function n(o,s){return Cn(r(o,s),s)}var a=function(){var o=function(i,u,c,d,f){i.push(u),i.push(c+","+d),i.push('"'+f.replace(/"/g,'""')+'"')},s=function(i,u,c,d){i.push(u+","+c),i.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(i){var u=[],c=xt(i["!ref"]),d,f=Array.isArray(i);o(u,"TABLE",0,1,"sheetjs"),o(u,"VECTORS",0,c.e.r-c.s.r+1,""),o(u,"TUPLES",0,c.e.c-c.s.c+1,""),o(u,"DATA",0,0,"");for(var p=c.s.r;p<=c.e.r;++p){s(u,-1,0,"BOT");for(var h=c.s.c;h<=c.e.c;++h){var g=Be({r:p,c:h});if(d=f?(i[p]||[])[h]:i[g],!d){s(u,1,0,"");continue}switch(d.t){case"n":var m=d.w;!m&&d.v!=null&&(m=d.v),m==null?d.f&&!d.F?s(u,1,0,"="+d.f):s(u,1,0,""):s(u,0,m,"V");break;case"b":s(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=hr(d.z||Ge[14],Jt(_t(d.v)))),s(u,0,d.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var w=`\r
`,v=u.join(w);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),aE=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,f){for(var p=d.split(`
`),h=-1,g=-1,m=0,w=[];m!==p.length;++m){var v=p[m].trim().split(":");if(v[0]==="cell"){var C=Zt(v[1]);if(w.length<=C.r)for(h=w.length;h<=C.r;++h)w[h]||(w[h]=[]);switch(h=C.r,g=C.c,v[2]){case"t":w[h][g]=e(v[3]);break;case"v":w[h][g]=+v[3];break;case"vtf":var E=v[v.length-1];case"vtc":switch(v[3]){case"nl":w[h][g]=!!+v[4];break;default:w[h][g]=+v[4];break}v[2]=="vtf"&&(w[h][g]=[w[h][g],E])}}}return f&&f.sheetRows&&(w=w.slice(0,f.sheetRows)),w}function n(d,f){return Ca(r(d,f),f)}function a(d,f){return Cn(n(d,f),f)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),i="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var f=[],p=[],h,g="",m=wa(d["!ref"]),w=Array.isArray(d),v=m.s.r;v<=m.e.r;++v)for(var C=m.s.c;C<=m.e.c;++C)if(g=Be({r:v,c:C}),h=w?(d[v]||[])[C]:d[g],!(!h||h.v==null||h.t==="z")){switch(p=["cell",g,"t"],h.t){case"s":case"str":p.push(t(h.v));break;case"n":h.f?(p[2]="vtf",p[3]="n",p[4]=h.v,p[5]=t(h.f)):(p[2]="v",p[3]=h.v);break;case"b":p[2]="vt"+(h.f?"f":"c"),p[3]="nl",p[4]=h.v?"1":"0",p[5]=t(h.f||(h.v?"TRUE":"FALSE"));break;case"d":var E=Jt(_t(h.v));p[2]="vtc",p[3]="nd",p[4]=""+E,p[5]=h.w||hr(h.z||Ge[14],E);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function c(d){return[o,s,l,s,u(d),i].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:c}}(),qa=function(){function e(c,d,f,p,h){h.raw?d[f][p]=c:c===""||(c==="TRUE"?d[f][p]=!0:c==="FALSE"?d[f][p]=!1:isNaN(yr(c))?isNaN(ha(c).getDate())?d[f][p]=c:d[f][p]=_t(c):d[f][p]=yr(c))}function t(c,d){var f=d||{},p=[];if(!c||c.length===0)return p;for(var h=c.split(/[\r\n]/),g=h.length-1;g>=0&&h[g].length===0;)--g;for(var m=10,w=0,v=0;v<=g;++v)w=h[v].indexOf(" "),w==-1?w=h[v].length:w++,m=Math.max(m,w);for(v=0;v<=g;++v){p[v]=[];var C=0;for(e(h[v].slice(0,m).trim(),p,v,C,f),C=1;C<=(h[v].length-m)/10+1;++C)e(h[v].slice(m+(C-1)*10,m+C*10).trim(),p,v,C,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(c){for(var d={},f=!1,p=0,h=0;p<c.length;++p)(h=c.charCodeAt(p))==34?f=!f:!f&&h in r&&(d[h]=(d[h]||0)+1);h=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&h.push([d[p],p]);if(!h.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&h.push([d[p],p])}return h.sort(function(g,m){return g[0]-m[0]||n[g[1]]-n[m[1]]}),r[h.pop()[1]]||44}function o(c,d){var f=d||{},p="",h=f.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(p=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(p=c.charAt(4),c=c.slice(6)):p=a(c.slice(0,1024)):f&&f.FS?p=f.FS:p=a(c.slice(0,1024));var m=0,w=0,v=0,C=0,E=0,R=p.charCodeAt(0),S=!1,b=0,T=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var A=f.dateNF!=null?xb(f.dateNF):null;function N(){var y=c.slice(C,E),D={};if(y.charAt(0)=='"'&&y.charAt(y.length-1)=='"'&&(y=y.slice(1,-1).replace(/""/g,'"')),y.length===0)D.t="z";else if(f.raw)D.t="s",D.v=y;else if(y.trim().length===0)D.t="s",D.v=y;else if(y.charCodeAt(0)==61)y.charCodeAt(1)==34&&y.charCodeAt(y.length-1)==34?(D.t="s",D.v=y.slice(2,-1).replace(/""/g,'"')):zT(y)?(D.t="n",D.f=y.slice(1)):(D.t="s",D.v=y);else if(y=="TRUE")D.t="b",D.v=!0;else if(y=="FALSE")D.t="b",D.v=!1;else if(!isNaN(v=yr(y)))D.t="n",f.cellText!==!1&&(D.w=y),D.v=v;else if(!isNaN(ha(y).getDate())||A&&y.match(A)){D.z=f.dateNF||Ge[14];var L=0;A&&y.match(A)&&(y=mb(y,f.dateNF,y.match(A)||[]),L=1),f.cellDates?(D.t="d",D.v=_t(y,L)):(D.t="n",D.v=Jt(_t(y,L))),f.cellText!==!1&&(D.w=hr(D.z,D.v instanceof Date?Jt(D.v):D.v)),f.cellNF||delete D.z}else D.t="s",D.v=y;if(D.t=="z"||(f.dense?(h[m]||(h[m]=[]),h[m][w]=D):h[Be({c:w,r:m})]=D),C=E+1,T=c.charCodeAt(C),g.e.c<w&&(g.e.c=w),g.e.r<m&&(g.e.r=m),b==R)++w;else if(w=0,++m,f.sheetRows&&f.sheetRows<=m)return!0}e:for(;E<c.length;++E)switch(b=c.charCodeAt(E)){case 34:T===34&&(S=!S);break;case R:case 10:case 13:if(!S&&N())break e;break}return E-C>0&&N(),h["!ref"]=qe(g),h}function s(c,d){return!(d&&d.PRN)||d.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?o(c,d):Ca(t(c,d),d)}function l(c,d){var f="",p=d.type=="string"?[0,0,0,0]:wi(c,d);switch(d.type){case"base64":f=sr(c);break;case"binary":f=c;break;case"buffer":d.codepage==65001?f=c.toString("utf8"):d.codepage&&typeof on<"u"?f=on.utils.decode(d.codepage,c):f=Xe&&Buffer.isBuffer(c)?c.toString("binary"):Vn(c);break;case"array":f=On(c);break;case"string":f=c;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=st(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=st(f):d.type=="binary"&&typeof on<"u"&&d.codepage&&(f=on.utils.decode(d.codepage,on.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?aE.to_sheet(d.type=="string"?f:st(f),d):s(f,d)}function i(c,d){return Cn(l(c,d),d)}function u(c){for(var d=[],f=xt(c["!ref"]),p,h=Array.isArray(c),g=f.s.r;g<=f.e.r;++g){for(var m=[],w=f.s.c;w<=f.e.c;++w){var v=Be({r:g,c:w});if(p=h?(c[g]||[])[w]:c[v],!p||p.v==null){m.push("          ");continue}for(var C=(p.w||(Xr(p),p.w)||"").slice(0,10);C.length<10;)C+=" ";m.push(C+(w===0?" ":""))}d.push(m.join(""))}return d.join(`
`)}return{to_workbook:i,to_sheet:l,from_sheet:u}}();function oE(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=rE.to_workbook(e,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return qa.to_workbook(e,t)}}var Ha=function(){function e(P,q,K){if(P){Pt(P,P.l||0);for(var X=K.Enum||Z;P.l<P.length;){var te=P.read_shift(2),le=X[te]||X[65535],fe=P.read_shift(2),de=P.l+fe,ie=le.f&&le.f(P,fe,K);if(P.l=de,q(ie,le,te))return}}}function t(P,q){switch(q.type){case"base64":return r(wr(sr(P)),q);case"binary":return r(wr(P),q);case"buffer":case"array":return r(P,q)}throw"Unsupported type "+q.type}function r(P,q){if(!P)return P;var K=q||{},X=K.dense?[]:{},te="Sheet1",le="",fe=0,de={},ie=[],xe=[],z={s:{r:0,c:0},e:{r:0,c:0}},Pe=K.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)K.Enum=Z,e(P,function(ne,be,Ae){switch(Ae){case 0:K.vers=ne,ne>=4096&&(K.qpro=!0);break;case 6:z=ne;break;case 204:ne&&(le=ne);break;case 222:le=ne;break;case 15:case 51:K.qpro||(ne[1].v=ne[1].v.slice(1));case 13:case 14:case 16:Ae==14&&(ne[2]&112)==112&&(ne[2]&15)>1&&(ne[2]&15)<15&&(ne[1].z=K.dateNF||Ge[14],K.cellDates&&(ne[1].t="d",ne[1].v=Ss(ne[1].v))),K.qpro&&ne[3]>fe&&(X["!ref"]=qe(z),de[te]=X,ie.push(te),X=K.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},fe=ne[3],te=le||"Sheet"+(fe+1),le="");var Me=K.dense?(X[ne[0].r]||[])[ne[0].c]:X[Be(ne[0])];if(Me){Me.t=ne[1].t,Me.v=ne[1].v,ne[1].z!=null&&(Me.z=ne[1].z),ne[1].f!=null&&(Me.f=ne[1].f);break}K.dense?(X[ne[0].r]||(X[ne[0].r]=[]),X[ne[0].r][ne[0].c]=ne[1]):X[Be(ne[0])]=ne[1];break}},K);else if(P[2]==26||P[2]==14)K.Enum=ee,P[2]==14&&(K.qpro=!0,P.l=0),e(P,function(ne,be,Ae){switch(Ae){case 204:te=ne;break;case 22:ne[1].v=ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ne[3]>fe&&(X["!ref"]=qe(z),de[te]=X,ie.push(te),X=K.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},fe=ne[3],te="Sheet"+(fe+1)),Pe>0&&ne[0].r>=Pe)break;K.dense?(X[ne[0].r]||(X[ne[0].r]=[]),X[ne[0].r][ne[0].c]=ne[1]):X[Be(ne[0])]=ne[1],z.e.c<ne[0].c&&(z.e.c=ne[0].c),z.e.r<ne[0].r&&(z.e.r=ne[0].r);break;case 27:ne[14e3]&&(xe[ne[14e3][0]]=ne[14e3][1]);break;case 1537:xe[ne[0]]=ne[1],ne[0]==fe&&(te=ne[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(X["!ref"]=qe(z),de[le||te]=X,ie.push(le||te),!xe.length)return{SheetNames:ie,Sheets:de};for(var _e={},Ie=[],ce=0;ce<xe.length;++ce)de[ie[ce]]?(Ie.push(xe[ce]||ie[ce]),_e[xe[ce]]=de[xe[ce]]||de[ie[ce]]):(Ie.push(xe[ce]),_e[xe[ce]]={"!ref":"A1"});return{SheetNames:Ie,Sheets:_e}}function n(P,q){var K=q||{};if(+K.codepage>=0&&br(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var X=sl(),te=xt(P["!ref"]),le=Array.isArray(P),fe=[];xr(X,0,o(1030)),xr(X,6,i(te));for(var de=Math.min(te.e.r,8191),ie=te.s.r;ie<=de;++ie)for(var xe=Ot(ie),z=te.s.c;z<=te.e.c;++z){ie===te.s.r&&(fe[z]=Et(z));var Pe=fe[z]+xe,_e=le?(P[ie]||[])[z]:P[Pe];if(!(!_e||_e.t=="z"))if(_e.t=="n")(_e.v|0)==_e.v&&_e.v>=-32768&&_e.v<=32767?xr(X,13,p(ie,z,_e.v)):xr(X,14,g(ie,z,_e.v));else{var Ie=Xr(_e);xr(X,15,d(ie,z,Ie.slice(0,239)))}}return xr(X,1),X.end()}function a(P,q){var K=q||{};if(+K.codepage>=0&&br(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var X=sl();xr(X,0,s(P));for(var te=0,le=0;te<P.SheetNames.length;++te)(P.Sheets[P.SheetNames[te]]||{})["!ref"]&&xr(X,27,_(P.SheetNames[te],le++));var fe=0;for(te=0;te<P.SheetNames.length;++te){var de=P.Sheets[P.SheetNames[te]];if(!(!de||!de["!ref"])){for(var ie=xt(de["!ref"]),xe=Array.isArray(de),z=[],Pe=Math.min(ie.e.r,8191),_e=ie.s.r;_e<=Pe;++_e)for(var Ie=Ot(_e),ce=ie.s.c;ce<=ie.e.c;++ce){_e===ie.s.r&&(z[ce]=Et(ce));var ne=z[ce]+Ie,be=xe?(de[_e]||[])[ce]:de[ne];if(!(!be||be.t=="z"))if(be.t=="n")xr(X,23,N(_e,ce,fe,be.v));else{var Ae=Xr(be);xr(X,22,b(_e,ce,fe,Ae.slice(0,239)))}}++fe}}return xr(X,1),X.end()}function o(P){var q=St(2);return q.write_shift(2,P),q}function s(P){var q=St(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var K=0,X=0,te=0,le=0;le<P.SheetNames.length;++le){var fe=P.SheetNames[le],de=P.Sheets[fe];if(!(!de||!de["!ref"])){++te;var ie=wa(de["!ref"]);K<ie.e.r&&(K=ie.e.r),X<ie.e.c&&(X=ie.e.c)}}return K>8191&&(K=8191),q.write_shift(2,K),q.write_shift(1,te),q.write_shift(1,X),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function l(P,q,K){var X={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&K.qpro?(X.s.c=P.read_shift(1),P.l++,X.s.r=P.read_shift(2),X.e.c=P.read_shift(1),P.l++,X.e.r=P.read_shift(2),X):(X.s.c=P.read_shift(2),X.s.r=P.read_shift(2),q==12&&K.qpro&&(P.l+=2),X.e.c=P.read_shift(2),X.e.r=P.read_shift(2),q==12&&K.qpro&&(P.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function i(P){var q=St(8);return q.write_shift(2,P.s.c),q.write_shift(2,P.s.r),q.write_shift(2,P.e.c),q.write_shift(2,P.e.r),q}function u(P,q,K){var X=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(X[0].c=P.read_shift(1),X[3]=P.read_shift(1),X[0].r=P.read_shift(2),P.l+=2):(X[2]=P.read_shift(1),X[0].c=P.read_shift(2),X[0].r=P.read_shift(2)),X}function c(P,q,K){var X=P.l+q,te=u(P,q,K);if(te[1].t="s",K.vers==20768){P.l++;var le=P.read_shift(1);return te[1].v=P.read_shift(le,"utf8"),te}return K.qpro&&P.l++,te[1].v=P.read_shift(X-P.l,"cstr"),te}function d(P,q,K){var X=St(7+K.length);X.write_shift(1,255),X.write_shift(2,q),X.write_shift(2,P),X.write_shift(1,39);for(var te=0;te<X.length;++te){var le=K.charCodeAt(te);X.write_shift(1,le>=128?95:le)}return X.write_shift(1,0),X}function f(P,q,K){var X=u(P,q,K);return X[1].v=P.read_shift(2,"i"),X}function p(P,q,K){var X=St(7);return X.write_shift(1,255),X.write_shift(2,q),X.write_shift(2,P),X.write_shift(2,K,"i"),X}function h(P,q,K){var X=u(P,q,K);return X[1].v=P.read_shift(8,"f"),X}function g(P,q,K){var X=St(13);return X.write_shift(1,255),X.write_shift(2,q),X.write_shift(2,P),X.write_shift(8,K,"f"),X}function m(P,q,K){var X=P.l+q,te=u(P,q,K);if(te[1].v=P.read_shift(8,"f"),K.qpro)P.l=X;else{var le=P.read_shift(2);E(P.slice(P.l,P.l+le),te),P.l+=le}return te}function w(P,q,K){var X=q&32768;return q&=-32769,q=(X?P:0)+(q>=8192?q-16384:q),(X?"":"$")+(K?Et(q):Ot(q))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(P,q){Pt(P,0);for(var K=[],X=0,te="",le="",fe="",de="";P.l<P.length;){var ie=P[P.l++];switch(ie){case 0:K.push(P.read_shift(8,"f"));break;case 1:le=w(q[0].c,P.read_shift(2),!0),te=w(q[0].r,P.read_shift(2),!1),K.push(le+te);break;case 2:{var xe=w(q[0].c,P.read_shift(2),!0),z=w(q[0].r,P.read_shift(2),!1);le=w(q[0].c,P.read_shift(2),!0),te=w(q[0].r,P.read_shift(2),!1),K.push(xe+z+":"+le+te)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(P.read_shift(2));break;case 6:{for(var Pe="";ie=P[P.l++];)Pe+=String.fromCharCode(ie);K.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:de=K.pop(),fe=K.pop(),K.push(["AND","OR"][ie-20]+"("+fe+","+de+")");break;default:if(ie<32&&C[ie])de=K.pop(),fe=K.pop(),K.push(fe+C[ie]+de);else if(v[ie]){if(X=v[ie][1],X==69&&(X=P[P.l++]),X>K.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+K.join("|")+"|");return}var _e=K.slice(-X);K.length-=X,K.push(v[ie][0]+"("+_e.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}K.length==1?q[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function R(P){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=P.read_shift(2),q[3]=P[P.l++],q[0].c=P[P.l++],q}function S(P,q){var K=R(P);return K[1].t="s",K[1].v=P.read_shift(q-4,"cstr"),K}function b(P,q,K,X){var te=St(6+X.length);te.write_shift(2,P),te.write_shift(1,K),te.write_shift(1,q),te.write_shift(1,39);for(var le=0;le<X.length;++le){var fe=X.charCodeAt(le);te.write_shift(1,fe>=128?95:fe)}return te.write_shift(1,0),te}function T(P,q){var K=R(P);K[1].v=P.read_shift(2);var X=K[1].v>>1;if(K[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return K[1].v=X,K}function A(P,q){var K=R(P),X=P.read_shift(4),te=P.read_shift(4),le=P.read_shift(2);if(le==65535)return X===0&&te===3221225472?(K[1].t="e",K[1].v=15):X===0&&te===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var fe=le&32768;return le=(le&32767)-16446,K[1].v=(1-fe*2)*(te*Math.pow(2,le+32)+X*Math.pow(2,le)),K}function N(P,q,K,X){var te=St(14);if(te.write_shift(2,P),te.write_shift(1,K),te.write_shift(1,q),X==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var le=0,fe=0,de=0,ie=0;return X<0&&(le=1,X=-X),fe=Math.log2(X)|0,X/=Math.pow(2,fe-31),ie=X>>>0,ie&2147483648||(X/=2,++fe,ie=X>>>0),X-=ie,ie|=2147483648,ie>>>=0,X*=Math.pow(2,32),de=X>>>0,te.write_shift(4,de),te.write_shift(4,ie),fe+=16383+(le?32768:0),te.write_shift(2,fe),te}function y(P,q){var K=A(P);return P.l+=q-14,K}function D(P,q){var K=R(P),X=P.read_shift(4);return K[1].v=X>>6,K}function L(P,q){var K=R(P),X=P.read_shift(8,"f");return K[1].v=X,K}function M(P,q){var K=L(P);return P.l+=q-10,K}function F(P,q){return P[P.l+q-1]==0?P.read_shift(q,"cstr"):""}function B(P,q){var K=P[P.l++];K>q-1&&(K=q-1);for(var X="";X.length<K;)X+=String.fromCharCode(P[P.l++]);return X}function H(P,q,K){if(!(!K.qpro||q<21)){var X=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var te=P.read_shift(q-21,"cstr");return[X,te]}}function G(P,q){for(var K={},X=P.l+q;P.l<X;){var te=P.read_shift(2);if(te==14e3){for(K[te]=[0,""],K[te][0]=P.read_shift(2);P[P.l];)K[te][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return K}function _(P,q){var K=St(5+P.length);K.write_shift(2,14e3),K.write_shift(2,q);for(var X=0;X<P.length;++X){var te=P.charCodeAt(X);K[K.l++]=te>127?95:te}return K[K.l++]=0,K}var Z={0:{n:"BOF",f:Ct},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:h},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:F},222:{n:"SHEETNAMELP",f:B},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:y},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:F},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:H},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function sE(e){var t={},r=e.match(zt),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=De(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;t.cp=Yl[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return t}var lE=function(){var e=Xa("t"),t=Xa("rPr");function r(o){var s=o.match(e);if(!s)return{t:"s",v:""};var l={t:"s",v:Ze(s[1])},i=o.match(t);return i&&(l.s=sE(i[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),iE=function(){var t=/(\r\n|\n)/g;function r(a,o,s){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),o.push('<span style="'+l.join("")+'">'),a.b&&(o.push("<b>"),s.push("</b>")),a.i&&(o.push("<i>"),s.push("</i>")),a.strike&&(o.push("<s>"),s.push("</s>"));var i=a.valign||"";return i=="superscript"||i=="super"?i="sup":i=="subscript"&&(i="sub"),i!=""&&(o.push("<"+i+">"),s.push("</"+i+">")),s.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(t,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),cE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uE=/<(?:\w+:)?r>/,dE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fi(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ze(st(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=st(e),r&&(n.h=ri(n.t))):e.match(uE)&&(n.r=st(e),n.t=Ze(st((e.replace(dE,"").match(cE)||[]).join("").replace(zt,""))),r&&(n.h=iE(lE(n.r)))),n):{t:""}}var fE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hE=/<(?:\w+:)?(?:si|sstItem)>/g,gE=/<\/(?:\w+:)?(?:si|sstItem)>/;function pE(e,t){var r=[],n="";if(!e)return r;var a=e.match(fE);if(a){n=a[2].replace(hE,"").split(gE);for(var o=0;o!=n.length;++o){var s=fi(n[o].trim(),t);s!=null&&(r[r.length]=s)}a=De(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function xE(e){return[e.read_shift(4),e.read_shift(4)]}function mE(e,t){var r=[],n=!1;return Zr(e,function(o,s,l){switch(l){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function zd(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Kr(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function vE(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Kr(e,4),t.U=Kr(e,4),t.W=Kr(e,4),t}function wE(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=o,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function CE(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(wE(e));return t}function bE(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function SE(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Kr(e,4),t.U=Kr(e,4),t.W=Kr(e,4),t}function kE(e){var t=SE(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function jd(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Wd(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function EE(e){var t=Kr(e);switch(t.Minor){case 2:return[t.Minor,TE(e)];case 3:return[t.Minor,yE()];case 4:return[t.Minor,_E(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function TE(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=jd(e,r),a=Wd(e,e.length-e.l);return{t:"Std",h:n,v:a}}function yE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _E(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(zt,function(o){var s=De(o);switch(Br(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=s[l]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function FE(e,t){var r={},n=r.EncryptionVersionInfo=Kr(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=jd(e,a),t-=a,r.EncryptionVerifier=Wd(e,t),r}function IE(e){var t={},r=t.EncryptionVersionInfo=Kr(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function PE(e){var t=0,r,n=zd(e),a=n.length+1,o,s,l,i,u;for(r=pn(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)s=r[o],l=t&16384?1:0,i=t<<1&32767,u=l|i,t=u^s;return t^52811}var Kd=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,l){return n(s^l)},o=function(s){for(var l=t[s.length-1],i=104,u=s.length-1;u>=0;--u)for(var c=s[u],d=0;d!=7;++d)c&64&&(l^=r[i]),c*=2,--i;return l};return function(s){for(var l=zd(s),i=o(l),u=l.length,c=pn(16),d=0;d!=16;++d)c[d]=0;var f,p,h;for((u&1)===1&&(f=i>>8,c[u]=a(e[0],f),--u,f=i&255,p=l[l.length-1],c[u]=a(p,f));u>0;)--u,f=i>>8,c[u]=a(l[u],f),--u,f=i&255,c[u]=a(l[u],f);for(u=15,h=15-l.length;h>0;)f=i>>8,c[u]=a(e[h],f),--u,--h,f=i&255,c[u]=a(l[u],f),--u,--h;return c}}(),AE=function(e,t,r,n,a){a||(a=t),n||(n=Kd(e));var o,s;for(o=0;o!=t.length;++o)s=t[o],s^=n[r],s=(s>>5|s<<3)&255,a[o]=s,++r;return[a,r,n]},ME=function(e){var t=0,r=Kd(e);return function(n){var a=AE("",n,t,r);return t=a[1],a[0]}};function DE(e,t,r,n){var a={key:Ct(e),verificationBytes:Ct(e)};return r.password&&(a.verifier=PE(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=ME(r.password)),a}function OE(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=IE(e):n.Data=FE(e,t),n}function RE(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?OE(e,t-2,n):DE(e,r.biff>=8?t:t-2,r,n),n}var LE=function(){function e(a,o){switch(o.type){case"base64":return t(sr(a),o);case"binary":return t(a,o);case"buffer":return t(Xe&&Buffer.isBuffer(a)?a.toString("binary"):Vn(a),o);case"array":return t(On(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){var s=o||{},l=s.dense?[]:{},i=a.match(/\\trowd.*?\\row\b/g);if(!i.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:i.length-1}};return i.forEach(function(c,d){Array.isArray(l)&&(l[d]=[]);for(var f=/\\\w+\b/g,p=0,h,g=-1;h=f.exec(c);){switch(h[0]){case"\\cell":var m=c.slice(p,f.lastIndex-h[0].length);if(m[0]==" "&&(m=m.slice(1)),++g,m.length){var w={v:m,t:"s"};Array.isArray(l)?l[d][g]=w:l[Be({r:d,c:g})]=w}break}p=f.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=qe(u),l}function r(a,o){return Cn(e(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],s=xt(a["!ref"]),l,i=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){o.push("\\trowd\\trautofit1");for(var c=s.s.c;c<=s.e.c;++c)o.push("\\cellx"+(c+1));for(o.push("\\pard\\intbl"),c=s.s.c;c<=s.e.c;++c){var d=Be({r:u,c});l=i?(a[u]||[])[c]:a[d],!(!l||l.v==null&&(!l.f||l.F))&&(o.push(" "+(l.w||(Xr(l),l.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function NE(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Za(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function BE(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),o=Math.min(t,r,n),s=a-o;if(s===0)return[0,0,t];var l=0,i=0,u=a+o;switch(i=s/(u>1?2-u:u),a){case t:l=((r-n)/s+6)%6;break;case r:l=(n-t)/s+2;break;case n:l=(t-r)/s+4;break}return[l/6,i,u/2]}function HE(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),o=n-a/2,s=[o,o,o],l=6*t,i;if(r!==0)switch(l|0){case 0:case 6:i=a*l,s[0]+=a,s[1]+=i;break;case 1:i=a*(2-l),s[0]+=i,s[1]+=a;break;case 2:i=a*(l-2),s[1]+=a,s[2]+=i;break;case 3:i=a*(4-l),s[1]+=i,s[2]+=a;break;case 4:i=a*(l-4),s[2]+=a,s[0]+=i;break;case 5:i=a*(6-l),s[2]+=i,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function rs(e,t){if(t===0)return e;var r=BE(NE(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Za(HE(r))}var Xd=6,$E=15,VE=1,qt=Xd;function ns(e){return Math.floor((e+Math.round(128/qt)/256)*qt)}function as(e){return Math.floor((e-5)/qt*100+.5)/100}function ul(e){return Math.round((e*qt+5)/qt*256)/256}function Gs(e){return ul(as(ns(e)))}function hi(e){var t=Math.abs(e-Gs(e)),r=qt;if(t>.005)for(qt=VE;qt<$E;++qt)Math.abs(e-Gs(e))<=t&&(t=Math.abs(e-Gs(e)),r=qt);qt=r}function ga(e){e.width?(e.wpx=ns(e.width),e.wch=as(e.wpx),e.MDW=qt):e.wpx?(e.wch=as(e.wpx),e.width=ul(e.wch),e.MDW=qt):typeof e.wch=="number"&&(e.width=ul(e.wch),e.wpx=ns(e.width),e.MDW=qt),e.customWidth&&delete e.customWidth}var GE=96,Yd=GE;function qd(e){return e*96/Yd}function Qa(e){return e*Yd/96}var UE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zE(e,t,r,n){t.Borders=[];var a={},o=!1;(e[0].match(zt)||[]).forEach(function(s){var l=De(s);switch(Br(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=dt(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=dt(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in borders")}})}function jE(e,t,r,n){t.Fills=[];var a={},o=!1;(e[0].match(zt)||[]).forEach(function(s){var l=De(s);switch(Br(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fills")}})}function WE(e,t,r,n){t.Fonts=[];var a={},o=!1;(e[0].match(zt)||[]).forEach(function(s){var l=De(s);switch(Br(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=st(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?dt(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?dt(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?dt(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?dt(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?dt(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?dt(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?dt(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Yl[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=dt(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var i=Pn[a.color.index];a.color.index==81&&(i=Pn[1]),i||(i=Pn[1]),a.color.rgb=i[0].toString(16)+i[1].toString(16)+i[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=rs(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fonts")}})}function KE(e,t,r){t.NumberFmt=[];for(var n=Lr(Ge),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ge[n[a]];var o=e[0].match(zt);if(o)for(a=0;a<o.length;++a){var s=De(o[a]);switch(Br(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Ze(st(s.formatCode)),i=parseInt(s.numFmtId,10);if(t.NumberFmt[i]=l,i>0){if(i>392){for(i=392;i>60&&t.NumberFmt[i]!=null;--i);t.NumberFmt[i]=l}In(l,i)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var Io=["numFmtId","fillId","fontId","borderId","xfId"],Po=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function XE(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(zt)||[]).forEach(function(o){var s=De(o),l=0;switch(Br(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],l=0;l<Io.length;++l)n[Io[l]]&&(n[Io[l]]=parseInt(n[Io[l]],10));for(l=0;l<Po.length;++l)n[Po[l]]&&(n[Po[l]]=dt(n[Po[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var i={};s.vertical&&(i.vertical=s.vertical),s.horizontal&&(i.horizontal=s.horizontal),s.textRotation!=null&&(i.textRotation=s.textRotation),s.indent&&(i.indent=s.indent),s.wrapText&&(i.wrapText=dt(s.wrapText)),n.alignment=i;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var YE=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,i,u){var c={};if(!l)return c;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=l.match(t))&&KE(d,c,u),(d=l.match(a))&&WE(d,c,i,u),(d=l.match(n))&&jE(d,c,i,u),(d=l.match(o))&&zE(d,c,i,u),(d=l.match(r))&&XE(d,c,u),c}}();function qE(e,t){var r=e.read_shift(2),n=Vt(e);return[r,n]}function ZE(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=lS(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=e.read_shift(2);switch(o===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var l=e.read_shift(1);l>0&&(n.family=l);var i=e.read_shift(1);switch(i>0&&(n.charset=i),e.l++,n.color=sS(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vt(e),n}var QE=Gt;function JE(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var eT=Gt;function tT(e,t,r){var n={};n.NumberFmt=[];for(var a in Ge)n.NumberFmt[a]=Ge[a];n.CellXf=[],n.Fonts=[];var o=[],s=!1;return Zr(e,function(i,u,c){switch(c){case 44:n.NumberFmt[i[0]]=i[1],In(i[1],i[0]);break;case 43:n.Fonts.push(i),i.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=rs(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(i);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(c),s=!0;break;case 38:o.pop(),s=!1;break;default:if(u.T>0)o.push(c);else if(u.T<0)o.pop();else if(!s||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}var rT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function nT(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(zt)||[]).forEach(function(a){var o=De(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(t.themeElements.clrScheme[rT.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function aT(){}function oT(){}var sT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,iT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function cT(e,t,r){t.themeElements={};var n;[["clrScheme",sT,nT],["fontScheme",lT,aT],["fmtScheme",iT,oT]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var uT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Zd(e,t){(!e||e.length===0)&&(e=dT());var r,n={};if(!(r=e.match(uT)))throw new Error("themeElements not found in theme");return cT(r[0],n,t),n.raw=e,n}function dT(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[id];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function fT(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var o=e.slice(e.l);e.l=n;var s;try{s=ld(o,{type:"array"})}catch{return}var l=or(s,"theme/theme/theme1.xml",!0);if(l)return Zd(l,r)}}function hT(e){return e.read_shift(4)}function gT(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=pT(e,4);break;case 2:t.xclrValue=Nd(e);break;case 3:t.xclrValue=hT(e);break;case 4:e.l+=4;break}return e.l+=8,t}function pT(e,t){return Gt(e,t)}function xT(e,t){return Gt(e,t)}function mT(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=gT(e);break;case 6:n[1]=xT(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function vT(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(mT(e,r-e.l));return{ixfe:n,ext:o}}function wT(e,t){t.forEach(function(r){switch(r[0]){}})}function CT(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Vt(e)}}function bT(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function ST(e){return e.l+=4,e.read_shift(4)!=0}function kT(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],s=!1,l=2;return Zr(e,function(i,u,c){switch(c){case 335:n.Types.push({name:i.name});break;case 51:i.forEach(function(d){l==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):l==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:l=i?1:0;break;case 338:l=2;break;case 35:o.push(c),s=!0;break;case 36:o.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function ET(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,o=2,s;return e.replace(zt,function(l){var i=De(l);switch(Br(i[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:i.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==i.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[i.t-1].name,index:+i.v}):o==0&&n.Value.push({type:n.Types[i.t-1].name,index:+i.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+i.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+i[0]+" in metadata")}return l}),n}function TT(e){var t=[];if(!e)return t;var r=1;return(e.match(zt)||[]).forEach(function(n){var a=De(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function yT(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Be(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function _T(e,t,r){var n=[];return Zr(e,function(o,s,l){switch(l){case 63:n.push(o);break;default:if(!s.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function FT(e,t,r,n){if(!e)return e;var a=n||{},o=!1;Zr(e,function(l,i,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!i.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function IT(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function ru(e,t,r,n){var a=Array.isArray(e),o;t.forEach(function(s){var l=Zt(s.ref);if(a?(e[l.r]||(e[l.r]=[]),o=e[l.r][l.c]):o=e[s.ref],!o){o={t:"z"},a?e[l.r][l.c]=o:e[s.ref]=o;var i=xt(e["!ref"]||"BDWGO1000001:A1");i.s.r>l.r&&(i.s.r=l.r),i.e.r<l.r&&(i.e.r=l.r),i.s.c>l.c&&(i.s.c=l.c),i.e.c<l.c&&(i.e.c=l.c);var u=qe(i);u!==e["!ref"]&&(e["!ref"]=u)}o.c||(o.c=[]);var c={a:s.author,t:s.t,r:s.r,T:r};s.h&&(c.h=s.h);for(var d=o.c.length-1;d>=0;--d){if(!r&&o.c[d].T)return;r&&!o.c[d].T&&o.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(c.a==n[d].id){c.a=n[d].name||c.a;break}}o.c.push(c)})}function PT(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var i=De(l[0]),u={author:i.authorId&&r[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},c=Zt(i.ref);if(!(t.sheetRows&&t.sheetRows<=c.r)){var d=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!d&&!!d[1]&&fi(d[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),n.push(u)}}}}),n}function AT(e,t){var r=[],n=!1,a={},o=0;return e.replace(zt,function(l,i){var u=De(l);switch(Br(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=i+l.length;break;case"</text>":a.t=e.slice(o,i).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function MT(e,t){var r=[],n=!1;return e.replace(zt,function(o){var s=De(o);switch(Br(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return o}),r}function DT(e){var t={};t.iauthor=e.read_shift(4);var r=Un(e);return t.rfx=r.s,t.ref=Be(r.s),e.l+=16,t}var OT=Vt;function RT(e,t){var r=[],n=[],a={},o=!1;return Zr(e,function(l,i,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!i.T){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var LT="application/vnd.ms-office.vbaProject";function NT(e){var t=Ye.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ye.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ye.write(t)}function BT(){return{"!type":"dialog"}}function HT(){return{"!type":"dialog"}}function $T(){return{"!type":"macro"}}function VT(){return{"!type":"macro"}}var ca=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,o,s){var l=!1,i=!1;o.length==0?i=!0:o.charAt(0)=="["&&(i=!0,o=o.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var u=o.length>0?parseInt(o,10)|0:0,c=s.length>0?parseInt(s,10)|0:0;return l?c+=t.c:--c,i?u+=t.r:--u,a+(l?"":"$")+Et(c)+(i?"":"$")+Ot(u)}return function(a,o){return t=o,a.replace(e,r)}}(),Qd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,GT=function(){return function(t,r){return t.replace(Qd,function(n,a,o,s,l,i){var u=si(s)-(o?0:r.c),c=oi(i)-(l?0:r.r),d=c==0?"":l?c+1:"["+c+"]",f=u==0?"":o?u+1:"["+u+"]";return a+"R"+d+"C"+f})}}();function Jd(e,t){return e.replace(Qd,function(r,n,a,o,s,l){return n+(a=="$"?a+o:Et(si(o)+t.c))+(s=="$"?s+l:Ot(oi(l)+t.r))})}function UT(e,t,r){var n=wa(t),a=n.s,o=Zt(r),s={r:o.r-a.r,c:o.c-a.c};return Jd(e,s)}function zT(e){return e.length!=1}function nu(e){return e.replace(/_xlfn\./g,"")}function vt(e){e.l+=1}function xn(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function ef(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return tf(e);r.biff==12&&(n=4)}var a=e.read_shift(n),o=e.read_shift(n),s=xn(e,2),l=xn(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:l[0],cRel:l[1],rRel:l[2]}}}function tf(e){var t=xn(e,2),r=xn(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function jT(e,t,r){if(r.biff<8)return tf(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),o=xn(e,2),s=xn(e,2);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function rf(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return WT(e);var n=e.read_shift(r&&r.biff==12?4:2),a=xn(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function WT(e){var t=xn(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function KT(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function XT(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return YT(e);var a=e.read_shift(n>=12?4:2),o=e.read_shift(2),s=(o&16384)>>14,l=(o&32768)>>15;if(o&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:s,rRel:l}}function YT(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function qT(e,t,r){var n=(e[e.l++]&96)>>5,a=ef(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function ZT(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var s=ef(e,o,r);return[n,a,s]}function QT(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function JT(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[n,a]}function ey(e,t,r){var n=(e[e.l++]&96)>>5,a=jT(e,t-1,r);return[n,a]}function ty(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function au(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function ry(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function ny(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function ay(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function oy(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function sy(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function nf(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function ly(e){return e.read_shift(2),nf(e)}function iy(e){return e.read_shift(2),nf(e)}function cy(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=rf(e,0,r);return[n,a]}function uy(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=XT(e,0,r);return[n,a]}function dy(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var o=rf(e,0,r);return[n,a,o]}function fy(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[h_[a],sf[a],n]}function hy(e,t,r){var n=e[e.l++],a=e.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:gy(e);return[a,(o[0]===0?sf:f_)[o[1]]]}function gy(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function py(e,t,r){e.l+=r&&r.biff==2?3:4}function xy(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function my(e){return e.l++,zn[e.read_shift(1)]}function vy(e){return e.l++,e.read_shift(2)}function wy(e){return e.l++,e.read_shift(1)!==0}function Cy(e){return e.l++,Ht(e)}function by(e,t,r){return e.l++,co(e,t-1,r)}function Sy(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=mt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ht(e);break;case 2:r[1]=jn(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ky(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?Un:ks)(e));return a}function Ey(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,s=[];o!=n&&(s[o]=[]);++o)for(var l=0;l!=a;++l)s[o][l]=Sy(e,r.biff);return s}function Ty(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,o]}function yy(e,t,r){if(r.biff==5)return _y(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[n,a,o]}function _y(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Fy(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Iy(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Py(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Ay(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[n,a]}var My=Gt,Dy=Gt,Oy=Gt;function fo(e,t,r){return e.l+=2,[KT(e)]}function gi(e){return e.l+=6,[]}var Ry=fo,Ly=gi,Ny=gi,By=fo;function af(e){return e.l+=2,[Ct(e),e.read_shift(2)&1]}var Hy=fo,$y=af,Vy=gi,Gy=fo,Uy=fo,zy=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jy(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),s=zy[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:o}}function Wy(e){return e.l+=2,[e.read_shift(4)]}function Ky(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Xy(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Yy(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function qy(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Zy(e){return e.l+=4,[0,0]}var ou={1:{n:"PtgExp",f:xy},2:{n:"PtgTbl",f:Oy},3:{n:"PtgAdd",f:vt},4:{n:"PtgSub",f:vt},5:{n:"PtgMul",f:vt},6:{n:"PtgDiv",f:vt},7:{n:"PtgPower",f:vt},8:{n:"PtgConcat",f:vt},9:{n:"PtgLt",f:vt},10:{n:"PtgLe",f:vt},11:{n:"PtgEq",f:vt},12:{n:"PtgGe",f:vt},13:{n:"PtgGt",f:vt},14:{n:"PtgNe",f:vt},15:{n:"PtgIsect",f:vt},16:{n:"PtgUnion",f:vt},17:{n:"PtgRange",f:vt},18:{n:"PtgUplus",f:vt},19:{n:"PtgUminus",f:vt},20:{n:"PtgPercent",f:vt},21:{n:"PtgParen",f:vt},22:{n:"PtgMissArg",f:vt},23:{n:"PtgStr",f:by},26:{n:"PtgSheet",f:Ky},27:{n:"PtgEndSheet",f:Xy},28:{n:"PtgErr",f:my},29:{n:"PtgBool",f:wy},30:{n:"PtgInt",f:vy},31:{n:"PtgNum",f:Cy},32:{n:"PtgArray",f:ty},33:{n:"PtgFunc",f:fy},34:{n:"PtgFuncVar",f:hy},35:{n:"PtgName",f:Ty},36:{n:"PtgRef",f:cy},37:{n:"PtgArea",f:qT},38:{n:"PtgMemArea",f:Fy},39:{n:"PtgMemErr",f:My},40:{n:"PtgMemNoMem",f:Dy},41:{n:"PtgMemFunc",f:Iy},42:{n:"PtgRefErr",f:Py},43:{n:"PtgAreaErr",f:QT},44:{n:"PtgRefN",f:uy},45:{n:"PtgAreaN",f:ey},46:{n:"PtgMemAreaN",f:Yy},47:{n:"PtgMemNoMemN",f:qy},57:{n:"PtgNameX",f:yy},58:{n:"PtgRef3d",f:dy},59:{n:"PtgArea3d",f:ZT},60:{n:"PtgRefErr3d",f:Ay},61:{n:"PtgAreaErr3d",f:JT},255:{}},Qy={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Jy={1:{n:"PtgElfLel",f:af},2:{n:"PtgElfRw",f:Gy},3:{n:"PtgElfCol",f:Ry},6:{n:"PtgElfRwV",f:Uy},7:{n:"PtgElfColV",f:By},10:{n:"PtgElfRadical",f:Hy},11:{n:"PtgElfRadicalS",f:Vy},13:{n:"PtgElfColS",f:Ly},15:{n:"PtgElfColSV",f:Ny},16:{n:"PtgElfRadicalLel",f:$y},25:{n:"PtgList",f:jy},29:{n:"PtgSxName",f:Wy},255:{}},e_={0:{n:"PtgAttrNoop",f:Zy},1:{n:"PtgAttrSemi",f:sy},2:{n:"PtgAttrIf",f:ay},4:{n:"PtgAttrChoose",f:ry},8:{n:"PtgAttrGoto",f:ny},16:{n:"PtgAttrSum",f:py},32:{n:"PtgAttrBaxcel",f:au},33:{n:"PtgAttrBaxcel",f:au},64:{n:"PtgAttrSpace",f:ly},65:{n:"PtgAttrSpaceSemi",f:iy},128:{n:"PtgAttrIfError",f:oy},255:{}};function ho(e,t,r,n){if(n.biff<8)return Gt(e,t);for(var a=e.l+t,o=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=Ey(e,0,n),o.push(r[s][1]);break;case"PtgMemArea":r[s][2]=ky(e,r[s][1],n),o.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),o.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&o.push(Gt(e,t)),o}function go(e,t,r){for(var n=e.l+t,a,o,s=[];n!=e.l;)t=n-e.l,o=e[e.l],a=ou[o]||ou[Qy[o]],(o===24||o===25)&&(a=(o===24?Jy:e_)[e[e.l+1]]),!a||!a.f?Gt(e,t):s.push([a.n,a.f(e,t,r)]);return s}function t_(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],o=0;o<n.length;++o){var s=n[o];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var r_={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function n_(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function of(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function su(e,t,r){var n=of(e,t,r);return n=="#REF"?n:n_(n,r)}function Bt(e,t,r,n,a){var o=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},l=[],i,u,c,d=0,f=0,p,h="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",w=0,v=e[0].length;w<v;++w){var C=e[0][w];switch(C[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=pt(" ",e[0][g][1][1]);break;case 1:m=pt("\r",e[0][g][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+m,g=-1}l.push(u+r_[C[0]]+i);break;case"PtgIsect":i=l.pop(),u=l.pop(),l.push(u+" "+i);break;case"PtgUnion":i=l.pop(),u=l.pop(),l.push(u+","+i);break;case"PtgRange":i=l.pop(),u=l.pop(),l.push(u+":"+i);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=Ra(C[1][1],s,a),l.push(La(c,o));break;case"PtgRefN":c=r?Ra(C[1][1],r,a):C[1][1],l.push(La(c,o));break;case"PtgRef3d":d=C[1][1],c=Ra(C[1][2],s,a),h=su(n,d,a),l.push(h+"!"+La(c,o));break;case"PtgFunc":case"PtgFuncVar":var E=C[1][0],R=C[1][1];E||(E=0),E&=127;var S=E==0?[]:l.slice(-E);l.length-=E,R==="User"&&(R=S.shift()),l.push(R+"("+S.join(",")+")");break;case"PtgBool":l.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(C[1]);break;case"PtgNum":l.push(String(C[1]));break;case"PtgStr":l.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(C[1]);break;case"PtgAreaN":p=$c(C[1][1],r?{s:r}:s,a),l.push($s(p,a));break;case"PtgArea":p=$c(C[1][1],s,a),l.push($s(p,a));break;case"PtgArea3d":d=C[1][1],p=C[1][2],h=su(n,d,a),l.push(h+"!"+$s(p,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=C[1][2];var b=(n.names||[])[f-1]||(n[0]||[])[f],T=b?b.Name:"SH33TJSNAME"+String(f);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),l.push(T);break;case"PtgNameX":var A=C[1][1];f=C[1][2];var N;if(a.biff<=5)A<0&&(A=-A),n[A]&&(N=n[A][f]);else{var y="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][f]&&n[A][f].itab>0&&(y=n.SheetNames[n[A][f].itab-1]+"!"):y=n.SheetNames[f-1]+"!"),n[A]&&n[A][f])y+=n[A][f].Name;else if(n[0]&&n[0][f])y+=n[0][f].Name;else{var D=(of(n,A,a)||"").split(";;");D[f-1]?y=D[f-1]:y+="SH33TJSERRX"}l.push(y);break}N||(N={Name:"SH33TJSERRY"}),l.push(N.Name);break;case"PtgParen":var L="(",M=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:L=pt(" ",e[0][g][1][1])+L;break;case 3:L=pt("\r",e[0][g][1][1])+L;break;case 4:M=pt(" ",e[0][g][1][1])+M;break;case 5:M=pt("\r",e[0][g][1][1])+M;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(L+l.pop()+M);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":c={c:C[1][1],r:C[1][0]};var F={c:r.c,r:r.r};if(n.sharedf[Be(c)]){var B=n.sharedf[Be(c)];l.push(Bt(B,s,F,n,a))}else{var H=!1;for(i=0;i!=n.arrayf.length;++i)if(u=n.arrayf[i],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){l.push(Bt(u[1],s,F,n,a)),H=!0;break}H||l.push(C[1])}break;case"PtgArray":l.push("{"+t_(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var G=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&G.indexOf(e[0][w][0])==-1){C=e[0][g];var _=!0;switch(C[1][0]){case 4:_=!1;case 0:m=pt(" ",C[1][1]);break;case 5:_=!1;case 1:m=pt("\r",C[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}l.push((_?m:"")+l.pop()+(_?"":m)),g=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function a_(e,t,r){var n=e.l+t,a=r.biff==2?1:2,o,s=e.read_shift(a);if(s==65535)return[[],Gt(e,t-2)];var l=go(e,s,r);return t!==s+a&&(o=ho(e,t-s-a,l,r)),e.l=n,[l,o]}function o_(e,t,r){var n=e.l+t,a=r.biff==2?1:2,o,s=e.read_shift(a);if(s==65535)return[[],Gt(e,t-2)];var l=go(e,s,r);return t!==s+a&&(o=ho(e,t-s-a,l,r)),e.l=n,[l,o]}function s_(e,t,r,n){var a=e.l+t,o=go(e,n,r),s;return a!==e.l&&(s=ho(e,a-e.l,o,r)),[o,s]}function l_(e,t,r){var n=e.l+t,a,o=e.read_shift(2),s=go(e,o,r);return o==65535?[[],Gt(e,t-2)]:(t!==o+2&&(a=ho(e,n-o-2,s,r)),[s,a])}function i_(e){var t;if(Ur(e,e.l+6)!==65535)return[Ht(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Us(e,t,r){var n=e.l+t,a=Hr(e);r.biff==2&&++e.l;var o=i_(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=o_(e,n-e.l,r);return{cell:a,val:o[0],formula:l,shared:s>>3&1,tt:o[1]}}function Es(e,t,r){var n=e.read_shift(4),a=go(e,n,r),o=e.read_shift(4),s=o>0?ho(e,o,a,r):null;return[a,s]}var c_=Es,Ts=Es,u_=Es,d_=Es,f_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},sf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},h_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function lu(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zs(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var $a={},ua={};function Va(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function lf(e,t,r,n,a,o){try{n.cellNF&&(e.z=Ge[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=_t(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ge[t]==null&&In(pb[t]||"General",t),e.t==="e")e.w=e.w||zn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ka(e.v);else if(e.t==="d"){var s=Jt(e.v);(s|0)===s?e.w=s.toString(10):e.w=Ka(s)}else{if(e.v===void 0)return"";e.w=Dn(e.v,ua)}else e.t==="d"?e.w=hr(t,Jt(e.v),ua):e.w=hr(t,e.v,ua)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rs(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rs(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&o.Fills)throw l}}}function g_(e,t){var r=xt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=qe(r))}var p_=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,x_=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,m_=/<(?:\w:)?hyperlink [^>]*>/mg,v_=/"(\w*:\w*)"/,w_=/<(?:\w:)?col\b[^>]*[\/]?>/g,C_=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,b_=/<(?:\w:)?pageMargins[^>]*\/>/g,cf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,S_=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,k_=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function E_(e,t,r,n,a,o,s){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},i={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",c="",d=e.match(x_);d?(u=e.slice(0,d.index),c=e.slice(d.index+d[0].length)):u=c=e;var f=u.match(cf);f?pi(f[0],l,a,r):(f=u.match(S_))&&T_(f[0],f[1]||"",l,a,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var h=u.slice(p,p+50).match(v_);h&&g_(l,h[1])}var g=u.match(k_);g&&g[1]&&A_(g[1],a);var m=[];if(t.cellStyles){var w=u.match(w_);w&&F_(m,w)}d&&M_(d[1],l,t,i,o,s);var v=c.match(C_);v&&(l["!autofilter"]=I_(v[0]));var C=[],E=c.match(p_);if(E)for(p=0;p!=E.length;++p)C[p]=xt(E[p].slice(E[p].indexOf('"')+1));var R=c.match(m_);R&&y_(l,R,n);var S=c.match(b_);if(S&&(l["!margins"]=__(De(S[0]))),!l["!ref"]&&i.e.c>=i.s.c&&i.e.r>=i.s.r&&(l["!ref"]=qe(i)),t.sheetRows>0&&l["!ref"]){var b=xt(l["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>i.e.r&&(b.e.r=i.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>i.e.c&&(b.e.c=i.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),l["!fullref"]=l["!ref"],l["!ref"]=qe(b))}return m.length>0&&(l["!cols"]=m),C.length>0&&(l["!merges"]=C),l}function pi(e,t,r,n){var a=De(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ze(st(a.codeName)))}function T_(e,t,r,n,a){pi(e.slice(0,e.indexOf(">")),r,n,a)}function y_(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var o=De(st(t[a]),!0);if(!o.ref)return;var s=((r||{})["!id"]||[])[o.id];s?(o.Target=s.Target,o.location&&(o.Target+="#"+Ze(o.location))):(o.Target="#"+Ze(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var l=xt(o.ref),i=l.s.r;i<=l.e.r;++i)for(var u=l.s.c;u<=l.e.c;++u){var c=Be({c:u,r:i});n?(e[i]||(e[i]=[]),e[i][u]||(e[i][u]={t:"z",v:void 0}),e[i][u].l=o):(e[c]||(e[c]={t:"z",v:void 0}),e[c].l=o)}}}function __(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function F_(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=De(t[n],!0);a.hidden&&(a.hidden=dt(a.hidden));var o=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,hi(a.width)),ga(a);o<=s;)e[o++]=Dt(a)}}function I_(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var P_=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function A_(e,t){t.Views||(t.Views=[{}]),(e.match(P_)||[]).forEach(function(r,n){var a=De(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),dt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var M_=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Xa("v"),s=Xa("f");return function(i,u,c,d,f,p){for(var h=0,g="",m=[],w=[],v=0,C=0,E=0,R="",S,b,T=0,A=0,N,y,D=0,L=0,M=Array.isArray(p.CellXf),F,B=[],H=[],G=Array.isArray(u),_=[],Z={},ee=!1,P=!!c.sheetStubs,q=i.split(t),K=0,X=q.length;K!=X;++K){g=q[K].trim();var te=g.length;if(te!==0){var le=0;e:for(h=0;h<te;++h)switch(g[h]){case">":if(g[h-1]!="/"){++h;break e}if(c&&c.cellStyles){if(b=De(g.slice(le,h),!0),T=b.r!=null?parseInt(b.r,10):T+1,A=-1,c.sheetRows&&c.sheetRows<T)continue;Z={},ee=!1,b.ht&&(ee=!0,Z.hpt=parseFloat(b.ht),Z.hpx=Qa(Z.hpt)),b.hidden=="1"&&(ee=!0,Z.hidden=!0),b.outlineLevel!=null&&(ee=!0,Z.level=+b.outlineLevel),ee&&(_[T-1]=Z)}break;case"<":le=h;break}if(le>=h)break;if(b=De(g.slice(le,h),!0),T=b.r!=null?parseInt(b.r,10):T+1,A=-1,!(c.sheetRows&&c.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),c&&c.cellStyles&&(Z={},ee=!1,b.ht&&(ee=!0,Z.hpt=parseFloat(b.ht),Z.hpx=Qa(Z.hpt)),b.hidden=="1"&&(ee=!0,Z.hidden=!0),b.outlineLevel!=null&&(ee=!0,Z.level=+b.outlineLevel),ee&&(_[T-1]=Z)),m=g.slice(h).split(e);for(var fe=0;fe!=m.length&&m[fe].trim().charAt(0)=="<";++fe);for(m=m.slice(fe),h=0;h!=m.length;++h)if(g=m[h].trim(),g.length!==0){if(w=g.match(r),v=h,C=0,E=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,w!=null&&w.length===2){for(v=0,R=w[1],C=0;C!=R.length&&!((E=R.charCodeAt(C)-64)<1||E>26);++C)v=26*v+E;--v,A=v}else++A;for(C=0;C!=g.length&&g.charCodeAt(C)!==62;++C);if(++C,b=De(g.slice(0,C),!0),b.r||(b.r=Be({r:T-1,c:A})),R=g.slice(C),S={t:""},(w=R.match(o))!=null&&w[1]!==""&&(S.v=Ze(w[1])),c.cellFormula){if((w=R.match(s))!=null&&w[1]!==""){if(S.f=Ze(st(w[1])).replace(/\r\n/g,`
`),c.xlfn||(S.f=nu(S.f)),w[0].indexOf('t="array"')>-1)S.F=(R.match(a)||[])[1],S.F.indexOf(":")>-1&&B.push([xt(S.F),S.F]);else if(w[0].indexOf('t="shared"')>-1){y=De(w[0]);var de=Ze(st(w[1]));c.xlfn||(de=nu(de)),H[parseInt(y.si,10)]=[y,de,b.r]}}else(w=R.match(/<f[^>]*\/>/))&&(y=De(w[0]),H[y.si]&&(S.f=UT(H[y.si][1],H[y.si][2],b.r)));var ie=Zt(b.r);for(C=0;C<B.length;++C)ie.r>=B[C][0].s.r&&ie.r<=B[C][0].e.r&&ie.c>=B[C][0].s.c&&ie.c<=B[C][0].e.c&&(S.F=B[C][1])}if(b.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(P)S.t="z";else continue;else S.t=b.t||"n";switch(d.s.c>A&&(d.s.c=A),d.e.c<A&&(d.e.c=A),S.t){case"n":if(S.v==""||S.v==null){if(!P)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!P)continue;S.t="z"}else N=$a[parseInt(S.v,10)],S.v=N.t,S.r=N.r,c.cellHTML&&(S.h=N.h);break;case"str":S.t="s",S.v=S.v!=null?st(S.v):"",c.cellHTML&&(S.h=ri(S.v));break;case"inlineStr":w=R.match(n),S.t="s",w!=null&&(N=fi(w[1]))?(S.v=N.t,c.cellHTML&&(S.h=N.h)):S.v="";break;case"b":S.v=dt(S.v);break;case"d":c.cellDates?S.v=_t(S.v,1):(S.v=Jt(_t(S.v,1)),S.t="n");break;case"e":(!c||c.cellText!==!1)&&(S.w=S.v),S.v=Id[S.v];break}if(D=L=0,F=null,M&&b.s!==void 0&&(F=p.CellXf[b.s],F!=null&&(F.numFmtId!=null&&(D=F.numFmtId),c.cellStyles&&F.fillId!=null&&(L=F.fillId))),lf(S,D,L,c,f,p),c.cellDates&&M&&S.t=="n"&&va(Ge[D])&&(S.t="d",S.v=Ss(S.v)),b.cm&&c.xlmeta){var xe=(c.xlmeta.Cell||[])[+b.cm-1];xe&&xe.type=="XLDAPR"&&(S.D=!0)}if(G){var z=Zt(b.r);u[z.r]||(u[z.r]=[]),u[z.r][z.c]=S}else u[b.r]=S}}}}_.length>0&&(u["!rows"]=_)}}();function D_(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}var O_=Un;function R_(){}function L_(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=aS(e),r}function N_(e){var t=gr(e);return[t]}function B_(e){var t=Gn(e);return[t]}function H_(e){var t=gr(e),r=e.read_shift(1);return[t,r,"b"]}function $_(e){var t=Gn(e),r=e.read_shift(1);return[t,r,"b"]}function V_(e){var t=gr(e),r=e.read_shift(1);return[t,r,"e"]}function G_(e){var t=Gn(e),r=e.read_shift(1);return[t,r,"e"]}function U_(e){var t=gr(e),r=e.read_shift(4);return[t,r,"s"]}function z_(e){var t=Gn(e),r=e.read_shift(4);return[t,r,"s"]}function j_(e){var t=gr(e),r=Ht(e);return[t,r,"n"]}function uf(e){var t=Gn(e),r=Ht(e);return[t,r,"n"]}function W_(e){var t=gr(e),r=ci(e);return[t,r,"n"]}function K_(e){var t=Gn(e),r=ci(e);return[t,r,"n"]}function X_(e){var t=gr(e),r=li(e);return[t,r,"is"]}function Y_(e){var t=gr(e),r=Vt(e);return[t,r,"str"]}function q_(e){var t=Gn(e),r=Vt(e);return[t,r,"str"]}function Z_(e,t,r){var n=e.l+t,a=gr(e);a.r=r["!row"];var o=e.read_shift(1),s=[a,o,"b"];if(r.cellFormula){e.l+=2;var l=Ts(e,n-e.l,r);s[3]=Bt(l,null,a,r.supbooks,r)}else e.l=n;return s}function Q_(e,t,r){var n=e.l+t,a=gr(e);a.r=r["!row"];var o=e.read_shift(1),s=[a,o,"e"];if(r.cellFormula){e.l+=2;var l=Ts(e,n-e.l,r);s[3]=Bt(l,null,a,r.supbooks,r)}else e.l=n;return s}function J_(e,t,r){var n=e.l+t,a=gr(e);a.r=r["!row"];var o=Ht(e),s=[a,o,"n"];if(r.cellFormula){e.l+=2;var l=Ts(e,n-e.l,r);s[3]=Bt(l,null,a,r.supbooks,r)}else e.l=n;return s}function eF(e,t,r){var n=e.l+t,a=gr(e);a.r=r["!row"];var o=Vt(e),s=[a,o,"str"];if(r.cellFormula){e.l+=2;var l=Ts(e,n-e.l,r);s[3]=Bt(l,null,a,r.supbooks,r)}else e.l=n;return s}var tF=Un;function rF(e,t){var r=e.l+t,n=Un(e),a=ii(e),o=Vt(e),s=Vt(e),l=Vt(e);e.l=r;var i={rfx:n,relId:a,loc:o,display:l};return s&&(i.Tooltip=s),i}function nF(){}function aF(e,t,r){var n=e.l+t,a=yd(e),o=e.read_shift(1),s=[a];if(s[2]=o,r.cellFormula){var l=c_(e,n-e.l,r);s[1]=l}else e.l=n;return s}function oF(e,t,r){var n=e.l+t,a=Un(e),o=[a];if(r.cellFormula){var s=d_(e,n-e.l,r);o[1]=s,e.l=n}else e.l=n;return o}var sF=["left","right","top","bottom","header","footer"];function lF(e){var t={};return sF.forEach(function(r){t[r]=Ht(e)}),t}function iF(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function cF(){}function uF(){}function dF(e,t,r,n,a,o,s){if(!e)return e;var l=t||{};n||(n={"!id":{}});var i=l.dense?[]:{},u,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,f=!1,p,h,g,m,w,v,C,E,R,S=[];l.biff=12,l["!row"]=0;var b=0,T=!1,A=[],N={},y=l.supbooks||a.supbooks||[[]];if(y.sharedf=N,y.arrayf=A,y.SheetNames=a.SheetNames||a.Sheets.map(function(G){return G.name}),!l.supbooks&&(l.supbooks=y,a.Names))for(var D=0;D<a.Names.length;++D)y[0][D+1]=a.Names[D];var L=[],M=[],F=!1;os[16]={n:"BrtShortReal",f:uf};var B;if(Zr(e,function(_,Z,ee){if(!f)switch(ee){case 148:u=_;break;case 0:p=_,l.sheetRows&&l.sheetRows<=p.r&&(f=!0),E=Ot(m=p.r),l["!row"]=p.r,(_.hidden||_.hpt||_.level!=null)&&(_.hpt&&(_.hpx=Qa(_.hpt)),M[_.r]=_);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(h={t:_[2]},_[2]){case"n":h.v=_[1];break;case"s":C=$a[_[1]],h.v=C.t,h.r=C.r;break;case"b":h.v=!!_[1];break;case"e":h.v=_[1],l.cellText!==!1&&(h.w=zn[h.v]);break;case"str":h.t="s",h.v=_[1];break;case"is":h.t="s",h.v=_[1].t;break}if((g=s.CellXf[_[0].iStyleRef])&&lf(h,g.numFmtId,null,l,o,s),w=_[0].c==-1?w+1:_[0].c,l.dense?(i[m]||(i[m]=[]),i[m][w]=h):i[Et(w)+E]=h,l.cellFormula){for(T=!1,b=0;b<A.length;++b){var P=A[b];p.r>=P[0].s.r&&p.r<=P[0].e.r&&w>=P[0].s.c&&w<=P[0].e.c&&(h.F=qe(P[0]),T=!0)}!T&&_.length>3&&(h.f=_[3])}if(c.s.r>p.r&&(c.s.r=p.r),c.s.c>w&&(c.s.c=w),c.e.r<p.r&&(c.e.r=p.r),c.e.c<w&&(c.e.c=w),l.cellDates&&g&&h.t=="n"&&va(Ge[g.numFmtId])){var q=En(h.v);q&&(h.t="d",h.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}B&&(B.type=="XLDAPR"&&(h.D=!0),B=void 0);break;case 1:case 12:if(!l.sheetStubs||d)break;h={t:"z",v:void 0},w=_[0].c==-1?w+1:_[0].c,l.dense?(i[m]||(i[m]=[]),i[m][w]=h):i[Et(w)+E]=h,c.s.r>p.r&&(c.s.r=p.r),c.s.c>w&&(c.s.c=w),c.e.r<p.r&&(c.e.r=p.r),c.e.c<w&&(c.e.c=w),B&&(B.type=="XLDAPR"&&(h.D=!0),B=void 0);break;case 176:S.push(_);break;case 49:B=((l.xlmeta||{}).Cell||[])[_-1];break;case 494:var K=n["!id"][_.relId];for(K?(_.Target=K.Target,_.loc&&(_.Target+="#"+_.loc),_.Rel=K):_.relId==""&&(_.Target="#"+_.loc),m=_.rfx.s.r;m<=_.rfx.e.r;++m)for(w=_.rfx.s.c;w<=_.rfx.e.c;++w)l.dense?(i[m]||(i[m]=[]),i[m][w]||(i[m][w]={t:"z",v:void 0}),i[m][w].l=_):(v=Be({c:w,r:m}),i[v]||(i[v]={t:"z",v:void 0}),i[v].l=_);break;case 426:if(!l.cellFormula)break;A.push(_),R=l.dense?i[m][w]:i[Et(w)+E],R.f=Bt(_[1],c,{r:p.r,c:w},y,l),R.F=qe(_[0]);break;case 427:if(!l.cellFormula)break;N[Be(_[0].s)]=_[1],R=l.dense?i[m][w]:i[Et(w)+E],R.f=Bt(_[1],c,{r:p.r,c:w},y,l);break;case 60:if(!l.cellStyles)break;for(;_.e>=_.s;)L[_.e--]={width:_.w/256,hidden:!!(_.flags&1),level:_.level},F||(F=!0,hi(_.w/256)),ga(L[_.e+1]);break;case 161:i["!autofilter"]={ref:qe(_)};break;case 476:i["!margins"]=_;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),_.name&&(a.Sheets[r].CodeName=_.name),(_.above||_.left)&&(i["!outline"]={above:_.above,left:_.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),_.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!Z.T){if(!d||l.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},l),delete l.supbooks,delete l["!row"],!i["!ref"]&&(c.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(i["!ref"]=qe(u||c)),l.sheetRows&&i["!ref"]){var H=xt(i["!ref"]);l.sheetRows<=+H.e.r&&(H.e.r=l.sheetRows-1,H.e.r>c.e.r&&(H.e.r=c.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>c.e.c&&(H.e.c=c.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),i["!fullref"]=i["!ref"],i["!ref"]=qe(H))}return S.length>0&&(i["!merges"]=S),L.length>0&&(i["!cols"]=L),M.length>0&&(i["!rows"]=M),i}function fF(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var s=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[t,a,n]}function hF(e,t,r,n,a,o){var s=o||{"!type":"chart"};if(!e)return o;var l=0,i=0,u="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var f=fF(d);c.s.r=c.s.c=0,c.e.c=l,u=Et(l),f[0].forEach(function(p,h){s[u+Ot(h)]={t:"n",v:p,z:f[1]},i=h}),c.e.r<i&&(c.e.r=i),++l}),l>0&&(s["!ref"]=qe(c)),s}function gF(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s,l=e.match(cf);return l&&pi(l[0],o,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function pF(e,t){e.l+=10;var r=Vt(e);return{name:r}}function xF(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Zr(e,function(i,u,c){switch(c){case 550:o["!rel"]=i;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),i.name&&(a.Sheets[r].CodeName=i.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}},t),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var df=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],vF=[],wF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function iu(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var o=t[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=dt(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function cu(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=dt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ff(e){cu(e.WBProps,df),cu(e.CalcPr,wF),iu(e.WBView,mF),iu(e.Sheets,vF),ua.date1904=dt(e.WBProps.date1904)}var CF="][*?/\\".split("");function bF(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return CF.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var SF=/<\w+:workbook/;function kF(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},s=0;if(e.replace(zt,function(i,u){var c=De(i);switch(Br(c[0])){case"<?xml":break;case"<workbook":i.match(SF)&&(a="xmlns"+i.match(/<(\w+):/)[1]),r.xmlns=c[a];break;case"</workbook>":break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":df.forEach(function(d){if(c[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=dt(c[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(c[d[0]],10);break;default:r.WBProps[d[0]]=c[d[0]]}}),c.codeName&&(r.WBProps.CodeName=st(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Ze(st(c.name)),delete c[0],r.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=st(c.name),c.comment&&(o.Comment=c.comment),c.localSheetId&&(o.Sheet=+c.localSheetId),dt(c.hidden||"0")&&(o.Hidden=!0),s=u+i.length;break;case"</definedName>":o.Ref=Ze(st(e.slice(s,u))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete c[0],r.CalcPr=c;break;case"<calcPr/>":delete c[0],r.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return i}),Vb.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ff(r),r}function EF(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ll(e),r.name=Vt(e),r}function TF(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Vt(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function yF(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _F(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),o=oS(e),s=u_(e,0,r),l=ii(e);e.l=n;var i={Name:o,Ptg:s};return a<268435455&&(i.Sheet=a),l&&(i.Comment=l),i}function FF(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var o=[],s=[[]];return s.SheetNames=[],s.XTI=[],os[16]={n:"BrtFRTArchID$",f:yF},Zr(e,function(i,u,c){switch(c){case 156:s.SheetNames.push(i.name),r.Sheets.push(i);break;case 153:r.WBProps=i;break;case 39:i.Sheet!=null&&(t.SID=i.Sheet),i.Ref=Bt(i.Ptg,null,null,s,t),delete t.SID,delete i.Ptg,o.push(i);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([c,i]):s[0]=[c,i],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(i),s.XTI=s.XTI.concat(i);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(c),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(c),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},t),ff(r),r.Names=o,r.supbooks=s,r}function IF(e,t,r){return t.slice(-4)===".bin"?FF(e,r):kF(e,r)}function PF(e,t,r,n,a,o,s,l){return t.slice(-4)===".bin"?dF(e,n,r,a,o,s,l):E_(e,n,r,a,o,s,l)}function AF(e,t,r,n,a,o,s,l){return t.slice(-4)===".bin"?xF(e,n,r,a,o):gF(e,n,r,a,o)}function MF(e,t,r,n,a,o,s,l){return t.slice(-4)===".bin"?$T():VT()}function DF(e,t,r,n,a,o,s,l){return t.slice(-4)===".bin"?BT():HT()}function OF(e,t,r,n){return t.slice(-4)===".bin"?tT(e,r,n):YE(e,r,n)}function RF(e,t,r){return Zd(e,r)}function LF(e,t,r){return t.slice(-4)===".bin"?mE(e,r):pE(e,r)}function NF(e,t,r){return t.slice(-4)===".bin"?RT(e,r):PT(e,r)}function BF(e,t,r){return t.slice(-4)===".bin"?_T(e):TT(e)}function HF(e,t,r,n){return r.slice(-4)===".bin"?FT(e,t,r,n):void 0}function $F(e,t,r){return t.slice(-4)===".bin"?kT(e,t,r):ET(e,t,r)}var hf=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gf=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pr(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var a=e.match(hf),o,s,l,i;if(a)for(i=0;i!=a.length;++i)o=a[i].match(gf),(s=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?l="xmlns"+o[1].slice(6):l=o[1].slice(s+1),n[l]=o[2].slice(1,o[2].length-1));return n}function VF(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(hf),a,o,s,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(gf),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(o+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Ga;function GF(e,t){var r=Ga[e]||Ze(e);return r==="General"?Dn(t):hr(r,t)}function UF(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=dt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=_t(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ze(t)]=a}function zF(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||zn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ka(e.v):e.w=Dn(e.v):e.w=GF(t||"General",e.v)}catch(o){if(r.WTF)throw o}try{var n=Ga[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&va(n)){var a=En(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function jF(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=UE[n.Pattern]||n.Pattern)}e[t.ID]=t}function WF(e,t,r,n,a,o,s,l,i,u){var c="General",d=n.StyleID,f={};u=u||{};var p=[],h=0;for(d===void 0&&l&&(d=l.StyleID),d===void 0&&s&&(d=s.StyleID);o[d]!==void 0&&(o[d].nf&&(c=o[d].nf),o[d].Interior&&p.push(o[d].Interior),!!o[d].Parent);)d=o[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=dt(e);break;case"String":n.t="s",n.r=Ac(Ze(e)),n.v=e.indexOf("<")>-1?Ze(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(_t(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ze(e):n.v<60&&(n.v=n.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Id[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Ac(t||e));break}if(zF(n,c,u),u.cellFormula!==!1)if(n.Formula){var g=Ze(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=ca(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ca("RC:RC",a):n.ArrayRange&&(n.F=ca(n.ArrayRange,a),i.push([xt(n.F),n.F]))}else for(h=0;h<i.length;++h)a.r>=i[h][0].s.r&&a.r<=i[h][0].e.r&&a.c>=i[h][0].s.c&&a.c<=i[h][0].e.c&&(n.F=i[h][1]);u.cellStyles&&(p.forEach(function(m){!f.patternType&&m.patternType&&(f.patternType=m.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function KF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function js(e,t){var r=t||{};ed();var n=Fa(ni(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=st(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Dt(r);return s.type="string",qa.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(be){a.indexOf("<"+be)>=0&&(o=!0)}),o)return rI(n,r);Ga={"General Number":"General","General Date":Ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ge[15],"Short Date":Ge[14],"Long Time":Ge[19],"Medium Time":Ge[18],"Short Time":Ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ge[2],Standard:Ge[4],Percent:Ge[10],Scientific:Ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,i=[],u,c={},d=[],f=r.dense?[]:{},p="",h={},g={},m=pr('<Data ss:Type="String">'),w=0,v=0,C=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},S={},b="",T=0,A=[],N={},y={},D=0,L=[],M=[],F={},B=[],H,G=!1,_=[],Z=[],ee={},P=0,q=0,K={Sheets:[],WBProps:{date1904:!1}},X={};Ya.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";l=Ya.exec(n);)switch(l[3]=(te=l[3]).toLowerCase()){case"data":if(te=="data"){if(l[1]==="/"){if((u=i.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&i.push([l[3],!0]);break}if(i[i.length-1][1])break;l[1]==="/"?WF(n.slice(w,l.index),b,m,i[i.length-1][0]=="comment"?F:h,{c:v,r:C},R,B[v],g,_,r):(b="",m=pr(l[0]),w=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(M.length>0&&(h.c=M),(!r.sheetRows||r.sheetRows>C)&&h.v!==void 0&&(r.dense?(f[C]||(f[C]=[]),f[C][v]=h):f[Et(v)+Ot(C)]=h),h.HRef&&(h.l={Target:Ze(h.HRef)},h.HRefScreenTip&&(h.l.Tooltip=h.HRefScreenTip),delete h.HRef,delete h.HRefScreenTip),(h.MergeAcross||h.MergeDown)&&(P=v+(parseInt(h.MergeAcross,10)|0),q=C+(parseInt(h.MergeDown,10)|0),A.push({s:{c:v,r:C},e:{c:P,r:q}})),!r.sheetStubs)h.MergeAcross?v=P+1:++v;else if(h.MergeAcross||h.MergeDown){for(var le=v;le<=P;++le)for(var fe=C;fe<=q;++fe)(le>v||fe>C)&&(r.dense?(f[fe]||(f[fe]=[]),f[fe][le]={t:"z"}):f[Et(le)+Ot(fe)]={t:"z"});v=P+1}else++v;else h=VF(l[0]),h.Index&&(v=+h.Index-1),v<E.s.c&&(E.s.c=v),v>E.e.c&&(E.e.c=v),l[0].slice(-2)==="/>"&&++v,M=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(C<E.s.r&&(E.s.r=C),C>E.e.r&&(E.e.r=C),l[0].slice(-2)==="/>"&&(g=pr(l[0]),g.Index&&(C=+g.Index-1)),v=0,++C):(g=pr(l[0]),g.Index&&(C=+g.Index-1),ee={},(g.AutoFitHeight=="0"||g.Height)&&(ee.hpx=parseInt(g.Height,10),ee.hpt=qd(ee.hpx),Z[C]=ee),g.Hidden=="1"&&(ee.hidden=!0,Z[C]=ee));break;case"worksheet":if(l[1]==="/"){if((u=i.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));d.push(p),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(f["!ref"]=qe(E),r.sheetRows&&r.sheetRows<=E.e.r&&(f["!fullref"]=f["!ref"],E.e.r=r.sheetRows-1,f["!ref"]=qe(E))),A.length&&(f["!merges"]=A),B.length>0&&(f["!cols"]=B),Z.length>0&&(f["!rows"]=Z),c[p]=f}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=v=0,i.push([l[3],!1]),u=pr(l[0]),p=Ze(u.Name),f=r.dense?[]:{},A=[],_=[],Z=[],X={name:p,Hidden:0},K.Sheets.push(X);break;case"table":if(l[1]==="/"){if((u=i.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;i.push([l[3],!1]),B=[],G=!1}break;case"style":l[1]==="/"?jF(R,S,r):S=pr(l[0]);break;case"numberformat":S.nf=Ze(pr(l[0]).Format||"General"),Ga[S.nf]&&(S.nf=Ga[S.nf]);for(var de=0;de!=392&&Ge[de]!=S.nf;++de);if(de==392){for(de=57;de!=392;++de)if(Ge[de]==null){In(S.nf,de);break}}break;case"column":if(i[i.length-1][0]!=="table")break;if(H=pr(l[0]),H.Hidden&&(H.hidden=!0,delete H.Hidden),H.Width&&(H.wpx=parseInt(H.Width,10)),!G&&H.wpx>10){G=!0,qt=Xd;for(var ie=0;ie<B.length;++ie)B[ie]&&ga(B[ie])}G&&ga(H),B[H.Index-1||B.length]=H;for(var xe=0;xe<+H.Span;++xe)B[B.length]=Dt(H);break;case"namedrange":if(l[1]==="/")break;K.Names||(K.Names=[]);var z=De(l[0]),Pe={Name:z.Name,Ref:ca(z.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(Pe.Sheet=K.Sheets.length-1),K.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?b+=n.slice(T,l.index):T=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=pr(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?PS(N,te,n.slice(D,l.index)):D=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=i.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else i.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=i.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));KF(F),M.push(F)}else i.push([l[3],!1]),u=pr(l[0]),F={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=i.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var _e=pr(l[0]);f["!autofilter"]={ref:ca(_e.Range).replace(/\$/g,"")},i.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=i.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&i.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=i.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&i.push([l[3],!0]);break;case"null":break;default:if(i.length==0&&l[3]=="document"||i.length==0&&l[3]=="uof")return pu(n,r);var Ie=!0;switch(i[i.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ie=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ie=!1}break;case"excelworkbook":switch(l[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ie=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ie=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(D,l.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else D=l.index+l[0].length;break;case"header":f["!margins"]||Va(f["!margins"]={},"xlml"),isNaN(+De(l[0]).Margin)||(f["!margins"].header=+De(l[0]).Margin);break;case"footer":f["!margins"]||Va(f["!margins"]={},"xlml"),isNaN(+De(l[0]).Margin)||(f["!margins"].footer=+De(l[0]).Margin);break;case"pagemargins":var ce=De(l[0]);f["!margins"]||Va(f["!margins"]={},"xlml"),isNaN(+ce.Top)||(f["!margins"].top=+ce.Top),isNaN(+ce.Left)||(f["!margins"].left=+ce.Left),isNaN(+ce.Right)||(f["!margins"].right=+ce.Right),isNaN(+ce.Bottom)||(f["!margins"].bottom=+ce.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ie=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ie=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ie=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ie=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ie=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ie=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ie=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ie=!1}break;case"smarttags":break;default:Ie=!1;break}if(Ie||l[3].match(/!\[CDATA/))break;if(!i[i.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+i.join("|");if(i[i.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?UF(y,te,L,n.slice(D,l.index)):(L=l,D=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+i.join("|")}var ne={};return!r.bookSheets&&!r.bookProps&&(ne.Sheets=c),ne.SheetNames=d,ne.Workbook=K,ne.SSF=Dt(Ge),ne.Props=N,ne.Custprops=y,ne}function dl(e,t){switch(vi(t=t||{}),t.type||"base64"){case"base64":return js(sr(e),t);case"binary":case"buffer":case"file":return js(e,t);case"array":return js(Vn(e),t)}}function XF(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=iS(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=cS(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var YF=[60,1084,2066,2165,2175];function qF(e,t,r,n,a){var o=n,s=[],l=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}s.push(l),r.l+=o;for(var i=Ur(r,r.l),u=fl[i],c=0;u!=null&&YF.indexOf(i)>-1;)o=Ur(r,r.l+2),c=r.l+4,i==2066?c+=4:(i==2165||i==2175)&&(c+=12),l=r.slice(c,r.l+4+o),s.push(l),r.l+=4+o,u=fl[i=Ur(r,r.l)];var d=sn(s);Pt(d,0);var f=0;d.lens=[];for(var p=0;p<s.length;++p)d.lens.push(f),f+=s[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function Pr(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ge[n])}catch(o){if(t.WTF)throw o}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||zn[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ka(e.v):e.w=Dn(e.v):e.w=hr(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&n&&e.t=="n"&&va(Ge[n]||String(n))){var a=En(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Ao(e,t,r){return{v:e,ixfe:t,t:r}}function ZF(e,t){var r={opts:{}},n={},a=t.dense?[]:{},o={},s={},l=null,i=[],u="",c={},d,f="",p,h,g,m,w={},v=[],C,E,R=[],S=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},A=function(Re){return Re<8?Pn[Re]:Re<64&&S[Re-8]||Pn[Re]},N=function(Re,lt,nt){var Ke=lt.XF.data;if(!(!Ke||!Ke.patternType||!nt||!nt.cellStyles)){lt.s={},lt.s.patternType=Ke.patternType;var jt;(jt=Za(A(Ke.icvFore)))&&(lt.s.fgColor={rgb:jt}),(jt=Za(A(Ke.icvBack)))&&(lt.s.bgColor={rgb:jt})}},y=function(Re,lt,nt){if(!(ee>1)&&!(nt.sheetRows&&Re.r>=nt.sheetRows)){if(nt.cellStyles&&lt.XF&&lt.XF.data&&N(Re,lt,nt),delete lt.ixfe,delete lt.XF,d=Re,f=Be(Re),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<s.s.r&&(s.s.r=Re.r),Re.c<s.s.c&&(s.s.c=Re.c),Re.r+1>s.e.r&&(s.e.r=Re.r+1),Re.c+1>s.e.c&&(s.e.c=Re.c+1),nt.cellFormula&&lt.f){for(var Ke=0;Ke<v.length;++Ke)if(!(v[Ke][0].s.c>Re.c||v[Ke][0].s.r>Re.r)&&!(v[Ke][0].e.c<Re.c||v[Ke][0].e.r<Re.r)){lt.F=qe(v[Ke][0]),(v[Ke][0].s.c!=Re.c||v[Ke][0].s.r!=Re.r)&&delete lt.f,lt.f&&(lt.f=""+Bt(v[Ke][1],s,Re,_,D));break}}nt.dense?(a[Re.r]||(a[Re.r]=[]),a[Re.r][Re.c]=lt):a[f]=lt}},D={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var L,M=[],F=[],B=[],H=[],G=!1,_=[];_.SheetNames=D.snames,_.sharedf=D.sharedf,_.arrayf=D.arrayf,_.names=[],_.XTI=[];var Z=0,ee=0,P=0,q=[],K=[],X;D.codepage=1200,br(1200);for(var te=!1;e.l<e.length-1;){var le=e.l,fe=e.read_shift(2);if(fe===0&&Z===10)break;var de=e.l===e.length?0:e.read_shift(2),ie=fl[fe];if(ie&&ie.f){if(t.bookSheets&&Z===133&&fe!==133)break;if(Z=fe,ie.r===2||ie.r==12){var xe=e.read_shift(2);if(de-=2,!D.enc&&xe!==fe&&((xe&255)<<8|xe>>8)!==fe)throw new Error("rt mismatch: "+xe+"!="+fe);ie.r==12&&(e.l+=10,de-=10)}var z={};if(fe===10?z=ie.f(e,de,D):z=qF(fe,ie,e,de,D),ee==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(fe){case 34:r.opts.Date1904=b.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=z,!t.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=z;break;case 66:var Pe=Number(z);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}br(D.codepage=Pe),te=!0;break;case 317:D.rrtabid=z;break;case 25:D.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:D.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(a["!type"]="dialog"),z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:R.push(z);break;case 430:_.push([z]),_[_.length-1].XTI=[];break;case 35:case 547:_[_.length-1].push(z);break;case 24:case 536:X={Name:z.Name,Ref:Bt(z.rgce,s,null,_,D)},z.itab>0&&(X.Sheet=z.itab-1),_.names.push(X),_[0]||(_[0]=[],_[0].XTI=[]),_[_.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(K[z.itab-1]={ref:qe(z.rgce[0][0][1][2])});break;case 22:D.ExternCount=z;break;case 23:_.length==0&&(_[0]=[],_[0].XTI=[]),_[_.length-1].XTI=_[_.length-1].XTI.concat(z),_.XTI=_.XTI.concat(z);break;case 2196:if(D.biff<8)break;X!=null&&(X.Comment=z[1]);break;case 18:a["!protect"]=z;break;case 19:z!==0&&D.WTF&&console.error("Password verifier: "+z);break;case 133:o[z.pos]=z,D.snames.push(z.name);break;case 10:{if(--ee)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=qe(s),t.sheetRows&&t.sheetRows<=s.e.r){var _e=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=qe(s),s.e.r=_e}s.e.r++,s.e.c++}M.length>0&&(a["!merges"]=M),F.length>0&&(a["!objects"]=F),B.length>0&&(a["!cols"]=B),H.length>0&&(a["!rows"]=H),b.Sheets.push(T)}u===""?c=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),D.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(D.biff=5,te=!0,br(D.codepage=28591)),D.biff==8&&z.BIFFVer==0&&z.dt==16&&(D.biff=2),ee++)break;if(a=t.dense?[]:{},D.biff<8&&!te&&(te=!0,br(D.codepage=t.codepage||1252)),D.biff<5||z.BIFFVer==0&&z.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ie={pos:e.l-de,name:u};o[Ie.pos]=Ie,D.snames.push(u)}else u=(o[le]||{name:""}).name;z.dt==32&&(a["!type"]="chart"),z.dt==64&&(a["!type"]="macro"),M=[],F=[],D.arrayf=v=[],B=[],H=[],G=!1,T={Hidden:(o[le]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[z.r]||[])[z.c]:a[Be({c:z.c,r:z.r})])&&++z.c,C={ixfe:z.ixfe,XF:R[z.ixfe]||{},v:z.val,t:"n"},P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y({c:z.c,r:z.r},C,t);break;case 5:case 517:C={ixfe:z.ixfe,XF:R[z.ixfe],v:z.val,t:z.t},P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y({c:z.c,r:z.r},C,t);break;case 638:C={ixfe:z.ixfe,XF:R[z.ixfe],v:z.rknum,t:"n"},P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y({c:z.c,r:z.r},C,t);break;case 189:for(var ce=z.c;ce<=z.C;++ce){var ne=z.rkrec[ce-z.c][0];C={ixfe:ne,XF:R[ne],v:z.rkrec[ce-z.c][1],t:"n"},P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y({c:ce,r:z.r},C,t)}break;case 6:case 518:case 1030:{if(z.val=="String"){l=z;break}if(C=Ao(z.val,z.cell.ixfe,z.tt),C.XF=R[C.ixfe],t.cellFormula){var be=z.formula;if(be&&be[0]&&be[0][0]&&be[0][0][0]=="PtgExp"){var Ae=be[0][0][1][0],Me=be[0][0][1][1],Oe=Be({r:Ae,c:Me});w[Oe]?C.f=""+Bt(z.formula,s,z.cell,_,D):C.F=((t.dense?(a[Ae]||[])[Me]:a[Oe])||{}).F}else C.f=""+Bt(z.formula,s,z.cell,_,D)}P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y(z.cell,C,t),l=z}break;case 7:case 519:if(l)l.val=z,C=Ao(z,l.cell.ixfe,"s"),C.XF=R[C.ixfe],t.cellFormula&&(C.f=""+Bt(l.formula,s,l.cell,_,D)),P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y(l.cell,C,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(z);var ye=Be(z[0].s);if(p=t.dense?(a[z[0].s.r]||[])[z[0].s.c]:a[ye],t.cellFormula&&p){if(!l||!ye||!p)break;p.f=""+Bt(z[1],s,z[0],_,D),p.F=qe(z[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!l)break;w[Be(l.cell)]=z[0],p=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[Be(l.cell)],(p||{}).f=""+Bt(z[0],s,d,_,D)}}break;case 253:C=Ao(i[z.isst].t,z.ixfe,"s"),i[z.isst].h&&(C.h=i[z.isst].h),C.XF=R[C.ixfe],P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y({c:z.c,r:z.r},C,t);break;case 513:t.sheetStubs&&(C={ixfe:z.ixfe,XF:R[z.ixfe],t:"z"},P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y({c:z.c,r:z.r},C,t));break;case 190:if(t.sheetStubs)for(var he=z.c;he<=z.C;++he){var ve=z.ixfe[he-z.c];C={ixfe:ve,XF:R[ve],t:"z"},P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y({c:he,r:z.r},C,t)}break;case 214:case 516:case 4:C=Ao(z.val,z.ixfe,"s"),C.XF=R[C.ixfe],P>0&&(C.z=q[C.ixfe>>8&63]),Pr(C,t,r.opts.Date1904),y({c:z.c,r:z.r},C,t);break;case 0:case 512:ee===1&&(s=z);break;case 252:i=z;break;case 1054:if(D.biff==4){q[P++]=z[1];for(var Ee=0;Ee<P+163&&Ge[Ee]!=z[1];++Ee);Ee>=163&&In(z[1],P+163)}else In(z[1],z[0]);break;case 30:{q[P++]=z;for(var Ne=0;Ne<P+163&&Ge[Ne]!=z;++Ne);Ne>=163&&In(z,P+163)}break;case 229:M=M.concat(z);break;case 93:F[z.cmo[0]]=D.lastobj=z;break;case 438:D.lastobj.TxO=z;break;case 127:D.lastobj.ImData=z;break;case 440:for(m=z[0].s.r;m<=z[0].e.r;++m)for(g=z[0].s.c;g<=z[0].e.c;++g)p=t.dense?(a[m]||[])[g]:a[Be({c:g,r:m})],p&&(p.l=z[1]);break;case 2048:for(m=z[0].s.r;m<=z[0].e.r;++m)for(g=z[0].s.c;g<=z[0].e.c;++g)p=t.dense?(a[m]||[])[g]:a[Be({c:g,r:m})],p&&p.l&&(p.l.Tooltip=z[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;p=t.dense?(a[z[0].r]||[])[z[0].c]:a[Be(z[0])];var Je=F[z[2]];p||(t.dense?(a[z[0].r]||(a[z[0].r]=[]),p=a[z[0].r][z[0].c]={t:"z"}):p=a[Be(z[0])]={t:"z"},s.e.r=Math.max(s.e.r,z[0].r),s.s.r=Math.min(s.s.r,z[0].r),s.e.c=Math.max(s.e.c,z[0].c),s.s.c=Math.min(s.s.c,z[0].c)),p.c||(p.c=[]),h={a:z[1],t:Je.TxO.t},p.c.push(h)}break;case 2173:wT(R[z.ixfe],z.ext);break;case 125:{if(!D.cellStyles)break;for(;z.e>=z.s;)B[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},G||(G=!0,hi(z.w/256)),ga(B[z.e+1])}break;case 520:{var rt={};z.level!=null&&(H[z.r]=rt,rt.level=z.level),z.hidden&&(H[z.r]=rt,rt.hidden=!0),z.hpt&&(H[z.r]=rt,rt.hpt=z.hpt,rt.hpx=Qa(z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Va(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=z;break;case 161:a["!margins"]||Va(a["!margins"]={}),a["!margins"].header=z.header,a["!margins"].footer=z.footer;break;case 574:z.RTL&&(b.Views[0].RTL=!0);break;case 146:S=z;break;case 2198:L=z;break;case 140:E=z;break;case 442:u?T.CodeName=z||T.name:b.WBProps.CodeName=z||"ThisWorkbook";break}}else ie||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),e.l+=de}return r.SheetNames=Lr(o).sort(function(ut,Re){return Number(ut)-Number(Re)}).map(function(ut){return o[ut].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&c["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=c)):r.Preamble=c,r.Sheets&&K.forEach(function(ut,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=ut}),r.Strings=i,r.SSF=Dt(Ge),D.enc&&(r.Encryption=D.enc),L&&(r.Themes=L),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),_.names.length>0&&(b.Names=_.names),r.Workbook=b,r}var uu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function QF(e,t,r){var n=Ye.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Kc(n,pS,uu.DSI);for(var o in a)t[o]=a[o]}catch(u){if(r.WTF)throw u}var s=Ye.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var l=Kc(s,xS,uu.SI);for(var i in l)t[i]==null&&(t[i]=l[i])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Ad(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function pf(e,t){t||(t={}),vi(t),G0(),t.codepage&&ql(t.codepage);var r,n;if(e.FullPaths){if(Ye.find(e,"/encryption"))throw new Error("File is password-protected");r=Ye.find(e,"!CompObj"),n=Ye.find(e,"/Workbook")||Ye.find(e,"/Book")}else{switch(t.type){case"base64":e=wr(sr(e));break;case"binary":e=wr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Pt(e,0),n={content:e}}var a,o;if(r&&XF(r),t.bookProps&&!t.bookSheets)a={};else{var s=Xe?"buffer":"array";if(n&&n.content)a=ZF(n.content,t);else if((o=Ye.find(e,"PerfectOffice_MAIN"))&&o.content)a=Ha.to_workbook(o.content,(t.type=s,t));else if((o=Ye.find(e,"NativeContent_MAIN"))&&o.content)a=Ha.to_workbook(o.content,(t.type=s,t));else throw(o=Ye.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ye.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=NT(e))}var l={};return e.FullPaths&&QF(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}var os={0:{f:D_},1:{f:N_},2:{f:W_},3:{f:V_},4:{f:H_},5:{f:j_},6:{f:Y_},7:{f:U_},8:{f:eF},9:{f:J_},10:{f:Z_},11:{f:Q_},12:{f:B_},13:{f:K_},14:{f:G_},15:{f:$_},16:{f:uf},17:{f:q_},18:{f:z_},19:{f:li},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_F},40:{},42:{},43:{f:ZE},44:{f:qE},45:{f:QE},46:{f:eT},47:{f:JE},48:{},49:{f:tS},50:{},51:{f:bT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ud},62:{f:X_},63:{f:yT},64:{f:cF},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:iF},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:L_},148:{f:O_,p:16},151:{f:nF},152:{},153:{f:TF},154:{},155:{},156:{f:EF},157:{},158:{},159:{T:1,f:xE},160:{T:-1},161:{T:1,f:Un},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:CT},336:{T:-1},337:{f:ST,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ll},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Gd},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:aF},427:{f:oF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:lF},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:R_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:rF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ll},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OT},633:{T:1},634:{T:-1},635:{T:1,f:DT},636:{T:-1},637:{f:nS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},fl={6:{f:Us},10:{f:en},12:{f:Ct},13:{f:Ct},14:{f:mt},15:{f:mt},16:{f:Ht},17:{f:mt},18:{f:mt},19:{f:Ct},20:{f:Zc},21:{f:Zc},23:{f:Gd},24:{f:Jc},25:{f:mt},26:{},27:{},28:{f:Ak},29:{},34:{f:mt},35:{f:Qc},38:{f:Ht},39:{f:Ht},40:{f:Ht},41:{f:Ht},42:{f:mt},43:{f:mt},47:{f:RE},49:{f:fk},51:{f:Ct},60:{},61:{f:ck},64:{f:mt},65:{f:dk},66:{f:Ct},77:{},80:{},81:{},82:{},85:{f:Ct},89:{},90:{},91:{},92:{f:tk},93:{f:Dk},94:{},95:{f:mt},96:{},97:{},99:{f:mt},125:{f:Ud},128:{f:Sk},129:{f:rk},130:{f:Ct},131:{f:mt},132:{f:mt},133:{f:nk},134:{},140:{f:Hk},141:{f:Ct},144:{},146:{f:Vk},151:{},152:{},153:{},154:{},155:{},156:{f:Ct},157:{},158:{},160:{f:Wk},161:{f:Uk},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:vk},190:{f:wk},193:{f:en},197:{},198:{},199:{},200:{},201:{},202:{f:mt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ct},220:{},221:{f:mt},222:{},224:{f:bk},225:{f:ek},226:{f:en},227:{},229:{f:Mk},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ak},253:{f:hk},255:{f:ok},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ld},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:mt},353:{f:en},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Ek},431:{f:mt},432:{},433:{},434:{},437:{},438:{f:Lk},439:{f:mt},440:{f:Nk},441:{},442:{f:uo},443:{},444:{f:Ct},445:{},446:{},448:{f:en},449:{f:ik,r:2},450:{f:en},512:{f:Yc},513:{f:jk},515:{f:kk},516:{f:gk},517:{f:qc},519:{f:Kk},520:{f:sk},523:{},545:{f:eu},549:{f:Xc},566:{},574:{f:uk},638:{f:mk},659:{},1048:{},1054:{f:pk},1084:{},1212:{f:Fk},2048:{f:Bk},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Fo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:en},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Gk,r:12},2173:{f:vT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:mt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_k,r:12},2197:{},2198:{f:fT,r:12},2199:{},2200:{},2201:{},2202:{f:Ik,r:12},2203:{f:en},2204:{},2205:{},2206:{},2207:{},2211:{f:lk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ct},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:zk},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:$k},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Yc},1:{},2:{f:Zk},3:{f:qk},4:{f:Yk},5:{f:qc},7:{f:Qk},8:{},9:{f:Fo},11:{},22:{f:Ct},30:{f:xk},31:{},32:{},33:{f:eu},36:{},37:{f:Xc},50:{f:Jk},62:{},52:{},67:{},68:{f:Ct},69:{},86:{},126:{},127:{f:Xk},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eE},223:{},234:{},354:{},421:{},518:{f:Us},521:{f:Fo},536:{f:Jc},547:{f:Qc},561:{},579:{},1030:{f:Us},1033:{f:Fo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function xr(e,t,r,n){var a=t;if(!isNaN(a)){var o=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,o),o>0&&kd(r)&&e.push(r)}}function du(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),s=a.index,l=o&&o.index||e.length,i=Eb(e.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,c=0,d=0,f=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},h=[];for(s=0;s<i.length;++s){var g=i[s].trim(),m=g.slice(0,3).toLowerCase();if(m=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}c=0;continue}if(!(m!="<td"&&m!="<th")){var w=g.split(/<\/t[dh]>/i);for(l=0;l<w.length;++l){var v=w[l].trim();if(v.match(/<t[dh]/i)){for(var C=v,E=0;C.charAt(0)=="<"&&(E=C.indexOf(">"))>-1;)C=C.slice(E+1);for(var R=0;R<h.length;++R){var S=h[R];S.s.c==c&&S.s.r<u&&u<=S.e.r&&(c=S.e.c+1,R=-1)}var b=De(v.slice(0,v.indexOf(">")));f=b.colspan?+b.colspan:1,((d=+b.rowspan)>1||f>1)&&h.push({s:{r:u,c},e:{r:u+(d||1)-1,c:c+f-1}});var T=b.t||b["data-t"]||"";if(!C.length){c+=f;continue}if(C=ud(C),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>c&&(p.s.c=c),p.e.c<c&&(p.e.c=c),!C.length){c+=f;continue}var A={t:"s",v:C};r.raw||!C.trim().length||T=="s"||(C==="TRUE"?A={t:"b",v:!0}:C==="FALSE"?A={t:"b",v:!1}:isNaN(yr(C))?isNaN(ha(C).getDate())||(A={t:"d",v:_t(C)},r.cellDates||(A={t:"n",v:Jt(A.v)}),A.z=r.dateNF||Ge[14]):A={t:"n",v:yr(C)}),r.dense?(n[u]||(n[u]=[]),n[u][c]=A):n[Be({r:u,c})]=A,c+=f}}}}return n["!ref"]=qe(p),h.length&&(n["!merges"]=h),n}function JF(e,t,r,n){for(var a=e["!merges"]||[],o=[],s=t.s.c;s<=t.e.c;++s){for(var l=0,i=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){l=-1;break}l=a[u].e.r-a[u].s.r+1,i=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var c=Be({r,c:s}),d=n.dense?(e[r]||[])[s]:e[c],f=d&&d.v!=null&&(d.h||ri(d.w||(Xr(d),d.w)||""))||"",p={};l>1&&(p.rowspan=l),i>1&&(p.colspan=i),n.editable?f='<span contenteditable="true">'+f+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),p.id=(n.id||"sjs")+"-"+c,o.push(Hb("td",f,p))}}var h="<tr>";return h+o.join("")+"</tr>"}var eI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tI="</body></html>";function rI(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Cn(du(r[0],t),t);var n=Ci();return r.forEach(function(a,o){bi(n,du(a,t),"Sheet"+(o+1))}),n}function nI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function aI(e,t){var r=t||{},n=r.header!=null?r.header:eI,a=r.footer!=null?r.footer:tI,o=[n],s=wa(e["!ref"]);r.dense=Array.isArray(e),o.push(nI(e,s,r));for(var l=s.s.r;l<=s.e.r;++l)o.push(JF(e,s,l,r));return o.push("</table>"+a),o.join("")}function xf(e,t,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Zt(n.origin):n.origin;a=s.r,o=s.c}var l=t.getElementsByTagName("tr"),i=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var c=wa(e["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),a==-1&&(u.e.r=a=c.e.r+1)}var d=[],f=0,p=e["!rows"]||(e["!rows"]=[]),h=0,g=0,m=0,w=0,v=0,C=0;for(e["!cols"]||(e["!cols"]=[]);h<l.length&&g<i;++h){var E=l[h];if(fu(E)){if(n.display)continue;p[g]={hidden:!0}}var R=E.children;for(m=w=0;m<R.length;++m){var S=R[m];if(!(n.display&&fu(S))){var b=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):ud(S.innerHTML),T=S.getAttribute("data-z")||S.getAttribute("z");for(f=0;f<d.length;++f){var A=d[f];A.s.c==w+o&&A.s.r<g+a&&g+a<=A.e.r&&(w=A.e.c+1-o,f=-1)}C=+S.getAttribute("colspan")||1,((v=+S.getAttribute("rowspan")||1)>1||C>1)&&d.push({s:{r:g+a,c:w+o},e:{r:g+a+(v||1)-1,c:w+o+(C||1)-1}});var N={t:"s",v:b},y=S.getAttribute("data-t")||S.getAttribute("t")||"";b!=null&&(b.length==0?N.t=y||"z":n.raw||b.trim().length==0||y=="s"||(b==="TRUE"?N={t:"b",v:!0}:b==="FALSE"?N={t:"b",v:!1}:isNaN(yr(b))?isNaN(ha(b).getDate())||(N={t:"d",v:_t(b)},n.cellDates||(N={t:"n",v:Jt(N.v)}),N.z=n.dateNF||Ge[14]):N={t:"n",v:yr(b)})),N.z===void 0&&T!=null&&(N.z=T);var D="",L=S.getElementsByTagName("A");if(L&&L.length)for(var M=0;M<L.length&&!(L[M].hasAttribute("href")&&(D=L[M].getAttribute("href"),D.charAt(0)!="#"));++M);D&&D.charAt(0)!="#"&&(N.l={Target:D}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][w+o]=N):e[Be({c:w+o,r:g+a})]=N,u.e.c<w+o&&(u.e.c=w+o),w+=C}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=qe(u),g>=i&&(e["!fullref"]=qe((u.e.r=l.length-h+g-1+a,u))),e}function mf(e,t){var r=t||{},n=r.dense?[]:{};return xf(n,e,t)}function oI(e,t){return Cn(mf(e,t),t)}function fu(e){var t="",r=sI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function sI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lI(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ze(t.replace(/<[^>]*>/g,""));return[r]}var hu={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function vf(e,t){var r=t||{},n=ni(e),a=[],o,s,l={name:""},i="",u=0,c,d,f={},p=[],h=r.dense?[]:{},g,m,w={value:""},v="",C=0,E=[],R=-1,S=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,A={},N=[],y={},D=0,L=0,M=[],F=1,B=1,H=[],G={Names:[]},_={},Z=["",""],ee=[],P={},q="",K=0,X=!1,te=!1,le=0;for(Ya.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Ya.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"å·¥ä½œè¡¨":g[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?h["!ref"]=qe(b):h["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(h["!fullref"]=h["!ref"],b.e.r=r.sheetRows-1,h["!ref"]=qe(b)),N.length&&(h["!merges"]=N),M.length&&(h["!rows"]=M),c.name=c.åç§°||c.name,typeof JSON<"u"&&JSON.stringify(c),p.push(c.name),f[c.name]=h,te=!1):g[0].charAt(g[0].length-2)!=="/"&&(c=De(g[0],!1),R=S=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,h=r.dense?[]:{},N=[],M=[],te=!0);break;case"table-row-group":g[1]==="/"?--T:++T;break;case"table-row":case"è¡Œ":if(g[1]==="/"){R+=F,F=1;break}if(d=De(g[0],!1),d.è¡Œå·?R=d.è¡Œå·-1:R==-1&&(R=0),F=+d["number-rows-repeated"]||1,F<10)for(le=0;le<F;++le)T>0&&(M[R+le]={level:T});S=-1;break;case"covered-table-cell":g[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(h[R]||(h[R]=[]),h[R][S]={t:"z"}):h[Be({r:R,c:S})]={t:"z"}),v="",E=[];break;case"table-cell":case"æ•°æ®":if(g[0].charAt(g[0].length-2)==="/")++S,w=De(g[0],!1),B=parseInt(w["number-columns-repeated"]||"1",10),m={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(m.f=lu(Ze(w.formula))),(w.æ•°æ®ç±»åž‹||w["value-type"])=="string"&&(m.t="s",m.v=Ze(w["string-value"]||""),r.dense?(h[R]||(h[R]=[]),h[R][S]=m):h[Be({r:R,c:S})]=m),S+=B-1;else if(g[1]!=="/"){++S,v="",C=0,E=[],B=1;var fe=F?R+F-1:R;if(S>b.e.c&&(b.e.c=S),S<b.s.c&&(b.s.c=S),R<b.s.r&&(b.s.r=R),fe>b.e.r&&(b.e.r=fe),w=De(g[0],!1),ee=[],P={},m={t:w.æ•°æ®ç±»åž‹||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=Ze(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(D=parseInt(w["number-matrix-rows-spanned"],10)||0,L=parseInt(w["number-matrix-columns-spanned"],10)||0,y={s:{r:R,c:S},e:{r:R+D-1,c:S+L-1}},m.F=qe(y),H.push([y,m.F])),w.formula)m.f=lu(w.formula);else for(le=0;le<H.length;++le)R>=H[le][0].s.r&&R<=H[le][0].e.r&&S>=H[le][0].s.c&&S<=H[le][0].e.c&&(m.F=H[le][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(D=parseInt(w["number-rows-spanned"],10)||0,L=parseInt(w["number-columns-spanned"],10)||0,y={s:{r:R,c:S},e:{r:R+D-1,c:S+L-1}},N.push(y)),w["number-columns-repeated"]&&(B=parseInt(w["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=dt(w["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(w.value);break;case"percentage":m.t="n",m.v=parseFloat(w.value);break;case"currency":m.t="n",m.v=parseFloat(w.value);break;case"date":m.t="d",m.v=_t(w["date-value"]),r.cellDates||(m.t="n",m.v=Jt(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=bb(w["time-value"])/86400,r.cellDates&&(m.t="d",m.v=Ss(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(w.æ•°æ®æ•°å€¼);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",w["string-value"]!=null&&(v=Ze(w["string-value"]),E=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(X=!1,m.t==="s"&&(m.v=v||"",E.length&&(m.R=E),X=C==0),_.Target&&(m.l=_),ee.length>0&&(m.c=ee,ee=[]),v&&r.cellText!==!1&&(m.w=v),X&&(m.t="z",delete m.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=R))for(var de=0;de<F;++de){if(B=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(h[R+de]||(h[R+de]=[]),h[R+de][S]=de==0?m:Dt(m);--B>0;)h[R+de][S+B]=Dt(m);else for(h[Be({r:R+de,c:S})]=m;--B>0;)h[Be({r:R+de,c:S+B})]=Dt(m);b.e.c<=S&&(b.e.c=S)}B=parseInt(w["number-columns-repeated"]||"1",10),S+=B-1,B=0,m={},v="",E=[]}_={};break;case"document":case"document-content":case"ç”µå­è¡¨æ ¼æ–‡æ¡£":case"spreadsheet":case"ä¸»ä½“":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o;P.t=v,E.length&&(P.R=E),P.a=q,ee.push(P)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);q="",K=0,v="",C=0,E=[];break;case"creator":g[1]==="/"?q=n.slice(K,g.index):K=g.index+g[0].length;break;case"meta":case"å…ƒæ•°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);v="",C=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(A[l.name]=i,(o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&(i="",l=De(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=De(g[0],!1),i+=hu[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=De(g[0],!1),i+=hu[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":i+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":s=De(g[0],!1),Z=zs(s["cell-range-address"]);var ie={Name:s.name,Ref:Z[0]+"!"+Z[1]};te&&(ie.Sheet=p.length),G.Names.push(ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"ç”µå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"æ–‡æœ¬ä¸²":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!w||!w["string-value"])){var xe=lI(n.slice(C,g.index));v=(v.length>0?v+`
`:"")+xe[0]}else De(g[0],!1),C=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{Z=zs(De(g[0])["target-range-address"]),f[Z[0]]["!autofilter"]={ref:Z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"æ ‡é¢˜":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(_=De(g[0],!1),!_.href)break;_.Target=Ze(_.href),delete _.href,_.Target.charAt(0)=="#"&&_.Target.indexOf(".")>-1?(Z=zs(_.Target.slice(1)),_.Target="#"+Z[0]+"!"+Z[1]):_.Target.match(/^\.\.[\\\/]/)&&(_.Target=_.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­—:":break;default:if(r.WTF)throw new Error(g)}}var z={Sheets:f,SheetNames:p,Workbook:G};return r.bookSheets&&delete z.Sheets,z}function gu(e,t){t=t||{},cr(e,"META-INF/manifest.xml")&&kS(wt(e,"META-INF/manifest.xml"),t);var r=or(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=vf(st(r),t);return cr(e,"meta.xml")&&(n.Props=Pd(wt(e,"meta.xml"))),n}function pu(e,t){return vf(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function xi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function hl(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):st(Vn(e))}function gl(e){var t=e.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function xu(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function iI(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Ja(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Tt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function $t(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Ja(e,r),o=a&7;a=Math.floor(a/8);var s=0,l;if(a==0)break;switch(o){case 0:{for(var i=r[0];e[r[0]++]>=128;);l=e.slice(i,r[0])}break;case 5:s=4,l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Ja(e,r),l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:o};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function mi(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function cI(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Ja(e,n),o=$t(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Tt(o[1][0].data),messages:[]};o[2].forEach(function(l){var i=$t(l.data),u=Tt(i[3][0].data);s.messages.push({meta:i,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=o[3])!=null&&t[0]&&(s.merge=Tt(o[3][0].data)>>>0>0),r.push(s)}return r}function uI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ja(t,r),a=[];r[0]<t.length;){var o=t[r[0]]&3;if(o==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var l=s-59;s=t[r[0]],l>1&&(s|=t[r[0]+1]<<8),l>2&&(s|=t[r[0]+2]<<16),l>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=l}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var i=0,u=0;if(o==1?(u=(t[r[0]]>>2&7)+4,i=(t[r[0]++]&224)<<3,i|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,o==2?(i=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(i=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[gl(a)],i==0)throw new Error("Invalid offset 0");if(i>a[0].length)throw new Error("Invalid offset beyond length");if(u>=i)for(a.push(a[0].slice(-i)),u-=i;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-i,-i+u))}}var c=gl(a);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function dI(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(uI(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return gl(t)}function fI(e,t,r,n){var a=xi(e),o=a.getUint32(4,!0),s=(n>1?12:8)+xu(o&(n>1?3470:398))*4,l=-1,i=-1,u=NaN,c=new Date(2001,0,1);o&512&&(l=a.getUint32(s,!0),s+=4),s+=xu(o&(n>1?12288:4096))*4,o&16&&(i=a.getUint32(s,!0),s+=4),o&32&&(u=a.getFloat64(s,!0),s+=8),o&64&&(c.setTime(c.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[i]};break;case 5:d={t:"d",v:c};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(l>-1)d={t:"s",v:r[l]};else if(i>-1)d={t:"s",v:t[i]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function hI(e,t,r){var n=xi(e),a=n.getUint32(8,!0),o=12,s=-1,l=-1,i=NaN,u=NaN,c=new Date(2001,0,1);a&1&&(i=iI(e,o),o+=16),a&2&&(u=n.getFloat64(o,!0),o+=8),a&4&&(c.setTime(c.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(l=n.getUint32(o,!0),o+=4),a&16&&(s=n.getUint32(o,!0),o+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:i};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:c};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1)d={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:i};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function gI(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return fI(e,t,r,e[0]);case 5:return hI(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function hn(e){var t=$t(e);return Ja(t[1][0].data)}function mu(e,t){var r=$t(t.data),n=Tt(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(s){var l=$t(s.data),i=Tt(l[1][0].data)>>>0;switch(n){case 1:o[i]=hl(l[3][0].data);break;case 8:{var u=e[hn(l[9][0].data)][0],c=$t(u.data),d=e[hn(c[1][0].data)][0],f=Tt(d.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var p=$t(d.data);o[i]=p[3].map(function(h){return hl(h.data)}).join("")}break}}),o}function pI(e,t){var r,n,a,o,s,l,i,u,c,d,f,p,h,g,m=$t(e),w=Tt(m[1][0].data)>>>0,v=Tt(m[2][0].data)>>>0,C=((n=(r=m[8])==null?void 0:r[0])==null?void 0:n.data)&&Tt(m[8][0].data)>0||!1,E,R;if((o=(a=m[7])==null?void 0:a[0])!=null&&o.data&&t!=0)E=(l=(s=m[7])==null?void 0:s[0])==null?void 0:l.data,R=(u=(i=m[6])==null?void 0:i[0])==null?void 0:u.data;else if((d=(c=m[4])==null?void 0:c[0])!=null&&d.data&&t!=1)E=(p=(f=m[4])==null?void 0:f[0])==null?void 0:p.data,R=(g=(h=m[3])==null?void 0:h[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=C?4:1,b=xi(E),T=[],A=0;A<E.length/2;++A){var N=b.getUint16(A*2,!0);N<65535&&T.push([A,N])}if(T.length!=v)throw"Expected ".concat(v," cells, found ").concat(T.length);var y=[];for(A=0;A<T.length-1;++A)y[T[A][0]]=R.subarray(T[A][1]*S,T[A+1][1]*S);return T.length>=1&&(y[T[T.length-1][0]]=R.subarray(T[T.length-1][1]*S)),{R:w,cells:y}}function xI(e,t){var r,n=$t(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Tt(n[7][0].data)>>>0>0?1:0:-1,o=mi(n[5],function(s){return pI(s,a)});return{nrows:Tt(n[4][0].data)>>>0,data:o.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(i,u){if(s[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));s[l.R][u]=i}),s},[])}}function mI(e,t,r){var n,a=$t(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Tt(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Tt(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=qe(o);var s=$t(a[4][0].data),l=mu(e,e[hn(s[4][0].data)][0]),i=(n=s[17])!=null&&n[0]?mu(e,e[hn(s[17][0].data)][0]):[],u=$t(s[3][0].data),c=0;u[1].forEach(function(d){var f=$t(d.data),p=e[hn(f[2][0].data)][0],h=Tt(p.meta[1][0].data);if(h!=6002)throw new Error("6001 unexpected reference to ".concat(h));var g=xI(e,p);g.data.forEach(function(m,w){m.forEach(function(v,C){var E=Be({r:c+w,c:C}),R=gI(v,l,i);R&&(r[E]=R)})}),c+=g.nrows})}function vI(e,t){var r=$t(t.data),n={"!ref":"A1"},a=e[hn(r[2][0].data)],o=Tt(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return mI(e,a[0],n),n}function wI(e,t){var r,n=$t(t.data),a={name:(r=n[1])!=null&&r[0]?hl(n[1][0].data):"",sheets:[]},o=mi(n[2],hn);return o.forEach(function(s){e[s].forEach(function(l){var i=Tt(l.meta[1][0].data);i==6e3&&a.sheets.push(vI(e,l))})}),a}function CI(e,t){var r=Ci(),n=$t(t.data),a=mi(n[1],hn);if(a.forEach(function(o){e[o].forEach(function(s){var l=Tt(s.meta[1][0].data);if(l==2){var i=wI(e,s);i.sheets.forEach(function(u,c){bi(r,u,c==0?i.name:i.name+"_"+c,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ws(e){var t,r,n,a,o={},s=[];if(e.FullPaths.forEach(function(i){if(i.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(i){if(i.name.match(/\.iwa$/)){var u;try{u=dI(i.content)}catch(d){return console.log("?? "+i.content.length+" "+(d.message||d))}var c;try{c=cI(u)}catch(d){return console.log("## "+(d.message||d))}c.forEach(function(d){o[d.id]=d.messages,s.push(d.id)})}}),!s.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=o==null?void 0:o[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Tt(o[1][0].meta[1][0].data)==1&&o[1][0];if(l||s.forEach(function(i){o[i].forEach(function(u){var c=Tt(u.meta[1][0].data)>>>0;if(c==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return CI(o,l)}function bI(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function vi(e){bI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function SI(e){return aa.WS.indexOf(e)>-1?"sheet":e==aa.CS?"chart":e==aa.DS?"dialog":e==aa.MS?"macro":e&&e.length?e:"sheet"}function kI(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,SI(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function EI(e,t,r,n,a,o,s,l,i,u,c,d){try{o[n]=Na(or(e,r,!0),t);var f=wt(e,t),p;switch(l){case"sheet":p=PF(f,t,a,i,o[n],u,c,d);break;case"chart":if(p=AF(f,t,a,i,o[n],u,c,d),!p||!p["!drawel"])break;var h=Pa(p["!drawel"].Target,t),g=il(h),m=IT(or(e,h,!0),Na(or(e,g,!0),h)),w=Pa(m,h),v=il(w);p=hF(or(e,w,!0),w,i,Na(or(e,v,!0),w),u,p);break;case"macro":p=MF(f,t,a,i,o[n],u,c,d);break;case"dialog":p=DF(f,t,a,i,o[n],u,c,d);break;default:throw new Error("Unrecognized sheet type "+l)}s[n]=p;var C=[];o&&o[n]&&Lr(o[n]).forEach(function(E){var R="";if(o[n][E].Type==aa.CMNT){R=Pa(o[n][E].Target,t);var S=NF(wt(e,R,!0),R,i);if(!S||!S.length)return;ru(p,S,!1)}o[n][E].Type==aa.TCMNT&&(R=Pa(o[n][E].Target,t),C=C.concat(AT(wt(e,R,!0),i)))}),C&&C.length&&ru(p,C,!0,i.people||[])}catch(E){if(i.WTF)throw E}}function lr(e){return e.charAt(0)=="/"?e.slice(1):e}function TI(e,t){if(ed(),t=t||{},vi(t),cr(e,"META-INF/manifest.xml")||cr(e,"objectdata.xml"))return gu(e,t);if(cr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ws<"u"){if(e.FileIndex)return Ws(e);var r=Ye.utils.cfb_new();return Ic(e).forEach(function(M){yb(r,M,sd(e,M))}),Ws(r)}throw new Error("Unsupported NUMBERS file")}if(!cr(e,"[Content_Types].xml"))throw cr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):cr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ic(e),a=bS(or(e,"[Content_Types].xml")),o=!1,s,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",wt(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!wt(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var i={},u={};if(!t.bookSheets&&!t.bookProps){if($a=[],a.sst)try{$a=LF(wt(e,lr(a.sst)),a.sst,t)}catch(M){if(t.WTF)throw M}t.cellStyles&&a.themes.length&&(i=RF(or(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=OF(wt(e,lr(a.style)),a.style,i,t))}a.links.map(function(M){try{var F=Na(or(e,il(lr(M))),M);return HF(wt(e,lr(M)),F,M,t)}catch{}});var c=IF(wt(e,lr(a.workbooks[0])),a.workbooks[0],t),d={},f="";a.coreprops.length&&(f=wt(e,lr(a.coreprops[0]),!0),f&&(d=Pd(f)),a.extprops.length!==0&&(f=wt(e,lr(a.extprops[0]),!0),f&&yS(f,d,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(f=or(e,lr(a.custprops[0]),!0),f&&(p=FS(f,t)));var h={};if((t.bookSheets||t.bookProps)&&(c.Sheets?s=c.Sheets.map(function(F){return F.name}):d.Worksheets&&d.SheetNames.length>0&&(s=d.SheetNames),t.bookProps&&(h.Props=d,h.Custprops=p),t.bookSheets&&typeof s<"u"&&(h.SheetNames=s),t.bookSheets?h.SheetNames:t.bookProps))return h;s={};var g={};t.bookDeps&&a.calcchain&&(g=BF(wt(e,lr(a.calcchain)),a.calcchain));var m=0,w={},v,C;{var E=c.Sheets;d.Worksheets=E.length,d.SheetNames=[];for(var R=0;R!=E.length;++R)d.SheetNames[R]=E[R].name}var S=o?"bin":"xml",b=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,b+1)+"_rels/"+a.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");cr(e,T)||(T="xl/_rels/workbook."+S+".rels");var A=Na(or(e,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=$F(wt(e,lr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=MT(wt(e,lr(a.people[0])),t)),A&&(A=kI(A,c.Sheets));var N=wt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=d.Worksheets;++m){var y="sheet";if(A&&A[m]?(v="xl/"+A[m][1].replace(/[\/]?xl\//,""),cr(e,v)||(v=A[m][1]),cr(e,v)||(v=T.replace(/_rels\/.*$/,"")+A[m][1]),y=A[m][2]):(v="xl/worksheets/sheet"+(m+1-N)+"."+S,v=v.replace(/sheet0\./,"sheet.")),C=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(m!=t.sheets)continue e;break;case"string":if(d.SheetNames[m].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==m&&(D=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==d.SheetNames[m].toLowerCase()&&(D=1);if(!D)continue e}}EI(e,v,C,d.SheetNames[m],m,w,s,y,t,c,i,u)}return h={Directory:a,Workbook:c,Props:d,Custprops:p,Deps:g,Sheets:s,SheetNames:d.SheetNames,Strings:$a,Styles:u,Themes:i,SSF:Dt(Ge)},t&&t.bookFiles&&(e.files?(h.keys=n,h.files=e.files):(h.keys=[],h.files={},e.FullPaths.forEach(function(M,F){M=M.replace(/^Root Entry[\/]/,""),h.keys.push(M),h.files[M]=e.FileIndex[F]}))),t&&t.bookVBA&&(a.vba.length>0?h.vbaraw=wt(e,lr(a.vba[0]),!0):a.defaults&&a.defaults.bin===LT&&(h.vbaraw=wt(e,"xl/vbaProject.bin",!0))),h}function yI(e,t){var r=t||{},n="Workbook",a=Ye.find(e,n);try{if(n="/!DataSpaces/Version",a=Ye.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(vE(a.content),n="/!DataSpaces/DataSpaceMap",a=Ye.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=CE(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ye.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=bE(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ye.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);kE(a.content)}catch{}if(n="/EncryptionInfo",a=Ye.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=EE(a.content);if(n="/EncryptedPackage",a=Ye.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function wi(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=sr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _I(e,t){return Ye.find(e,"EncryptedPackage")?yI(e,t):pf(e,t)}function FI(e,t){var r,n=e,a=t||{};return a.type||(a.type=Xe&&Buffer.isBuffer(e)?"buffer":"base64"),r=ld(n,a),TI(r,a)}function wf(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return dl(e.slice(r),t);default:break e}return qa.to_workbook(e,t)}function II(e,t){var r="",n=wi(e,t);switch(t.type){case"base64":r=sr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=On(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=st(r)),t.type="binary",wf(r,t)}function PI(e,t){var r=e;return t.type=="base64"&&(r=sr(r)),r=on.utils.decode(1200,r.slice(2),"str"),t.type="binary",wf(r,t)}function AI(e){return e.match(/[^\x00-\x7F]/)?Aa(e):e}function Ks(e,t,r,n){return n?(r.type="string",qa.to_workbook(e,r)):qa.to_workbook(t,r)}function pl(e,t){G0();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return pl(new Uint8Array(e),(r=Dt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ua={},r.dateNF&&(ua.dateNF=r.dateNF),r.type||(r.type=Xe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Xe?"buffer":"binary",n=wb(e),typeof Uint8Array<"u"&&!Xe&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=AI(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return r=Dt(r),r.type="array",pl(Zl(n),r)}switch((a=wi(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return _I(Ye.read(n,r),r);break;case 9:if(a[1]<=8)return pf(n,r);break;case 60:return dl(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return oE(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return nE.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?FI(n,r):Ks(e,n,r,o);case 239:return a[3]===60?dl(n,r):Ks(e,n,r,o);case 255:if(a[1]===254)return PI(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Ha.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ha.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return tu.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return LE.to_workbook(n,r);break;case 10:case 13:case 32:return II(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tE.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?tu.to_workbook(n,r):Ks(e,n,r,o)}function MI(e,t,r,n,a,o,s,l){var i=Ot(r),u=l.defval,c=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),d=!0,f=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!s||e[r])for(var p=t.s.c;p<=t.e.c;++p){var h=s?e[r][p]:e[n[p]+i];if(h===void 0||h.t===void 0){if(u===void 0)continue;o[p]!=null&&(f[o[p]]=u);continue}var g=h.v;switch(h.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+h.t)}if(o[p]!=null){if(g==null)if(h.t=="e"&&g===null)f[o[p]]=null;else if(u!==void 0)f[o[p]]=u;else if(c&&g===null)f[o[p]]=null;else continue;else f[o[p]]=c&&(h.t!=="n"||h.t==="n"&&l.rawNumbers!==!1)?g:Xr(h,g,l);g!=null&&(d=!1)}}return{row:f,isempty:d}}function xl(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],s=0,l="",i={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof c){case"string":i=xt(c);break;case"number":i=xt(e["!ref"]),i.s.r=c;break;default:i=c}n>0&&(a=0);var d=Ot(i.s.r),f=[],p=[],h=0,g=0,m=Array.isArray(e),w=i.s.r,v=0,C={};m&&!e[w]&&(e[w]=[]);var E=u.skipHidden&&e["!cols"]||[],R=u.skipHidden&&e["!rows"]||[];for(v=i.s.c;v<=i.e.c;++v)if(!(E[v]||{}).hidden)switch(f[v]=Et(v),r=m?e[w][v]:e[f[v]+d],n){case 1:o[v]=v-i.s.c;break;case 2:o[v]=f[v];break;case 3:o[v]=u.header[v-i.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=s=Xr(r,null,u),g=C[s]||0,!g)C[s]=1;else{do l=s+"_"+g++;while(C[l]);C[s]=g,C[l]=1}o[v]=l}for(w=i.s.r+a;w<=i.e.r;++w)if(!(R[w]||{}).hidden){var S=MI(e,i,w,f,n,o,m,u);(S.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[h++]=S.row)}return p.length=h,p}var vu=/"/g;function DI(e,t,r,n,a,o,s,l){for(var i=!0,u=[],c="",d=Ot(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var p=l.dense?(e[r]||[])[f]:e[n[f]+d];if(p==null)c="";else if(p.v!=null){i=!1,c=""+(l.rawNumbers&&p.t=="n"?p.v:Xr(p,null,l));for(var h=0,g=0;h!==c.length;++h)if((g=c.charCodeAt(h))===a||g===o||g===34||l.forceQuotes){c='"'+c.replace(vu,'""')+'"';break}c=="ID"&&(c='"ID"')}else p.f!=null&&!p.F?(i=!1,c="="+p.f,c.indexOf(",")>=0&&(c='"'+c.replace(vu,'""')+'"')):c="";u.push(c)}return l.blankrows===!1&&i?null:u.join(s)}function Cf(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=xt(e["!ref"]),o=n.FS!==void 0?n.FS:",",s=o.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,i=l.charCodeAt(0),u=new RegExp((o=="|"?"\\|":o)+"+$"),c="",d=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],h=a.s.c;h<=a.e.c;++h)(f[h]||{}).hidden||(d[h]=Et(h));for(var g=0,m=a.s.r;m<=a.e.r;++m)(p[m]||{}).hidden||(c=DI(e,a,m,d,s,i,o,n),c!=null&&(n.strip&&(c=c.replace(u,"")),(c||n.blankrows!==!1)&&r.push((g++?l:"")+c)));return delete n.dense,r.join("")}function OI(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Cf(e,t);return r}function RI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=xt(e["!ref"]),o="",s=[],l,i=[],u=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)s[l]=Et(l);for(var c=a.s.r;c<=a.e.r;++c)for(o=Ot(c),l=a.s.c;l<=a.e.c;++l)if(t=s[l]+o,r=u?(e[c]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}i[i.length]=t+"="+n}return i}function bf(e,t,r){var n=r||{},a=+!n.skipHeader,o=e||{},s=0,l=0;if(o&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Zt(n.origin):n.origin;s=i.r,l=i.c}var u,c={s:{c:0,r:0},e:{c:l,r:s+t.length-1+a}};if(o["!ref"]){var d=xt(o["!ref"]);c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),s==-1&&(s=d.e.r+1,c.e.r=s+t.length-1+a)}else s==-1&&(s=0,c.e.r=t.length-1+a);var f=n.header||[],p=0;t.forEach(function(g,m){Lr(g).forEach(function(w){(p=f.indexOf(w))==-1&&(f[p=f.length]=w);var v=g[w],C="z",E="",R=Be({c:l+p,r:s+m+a});u=eo(o,R),v&&typeof v=="object"&&!(v instanceof Date)?o[R]=v:(typeof v=="number"?C="n":typeof v=="boolean"?C="b":typeof v=="string"?C="s":v instanceof Date?(C="d",n.cellDates||(C="n",v=Jt(v)),E=n.dateNF||Ge[14]):v===null&&n.nullError&&(C="e",v=0),u?(u.t=C,u.v=v,delete u.w,delete u.R,E&&(u.z=E)):o[R]=u={t:C,v},E&&(u.z=E))})}),c.e.c=Math.max(c.e.c,l+f.length-1);var h=Ot(s);if(a)for(p=0;p<f.length;++p)o[Et(p+l)+h]={t:"s",v:f[p]};return o["!ref"]=qe(c),o}function LI(e,t){return bf(null,e,t)}function eo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Zt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?eo(e,Be(t)):eo(e,Be({r:t,c:r||0}))}function NI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ci(){return{SheetNames:[],Sheets:{}}}function bi(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var s=o&&o[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(bF(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function BI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=NI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function HI(e,t){return e.z=t,e}function Sf(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function $I(e,t,r){return Sf(e,"#"+t,r)}function VI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function GI(e,t,r,n){for(var a=typeof t!="string"?t:xt(t),o=typeof t=="string"?t:qe(t),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var i=eo(e,s,l);i.t="n",i.F=o,delete i.v,s==a.s.r&&l==a.s.c&&(i.f=r,n&&(i.D=!0))}return e}var UI={encode_col:Et,encode_row:Ot,encode_cell:Be,encode_range:qe,decode_col:si,decode_row:oi,split_cell:eS,decode_cell:Zt,decode_range:wa,format_cell:Xr,sheet_add_aoa:Td,sheet_add_json:bf,sheet_add_dom:xf,aoa_to_sheet:Ca,json_to_sheet:LI,table_to_sheet:mf,table_to_book:oI,sheet_to_csv:Cf,sheet_to_txt:OI,sheet_to_json:xl,sheet_to_html:aI,sheet_to_formulae:RI,sheet_to_row_object_array:xl,sheet_get_cell:eo,book_new:Ci,book_append_sheet:bi,book_set_sheet_visibility:BI,cell_set_number_format:HI,cell_set_hyperlink:Sf,cell_set_internal_link:$I,cell_add_comment:VI,sheet_set_array_formula:GI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Si={},zI=ro;Object.defineProperty(Si,"__esModule",{value:!0});var kf=Si.default=void 0,jI=zI(to()),WI=I;kf=Si.default=(0,jI.default)((0,WI.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile");var KI={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const XI=KI,Ef=({openDialog:e,setOpenDialog:t})=>{const r=Yr(),n=Cl(r.palette.mode),a=Ma(r.breakpoints.down("md")),o=Ma("(max-width:480px)"),s=Ma("(max-width:920px)"),[l,i]=x.useState(void 0),[u,c]=x.useState([]),[d,f]=x.useState(""),p=yi(v=>v.menuItems.selected),h=yi(v=>v.toastInfo),{typography:g}=Rf(r.palette.mode),m=v=>{v.preventDefault(),w()},w=()=>{if(l){const v=new FileReader;v.onload=C=>{const E=pl(C.target.result),R=E.SheetNames;if(R.length){const S=UI.sheet_to_json(E.Sheets[R[0]]);c(S)}},v.readAsArrayBuffer(l)}};return x.useEffect(()=>{u!=null&&u.length&&u.forEach(v=>{const C=(v==null?void 0:v.father_name)||(v==null?void 0:v.mother_name)||(v==null?void 0:v.guardian),E=`${C}${XI.VITE_SECRET_CODE}`;_i.UserAPI.register({username:C,password:E,email:v==null?void 0:v.email,contact_no:v==null?void 0:v.contact_no,role:5,designation:"parent",status:"active"}).then(({data:R})=>{(R==null?void 0:R.status)==="Success"&&_i.StudentAPI.createStudent({...v,parent_id:R.data.id}).then(S=>{console.log("imopirt model response:",S)}).catch(S=>{console.error("API error:",S)})}).catch(R=>{console.error("API error:",R)})})},[u==null?void 0:u.length]),I.jsx("div",{children:I.jsxs(Lf,{fullScreen:a,open:e,"aria-labelledby":"responsive-dialog-title",sx:{top:o?"33%":s?"25%":"20%",height:o?"49%":s?"39%":"60%","& .MuiPaper-root":{width:"100%",backgroundImage:r.palette.mode=="light"?`linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url(${Fi})`:`linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), url(${Fi})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}},children:[I.jsx(Nf,{fontFamily:g.fontFamily,fontSize:g.h2.fontSize,color:n.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`Import ${p}s`}),I.jsx(gn,{children:I.jsxs("form",{onSubmit:m,style:{display:"flex",flexDirection:"column"},children:[I.jsx(Sl,{name:"importedFile",label:"Upload Your File",value:l,size:"medium",InputProps:{startAdornment:I.jsxs(ln,{component:"label",sx:{width:"99%"},children:[I.jsx(kf,{}),I.jsx("input",{hidden:!0,type:"file",name:"importedFile",onChange:v=>{const C=v.target.files[0];i(C),f(C.name)}})]})},sx:{m:"8px auto",outline:"none",width:"40%"}}),I.jsxs("div",{style:{lineHeight:"30px",gridColumn:"span 2",display:"flex",fontWeight:"600",marginLeft:"30%"},children:["Your Selected File: ",I.jsx("div",{style:{fontWeight:"900",marginLeft:"20px",color:"blue"},children:d})," "]}),I.jsx(Eu,{}),I.jsxs(gn,{display:"flex",justifyContent:"end",p:"20px",children:[I.jsx(Ro,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>t(!1),children:"Cancel"}),I.jsx(Ro,{type:"submit",color:"success",variant:"contained",children:"Submit"}),I.jsx(Bf,{alerting:h.toastAlert,severity:h.toastSeverity,message:h.toastMessage})]})]})})]})})};Ef.propTypes={setOpenDialog:J.func,openDialog:J.bool};const YI=["All","Student","Pre Nursery","Nursery","Lower Kindergarten","Upper Kindergarten","PN","NS","LKG","UKG","KG","Ist","Class 1","Class 2","Class 3","Class 4","Class 5","Class 6","Class 7","Class 8","Class 9","Class 10","Class 11","Class 12"],qI=je("div")(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:"50px",height:"100%","& .ant-empty-img-1":{fill:e.palette.mode==="light"?"#aeb8c2":"#262626"},"& .ant-empty-img-2":{fill:e.palette.mode==="light"?"#f5f5f7":"#595959"},"& .ant-empty-img-3":{fill:e.palette.mode==="light"?"#dce0e6":"#434343"},"& .ant-empty-img-4":{fill:e.palette.mode==="light"?"#fff":"#1c1c1c"},"& .ant-empty-img-5":{fillOpacity:e.palette.mode==="light"?"0.8":"0.08",fill:e.palette.mode==="light"?"#f5f5f5":"#fff"}}));function ZI(){return I.jsxs(qI,{children:[I.jsx("svg",{width:"130",height:"110",viewBox:"0 0 184 152","aria-hidden":!0,focusable:"false",children:I.jsxs("g",{fill:"none",fillRule:"evenodd",children:[I.jsxs("g",{transform:"translate(24 31.67)",children:[I.jsx("ellipse",{className:"ant-empty-img-5",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),I.jsx("path",{className:"ant-empty-img-1",d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"}),I.jsx("path",{className:"ant-empty-img-2",d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"}),I.jsx("path",{className:"ant-empty-img-3",d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"})]}),I.jsx("path",{className:"ant-empty-img-3",d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"}),I.jsxs("g",{className:"ant-empty-img-4",transform:"translate(149.65 15.383)",children:[I.jsx("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),I.jsx("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"})]})]})}),I.jsx(gn,{sx:{mt:1},children:"No Rows"})]})}const QI=()=>I.jsx(gn,{sx:{height:"max-content"},children:[...Array(6)].map((e,t)=>t%2?I.jsx(ml,{variant:"rounded",animation:"wave",width:600,height:20},t):I.jsx(ml,{variant:"rounded",animation:"wave",width:500,height:20},t))}),ml=({variant:e,animation:t,height:r,width:n})=>I.jsx(_u,{variant:e,animation:t,width:n,height:r,sx:{my:3,mx:1}});ml.propTypes={variant:J.string,animation:J.string,height:J.oneOfType([J.number,J.string]),width:J.oneOfType([J.number,J.string])};const JI=({action:e,api:t,getQuery:r,condition:n=!1,columns:a,rows:o,count:s,loading:l,selected:i,pageSizeOptions:u,searchFlag:c,setOldPagination:d})=>{const f={page:0,pageSize:5},p=Yr(),h=Cl(p.palette.mode),[g,m]=x.useState(f),[w,v]=x.useState(!1);x.useEffect(()=>{!c.search&&!c.searching?(r(g.page,g.pageSize,e,t,n),d(g)):c.searching||(r(c,c,e,t,n),m({}))},[i,g.page,g.pageSize,c.searching]),x.useEffect(()=>{m(f)},[i]);const[C,E]=x.useState(s||0);return x.useEffect(()=>{E(()=>s||0)},[s,E]),I.jsxs(gn,{m:"30px 0 0 0",sx:{"& .MuiDataGrid-root":{border:"none",fontSize:"1rem"},"& .MuiDataGrid-cell":{borderBottom:"none"},"& .MuiDataGrid-cellCheckbox":{borderBottom:"none"},"& .MuiDataGrid-cell:focus-within":{outline:`1px solid ${h.greenAccent[600]}`},"& .MuiDataGrid-cell:hover":{color:h.greenAccent[300]},"& .name-column--cell":{color:h.greenAccent[300]},"& .MuiDataGrid-columnHeaders":{backgroundColor:h.blueAccent[700],borderBottom:"none"},"& .MuiDataGrid-columnHeader":{backgroundColor:h.blueAccent[700]},"& .MuiDataGrid-virtualScroller":{minHeight:320},"& .MuiDataGrid-footerContainer":{borderTop:"none",backgroundColor:h.blueAccent[700]},"& .MuiCheckbox-root":{color:`${h.greenAccent[200]} !important`},"& .MuiDataGrid-toolbarContainer .MuiButton-text":{color:`${h.grey[100]} !important`}},children:[I.jsx($2,{autoHeight:!0,disableRowSelectionOnClick:!0,getRowId:R=>i==="Class"?R.class_id:i==="Section"?R.section_id:R.id,rows:o||[],columns:a,loading:(YI.includes(i),l),rowCount:C,components:{Toolbar:()=>I.jsxs(gn,{display:"flex",children:[I.jsx(bv,{}),I.jsx(Ju,{children:I.jsxs(Ro,{sx:{padding:"0px"},onClick:()=>v(!0),children:[I.jsx($0,{sx:{marginRight:"5px"}}),"Import"]})})]}),LoadingOverlay:QI,noRowsOverlay:ZI},pagination:!0,ServerPaginationGrid:!0,paginationMode:"server",paginationModel:g,onPaginationModelChange:m,pageSizeOptions:u,keepNonExistentRowsSelected:!0}),w&&I.jsx(Ef,{openDialog:w,setOpenDialog:v})]})};JI.propTypes={action:J.func,api:J.object,getQuery:J.func,condition:J.oneOfType([J.object,J.bool]),columns:J.array,rows:J.array,count:J.number,loading:J.bool,selected:J.string,pageSizeOptions:J.arrayOf(J.number),searchFlag:J.shape({search:J.bool,searching:J.bool}),setOldPagination:J.func};var ki={},eP=ro;Object.defineProperty(ki,"__esModule",{value:!0});var tP=ki.default=void 0,rP=eP(to()),nP=I;tP=ki.default=(0,rP.default)((0,nP.jsx)("path",{d:"m15 16-4 4h10v-4zm-2.94-8.81L3 16.25V20h3.75l9.06-9.06zM5.92 18H5v-.92l7.06-7.06.92.92zm12.79-9.96c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75z"}),"DriveFileRenameOutlineOutlined");const cP="/assets/listBG-itIDZ4NO.jpg";export{dg as S,og as a,JI as b,YI as c,tP as d,cP as l};
