import{u as ft,t as yt,l as S,v as bt,j as o,B as m,T as St,p as N,U as Ct,a as s,w as Wt,x as It,h as mt,y as Bt,A as i,a1 as pt}from"./index-zLCHO5gj.js";import{l as xt,S as Tt,a as $t}from"./listBG-jqFZybtA.js";import{d as Mt,V as Lt}from"./Preview-vjJV04E4.js";import{d as Ot}from"./DriveFileRenameOutlineOutlined-sr1QJdZi.js";import{a as zt}from"./AmenityAction-TQ2VORm6.js";import{u as Ft}from"./index-mkkoW40k.js";import"./FormControlLabel-SXp-cdUw.js";import"./toPropertyKey-mta9U6ZT.js";import"./typeof-Q9eVcF_1.js";import"./ListItemText-2nz_AZOg.js";import"./CircularProgress-ieWN9mTc.js";import"./TableCell-yZ9kbJpi.js";import"./styles-g2-IrP8A.js";const Gt=(C=null)=>{const p=ft(),t=yt(p.palette.mode),{capitalizeEveryWord:x}=Ct(),w=S(a=>a.menuItems.selected),f=bt(),v=a=>{f(`/${w.toLowerCase()}/update/${a}`,{state:{id:a}})},D=a=>{C(!0),f("#",{state:{id:a}})};return[{field:"city",headerName:"City",headerAlign:"center",align:"center",flex:1,minWidth:150,renderCell:a=>{var n;let r=(n=a==null?void 0:a.row)==null?void 0:n.city;return o.jsx("div",{children:r||"/"})}},{field:"name",headerName:"Name",headerAlign:"center",align:"center",flex:1,minWidth:150},{field:"board",headerName:"Board",headerAlign:"center",align:"center",flex:1,minWidth:150},{field:"sub_type",headerName:"Sub Type",headerAlign:"center",align:"center",flex:1,minWidth:150,valueGetter:a=>x(a.row.sub_type)||""},{field:"contact_no_1",headerName:"Contact Number",headerAlign:"center",align:"center",flex:1,minWidth:150},{field:"status",headerName:"Status",headerAlign:"center",align:"center",flex:1,minWidth:150,renderCell:({row:{status:a}})=>o.jsx(m,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:a==="active"?t.greenAccent[600]:t.redAccent[700],borderRadius:"4px",children:o.jsx(St,{color:t.grey[100],sx:{ml:"5px"},children:x(a)||""})})},{field:"action",headerName:"Action",headerAlign:"center",align:"center",flex:1,minWidth:150,renderCell:({row:{id:a}})=>o.jsxs(m,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:[o.jsx(N,{color:"info",variant:"contained",onClick:()=>v(a),sx:{minWidth:"50px"},children:o.jsx(Ot,{})}),o.jsx(N,{color:"info",variant:"contained",onClick:()=>D(a),sx:{minWidth:"50px"},children:o.jsx(Mt,{})})]})}]},Qt=[5,10,20],oe=()=>{var L,O,z,F,G,Q,U,V,q,H,J,K,R,X,Y,Z,tt,et,at,ot,nt,st,ct,it,rt;const[C,p]=s.useState(!1),[t,x]=s.useState([]),[w,f]=s.useState([]),[v,D]=s.useState([]),[E,a]=s.useState([]),r=S(e=>e.menuItems.selected),n=S(e=>e.allFormAmenities),{listData:W,loading:wt}=S(e=>e.listingSchools),I=ft(),A=bt(),j=Wt(),{state:_}=It(),d=mt("(max-width:480px)"),B=mt("(max-width:920px)");let P=_==null?void 0:_.id;const[vt,T]=s.useState({search:!1,searching:!1}),[Dt,At]=s.useState(),$=yt(I.palette.mode),jt=document.getElementById("reload-btn"),{getPaginatedData:k}=Ft(),{findMultipleById:_t,getLocalStorage:Pt,toastAndNavigate:M}=Ct();s.useEffect(()=>{const e=Pt("menu");j(Bt(e.selected))},[]);const kt=s.useCallback(e=>{const y=[`/get-by-pk/school/${e}`,`/get-address/school/${e}`,`/get-image/school/${e}`];i.CommonAPI.multipleAPICall("GET",y).then(c=>{var h,u,lt,dt;(u=(h=c[0])==null?void 0:h.data)!=null&&u.data&&(c[0].data.data.amenities=_t((lt=c[0].data.data)==null?void 0:lt.amenities,(dt=n==null?void 0:n.listData)==null?void 0:dt.rows)),i.SchoolAPI.getSchoolClasses(e).then(l=>{var g,ht,ut,gt;const b={schoolData:{schoolData:c[0].data.data,selectedClass:l==null?void 0:l.data},addressData:(ht=(g=c[1])==null?void 0:g.data)==null?void 0:ht.data,imageData:(gt=(ut=c[2])==null?void 0:ut.data)==null?void 0:gt.data};x(b)}).catch(l=>{var b,g;M(j,!0,"error",((g=(b=l==null?void 0:l.response)==null?void 0:b.data)==null?void 0:g.msg)||"Error fetching school classes",A,0)})}).catch(c=>{var h,u;M(j,!0,"error",((u=(h=c==null?void 0:c.response)==null?void 0:h.data)==null?void 0:u.msg)||"Error fetching school classes",A,0)})},[(L=n==null?void 0:n.listData)==null?void 0:L.rows]);s.useEffect(()=>{var e,y;(y=(e=n==null?void 0:n.listData)==null?void 0:e.rows)!=null&&y.length||k(0,50,zt,i.AmenityAPI)},[(z=(O=n==null?void 0:n.listData)==null?void 0:O.rows)==null?void 0:z.length]),s.useEffect(()=>{P&&(kt(P),i.CountryAPI.getCountries().then(e=>{e.status==="Success"&&f(e.data.list)}).catch(e=>{throw e}),i.StateAPI.getAllStates().then(e=>{e.status==="Success"&&D(e.data.rows)}).catch(e=>{throw e}),i.CityAPI.getAllCities().then(e=>{e.status==="Success"&&a(e.data.rows)}).catch(e=>{throw e}))},[P]);const Nt={Registration_year:(G=(F=t==null?void 0:t.schoolData)==null?void 0:F.schoolData)==null?void 0:G.registration_year,Registered_by:(U=(Q=t==null?void 0:t.schoolData)==null?void 0:Q.schoolData)==null?void 0:U.registered_by,Name:(q=(V=t==null?void 0:t.schoolData)==null?void 0:V.schoolData)==null?void 0:q.name,Board:(J=(H=t==null?void 0:t.schoolData)==null?void 0:H.schoolData)==null?void 0:J.board,Email:(R=(K=t==null?void 0:t.schoolData)==null?void 0:K.schoolData)==null?void 0:R.email,Director:(Y=(X=t==null?void 0:t.schoolData)==null?void 0:X.schoolData)==null?void 0:Y.director,School_code:(tt=(Z=t==null?void 0:t.schoolData)==null?void 0:Z.schoolData)==null?void 0:tt.school_code},Et={Contact_no:(at=(et=t==null?void 0:t.schoolData)==null?void 0:et.schoolData)==null?void 0:at.contact_no_1,Type:(nt=(ot=t==null?void 0:t.schoolData)==null?void 0:ot.schoolData)==null?void 0:nt.type,Sub_type:(ct=(st=t==null?void 0:t.schoolData)==null?void 0:st.schoolData)==null?void 0:ct.sub_type,Principal:(rt=(it=t==null?void 0:t.schoolData)==null?void 0:it.schoolData)==null?void 0:rt.principal};return o.jsxs(m,{m:"10px",position:"relative",sx:{borderRadius:"20px",border:"0.5px solid black",overflow:"hidden",boxShadow:"1px 1px 10px black",backgroundImage:I.palette.mode==="light"?`linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url(${xt})`:`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${xt})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:[o.jsx(m,{height:d?"19vh":B?"8vh":"11vh",borderRadius:"4px",padding:d?"1vh":"2vh",backgroundColor:$.blueAccent[700],position:"relative",children:o.jsxs(m,{display:"flex",height:d?"16vh":"7vh",flexDirection:d?"column":"row",justifyContent:"space-between",alignItems:d?"center":"normal",children:[o.jsx(St,{component:"h2",variant:"h2",color:$.grey[100],fontWeight:"bold",children:r}),o.jsx(Tt,{action:pt,api:i.SchoolAPI,getSearchData:k,oldPagination:Dt,reloadBtn:jt,setSearchFlag:T}),o.jsxs(N,{type:"submit",color:"success",variant:"contained",onClick:()=>{A(`/${r.toLowerCase()}/create`)},sx:{height:B?"4vh":"auto"},children:["Create New ",r]})]})}),o.jsx($t,{action:pt,api:i.SchoolAPI,getQuery:k,columns:Gt(p),rows:W.rows,count:W.count,loading:wt,selected:r,pageSizeOptions:Qt,setOldPagination:At,searchFlag:vt,setSearchFlag:T}),o.jsx(Lt,{open:C,setOpen:p,title:"School Details",horizontalData:Nt,verticalData:Et,detail:t,countryData:w,stateData:v,cityData:E})]})};export{oe as default};
