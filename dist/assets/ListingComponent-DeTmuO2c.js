import{K as lt,N as ut,O as k,_,a as y,P as ht,Q as pt,T as c,j as e,V as mt,W as xt,r as gt,i as ft,f as N,G as vt,B as D,D as st,U as H,k as T,l as yt,A as B,h as rt,u as ct,t as it,E as bt,o as z,x as jt,b as at,s as Ct}from"./index-wJj9abeo.js";import{d as Dt,S as St,c as At,a as wt,b as Bt}from"./DriveFileRenameOutlineOutlined-wh212PVW.js";import"./dayjs.min-3WyAvf2v.js";import{C as Nt,b as Wt,a as Pt}from"./CardMedia-y74GAWPs.js";import{D as _t}from"./Dialog-H17IDJ7F.js";import{s as zt}from"./SectionAction-bDNrVPg3.js";import{s as nt}from"./StudentAction-8lZkmGVb.js";import{u as kt}from"./index-ngBz0NVi.js";import"./FormControlLabel-rkyz9wHp.js";import"./Chip-3qarAbJU.js";import"./index-R3E-xKkl.js";import"./ListItemText-UY9Do7UF.js";function Ht(t){return ut("MuiCardHeader",t)}const Mt=lt("MuiCardHeader",["root","avatar","action","content","title","subheader"]),ot=Mt,Tt=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],It=t=>{const{classes:o}=t;return xt({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},Ht,o)},Et=k("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(t,o)=>_({[`& .${ot.title}`]:o.title,[`& .${ot.subheader}`]:o.subheader},o.root)})({display:"flex",alignItems:"center",padding:16}),Rt=k("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(t,o)=>o.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),$t=k("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(t,o)=>o.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),Ft=k("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(t,o)=>o.content})({flex:"1 1 auto"}),Gt=y.forwardRef(function(o,j){const u=ht({props:o,name:"MuiCardHeader"}),{action:d,avatar:r,className:h,component:f="div",disableTypography:x=!1,subheader:w,subheaderTypographyProps:S,title:C,titleTypographyProps:b}=u,A=pt(u,Tt),p=_({},u,{component:f,disableTypography:x}),m=It(p);let s=C;s!=null&&s.type!==c&&!x&&(s=e.jsx(c,_({variant:r?"body2":"h5",className:m.title,component:"span",display:"block"},b,{children:s})));let i=w;return i!=null&&i.type!==c&&!x&&(i=e.jsx(c,_({variant:r?"body2":"body1",className:m.subheader,color:"text.secondary",component:"span",display:"block"},S,{children:i}))),e.jsxs(Et,_({className:mt(m.root,h),as:f,ref:j,ownerState:p},A,{children:[r&&e.jsx(Rt,{className:m.avatar,ownerState:p,children:r}),e.jsxs(Ft,{className:m.content,ownerState:p,children:[s,i]}),d&&e.jsx($t,{className:m.action,ownerState:p,children:d})]}))}),Ot=Gt;var I={},Ut=ft;Object.defineProperty(I,"__esModule",{value:!0});var dt=I.default=void 0,Lt=Ut(gt()),qt=e,Vt=(0,Lt.default)((0,qt.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm0 16H5V7h14v12zm-5.5-6c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5.67-1.5 1.5-1.5 1.5.67 1.5 1.5zM12 9c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4zm0 6.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"}),"Preview");dt=I.default=Vt;const Qt=({detail:t=null,countryData:o,stateData:j,cityData:u})=>{var A,p,m,s,i,a,g,n,v,l,W,P,E,R,$,F,G,O,U,L,q,V,Q,K,J,X,Y,Z,tt,et;console.log("detail=>",t);const d=N(M=>M.allFormSections),r=N(M=>M.allFormClasses),{findById:h,appendSuffix:f}=H(),x=(p=h((A=t==null?void 0:t.addressData)==null?void 0:A.country,o))==null?void 0:p.name,w=(s=h((m=t==null?void 0:t.addressData)==null?void 0:m.state,j))==null?void 0:s.name,S=(a=h((i=t==null?void 0:t.addressData)==null?void 0:i.city,u))==null?void 0:a.name,C=(n=h((g=t==null?void 0:t.studentData)==null?void 0:g.section,d==null?void 0:d.listData))==null?void 0:n.name,b=(l=h((v=t==null?void 0:t.studentData)==null?void 0:v.class,r==null?void 0:r.listData))==null?void 0:l.class_name;return e.jsxs(Nt,{children:[e.jsx(Ot,{avatar:e.jsx(vt,{sx:{background:"darkcyan"},"aria-label":"recipe",children:"i"}),title:e.jsx(c,{variant:"h3",component:"h2",sx:{fontWeight:"bold"},children:"Student Details"}),sx:{backgroundColor:"lightblue",margin:"5px",borderRadius:"5px"}}),e.jsxs(Wt,{children:[e.jsx(Pt,{component:"img",height:"230",image:"path/to/student/image",alt:(W=t==null?void 0:t.studentData)==null?void 0:W.firstname,sx:{width:"200px",float:"left",margin:"20px",border:"1px dotted black"}}),e.jsxs(D,{children:[e.jsxs(c,{gutterBottom:!0,variant:"h5",component:"h2",sx:{fontWeight:"bold",fontSize:"30px"},children:["Name : ",(P=t==null?void 0:t.studentData)==null?void 0:P.firstname," ",(E=t==null?void 0:t.studentData)==null?void 0:E.lastname]}),e.jsx(st,{sx:{marginBottom:"20px"}}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Class : ",b?f(b):""," ",C]}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Blood Group : ",(R=t==null?void 0:t.studentData)==null?void 0:R.blood_group]}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Birth Date : ",($=t==null?void 0:t.studentData)==null?void 0:$.dob]}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Addmission Date : ",(F=t==null?void 0:t.studentData)==null?void 0:F.admission_date]}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Address : ",(G=t==null?void 0:t.addressData)==null?void 0:G.street,", ",(O=t==null?void 0:t.addressData)==null?void 0:O.landmark,", ",S,", ",w,", ",x," - ",(U=t==null?void 0:t.addressData)==null?void 0:U.zipcode]})]}),e.jsx(st,{sx:{margin:"20px"}}),e.jsxs(D,{sx:{display:"flex",justifyContent:"space-between",marginLeft:"20px"},children:[e.jsxs(D,{children:[((L=t==null?void 0:t.studentData)==null?void 0:L.father_name)&&e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Father Name : ",(q=t==null?void 0:t.studentData)==null?void 0:q.father_name]}),((V=t==null?void 0:t.studentData)==null?void 0:V.mother_name)&&e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Mother Name : ",(Q=t==null?void 0:t.studentData)==null?void 0:Q.mother_name]}),((K=t==null?void 0:t.studentData)==null?void 0:K.guardian)&&e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Guardian : ",(J=t==null?void 0:t.studentData)==null?void 0:J.guardian]}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Phone : ",(X=t==null?void 0:t.studentData)==null?void 0:X.contact_no]}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Email : ",(Y=t==null?void 0:t.studentData)==null?void 0:Y.email]})]}),e.jsxs(D,{children:[e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Religion : ",(Z=t==null?void 0:t.studentData)==null?void 0:Z.religion]}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Caste Group : ",(tt=t==null?void 0:t.studentData)==null?void 0:tt.caste_group]}),e.jsxs(c,{gutterBottom:!0,variant:"body1",component:"p",sx:{fontWeight:"500",fontSize:"20px"},children:["Gender : ",(et=t==null?void 0:t.studentData)==null?void 0:et.gender]})]}),e.jsx(D,{})]})]})]})};function Kt({open:t,setOpen:o}){const j=()=>o(!1),[u,d]=y.useState(null),[r,h]=y.useState([]),[f,x]=y.useState([]),[w,S]=y.useState([]),{toastAndNavigate:C,findMultipleById:b}=H(),A=T(),{state:p}=yt(),m=N(a=>a.allSubjects);let s=p==null?void 0:p.id;const i=a=>{console.log("id=",a);const g=[`/get-by-pk/student/${a}`,`/get-address/student/${a}`];B.CommonAPI.multipleAPICall("GET",g).then(n=>{var l,W,P;n[0].data.data&&(n[0].data.data.subjects=b(n[0].data.data.subjects,(l=m==null?void 0:m.listData)==null?void 0:l.rows));const v={studentData:n[0].data.data,addressData:(P=(W=n[1])==null?void 0:W.data)==null?void 0:P.data};console.log({dataObj:v}),d(v)}).catch(n=>{var v,l;throw C(A,!0,"error",(l=(v=n==null?void 0:n.response)==null?void 0:v.data)==null?void 0:l.msg),n})};return y.useEffect(()=>{s&&(i(s),B.CountryAPI.getCountries().then(a=>{a.status==="Success"&&h(a.data.list)}).catch(a=>{throw a}),B.StateAPI.getAllStates().then(a=>{a.status==="Success"&&x(a.data.rows)}).catch(a=>{throw a}),B.CityAPI.getAllCities().then(a=>{a.status==="Success"&&S(a.data.rows)}).catch(a=>{throw a}))},[s]),e.jsx(y.Fragment,{children:e.jsx(_t,{open:t,onClose:j,BackdropProps:{style:{backgroundColor:"rgba(0, 0, 0, 0.3)",opacity:.5}},fullWidth:!0,maxWidth:"md",children:e.jsx(D,{children:e.jsx(Qt,{detail:u,countryData:r,stateData:f,cityData:w})})})})}const Jt=(t=null)=>{const[o,j]=y.useState(!1),u=N(s=>s.allFormClasses),d=N(s=>s.allFormSections),r=T(),h=rt(),f=ct(),x=it(f.palette.mode),{appendSuffix:w,findById:S,customSort:C,createUniqueDataArray:b}=H(),A=s=>{h(`/student/update/${s}`,{state:{id:s}})},p=s=>{j(!0),h("#",{state:{id:s}})};return y.useEffect(()=>{var s,i;(!((s=u==null?void 0:u.listData)!=null&&s.length)||!((i=d==null?void 0:d.listData)!=null&&i.length))&&B.SchoolAPI.getSchoolClasses(5).then(a=>{if(a.status==="Success"){a.data.sort(C);const g=b(a.data,"class_id","class_name");r(bt(g));const n=b(a.data,"id","name");r(zt(n))}}).catch(a=>{console.log("Error Fetching ClassData:",a)})},[u.listData.length,d.listData.length]),[{field:"fullname",headerName:"Name",headerAlign:"center",align:"center",flex:1,minWidth:120,valueGetter:s=>`${s.row.firstname||""} ${s.row.lastname||""}`},{field:"class",headerName:"Class",headerAlign:"center",align:"center",flex:1,minWidth:100,renderCell:s=>{var g,n,v,l;let i=(n=S((g=s==null?void 0:s.row)==null?void 0:g.class,u==null?void 0:u.listData))==null?void 0:n.class_name,a=(l=S((v=s==null?void 0:s.row)==null?void 0:v.section,d==null?void 0:d.listData))==null?void 0:l.name;return e.jsxs("div",{children:[i?w(i):"/"," ",a]})}},{field:"blood_group",headerName:"Blood Group",headerAlign:"center",align:"center",flex:1,minWidth:100},{field:"dob",headerName:"Date Of Birth",headerAlign:"center",align:"center",flex:1,minWidth:100},{field:"status",headerName:"STATUS",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:s}})=>e.jsx(D,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:s==="active"?x.greenAccent[600]:x.redAccent[700],borderRadius:"4px",children:e.jsx(c,{color:x.grey[100],sx:{ml:"5px"},children:s})})},{field:"action",headerName:"ACTION",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{id:s}})=>e.jsxs(D,{width:"85%",m:"0 auto",p:"5px",display:"flex",justifyContent:"space-around",children:[e.jsx(z,{color:"info",variant:"contained",disabled:t,onClick:()=>A(s),sx:{minWidth:"50px"},children:e.jsx(Dt,{})}),e.jsx(z,{color:"info",variant:"contained",onClick:()=>p(s),sx:{minWidth:"50px"},children:e.jsx(dt,{})}),e.jsx(Kt,{open:o,setOpen:j})]})}]},Xt=[5,10,20],le=({rolePriority:t=null})=>{const o=ct(),j=rt(),u=T(),d=jt(),r=at("(max-width:480px)"),h=at("(max-width:920px)"),f=N(l=>l.menuItems.selected),{listData:x,loading:w}=N(l=>l.allStudents),[S,C]=y.useState({search:!1,searching:!1}),[b,A]=y.useState(),{getPaginatedData:p}=kt(),{getLocalStorage:m,setLocalStorage:s}=H(),i=it(o.palette.mode),a=document.getElementById("reload-btn"),g=d?d.classId:null;let n=g?{classId:g}:null;if(t===5){const l=m("auth").id;n={...n,parentId:l}}y.useEffect(()=>{const l=m("menu");u(Ct(l.selected))},[]),y.useEffect(()=>{g&&s("class",g)},[g]);const v=()=>{a.style.display="none",C({search:!1,searching:!1,oldPagination:b})};return e.jsxs(D,{m:"10px",position:"relative",children:[e.jsx(D,{height:r?"19vh":h?"8vh":"11vh",borderRadius:"4px",padding:r?"1vh":"2vh",backgroundColor:i.blueAccent[700],children:e.jsxs(D,{display:"flex",height:r?"16vh":"7vh",flexDirection:r?"column":"row",justifyContent:"space-between",alignItems:r?"center":"normal",children:[e.jsx(c,{component:"h2",variant:"h2",color:i.grey[100],fontWeight:"bold",children:f}),e.jsx(St,{action:nt,api:B.StudentAPI,getSearchData:p,oldPagination:b,reloadBtn:a,setSearchFlag:C}),e.jsx(z,{type:"submit",color:"success",variant:"contained",disabled:t,onClick:()=>{j("/student/create")},sx:{height:h?"4vh":"auto"},children:At.includes(f)?"Admission":`Create New ${f}`})]})}),e.jsxs(z,{sx:{display:"none",position:"absolute",top:r?"23vh":h?"10.5vh":"16.5vh",left:r?"80vw":h?"39.5vw":"26vw",zIndex:1,borderRadius:"20%",color:i.grey[100]},id:"reload-btn",type:"button",onClick:v,children:[e.jsx("span",{style:{display:"inherit",marginRight:"5px"},children:e.jsx(wt,{})}),"Back"]}),e.jsx(Bt,{action:nt,api:B.StudentAPI,getQuery:p,columns:Jt(t),condition:n,rows:x.rows,count:x.count,loading:w,selected:f,pageSizeOptions:Xt,setOldPagination:A,searchFlag:S,setSearchFlag:C})]})};export{le as default};
