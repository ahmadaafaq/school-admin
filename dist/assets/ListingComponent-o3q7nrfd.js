import{l as g,w as At,v as bt,u as Dt,t as wt,a as i,V as $t,A as u,W as Mt,U as vt,j as n,B as k,T as yt,p as q,O as Tt,x as Ot,h as pt,y as Gt,P as Lt}from"./index-zLCHO5gj.js";import{l as xt,S as zt,c as Ft,a as Ut}from"./listBG-jqFZybtA.js";import{d as Vt,V as Qt}from"./Preview-vjJV04E4.js";import{d as qt}from"./DriveFileRenameOutlineOutlined-sr1QJdZi.js";import{s as Ht,a as Jt}from"./SectionAction-X4gvrGyO.js";import{s as Kt}from"./SubjectAction-cByBtOva.js";import{a as St}from"./StudentAction-ARQ8Q4-i.js";import{u as Xt}from"./index-mkkoW40k.js";import"./FormControlLabel-SXp-cdUw.js";import"./toPropertyKey-mta9U6ZT.js";import"./typeof-Q9eVcF_1.js";import"./ListItemText-2nz_AZOg.js";import"./CircularProgress-ieWN9mTc.js";import"./TableCell-yZ9kbJpi.js";import"./styles-g2-IrP8A.js";const Yt=(x=null,L=null)=>{var y,D,C,m;const s=g(e=>e.schoolClasses),t=g(e=>e.allClasses),c=g(e=>e.schoolSections),l=g(e=>e.allSections),w=At(),B=bt(),z=Dt(),S=wt(z.palette.mode),{appendSuffix:F,findById:h,fetchAndSetAll:o,fetchAndSetSchoolData:v,getLocalStorage:A,capitalizeEveryWord:b,formatDate:U}=vt(),E=e=>{B(`/student/update/${e}`,{state:{id:e}})},V=e=>{L(!0),B("#",{state:{id:e}})};return i.useEffect(()=>{var e,r,f,p;A("schoolInfo")||((e=t==null?void 0:t.listData)!=null&&e.length||o(w,$t,u.ClassAPI),(r=l==null?void 0:l.listData)!=null&&r.length||o(w,Ht,u.SectionAPI)),A("schoolInfo")&&(!((f=s==null?void 0:s.listData)!=null&&f.length)||!((p=c==null?void 0:c.listData)!=null&&p.length))&&v(w,Mt,Jt)},[(y=s==null?void 0:s.listData)==null?void 0:y.length,(D=c==null?void 0:c.listData)==null?void 0:D.length,(C=t==null?void 0:t.listData)==null?void 0:C.length,(m=l==null?void 0:l.listData)==null?void 0:m.length]),[{field:"fullname",headerName:"Name",headerAlign:"center",align:"center",flex:1,minWidth:150,valueGetter:e=>`${b(e.row.firstname)||""} ${b(e.row.lastname)||""}`},{field:"class",headerName:"Class",headerAlign:"center",align:"center",flex:1,minWidth:150,renderCell:e=>{var p,$,M,j,T,_,O,P;let r,f;return t.listData.length&&l.listData.length?(r=($=h((p=e==null?void 0:e.row)==null?void 0:p.class,t==null?void 0:t.listData))==null?void 0:$.class_name,f=(j=h((M=e==null?void 0:e.row)==null?void 0:M.section,l==null?void 0:l.listData))==null?void 0:j.section_name):s.listData.length&&c.listData.length&&(r=(_=h((T=e==null?void 0:e.row)==null?void 0:T.class,s==null?void 0:s.listData))==null?void 0:_.class_name,f=(P=h((O=e==null?void 0:e.row)==null?void 0:O.section,c==null?void 0:c.listData))==null?void 0:P.section_name),n.jsxs("div",{children:[r?F(r):"/"," ",f]})}},{field:"blood_group",headerName:"Blood Group",headerAlign:"center",align:"center",flex:1,minWidth:150},{field:"dob",headerName:"Date of Birth",headerAlign:"center",align:"center",flex:1,minWidth:150,valueFormatter:e=>`${U(e.value)}`},{field:"status",headerName:"Status",headerAlign:"center",align:"center",flex:1,minWidth:150,renderCell:({row:{status:e}})=>n.jsx(k,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:e==="active"?S.greenAccent[600]:S.redAccent[700],borderRadius:"4px",children:n.jsx(yt,{color:S.grey[100],sx:{ml:"5px"},children:b(e)||""})})},{field:"action",headerName:"Action",headerAlign:"center",align:"center",flex:1,minWidth:100,renderCell:({row:{id:e}})=>n.jsxs(k,{width:"85%",m:"0 auto",p:"5px",display:"flex",justifyContent:"space-around",children:[x!==1&&n.jsx(q,{color:"info",variant:"contained",onClick:()=>E(e),sx:{minWidth:"50px"},children:n.jsx(qt,{})}),n.jsx(q,{color:"info",variant:"contained",onClick:()=>V(e),sx:{minWidth:"50px"},children:n.jsx(Vt,{})})]})}]},Zt=[5,10,20],Rt=({rolePriority:x=null})=>{var H,J,K,X,Y,Z,R,tt,et,at,nt,ot,st,it,ct,lt,rt,dt,ht;const[L,s]=i.useState(!1),[t,c]=i.useState([]),[l,w]=i.useState([]),[B,z]=i.useState([]),[S,F]=i.useState([]),h=g(a=>a.menuItems.selected),o=g(a=>a.allSubjects),v=g(a=>a.schoolSections),A=g(a=>a.schoolClasses),{listData:b,loading:U}=g(a=>a.allStudents),E=Dt(),V=bt(),W=At(),y=Tt(),{state:D}=Ot(),C=wt(E.palette.mode),m=pt("(max-width:480px)"),e=pt("(max-width:920px)");let r=D==null?void 0:D.id;const[f,p]=i.useState({search:!1,searching:!1}),[$,M]=i.useState(),{getPaginatedData:j}=Xt(),{findMultipleById:T,findById:_,fetchAndSetAll:O,getLocalStorage:P,setLocalStorage:Ct,toastAndNavigate:jt}=vt(),_t=document.getElementById("reload-btn"),N=y?y.classId:null,Pt=(J=_((H=t==null?void 0:t.studentData)==null?void 0:H.section,v==null?void 0:v.listData))==null?void 0:J.section_name,Nt=(X=_((K=t==null?void 0:t.studentData)==null?void 0:K.class,A==null?void 0:A.listData))==null?void 0:X.class_name,It=!0;let Q=N?{classId:N}:null;if(x===5){const a=P("auth").id;Q={...Q,parentId:a}}const kt=i.useCallback(a=>{const Wt=[`/get-by-pk/student/${a}`,`/get-address/student/${a}`,`/get-image/student/${a}`];u.CommonAPI.multipleAPICall("GET",Wt).then(d=>{var I,ut,gt,mt,ft;d[0].data.data&&(d[0].data.data.subjects=T(d[0].data.data.subjects,(I=o==null?void 0:o.listData)==null?void 0:I.rows));const G={studentData:d[0].data.data,addressData:(gt=(ut=d[1])==null?void 0:ut.data)==null?void 0:gt.data,imageData:(ft=(mt=d[2])==null?void 0:mt.data)==null?void 0:ft.data};c(G)}).catch(d=>{var G,I;throw jt(W,!0,"error",d?(I=(G=d==null?void 0:d.response)==null?void 0:G.data)==null?void 0:I.msg:"An Error Occurred"),d})},[(Y=o==null?void 0:o.listData)==null?void 0:Y.rows,r]);i.useEffect(()=>{var a;(a=o==null?void 0:o.listData)!=null&&a.length||O(W,Kt,u.SubjectAPI)},[(Z=o==null?void 0:o.listData)==null?void 0:Z.length]),i.useEffect(()=>{r&&(kt(r),u.CountryAPI.getCountries().then(a=>{a.status==="Success"&&w(a.data.list)}).catch(a=>{throw a}),u.StateAPI.getAllStates().then(a=>{a.status==="Success"&&z(a.data.rows)}).catch(a=>{throw a}),u.CityAPI.getAllCities().then(a=>{a.status==="Success"&&F(a.data.rows)}).catch(a=>{throw a}))},[r]),i.useEffect(()=>{const a=P("menu");W(Gt(a.selected))},[]),i.useEffect(()=>{N&&Ct("class",N)},[N]);const Bt={Session:(R=t==null?void 0:t.studentData)==null?void 0:R.session,Name:(tt=t==null?void 0:t.studentData)==null?void 0:tt.firstname,Email:(et=t==null?void 0:t.studentData)==null?void 0:et.email,Dob:(at=t==null?void 0:t.studentData)==null?void 0:at.dob,Admission_date:(nt=t==null?void 0:t.studentData)==null?void 0:nt.admission_date,Blood_group:(ot=t==null?void 0:t.studentData)==null?void 0:ot.blood_group,Class:Nt,Section:Pt},Et={Father_name:(st=t==null?void 0:t.studentData)==null?void 0:st.father_name,Mother_name:(it=t==null?void 0:t.studentData)==null?void 0:it.mother_name,Guardian:(ct=t==null?void 0:t.studentData)==null?void 0:ct.guardian,Contact_no:(lt=t==null?void 0:t.studentData)==null?void 0:lt.contact_no,Religion:(rt=t==null?void 0:t.studentData)==null?void 0:rt.religion,Caste_group:(dt=t==null?void 0:t.studentData)==null?void 0:dt.caste_group,Gender:(ht=t==null?void 0:t.studentData)==null?void 0:ht.gender};return n.jsxs(k,{m:"10px",position:"relative",sx:{borderRadius:"20px",border:"0.5px solid black",overflow:"hidden",boxShadow:"1px 1px 10px black",backgroundImage:E.palette.mode==="light"?`linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url(${xt})`:`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${xt})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:[n.jsx(k,{height:m?"19vh":e?"8vh":"11vh",borderRadius:"4px",padding:m?"1vh":"2vh",backgroundColor:C.blueAccent[700],children:n.jsxs(k,{display:"flex",height:m?"16vh":"7vh",flexDirection:m?"column":"row",justifyContent:"space-between",alignItems:m?"center":"normal",children:[n.jsx(yt,{component:"h2",variant:"h2",color:C.grey[100],fontWeight:"bold",children:h}),n.jsx(zt,{action:St,api:u.StudentAPI,getSearchData:j,oldPagination:$,reloadBtn:_t,setSearchFlag:p}),x>1&&n.jsx(q,{type:"submit",color:"success",variant:"contained",onClick:()=>{V("/student/create")},sx:{height:e?"4vh":"auto"},children:Ft.includes(h)?"Admission":`Create New ${h}`})]})}),n.jsx(Ut,{action:St,api:u.StudentAPI,getQuery:j,columns:Yt(x,s),rolePriority:x,condition:Q,importBtn:It,rows:b.rows,count:b.count,loading:U,selected:h,pageSizeOptions:Zt,setOldPagination:M,searchFlag:f,setSearchFlag:p}),n.jsx(Qt,{open:L,setOpen:s,title:"Student Details",horizontalData:Bt,verticalData:Et,detail:t,countryData:l,stateData:B,cityData:S})]})};Rt.propTypes={rolePriority:Lt.number};export{Rt as default};
