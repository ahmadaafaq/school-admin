import{q as ne,s as oe,P as q,u as M,t as W,h as T,a as c,l as F,v as $,w as J,x as ie,k as re,y as Y,A as I,j as e,D as le,m as G,T as L,F as ce,B as x,z as de,C as ue,I as me,S as pe,E as Q,M as ge,G as he,p as P,H as xe,J as fe,U as z,Q as _}from"./index-zLCHO5gj.js";import{l as H,S as be,a as Ce}from"./listBG-jqFZybtA.js";import{d as je}from"./DriveFileRenameOutlineOutlined-sr1QJdZi.js";import{u as ye}from"./index-mkkoW40k.js";import"./FormControlLabel-SXp-cdUw.js";import"./toPropertyKey-mta9U6ZT.js";import"./typeof-Q9eVcF_1.js";import"./ListItemText-2nz_AZOg.js";import"./CircularProgress-ieWN9mTc.js";import"./TableCell-yZ9kbJpi.js";const Se=ne().shape({name:oe().min(1,"Name is Too Short!").max(40,"Name is Too Long!").required("This Field is Required")}),V={name:"",status:"active",subjects:[]},K=({openDialog:v,setOpenDialog:f})=>{const m=M(),u=W(m.palette.mode),A=T(m.breakpoints.down("md")),b=T("(max-width:480px)"),C=T("(max-width:920px)"),j=()=>{f(!1)},[a,k]=c.useState("Create"),[O,n]=c.useState(!1),[D,p]=c.useState(V),E=F(t=>t.menuItems.selected),w=F(t=>t.toastInfo),d=$(),r=J(),{state:y}=ie(),{typography:g}=re(m.palette.mode),{toastAndNavigate:h,getLocalStorage:X,getIdsFromObject:B}=z();let N=y==null?void 0:y.id;c.useEffect(()=>{const t=X("menu");r(Y(t.selected)),N?(k("Update"),ee(N)):(k("Create"),p(V))},[N]);const Z=c.useCallback(t=>{const o=[{...t,subjects:B(t.subjects)}],s=["/update-class"];n(!0),I.CommonAPI.multipleAPICall("PATCH",s,o).then(i=>{let l=!0;i.forEach(S=>{S.data.status!=="Success"&&(l=!1)}),l?(n(!1),h(r,!0,"info","Successfully Updated",d,"/class/listing",location.reload())):(n(!1),h(r,!0,"error","An Error Occurred. Please Try Again",d,location.reload()))}).catch(i=>{var l,S;throw n(!1),h(r,!0,"error",(S=(l=i==null?void 0:i.response)==null?void 0:l.data)==null?void 0:S.msg),i})},[]),ee=c.useCallback(t=>{n(!0);const o=[`/get-by-pk/class/${t}`];I.CommonAPI.multipleAPICall("GET",o).then(s=>{s[0].data.status==="Success"?(p(s[0].data.data),n(!1)):(n(!1),h(r,!0,"error","An Error Occurred, Please Try Again",d,0))}).catch(s=>{var i,l;throw n(!1),h(r,!0,"error",s?(l=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:l.msg:"An Error Occurred",d,0),s})},[]),te=c.useCallback(t=>{n(!0),t={...t,subjects:B(t==null?void 0:t.subjects)},I.ClassAPI.createClass(t).then(({data:o})=>{(o==null?void 0:o.status)==="Success"?(n(!1),h(r,!0,"success","Successfully Created"),setTimeout(()=>{j(),d(0)},2e3)):(n(!1),h(r,!0,"error","An Error Occurred, Please Try Again",d,0))}).catch(o=>{var s,i;throw n(!1),h(r,!0,o?(i=(s=o.response)==null?void 0:s.data)==null?void 0:i.msg:"An Error Occurred",d,0),o})},[]);return e.jsx("div",{children:e.jsxs(le,{fullScreen:A,open:v,onClose:j,"aria-labelledby":"responsive-dialog-title",sx:{top:b?"33%":C?"25%":"20%",height:b?"49%":C?"39%":"60%","& .MuiPaper-root":{width:"100%",backgroundImage:m.palette.mode=="light"?`linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url(${G})`:`linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), url(${G})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}},children:[e.jsx(L,{fontFamily:g.fontFamily,fontSize:g.h2.fontSize,color:u.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${a} ${E}`}),e.jsx(ce,{initialValues:D,enableReinitialize:!0,validationSchema:Se,onSubmit:t=>{t.id?Z(t):te(t)},children:({values:t,errors:o,touched:s,dirty:i,isSubmitting:l,handleBlur:S,handleChange:U,handleSubmit:ae,resetForm:se})=>e.jsxs("form",{onSubmit:ae,children:[e.jsxs(x,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(de,{variant:"filled",type:"text",name:"name",label:"Name*",autoComplete:"new-name",onBlur:S,onChange:U,value:t.name,error:!!s.name&&!!o.name,helperText:s.name&&o.name}),e.jsxs(ue,{variant:"filled",sx:{minWidth:120},error:!!s.status&&!!o.status,children:[e.jsx(me,{id:"statusField",children:"Status"}),e.jsx(pe,{variant:"filled",labelId:"statusField",label:"Status",name:"status",autoComplete:"new-status",value:t.status,onChange:U,children:Object.keys(Q.status).map(R=>e.jsx(ge,{value:R,children:Q.status[R]},R))})]})]}),e.jsx(he,{}),e.jsxs(x,{display:"flex",justifyContent:"end",p:"20px",children:[a==="Update"?null:e.jsx(P,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!i||l,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&se()},children:"Reset"}),e.jsx(P,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>j(),children:"Cancel"}),e.jsx(P,{type:"submit",disabled:!i||l,color:a==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(xe,{alerting:w.toastAlert,severity:w.toastSeverity,message:w.toastMessage})]})]})}),O===!0?e.jsx(fe,{}):null]})})};K.propTypes={openDialog:q.bool,setOpenDialog:q.func};const ve=v=>{const f=$(),m=M(),u=W(m.palette.mode),{capitalizeEveryWord:A,formatDate:b}=z(),C=a=>{v(),f("#",{state:{id:a}})};return[{field:"class_name",headerName:"Name",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"status",headerName:"Status",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:a}})=>e.jsx(x,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:a==="active"?u.greenAccent[600]:u.redAccent[700],borderRadius:"4px",children:e.jsx(L,{color:u.grey[100],sx:{ml:"5px"},children:A(a)||""})})},{field:"updated_at",headerName:"Updated",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:a=>`${b(a.value)||""}`},{field:"action",headerName:"Action",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{class_id:a}})=>e.jsx(x,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(P,{color:"info",variant:"contained",onClick:()=>C(a),sx:{minWidth:"50px"},children:e.jsx(je,{})})})}]},Ae=[5,10,20],Re=()=>{const[v,f]=c.useState(!1),[m,u]=c.useState({search:!1,searching:!1}),[A,b]=c.useState(),C=$(),j=J(),a=F(g=>g.menuItems.selected),{listData:k,loading:O}=F(g=>g.listingClasses),n=M(),D=W(n.palette.mode),p=T("(max-width:480px)"),E=T("(max-width:920px)"),w=document.getElementById("reload-btn"),{getPaginatedData:d}=ye(),{getLocalStorage:r}=z();c.useEffect(()=>{const g=r("menu");j(Y(g.selected))},[]);const y=()=>{f(!0)};return e.jsxs(x,{m:"10px",position:"relative",sx:{borderRadius:"20px",border:"0.5px solid black",overflow:"hidden",boxShadow:"1px 1px 10px black",backgroundImage:n.palette.mode==="light"?`linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url(${H})`:`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${H})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:[e.jsx(x,{height:p?"19vh":E?"8vh":"11vh",borderRadius:"4px",padding:p?"1vh":"2vh",backgroundColor:D.blueAccent[700],children:e.jsxs(x,{display:"flex",height:p?"16vh":"7vh",flexDirection:p?"column":"row",justifyContent:"space-between",alignItems:p?"center":"normal",children:[e.jsx(L,{component:"h2",variant:"h2",color:D.grey[100],fontWeight:"bold",children:a}),e.jsx(be,{action:_,api:I.ClassAPI,getSearchData:d,oldPagination:A,reloadBtn:w,setSearchFlag:u}),e.jsxs(P,{type:"submit",color:"success",variant:"contained",onClick:()=>{C("#",{state:{id:void 0}}),y()},sx:{height:E?"4vh":"auto"},children:["Create New ",a]})]})}),e.jsx(Ce,{action:_,api:I.ClassAPI,getQuery:d,columns:ve(y),rows:k.rows,count:k.count,loading:O,selected:a,pageSizeOptions:Ae,setOldPagination:b,searchFlag:m,setSearchFlag:u}),e.jsx(K,{openDialog:v,setOpenDialog:f})]})};export{Re as default};
