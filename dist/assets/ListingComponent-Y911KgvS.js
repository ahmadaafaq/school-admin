import{r as se,i as oe,j as n,v as ie,u as Q,t as U,B as C,T as Y,p as re,U as J,a as i,l as m,w as le,h as L,y as ce,V as de,A,W as ue,C as $,I as q,S as H,M as _,P as he}from"./index-zLCHO5gj.js";import me from"./FormInModalComponent-BWw4k-v2.js";import{l as V,S as ge,a as pe}from"./listBG-jqFZybtA.js";import{s as fe,a as G}from"./SectionAction-X4gvrGyO.js";import{a as b}from"./StudentAction-ARQ8Q4-i.js";import{u as xe}from"./index-mkkoW40k.js";import"./PaymentMethodAction-X7E_0a2C.js";import"./TableCell-yZ9kbJpi.js";import"./FormControlLabel-SXp-cdUw.js";import"./toPropertyKey-mta9U6ZT.js";import"./typeof-Q9eVcF_1.js";import"./ListItemText-2nz_AZOg.js";import"./CircularProgress-ieWN9mTc.js";var E={},ve=oe;Object.defineProperty(E,"__esModule",{value:!0});var K=E.default=void 0,Ae=ve(se()),Ce=n;K=E.default=(0,Ae.default)((0,Ce.jsx)("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote");const ye=(w=null,P=null)=>{const y=ie(),e=Q(),c=U(e.palette.mode),{capitalizeEveryWord:s}=J(),S=(a,r,l,I,o)=>{P(!0),y("#",{state:{id:a,cls:r,section:l,firstname:I,lastname:o}})};return[{field:"fullname",headerName:" Name",headerAlign:"center",align:"center",flex:1,minWidth:120,valueGetter:a=>`${s(a.row.firstname)||""} ${s(a.row.lastname)||""}`},{field:"session",headerName:"Academic Year",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"status",headerName:"Status",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:a}})=>n.jsx(C,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:a==="active"?c.greenAccent[600]:c.redAccent[700],borderRadius:"4px",children:n.jsx(Y,{color:c.grey[100],sx:{ml:"5px"},children:s(a)||""})})},w!==1&&{field:"action",headerName:"Action",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:a})=>n.jsx(C,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:n.jsx(re,{color:"info",variant:"contained",onClick:()=>S(a.id,a.class,a.section,a.firstname,a.lastname),sx:{minWidth:"50px"},children:n.jsx(K,{})})})}]},Ie=[5,10,20],_e=({rolePriority:w=null})=>{var M,N,T,B,F;const[P,y]=i.useState(!1),[e,c]=i.useState(null),[s,S]=i.useState([]),d=m(t=>t.schoolClasses),a=m(t=>t.allClasses),r=m(t=>t.schoolSections),l=m(t=>t.allSections),I=m(t=>t.menuItems.selected),{listData:o,loading:X}=m(t=>t.allStudents),R=Q(),g=le(),p=L("(max-width:480px)"),W=L("(max-width:920px)"),[Z,j]=i.useState({search:!1,searching:!1}),[O,ee]=i.useState(),{getPaginatedData:k}=xe(),{fetchAndSetAll:z,fetchAndSetSchoolData:te,getLocalStorage:D}=J(),u=U(R.palette.mode),ne=document.getElementById("reload-btn");let f=e!=null&&e.class?{classId:e.class}:null;return f=e!=null&&e.section?{...f,sectionId:e.section}:null,i.useEffect(()=>{const t=D("menu");g(ce(t.selected))},[]),i.useEffect(()=>{var t,x,v,h;D("schoolInfo")||((t=a==null?void 0:a.listData)!=null&&t.length||z(g,de,A.ClassAPI),(x=l==null?void 0:l.listData)!=null&&x.length||z(g,fe,A.SectionAPI)),D("schoolInfo")&&(!((v=d==null?void 0:d.listData)!=null&&v.length)||!((h=r==null?void 0:r.listData)!=null&&h.length)||!(s!=null&&s.length))&&te(g,ue,G,S)},[]),i.useEffect(()=>{e!=null&&e.class&&(e!=null&&e.section)&&k(0,5,b,A.StudentAPI,f)},[e==null?void 0:e.class,e==null?void 0:e.section]),i.useEffect(()=>{(()=>{const x=(s==null?void 0:s.filter(h=>h.class_id===(e==null?void 0:e.class)))||[],v=x.map(({section_id:h,section_name:ae})=>({section_id:h,section_name:ae}));console.log(e,f,x,v,s,"5 value"),g(G(v))})()},[e==null?void 0:e.class,s==null?void 0:s.length]),i.useEffect(()=>{var t;(t=o==null?void 0:o.rows)!=null&&t.length&&!(e!=null&&e.class)&&!(e!=null&&e.section)&&c({...e,class:o.rows[0].class,section:o.rows[0].section})},[(M=o==null?void 0:o.rows)==null?void 0:M.length]),n.jsxs(C,{m:"10px",position:"relative",sx:{borderRadius:"20px",border:"0.5px solid black",overflow:"hidden",boxShadow:"1px 1px 10px black",backgroundImage:R.palette.mode==="light"?`linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url(${V})`:`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${V})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:[n.jsx(C,{height:p?"19vh":W?"8vh":"11vh",borderRadius:"4px",padding:p?"1vh":"2vh",backgroundColor:u.blueAccent[700],children:n.jsxs(C,{display:"flex",height:p?"16vh":"7vh",flexDirection:p?"column":"row",justifyContent:"space-between",alignItems:p?"center":"normal",children:[n.jsx(Y,{component:"h2",variant:"h2",color:u.grey[100],fontWeight:"bold",children:I}),n.jsxs($,{variant:"filled",sx:{minWidth:120,marginRight:"10px"},children:[n.jsx(q,{children:"Class"}),n.jsx(H,{variant:"filled",value:(e==null?void 0:e.class)||"",onChange:t=>c({...e,class:t.target.value}),sx:{height:"100%",marginLeft:"1vh",backgroundColor:u.blueAccent[800],"&:hover":{backgroundColor:u.blueAccent[800]}},children:(N=a==null?void 0:a.listData)!=null&&N.length?a.listData.map(t=>n.jsx(_,{value:t.class_id,children:t.class_name},t.class_id)):(T=d==null?void 0:d.listData)!=null&&T.length?d.listData.map(t=>n.jsx(_,{value:t.class_id,children:t.class_name},t.class_id)):null})]}),n.jsxs($,{variant:"filled",sx:{minWidth:120,height:W?"4vh":"auto"},children:[n.jsx(q,{children:"Section"}),n.jsx(H,{variant:"filled",value:(e==null?void 0:e.section)||"",onChange:t=>c({...e,section:t.target.value}),sx:{height:"100%",marginRight:"1vh",backgroundColor:u.blueAccent[800],"&:hover":{backgroundColor:u.blueAccent[800]}},children:(B=l==null?void 0:l.listData)!=null&&B.length?l.listData.map(t=>n.jsx(_,{value:t.section_id,children:t.section_name},t.section_id)):(F=r==null?void 0:r.listData)!=null&&F.length?r.listData.map(t=>n.jsx(_,{value:t.section_id,children:t.section_name},t.section_id)):null})]}),n.jsx(ge,{action:b,api:A.StudentAPI,getSearchData:k,oldPagination:O,reloadBtn:ne,setSearchFlag:j})]})}),n.jsx(pe,{action:b,api:A.StudentAPI,getQuery:k,columns:ye(w,y),condition:f,rows:o.rows,count:o.count,loading:X,selected:I,pageSizeOptions:Ie,setOldPagination:ee,searchFlag:Z,setSearchFlag:j}),n.jsx(me,{openDialog:P,setOpenDialog:y})]})};_e.propTypes={rolePriority:he.number};export{_e as default};
