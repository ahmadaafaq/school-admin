import{q as se,s as ne,P as B,u as R,t as M,h as k,a as c,l as E,v as W,w as _,x as oe,k as ie,y as H,A as T,j as e,D as re,m as U,T as $,F as le,B as x,z as ce,C as de,I as ue,S as me,E as q,M as pe,G as ge,p as w,H as he,J as xe,U as L}from"./index-zLCHO5gj.js";import{l as G,S as fe,a as be}from"./listBG-jqFZybtA.js";import{d as je}from"./DriveFileRenameOutlineOutlined-sr1QJdZi.js";import{b as Q}from"./SubjectAction-cByBtOva.js";import{u as Se}from"./index-mkkoW40k.js";import"./FormControlLabel-SXp-cdUw.js";import"./toPropertyKey-mta9U6ZT.js";import"./typeof-Q9eVcF_1.js";import"./ListItemText-2nz_AZOg.js";import"./CircularProgress-ieWN9mTc.js";import"./TableCell-yZ9kbJpi.js";const ve=se().shape({name:ne().min(0,"Name is Too Short!").max(40,"Name is Too Long!").required("This Field is Required")}),V={name:"",status:"inactive"},J=({openDialog:v,setOpenDialog:f})=>{const i=R(),b=M(i.palette.mode),y=k(i.breakpoints.down("md")),j=k("(max-width:480px)"),u=k("(max-width:920px)"),m=()=>{f(!1)},[n,I]=c.useState("Create"),[F,o]=c.useState(!1),[P,p]=c.useState(V),D=E(a=>a.menuItems.selected),C=E(a=>a.toastInfo),d=W(),r=_(),{state:S}=oe(),{typography:g}=ie(i.palette.mode),{toastAndNavigate:h,getLocalStorage:Y}=L();let O=S==null?void 0:S.id;c.useEffect(()=>{const a=Y("menu");r(H(a.selected)),O?(I("Update"),X(O)):(I("Create"),p(V))},[O]);const K=c.useCallback(a=>{o(!0),T.SubjectAPI.updateSubject(a).then(({data:t})=>{t.status==="Success"?(o(!1),h(r,!0,"info","Successfully Updated"),setTimeout(()=>{m(),location.href="/subject/listing"},2e3)):(o(!1),h(r,!0,"error","An Error Occurred, Please Try Again",d,location.reload()))}).catch(t=>{var s,l;throw o(!1),h(r,!0,"error",t?(l=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:l.msg:"An Error Occurred",d,0),t})},[]),X=c.useCallback(a=>{o(!0);const t=[`/get-by-pk/subject/${a}`];T.CommonAPI.multipleAPICall("GET",t).then(s=>{s[0].data.status==="Success"?(p(s[0].data.data),o(!1)):(o(!1),h(r,!0,"error","An Error Occurred, Please Try Again",d,location.reload()))}).catch(s=>{var l,A;throw o(!1),h(r,!0,"error",s?(A=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:A.msg:"An Error Occurred",d,0),s})},[]),Z=c.useCallback(a=>{o(!0),T.SubjectAPI.createSubject(a).then(({data:t})=>{t.status==="Success"?(o(!1),h(r,!0,"success","Successfully Created"),setTimeout(()=>{m(),d(0)},2e3)):(o(!1),h(r,!0,"error","An Error Occurred, Please Try Again",d,0))}).catch(t=>{var s,l;throw o(!1),h(r,!0,t?(l=(s=t.response)==null?void 0:s.data)==null?void 0:l.msg:"An Error Occurred",d,location.reload()),t})},[]);return e.jsx("div",{children:e.jsxs(re,{fullScreen:y,open:v,onClose:m,"aria-labelledby":"responsive-dialog-title",sx:{top:j?"33%":u?"25%":"20%",height:j?"49%":u?"39%":"60%","& .MuiPaper-root":{width:"100%",backgroundImage:i.palette.mode=="light"?`linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url(${U})`:`linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), url(${U})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}},children:[e.jsx($,{fontFamily:g.fontFamily,fontSize:g.h2.fontSize,color:b.grey[100],fontWeight:"600",display:"inline-block",textAlign:"center",marginTop:"10px",children:`${n} ${D}`}),e.jsx(le,{initialValues:P,enableReinitialize:!0,validationSchema:ve,onSubmit:a=>{a.id?K(a):Z(a)},children:({values:a,errors:t,touched:s,dirty:l,isSubmitting:A,handleBlur:ee,handleChange:z,handleSubmit:te,resetForm:ae})=>e.jsxs("form",{onSubmit:te,children:[e.jsxs(x,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",padding:"20px",children:[e.jsx(ce,{variant:"filled",type:"text",name:"name",label:"Name*",onBlur:ee,onChange:z,value:a.name,error:!!s.name&&!!t.name,helperText:s.name&&t.name}),e.jsxs(de,{variant:"filled",sx:{minWidth:120},error:!!s.status&&!!t.status,children:[e.jsx(ue,{id:"statusField",children:"Status"}),e.jsx(me,{variant:"filled",labelId:"statusField",label:"Status",name:"status",value:a.status,onChange:z,children:Object.keys(q.status).map(N=>e.jsx(pe,{value:N,children:q.status[N]},N))})]})]}),e.jsx(ge,{}),e.jsxs(x,{display:"flex",justifyContent:"end",p:"20px",children:[n==="Update"?null:e.jsx(w,{type:"reset",color:"warning",variant:"contained",sx:{mr:3},disabled:!l||A,onClick:()=>{window.confirm("Do You Really Want To Reset?")&&ae()},children:"Reset"}),e.jsx(w,{color:"error",variant:"contained",sx:{mr:3},onClick:()=>m(),children:"Cancel"}),e.jsx(w,{type:"submit",disabled:!l||A,color:n==="Update"?"info":"success",variant:"contained",children:"Submit"}),e.jsx(he,{alerting:C.toastAlert,severity:C.toastSeverity,message:C.toastMessage})]})]})}),F===!0?e.jsx(xe,{}):null]})})};J.propTypes={openDialog:B.bool,setOpenDialog:B.func};const ye=v=>{const f=R(),i=M(f.palette.mode),{capitalizeEveryWord:b,formatDate:y}=L(),j=W(),u=n=>{v(),j("#",{state:{id:n}})};return[{field:"name",headerName:"Name",headerAlign:"center",align:"center",flex:1,minWidth:120},{field:"status",headerName:"Status",headerAlign:"center",align:"center",flex:1,minWidth:120,renderCell:({row:{status:n}})=>e.jsx(x,{width:"60%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",backgroundColor:n==="active"?i.greenAccent[600]:i.redAccent[700],borderRadius:"4px",children:e.jsx($,{color:i.grey[100],sx:{ml:"5px"},children:b(n)||""})})},{field:"updated_at",headerName:"Updated",headerAlign:"center",align:"center",flex:1,minWidth:100,valueFormatter:n=>`${y(n.value)}`},{field:"action",headerName:"Action",headerAlign:"center",align:"center",flex:1,minWidth:75,renderCell:({row:{id:n}})=>e.jsx(x,{width:"30%",m:"0 auto",p:"5px",display:"flex",justifyContent:"center",children:e.jsx(w,{color:"info",variant:"contained",onClick:()=>u(n),sx:{minWidth:"50px"},children:e.jsx(je,{})})})}]},Ce=[5,10,20],Re=()=>{const[v,f]=c.useState(!1),[i,b]=c.useState({search:!1,searching:!1}),[y,j]=c.useState(),u=E(g=>g.menuItems.selected),{listData:m,loading:n}=E(g=>g.listingSubjects),I=W(),F=_(),o=R(),P=M(o.palette.mode),p=k("(max-width:480px)"),D=k("(max-width:920px)"),C=document.getElementById("reload-btn"),{getPaginatedData:d}=Se(),{getLocalStorage:r}=L();c.useEffect(()=>{const g=r("menu");F(H(g.selected))},[]);const S=()=>{f(!0)};return e.jsxs(x,{m:"10px",position:"relative",sx:{borderRadius:"20px",border:"0.5px solid black",overflow:"hidden",boxShadow:"1px 1px 10px black",backgroundImage:o.palette.mode==="light"?`linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), url(${G})`:`linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${G})`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:[e.jsx(x,{height:p?"19vh":D?"8vh":"11vh",borderRadius:"4px",padding:p?"1vh":"2vh",backgroundColor:P.blueAccent[700],children:e.jsxs(x,{display:"flex",height:p?"16vh":"7vh",flexDirection:p?"column":"row",justifyContent:"space-between",alignItems:p?"center":"normal",children:[e.jsx($,{component:"h2",variant:"h2",color:P.grey[100],fontWeight:"bold",children:u}),e.jsx(fe,{action:Q,api:T.SubjectAPI,getSearchData:d,oldPagination:y,reloadBtn:C,setSearchFlag:b}),e.jsxs(w,{type:"submit",color:"success",variant:"contained",onClick:()=>{I("#",{state:{id:void 0}}),S()},sx:{height:D?"4vh":"auto"},children:["Create New ",u]})]})}),e.jsx(be,{action:Q,api:T.SubjectAPI,getQuery:d,columns:ye(S),rows:m.rows,count:m.count,loading:n,selected:u,pageSizeOptions:Ce,setOldPagination:j,searchFlag:i,setSearchFlag:b}),e.jsx(J,{openDialog:v,setOpenDialog:f})]})};export{Re as default};
